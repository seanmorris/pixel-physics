!function(){"use strict";var t="undefined"==typeof global?self:global;if("function"!=typeof t.require){var e={},r={},n={},i={}.hasOwnProperty,o=/^\.\.?(\/|$)/,a=function(t,e){for(var r,n=[],i=(o.test(e)?t+"/"+e:e).split("/"),a=0,s=i.length;a<s;a++)".."===(r=i[a])?n.pop():"."!==r&&""!==r&&n.push(r);return n.join("/")},s=function(t){return t.split("/").slice(0,-1).join("/")},c=function(e,n){var i,o={id:e,exports:{},hot:p&&p.createHot(e)};return r[e]=o,n(o.exports,(i=e,function(e){var r=a(s(i),e);return t.require(r,i)}),o),o.exports},u=function(t){var e=n[t];return e&&t!==e?u(e):t},l=function(t,n){null==n&&(n="/");var o=u(t);if(i.call(r,o))return r[o].exports;if(i.call(e,o))return c(o,e[o]);throw new Error("Cannot find module '"+t+"' from '"+n+"'")};l.alias=function(t,e){n[e]=t};var f=/\.[^.\/]+$/,h=/\/index(\.[^\/]+)?$/;l.register=l.define=function(t,o){if(t&&"object"==typeof t)for(var a in t)i.call(t,a)&&l.register(a,t[a]);else e[t]=o,delete r[t],function(t){if(f.test(t)){var e=t.replace(f,"");i.call(n,e)&&n[e].replace(f,"")!==e+"/index"||(n[e]=t)}if(h.test(t)){var r=t.replace(h,"");i.call(n,r)||(n[r]=t)}}(t)},l.list=function(){var t=[];for(var r in e)i.call(e,r)&&t.push(r);return t};var p=t._hmr&&new t._hmr(function(t,e){return u(a(s(t),e))},l,e,r);l._cache=r,l.hmr=p&&p.wrap,l.brunch=!0,t.require=l}}(),function(){"undefined"==typeof window||window;var t=function(t,e,r){var n={},i=function(e,r){try{return t(r+"/node_modules/"+e)}catch(t){if(-1===t.toString().indexOf("Cannot find module"))throw t;if(-1!==r.indexOf("node_modules")){var o=r.split("/"),a=o.lastIndexOf("node_modules"),s=o.slice(0,a).join("/");return i(e,s)}}return n};return function(o){if(o in e&&(o=e[o]),o){if("."!==o[0]&&r){var a=i(o,r);if(a!==n)return a}return t(o)}}};require.register("curvature/animate/Ease.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Ease=void 0;var n=r("../base/Mixin"),i=r("../mixin/PromiseMixin");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=c(e);if(r){var o=c(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e)}(this,n)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(l,n.Mixin["with"](i.PromiseMixin));var e,r,c,u=s(l);function l(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=u.call(this)).interval=t,e.terminal=!1,e.initial=!1,e.timeout=!1,e.final=!1,e.canceled=!1,e.done=!1,e.calculate=!!(e.calculate||"calculate"in r)&&r.calculate,e.bounded=!("bounded"in r)||r.bounded,e.repeat="repeat"in r?r.repeat:1,e.reverse="reverse"in r&&r.reverse,e}return e=l,(r=[{key:"start",value:function(){var t=this;this.done=!1,requestAnimationFrame(function(){t.initial=Date.now(),t.terminal=t.initial+t.interval,t.repeat>=0&&(t.terminal=t.initial+t.interval*t.repeat,t.timeout=setTimeout(function(){if(t.done)return t.reverse?0:1;t.done=!0,t[i.PromiseMixin.Accept](t.reverse?0:1)},t.interval*t.repeat))})}},{key:"cancel",value:function(){return this.done?this.final:(clearTimeout(this.timeout),this.final=this.current(),this.canceled=this.done=!0,this[i.PromiseMixin.Reject](this.final),this.final)}},{key:"fraction",value:function(){if(this.done)return this.reverse?0:1;if(!1===this.initial)return this.reverse?1:0;var t=Date.now()-this.initial;if(t/this.interval>=this.repeat)return this.reverse?0:1;var e=t%this.interval/this.interval;return this.reverse?1-e:e}},{key:"current",value:function(){var t=this.fraction();return this.calculate?this.calculate(t):t}}])&&o(e.prototype,r),c&&o(e,c),Object.defineProperty(e,"prototype",{writable:!1}),l}();e.Ease=u}()}),require.register("curvature/animate/ease/CubicInOut.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.CubicInOut=void 0;var n=r("../Ease");function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=c(e);if(r){var o=c(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}(this,n)}}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o(t,e)}(l,n.Ease);var e,r,c,u=a(l);function l(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=u.call.apply(u,[this].concat(o)),e=s(t),n=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},(r="calculate")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t}return e=l,r&&i(e.prototype,r),c&&i(e,c),Object.defineProperty(e,"prototype",{writable:!1}),e}();e.CubicInOut=u}()}),require.register("curvature/animate/ease/QuintInOut.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.QuintInOut=void 0;var n=r("../Ease");function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=c(e);if(r){var o=c(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}(this,n)}}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o(t,e)}(l,n.Ease);var e,r,c,u=a(l);function l(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=u.call.apply(u,[this].concat(o)),e=s(t),n=function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},(r="calculate")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t}return e=l,r&&i(e.prototype,r),c&&i(e,c),Object.defineProperty(e,"prototype",{writable:!1}),e}();e.QuintInOut=u}()}),require.register("curvature/base/Bag.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Bag=void 0;var n=r("./Bindable"),i=r("./Mixin"),o=r("../mixin/EventTargetMixin");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=u(e);if(r){var o=u(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e)}(this,n)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=Symbol("Mapped"),f=Symbol("Has"),h=Symbol("Add"),p=Symbol("Remove"),g=Symbol("Delete"),d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(y,i.Mixin["with"](o.EventTargetMixin));var e,r,u,d=c(y);function y(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),(t=d.call(this)).changeCallback=e,t.content=new Map,t.current=0,t.length=0,t.list=n.Bindable.makeBindable([]),t.meta=Symbol("meta"),t.type=void 0,t}return e=y,(r=[{key:"has",value:function(t){return this[l]?this[l].has(t):this[f](t)}},{key:f,value:function(t){return this.content.has(t)}},{key:"add",value:function(t){return this[l]?this[l].add(t):this[h](t)}},{key:h,value:function(t){if(void 0===t||!(t instanceof Object))throw new Error("Only objects may be added to Bags.");if(this.type&&!(t instanceof this.type))throw console.error(this.type,t),new Error("Only objects of type ".concat(this.type," may be added to this Bag."));if(!this.content.has(t)){var e=new CustomEvent("adding",{detail:{item:t}});if(this.dispatchEvent(e)){var r,n=(r=this.current++,Number(r));this.content.set(t,n),this.list[n]=t,this.changeCallback&&this.changeCallback(t,this.meta,y.ITEM_ADDED,n);var i=new CustomEvent("added",{detail:{item:t,id:n}});return this.dispatchEvent(i),this.length=this.size,n}}}},{key:"remove",value:function(t){return this[l]?this[l].remove(t):this[p](t)}},{key:p,value:function(t){if(void 0===t||!(t instanceof Object))throw new Error("Only objects may be removed from Bags.");if(this.type&&!(t instanceof this.type))throw console.error(this.type,t),new Error("Only objects of type ".concat(this.type," may be removed from this Bag."));if(!this.content.has(t))return this.changeCallback&&this.changeCallback(t,this.meta,0,void 0),!1;var e=new CustomEvent("removing",{detail:{item:t}});if(this.dispatchEvent(e)){var r=this.content.get(t);delete this.list[r],this.content.delete(t),this.changeCallback&&this.changeCallback(t,this.meta,y.ITEM_REMOVED,r);var n=new CustomEvent("removed",{detail:{item:t,id:r}});return this.dispatchEvent(n),this.length=this.size,t}}},{key:"delete",value:function(t){if(this[l])return this[l].delete(t);this[g](t)}},{key:g,value:function(t){this.remove(t)}},{key:"map",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(t){return t},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},r=new WeakMap,n=new y;return n[l]=this,this.addEventListener("added",function(i){var o=i.detail.item;if(e(o)&&!r.has(o)){var a=t(o);r.set(o,a),n[h](a)}}),this.addEventListener("removed",function(t){var e=t.detail.item;if(r.has(e)){var i=r.get(e);r.delete(e),n[p](i)}}),n}},{key:"size",get:function(){return this.content.size}},{key:"items",value:function(){return Array.from(this.content.entries()).map(function(t){return t[0]})}}])&&a(e.prototype,r),u&&a(e,u),Object.defineProperty(e,"prototype",{writable:!1}),y}();e.Bag=d,Object.defineProperty(d,"ITEM_ADDED",{configurable:!1,enumerable:!1,writable:!0,value:1}),Object.defineProperty(d,"ITEM_REMOVED",{configurable:!1,enumerable:!1,writable:!0,value:-1})}()}),require.register("curvature/base/Bindable.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e,n,i){return(t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o}).apply(null,arguments)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function n(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||o(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=o(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,a=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function o(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t){"@babel/helpers - typeof";return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Object.defineProperty(e,"__esModule",{value:!0}),e.Bindable=void 0;var l=Symbol("ref"),f=Symbol("original"),h=Symbol("deck"),p=Symbol("binding"),g=Symbol("subBinding"),d=Symbol("bindingAll"),y=Symbol("isBindable"),b=Symbol("wrapping"),v=Symbol("Names"),m=Symbol("executing"),w=Symbol("stack"),S=(Symbol("object"),Symbol("wrapped")),O=Symbol("unwrapped"),j=Symbol("getProto"),k=Symbol("onGet"),x=Symbol("onAllGet"),P=Symbol("bindChain"),_=Symbol("Descriptors"),M=Symbol("Before"),R=Symbol("After"),T=Symbol("NoGetters"),A=Object.getPrototypeOf(Int8Array),E=Set.prototype[Symbol.iterator],C=Map.prototype[Symbol.iterator],B=globalThis,D=[B.Node,B.File,B.Map,B.Set,B.WeakMap,B.WeakSet,B.ArrayBuffer,B.ResizeObserver,B.MutationObserver,B.PerformanceObserver,B.IntersectionObserver,B.IDBCursor,B.IDBCursorWithValue,B.IDBDatabase,B.IDBFactory,B.IDBIndex,B.IDBKeyRange,B.IDBObjectStore,B.IDBOpenDBRequest,B.IDBRequest,B.IDBTransaction,B.IDBVersionChangeEvent,B.Event,B.CustomEvent,B.FileSystemFileHandle].filter(function(t){return"function"==typeof t}),I=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,o,a;return r=e,a=[{key:"isBindable",value:function(t){return!(!t||!t[y])&&t[y]===e}},{key:"onDeck",value:function(t,e){return t[h][e]||!1}},{key:"ref",value:function(t){return t[l]||t||!1}},{key:"makeBindable",value:function(t){return this.make(t)}},{key:"shuck",value:function(t,r){r=r||new Map;var n={};if(t instanceof A||t instanceof ArrayBuffer){var i=t.slice(0);return r.set(t,i),i}var o=Object.keys(t);for(var a in o){var c=o[a];if("___"!==c.substring(0,3)){var u=r.get(t[c]);if(u)n[c]=u;else if(t[c]!==t){if(t[c]&&"object"===s(t[c])){var l=t[c];e.isBindable(t[c])&&(l=t[c][f]),n[c]=this.shuck(l,r)}else n[c]=t[c];r.set(t[c],n[c])}else r.set(t[c],n),n[c]=n}}return e.isBindable(t)&&(delete n.bindTo,delete n.isBound),n}},{key:"make",value:function(r){var o=this;if(!r||!["function","object"].includes(s(r)))return r;if(r[l])return r[l];if(r[y])return r;if(Object.isSealed(r)||Object.isFrozen(r)||!Object.isExtensible(r)||D.filter(function(t){return r instanceof t}).length)return r;Object.defineProperty(r,y,{configurable:!1,enumerable:!1,writable:!1,value:e}),Object.defineProperty(r,l,{configurable:!0,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(r,f,{configurable:!1,enumerable:!1,writable:!1,value:r}),Object.defineProperty(r,h,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(r,p,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(r,g,{configurable:!1,enumerable:!1,writable:!1,value:new Map}),Object.defineProperty(r,d,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(r,m,{enumerable:!1,writable:!0}),Object.defineProperty(r,b,{enumerable:!1,writable:!0}),Object.defineProperty(r,w,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(r,M,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(r,R,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(r,S,{configurable:!1,enumerable:!1,writable:!1,value:Object.preventExtensions(new Map)}),Object.defineProperty(r,O,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(r,_,{configurable:!1,enumerable:!1,writable:!1,value:Object.preventExtensions(new Map)});Object.defineProperty(r,"bindTo",{configurable:!1,enumerable:!1,writable:!1,value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=!1;if(Array.isArray(n)){var u=n.forEach(function(e){return t(e,i,a)});return function(){return u.forEach(function(t){return t()})}}if(n instanceof Function&&(a=i||{},i=n,c=!0),a.delay>=0&&(i=o.wrapDelayCallback(i,a.delay)),a.throttle>=0&&(i=o.wrapThrottleCallback(i,a.throttle)),a.wait>=0&&(i=o.wrapWaitCallback(i,a.wait)),a.frame&&(i=o.wrapFrameCallback(i,a.frame)),a.idle&&(i=o.wrapIdleCallback(i)),c){var l=r[d].length;if(r[d].push(i),!("now"in a)||a.now)for(var f in r)i(r[f],f,r,!1);return function(){delete r[d][l]}}if(r[p][n]||(r[p][n]=new Set),a.children){var h=i;i=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var o=n[0],c=r[g].get(h);if(c&&(r[g].delete(h),c()),"object"===s(o)){var u=e.make(o);e.isBindable(u)&&r[g].set(h,u.bindTo(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return h.apply(void 0,n.concat(e))},Object.assign({},a,{children:!1}))),h.apply(void 0,n)}else h.apply(void 0,n)}}r[p][n].add(i),"now"in a&&!a.now||i(r[n],n,r,!1);var y=function(){var t=r[g].get(i);t&&(r[g].delete(i),t()),r[p][n]&&r[p][n].has(i)&&r[p][n].delete(i)};return a.removeWith&&a.removeWith instanceof View&&a.removeWith.onRemove(function(){return y}),y}});Object.defineProperty(r,P,{configurable:!1,enumerable:!1,writable:!1,value:function(t,e){var n=t.split("."),i=n.shift(),a=n.slice(0),s=[];return s.push(r.bindTo(i,function(t,r,n,i){var c=a.join(".");0!==a.length?(void 0===t&&(t=n[r]=o.make({})),s=s.concat(t[P](c,e))):e(t,r,n,i)})),function(){return s.forEach(function(t){return t()})}}}),Object.defineProperty(r,"___before",{configurable:!1,enumerable:!1,writable:!1,value:function(t){var e=r[M].length;r[M].push(t);var n=!1;return function(){n||(n=!0,delete r[M][e])}}}),Object.defineProperty(r,"___after",{configurable:!1,enumerable:!1,writable:!1,value:function(t){var e=r[R].length;r[R].push(t);var n=!1;return function(){n||(n=!0,delete r[R][e])}}});Object.defineProperty(r,"isBound",{configurable:!1,enumerable:!1,writable:!1,value:function(){for(var t in r[d])if(r[d][t])return!0;for(var e in r[p])for(var n in r[p][e])if(r[p][e][n])return!0;return!1}});var a=function(t){r[t]&&r[t]instanceof Object&&!r[t]instanceof Promise&&(D.filter(function(e){return r[t]instanceof e}).length||!Object.isExtensible(r[t])||Object.isSealed(r[t])||(r[t]=e.make(r[t])))};for(var c in r)a(c);var u=r[_],B=r[S],I=r[w],F={get:function(n,o){if(B.has(o))return B.get(o);if(o===l||o===f||"apply"===o||"isBound"===o||"bindTo"===o||"__proto__"===o||"constructor"===o)return r[o];var a;if(u.has(o)?a=u.get(o):(a=Object.getOwnPropertyDescriptor(r,o),u.set(o,a)),a&&!a.configurable&&!a.writable)return r[o];if(x in r)return r[x](o);if(k in r&&!(o in r))return r[k](o);if(a&&!a.configurable&&!a.writable)return B.set(o,r[o]),r[o];if("function"==typeof r[o]){if(v in r[o])return r[o];Object.defineProperty(r[O],o,{configurable:!1,enumerable:!1,writable:!0,value:r[o]});var s=Object.getPrototypeOf(r)[o]===r[o],c="function"==typeof Promise&&r instanceof Promise||"function"==typeof Map&&r instanceof Map||"function"==typeof Set&&r instanceof Set||"function"==typeof C&&r.prototype===C||"function"==typeof E&&r.prototype===E||"function"==typeof E&&r.prototype===E||"function"==typeof WeakMap&&r instanceof WeakMap||"function"==typeof WeakSet&&r instanceof WeakSet||"function"==typeof Date&&r instanceof Date||"function"==typeof A&&r instanceof A||"function"==typeof ArrayBuffer&&r instanceof ArrayBuffer||"function"==typeof EventTarget&&r instanceof EventTarget||"function"==typeof ResizeObserver&&r instanceof ResizeObserver||"function"==typeof MutationObserver&&r instanceof MutationObserver||"function"==typeof PerformanceObserver&&r instanceof PerformanceObserver||"function"==typeof IntersectionObserver&&r instanceof IntersectionObserver||"function"==typeof r[Symbol.iterator]&&"next"===o?r:r[l],h=function(){r[m]=o,I.unshift(o);for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var u,l,f=i(r[M]);try{for(f.s();!(u=f.n()).done;)(0,u.value)(r,o,I,r,n)}catch(t){f.e(t)}finally{f.f()}if(new.target)l=t(r[O][o],n);else{var h=r[O][o];l=s?h.apply(c||r,n):h.apply(void 0,n)}var p,g=i(r[R]);try{for(g.s();!(p=g.n()).done;)(0,p.value)(r,o,I,r,n)}catch(t){g.e(t)}finally{g.f()}return r[m]=null,I.shift(),l};(h[v]=h[v]||new WeakMap).set(r,o),h[x]=function(t){var e=h[v].get(r);return r[e][t]};var p=e.make(h);return B.set(o,p),p}return r[o]},set:function(t,n,o){if(B.has(n)&&B.delete(n),n===f)return!0;var a=r[h];if(n in a&&a[n]===o)return!0;if(n.slice&&"___"===n.slice(-3))return!0;if(t[n]===o||"number"==typeof o&&isNaN(a[n])&&isNaN(o))return!0;for(var s in o&&o instanceof Object&&(D.filter(function(t){return r instanceof t}).length||!Object.isExtensible(r)||Object.isSealed(r)||(r[T],o=e.make(o))),a[n]=o,r[d])r[d][s]&&r[d][s](o,n,t,!1);var c=!1;if(n in r[p]){var u,l=i(r[p][n]);try{for(l.s();!(u=l.n()).done;)!1===(0,u.value)(o,n,t,!1,t[n])&&(c=!0)}catch(t){l.e(t)}finally{l.f()}}if(delete a[n],!c){var g=Object.getOwnPropertyDescriptor(t,n);t instanceof File&&"lastModifiedDate"==n||g&&!g.writable||t[n]!==o||(t[n]=o)}var y=Reflect.set(t,n,o);if(Array.isArray(t)&&r[p].length)for(var b in r[p].length)(0,r[p].length[b])(t.length,"length",t,!1,t.length);return y},construct:function(i,o){var a="constructor";for(var s in i[M])i[M][s](i,a,r[w],void 0,o);var c=e.make(t(i[f],n(o)));for(var u in i[R])i[R][u](i,a,r[w],c,o);return c},getPrototypeOf:function(t){return j in r?r[j]:Reflect.getPrototypeOf(t)},deleteProperty:function(t,e){var n=r[h];if(void 0!==n[e])return!0;if(!(e in t))return!0;if(u.has(e)){var o=u.get(e);if(o&&!o.configurable)return!1;u.delete(e)}for(var a in n[e]=null,B.has(e)&&B.delete(e),r[d])r[d][a](void 0,e,t,!0,t[e]);if(e in r[p]){var s,c=i(r[p][e]);try{for(c.s();!(s=c.n()).done;)(0,s.value)(void 0,e,t,!0,t[e])}catch(t){c.e(t)}finally{c.f()}}return delete n[e],delete t[e],!0}};return r[T]&&delete F.get,Object.defineProperty(r,l,{configurable:!1,enumerable:!1,writable:!1,value:new Proxy(r,F)}),r[l]}},{key:"clearBindings",value:function(t){var e;(e=function(t){return Object.keys(t).map(function(e){return delete t[e]})},function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.map(e)})(t[S],t[p],t[d],t[R],t[M])}},{key:"resolve",value:function(t,e){for(var r,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.split("."),o=i[0];i.length;){if(n&&1===i.length)return[this.make(t),i.shift(),o];!(!(r=i.shift())in t)&&t[r]&&t[r]instanceof Object||(t[r]={}),t=this.make(t[r])}return[this.make(t),r,o]}},{key:"wrapDelayCallback",value:function(t,e){return function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return setTimeout(function(){return t.apply(void 0,n)},e)}}},{key:"wrapThrottleCallback",value:function(t,e){var r=this;return this.throttles.set(t,!1),function(){r.throttles.get(t,!0)||(t.apply(void 0,arguments),r.throttles.set(t,!0),setTimeout(function(){r.throttles.set(t,!1)},e))}}},{key:"wrapWaitCallback",value:function(t,e){var r=this;return function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var a;(a=r.waiters.get(t))&&(r.waiters.delete(t),clearTimeout(a)),a=setTimeout(function(){return t.apply(void 0,i)},e),r.waiters.set(t,a)}}},{key:"wrapFrameCallback",value:function(t,e){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];requestAnimationFrame(function(){return t.apply(void 0,r)})}}},{key:"wrapIdleCallback",value:function(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];(window.requestIdleCallback||requestAnimationFrame)(function(){return t.apply(void 0,r)})}}}],(o=null)&&c(r.prototype,o),a&&c(r,a),Object.defineProperty(r,"prototype",{writable:!1}),e}();e.Bindable=I,u(I,"waiters",new WeakMap),u(I,"throttles",new WeakMap),Object.defineProperty(I,"OnGet",{configurable:!1,enumerable:!1,writable:!1,value:k}),Object.defineProperty(I,"NoGetters",{configurable:!1,enumerable:!1,writable:!1,value:T}),Object.defineProperty(I,"GetProto",{configurable:!1,enumerable:!1,writable:!1,value:j}),Object.defineProperty(I,"OnAllGet",{configurable:!1,enumerable:!1,writable:!1,value:x})}()}),require.register("curvature/base/Cache.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Cache=void 0;var r=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,n,i;return r=e,i=[{key:"store",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"standard",i=0;r&&(i=1e3*r+(new Date).getTime()),this.buckets||(this.buckets=new Map),this.buckets.has(n)||this.buckets.set(n,new Map);var o=new CustomEvent("cvCacheStore",{cancelable:!0,detail:{key:t,value:e,expiry:r,bucket:n}});document.dispatchEvent(o)&&this.buckets.get(n).set(t,{value:e,expiration:i})}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"standard",n=new CustomEvent("cvCacheLoad",{cancelable:!0,detail:{key:t,defaultvalue:e,bucket:r}});if(!document.dispatchEvent(n))return e;if(this.buckets&&this.buckets.has(r)&&this.buckets.get(r).has(t)){var i=this.buckets.get(r).get(t);if(0===i.expiration||i.expiration>(new Date).getTime())return this.buckets.get(r).get(t).value}return e}}],(n=null)&&t(r.prototype,n),i&&t(r,i),Object.defineProperty(r,"prototype",{writable:!1}),e}();e.Cache=r}()}),require.register("curvature/base/Config.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Config=void 0;var n={},i=r;try{n=i("/Config").Config||{}}catch(t){!0===globalThis.devMode&&console.error(t)}var o=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,n,i;return r=e,i=[{key:"get",value:function(t){return this.configs[t]}},{key:"set",value:function(t,e){return this.configs[t]=e,this}},{key:"dump",value:function(){return this.configs}},{key:"init",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n in e){var i=e[n];for(var o in"string"==typeof i&&(i=JSON.parse(i)),i){var a=i[o];return this.configs[o]=a}}return this}}],(n=null)&&t(r.prototype,n),i&&t(r,i),Object.defineProperty(r,"prototype",{writable:!1}),e}();e.Config=o,Object.defineProperty(o,"configs",{configurable:!1,enumerable:!1,writable:!1,value:n})}()}),require.register("curvature/base/Dom.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Dom=void 0;var r=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,n,i;return r=e,i=[{key:"mapTags",value:function(t,e,r,n,i){var o=[],a=!0;n&&(a=!1);var s=!1,c=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,{acceptNode:function(t,r){if(!a){if(t!==n)return NodeFilter.FILTER_SKIP;a=!0}return i&&t===i&&(s=!0),s?NodeFilter.FILTER_SKIP:e?t instanceof Element&&t.matches(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}},!1);for(0;c.nextNode();)o.push(r(c.currentNode,c));return o}},{key:"dispatchEvent",value:function(t,r){t.dispatchEvent(r),e.mapTags(t,!1,function(t){t.dispatchEvent(r)})}}],(n=null)&&t(r.prototype,n),i&&t(r,i),Object.defineProperty(r,"prototype",{writable:!1}),e}();e.Dom=r}()}),require.register("curvature/base/Mixin.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Mixin=void 0;var t=r("./Bindable");function n(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t){"@babel/helpers - typeof";return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=a(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}function a(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,n=h(t);if(e){var i=h(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l(this,r)}}function l(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return f(t)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function d(t,e,r){return e&&g(t.prototype,e),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var y=Symbol("constructor"),b=(Symbol("mixinList"),function(){function e(){p(this,e)}return d(e,null,[{key:"from",value:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return function(r){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(s,t);var a=u(s);function s(){var r;p(this,s);for(var c=arguments.length,u=new Array(c),h=0;h<c;h++)u[h]=arguments[h];var g,d=t.constructor?r=a.call.apply(a,[this].concat(u)):null,y=o(n);try{for(y.s();!(g=y.n()).done;){var b=g.value;switch(b[e.Constructor]&&b[e.Constructor].apply(f(r)),i(b)){case"function":e.mixClass(b,s);break;case"object":e.mixObject(b,f(r))}}}catch(t){y.e(t)}finally{y.f()}return l(r,d)}return d(s)}()}},{key:"make",value:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r.pop();return e.to.apply(e,[i].concat(r))}},{key:"to",value:function(t){for(var e={},r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];n.map(function(r){switch(i(r)){case"object":Object.assign(e,Object.getOwnPropertyDescriptors(r));break;case"function":Object.assign(e,Object.getOwnPropertyDescriptors(r.prototype))}delete e.constructor,Object.defineProperties(t.prototype,e)})}},{key:"with",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.from.apply(this,[function(){return d(function t(){p(this,t)})}()].concat(e))}},{key:"mixObject",value:function(t,e){var r,n=o(Object.getOwnPropertyNames(t));try{for(n.s();!(r=n.n()).done;){var i=r.value;"function"!=typeof t[i]?e[i]=t[i]:e[i]=t[i].bind(e)}}catch(t){n.e(t)}finally{n.f()}var a,s=o(Object.getOwnPropertySymbols(t));try{for(s.s();!(a=s.n()).done;){var c=a.value;"function"!=typeof t[c]?e[c]=t[c]:e[c]=t[c].bind(e)}}catch(t){s.e(t)}finally{s.f()}}},{key:"mixClass",value:function(t,e){var r,n=o(Object.getOwnPropertyNames(t.prototype));try{for(n.s();!(r=n.n()).done;){var i=r.value;if(!["name","prototype","length"].includes(i)){var a=Object.getOwnPropertyDescriptor(e,i);a&&!a.writable||("function"==typeof t[i]?e.prototype[i]=t.prototype[i].bind(e.prototype):e.prototype[i]=t.prototype[i])}}}catch(t){n.e(t)}finally{n.f()}var s,c=o(Object.getOwnPropertySymbols(t.prototype));try{for(c.s();!(s=c.n()).done;){var u=s.value;"function"==typeof t[u]?e.prototype[u]=t.prototype[u].bind(e.prototype):e.prototype[u]=t.prototype[u]}}catch(t){c.e(t)}finally{c.f()}var l,f=o(Object.getOwnPropertyNames(t));try{var h=function(){var r=l.value;if(["name","prototype","length"].includes(r))return"continue";var n=Object.getOwnPropertyDescriptor(e,r);if(n&&!n.writable)return"continue";if("function"!=typeof t[r])return e[r]=t[r],"continue";var i=e[r]||!1,o=t[r].bind(e);e[r]=function(){return i&&i.apply(void 0,arguments),o.apply(void 0,arguments)}};for(f.s();!(l=f.n()).done;)h()}catch(t){f.e(t)}finally{f.f()}var p,g=o(Object.getOwnPropertySymbols(t));try{var d=function(){var r=p.value;if("function"!=typeof t[r])return e.prototype[r]=t[r],"continue";var n=e[r]||!1,i=t[r].bind(e);e[r]=function(){return n&&n.apply(void 0,arguments),i.apply(void 0,arguments)}};for(g.s();!(p=g.n()).done;)d()}catch(t){g.e(t)}finally{g.f()}}},{key:"mix",value:function(e){for(var r={},i={},a=t.Bindable.makeBindable(e),s=function(t){var e,s=Object.getOwnPropertyNames(t.prototype),c=/^(before|after)__(.+)/,u=o(Object.getOwnPropertyNames(t));try{var l=function(){var i=e.value,o=i.match(c);if(o){switch(o[1]){case"before":a.___before(function(e,r,a,s,c){if(r===o[2])return t[i].bind(s).apply(void 0,n(c))});break;case"after":a.___after(function(e,r,a,s,c){if(r===o[2])return t[i].bind(s).apply(void 0,n(c))})}return"continue"}return r[i]?"continue":"function"!=typeof t[i]?"continue":void(r[i]=t[i])};for(u.s();!(e=u.n()).done;)l()}catch(t){u.e(t)}finally{u.f()}var f,h=o(s);try{var p=function(){var e=f.value,r=e.match(c);if(r){switch(r[1]){case"before":a.___before(function(i,o,a,s,c){if(o===r[2])return t.prototype[e].bind(s).apply(void 0,n(c))});break;case"after":a.___after(function(i,o,a,s,c){if(o===r[2])return t.prototype[e].bind(s).apply(void 0,n(c))})}return"continue"}return i[e]?"continue":"function"!=typeof t.prototype[e]?"continue":void(i[e]=t.prototype[e])};for(h.s();!(f=h.n()).done;)p()}catch(t){h.e(t)}finally{h.f()}},c=this;c&&c.prototype;c=Object.getPrototypeOf(c))s(c);for(var u in r)e[u]=r[u].bind(e);var l=function(t){e.prototype[t]=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return i[t].apply(this,r)}};for(var f in i)l(f);return a}}]),e}());e.Mixin=b,b.Constructor=y}()}),require.register("curvature/base/Router.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Router=void 0;var t=r("./View"),n=(r("./Cache"),r("./Config")),i=r("./Routes");function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||s(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=s(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw o}}}}function s(t,e){if(t){if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var l=Symbol("NotFound"),f=Symbol("Internal"),h=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,s,c;return r=e,c=[{key:"wait",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DOMContentLoaded";(arguments.length>2&&void 0!==arguments[2]?arguments[2]:document).addEventListener(r,function(){e.listen(t)})}},{key:"listen",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.listener=t||this.listener,this.routes=r||t.routes,Object.assign(this.query,this.queryOver({}));var n=function(r){r.preventDefault(),r.state&&"routedId"in r.state?(r.state.routedId<=e.routeCount?(e.history.splice(r.state.routedId),e.routeCount=r.state.routedId):r.state.routedId>e.routeCount&&(e.history.push(r.state.prev),e.routeCount=r.state.routedId),e.state=r.state):null!==e.prevPath&&e.prevPath!==location.pathname&&e.history.push(e.prevPath),"null"!==location.origin?e.match(location.pathname,t):e.match(e.nextPath,t)};window.addEventListener("cvUrlChanged",n),window.addEventListener("popstate",n);var i="null"!==location.origin&&location.pathname+location.search;location.origin&&location.hash&&(i+=location.hash);var o={routedId:this.routeCount,url:location.pathname,prev:this.prevPath};"null"!==location.origin&&history.replaceState(o,null,location.pathname),this.go(!1!==i?i:"/")}},{key:"go",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n.Config.get("title");r&&(document.title=r);var i={routedId:this.routeCount,prev:this.prevPath,url:location.pathname};-1===e?this.match(t,this.listener,!0):"null"===location.origin?this.nextPath=t:2===e&&location.pathname!==t?history.replaceState(i,null,t):location.pathname!==t&&history.pushState(i,null,t),(!e||e<0)&&(!1===e&&(this.path=null),e||("#"===t.substring(0,1)?window.dispatchEvent(new HashChangeEvent("hashchange")):window.dispatchEvent(new CustomEvent("cvUrlChanged")))),this.prevPath=t}},{key:"processRoute",value:function(e,r,n){return"function"==typeof e[r]?e[r].prototype instanceof t.View?new e[r](n):e[r](n):e[r]}},{key:"handleError",value:function(t,e,r,n,i,o,a,s){console.error(t),"undefined"!=typeof document&&document.dispatchEvent(new CustomEvent("cvRouteError",{detail:{error:t,path:o,prev:a,view:i,routes:e,selected:r}}));var c=window.devMode?"Unexpected error: "+String(t):"Unexpected error.";e[f]&&(n[f]=t,c=this.processRoute(e,f,n)),this.update(i,o,c,e,r,n,s)}},{key:"match",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.path!==t||n||"undefined"==typeof document){var s=new URL(t,location.origin&&"null"!==location.origin?location.origin:"http://example.com");this.queryString=location.search||s.search,t=this.path=s.pathname;var c=this.prevPath,u=e&&e.args?e.args.content:null,f=this.routes||e&&e.routes||i.Routes.dump(),h=new URLSearchParams(this.queryString);for(var p in Object.keys(this.query))delete this.query[p];var g,d=a(h);try{for(d.s();!(g=d.n()).done;){var y=o(g.value,2),b=y[0],v=y[1];this.query[b]=v}}catch(t){d.e(t)}finally{d.f()}var m={},w=!1,S="";for(var O in t=t.substr(1).split("/"),this.query)m[O]=this.query[O];t:for(var j in f){var k=j.split("/");if(!(k.length<t.length&&"*"!==k[k.length-1])){for(var x in k)if("%"==k[x].substr(0,1)){var P=null,_=/^%(\w+)\??/.exec(k[x]);if(_&&_[1]&&(P=_[1]),!P)throw new Error("".concat(k[x],' is not a valid argument segment in route "').concat(j,'"'));if(t[x])m[P]=t[x];else{if("?"!=k[x].substr(k[x].length-1,1))continue t;m[P]=""}}else if("*"!==k[x]&&t[x]!==k[x])continue t;w=j,S=f[j],"*"===k[k.length-1]&&(m.pathparts=t.slice(k.length-1));break}}var M=new CustomEvent("cvRouteStart",{cancelable:!0,detail:{path:t,prev:c,root:e,selected:w,routes:f}});if("undefined"==typeof document||document.dispatchEvent(M)){if(!n&&e&&u&&S instanceof Object&&u instanceof S&&!(S instanceof Promise)&&u.update(m))return e.args.content=u,!0;w in f||(f[w]=f[l]);try{return!1===(S=this.processRoute(f,w,m))&&(S=this.processRoute(f,l,m)),S instanceof Promise||(S=Promise.resolve(S)),"undefined"==typeof document?S:S.then(function(i){r.update(e,t,i,f,w,m,n)}).catch(function(i){r.handleError(i,f,w,m,e,t,c,n)})}catch(r){this.handleError(r,f,w,m,e,t,c,n)}}}}},{key:"update",value:function(e,r,n,i,o,a,s){if(e){var c=this.prevPath,u=new CustomEvent("cvRoute",{cancelable:!0,detail:{result:n,path:r,prev:c,view:e,routes:i,selected:o}});!1!==n&&(e.args.content instanceof t.View&&(e.args.content.pause(!0),e.args.content.remove()),document.dispatchEvent(u)&&(e.args.content=n),n instanceof t.View&&(n.pause(!1),n.update(a,s)));var l=new CustomEvent("cvRouteEnd",{cancelable:!0,detail:{result:n,path:r,prev:c,view:e,routes:i,selected:o}});document.dispatchEvent(l)}}},{key:"queryOver",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={},n={},i=a(new URLSearchParams(location.search));try{for(i.s();!(t=i.n()).done;){var o=t.value;n[o[0]]=o[1]}}catch(t){i.e(t)}finally{i.f()}return delete(r=Object.assign(r,n,e)).api,r}},{key:"queryToString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],n=t;for(var i in e||(n=this.queryOver(t)),n)""!==n[i]&&r.push(i+"="+encodeURIComponent(n[i]));return r.join("&")}},{key:"setQuery",value:function(t,e,r){var n=this.queryOver();n[t]=e,void 0===e&&delete n[t];var i=this.queryToString(n,!0);this.go(location.pathname+(i?"?"+i:"?"),r)}}],(s=null)&&u(r.prototype,s),c&&u(r,c),Object.defineProperty(r,"prototype",{writable:!1}),e}();e.Router=h,Object.defineProperty(h,"query",{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(h,"history",{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(h,"routeCount",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(h,"prevPath",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(h,"queryString",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(h,"InternalError",{configurable:!1,enumerable:!1,writable:!1,value:f}),Object.defineProperty(h,"NotFoundError",{configurable:!1,enumerable:!1,writable:!1,value:l})}()}),require.register("curvature/base/Routes.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Routes=void 0;var n={},i=r,o=!1,a=function(){if(!o){try{Object.assign(n,i("Routes").Routes||{})}catch(t){!0===globalThis.devMode&&console.warn(t)}o=!0}},s=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,n,i;return r=e,i=[{key:"get",value:function(t){return a(),this.routes[t]}},{key:"dump",value:function(){return a(),this.routes}}],(n=null)&&t(r.prototype,n),i&&t(r,i),Object.defineProperty(r,"prototype",{writable:!1}),e}();e.Routes=s,Object.defineProperty(s,"routes",{configurable:!1,enumerable:!1,writable:!1,value:n})}()}),require.register("curvature/base/RuleSet.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RuleSet=void 0;r("./Dom");var t=r("./Tag"),n=r("./View");function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||a(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=a(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}function a(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,a,s;return r=e,s=[{key:"add",value:function(t,e){return this.globalRules=this.globalRules||{},this.globalRules[t]=this.globalRules[t]||[],this.globalRules[t].push(e),this}},{key:"apply",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var r in this.globalRules)for(var n in this.globalRules[r]){var i,a=this.globalRules[r][n],s=this.wrap(t,a,e),c=o(t.querySelectorAll(r));try{for(c.s();!(i=c.n()).done;){s(i.value)}}catch(t){c.e(t)}finally{c.f()}}}},{key:"wait",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"DOMContentLoaded",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n=function(e,r){return function(){return r.removeEventListener(e,n),t.apply()}}(e,r);r.addEventListener(e,n)}},{key:"wrap",value:function(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=r;return(r instanceof n.View||r&&r.prototype&&r.prototype instanceof n.View)&&(o=function(){return r}),function(e){if(void 0===e.___cvApplied___&&Object.defineProperty(e,"___cvApplied___",{enumerable:!1,writable:!1,value:new WeakSet}),!e.___cvApplied___.has(r)){var a,s;i&&(a=s=i,i.viewList&&(s=i.viewList.parent));var c,u=new t.Tag(e,s,null,void 0,a),l=u.element.parentNode,f=u.element.nextSibling,h=o(u);if(!1!==h&&e.___cvApplied___.add(r),h instanceof HTMLElement&&(h=new t.Tag(h)),h instanceof t.Tag){if(!h.element.contains(u.element)){for(;u.element.firstChild;)h.element.appendChild(u.element.firstChild);u.remove()}f?l.insertBefore(h.element,f):l.appendChild(h.element)}h&&h.prototype&&h.prototype instanceof n.View&&(h=new h({},i)),h instanceof n.View&&(i&&(i.cleanup.push((c=h,function(){c.remove()})),i.cleanup.push(i.args.bindTo(function(t,e,r){r[e]=t,h.args[e]=t})),i.cleanup.push(h.args.bindTo(function(t,e,r,n){r[e]=t,i.args[e]=t}))),u.clear(),h.render(u.element))}}}}],(a=[{key:"add",value:function(t,e){return this.rules=this.rules||{},this.rules[t]=this.rules[t]||[],this.rules[t].push(e),this}},{key:"apply",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var n in e.apply(t,r),this.rules)for(var i in this.rules[n]){var a,s=this.rules[n][i],c=e.wrap(t,s,r),u=o(t.querySelectorAll(n));try{for(u.s();!(a=u.n()).done;){c(a.value)}}catch(t){u.e(t)}finally{u.f()}}}},{key:"purge",value:function(){if(this.rules)for(var t=0,e=Object.entries(this.rules);t<e.length;t++){var r=i(e[t],2),n=r[0];r[1];if(this.rules[n])for(var o in this.rules[n])delete this.rules[n][o]}}}])&&c(r.prototype,a),s&&c(r,s),Object.defineProperty(r,"prototype",{writable:!1}),e}();e.RuleSet=u}()}),require.register("curvature/base/SetMap.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e,n,i){return(t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o}).apply(null,arguments)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function n(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||i(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.SetMap=void 0;var s=function(){function e(){var t,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,r="_map",n=new Map,r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}var r,o,s;return r=e,(o=[{key:"has",value:function(t){return this._map.has(t)}},{key:"get",value:function(t){return this._map.get(t)}},{key:"getOne",value:function(t){var e,r=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=i(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,a=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}(this.get(t));try{for(r.s();!(e=r.n()).done;){return e.value}}catch(t){r.e(t)}finally{r.f()}}},{key:"add",value:function(t,e){var r=this._map.get(t);return r||this._map.set(t,r=new Set),r.add(e)}},{key:"remove",value:function(t,e){var r=this._map.get(t);if(r){var n=r.delete(e);return r.size||this._map.delete(t),n}}},{key:"values",value:function(){return t(Set,n(n(this._map.values()).map(function(t){return n(t.values())})))}}])&&a(r.prototype,o),s&&a(r,s),Object.defineProperty(r,"prototype",{writable:!1}),e}();e.SetMap=s}()}),require.register("curvature/base/Tag.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tag=void 0;var t=r("./Bindable");function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=Symbol("CurrentStyle"),o=function(t){if(this.node)for(var e in t){var r=String(t[e]);this[i].has(e)&&this[i].get(e)===t[e]||("-"===e[0]?this.node.style.setProperty(e,r):this.node.style[e]=r,void 0!==t[e]?this[i].set(e,t[e]):this[i].delete(e))}},a=function(t){var e=this;return"function"==typeof this[t]?this[t]:this.node&&"function"==typeof this.node[t]?function(){var r;return(r=e.node)[t].apply(r,arguments)}:"style"===t?this.proxy.style:this.node&&t in this.node?this.node[t]:this[t]},s=function(){function e(r,n,s,c,u){var l=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),"string"==typeof r){var f=document.createRange().createContextualFragment(r);r=f.firstChild}this.element=t.Bindable.makeBindable(r),this.node=this.element,this.parent=n,this.direct=u,this.ref=s,this.index=c,this.cleanup=[],this[t.Bindable.OnAllGet]=a.bind(this),this[i]=new Map;var h=t.Bindable.make(o.bind(this));return Object.defineProperty(this,"style",{value:h}),this.proxy=t.Bindable.make(this),this.proxy.style.bindTo(function(t,e,r,n){l[i].has(e)&&l[i].get(e)===t||(l.node.style[e]=t,n||void 0===t?l[i].delete(e):l[i].set(e,t))}),this.proxy.bindTo(function(t,e){if("index"!==e)return e in r&&r[e]!==t&&(r[e]=t),!1}),this.proxy}var r,s,c;return r=e,(s=[{key:"attr",value:function(t){for(var e in t)void 0===t[e]?this.node.removeAttribute(e):null===t[e]?this.node.setAttribute(e,""):this.node.setAttribute(e,t[e]);return this}},{key:"remove",value:function(){var e;for(this.node&&this.node.remove(),t.Bindable.clearBindings(this);e=this.cleanup.shift();)e();if(this.clear(),this.node){var r=new Event("cvDomDetached");this.node.dispatchEvent(r),this.node=this.element=this.ref=this.parent=void 0}}},{key:"clear",value:function(){if(this.node)for(var t=new Event("cvDomDetached");this.node.firstChild;)this.node.firstChild.dispatchEvent(t),this.node.removeChild(this.node.firstChild)}},{key:"pause",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}},{key:"listen",value:function(t,e,r){var n=this.node;n.addEventListener(t,e,r);var i=function(){n.removeEventListener(t,e,r)},o=function(){i(),i=function(){return console.warn("Already removed!")}};return this.parent.onRemove(function(){return o()}),o}}])&&n(r.prototype,s),c&&n(r,c),Object.defineProperty(r,"prototype",{writable:!1}),e}();e.Tag=s}()}),require.register("curvature/base/View.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.View=void 0;var t=r("./Bindable"),n=r("./ViewList"),i=r("./Router"),o=r("./Dom"),a=r("./Tag"),s=r("./Bag"),c=r("./RuleSet"),u=r("./Mixin"),l=(r("../mixin/PromiseMixin"),r("../mixin/EventTargetMixin"));function f(t){"@babel/helpers - typeof";return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||d(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||d(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=d(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function d(t,e){if(t){if("string"==typeof t)return y(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,n=S(t);if(e){var i=S(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(t,e){if(e&&("object"===f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return w(t)}(this,r)}}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var O=Symbol("dontParse"),j=Symbol("expandBind"),k=Symbol("uuid"),x=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e)}(P,u.Mixin["with"](l.EventTargetMixin));var d,y,S,x=m(P);function P(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,P),e=x.call(this,r,n),Object.defineProperty(w(e),"args",{value:t.Bindable.make(r)}),Object.defineProperty(w(e),k,{value:e.constructor.uuid()}),Object.defineProperty(w(e),"nodesAttached",{value:new s.Bag(function(t,e,r){})}),Object.defineProperty(w(e),"nodesDetached",{value:new s.Bag(function(t,e,r){})}),Object.defineProperty(w(e),"_onRemove",{value:new s.Bag(function(t,e,r){})}),Object.defineProperty(w(e),"cleanup",{value:[]}),Object.defineProperty(w(e),"parent",{value:n}),Object.defineProperty(w(e),"views",{value:new Map}),Object.defineProperty(w(e),"viewLists",{value:new Map}),Object.defineProperty(w(e),"withViews",{value:new Map}),Object.defineProperty(w(e),"tags",{value:t.Bindable.make({})}),Object.defineProperty(w(e),"nodes",{value:t.Bindable.make([])}),Object.defineProperty(w(e),"timeouts",{value:new Map}),Object.defineProperty(w(e),"intervals",{value:[]}),Object.defineProperty(w(e),"frames",{value:[]}),Object.defineProperty(w(e),"ruleSet",{value:new c.RuleSet}),Object.defineProperty(w(e),"preRuleSet",{value:new c.RuleSet}),Object.defineProperty(w(e),"subBindings",{value:{}}),Object.defineProperty(w(e),"templates",{value:{}}),Object.defineProperty(w(e),"eventCleanup",{value:[]}),Object.defineProperty(w(e),"unpauseCallbacks",{value:new Map}),Object.defineProperty(w(e),"interpolateRegex",{value:/(\[\[((?:\$+)?[\w\.\|-]+)\]\])/g}),Object.defineProperty(w(e),"rendered",{value:new Promise(function(t,r){return Object.defineProperty(w(e),"renderComplete",{value:t})})}),e.controller=w(e),e.loaded=Promise.resolve(w(e)),e.template="",e.firstNode=null,e.lastNode=null,e.viewList=null,e.mainView=null,e.preserve=!1,e.removed=!1,e}return d=P,y=[{key:"_id",get:function(){return this[k]}},{key:"onFrame",value:function(t){var e=this,r=!1,n=function(){r=!0};return requestAnimationFrame(function(){return function n(i){e.removed||r||(e.paused||t(Date.now()),requestAnimationFrame(n))}(Date.now())}),this.frames.push(n),n}},{key:"onNextFrame",value:function(t){return requestAnimationFrame(function(){return t(Date.now())})}},{key:"onIdle",value:function(t){return requestIdleCallback(function(){return t(Date.now())})}},{key:"onTimeout",value:function(t,e){var r=this,n={timeout:null,callback:null,time:t,fired:!1,created:(new Date).getTime(),paused:!1},i=function(){e(),n.fired=!0,r.timeouts.delete(n.timeout)},o=setTimeout(i,t);return n.callback=i,n.timeout=o,this.timeouts.set(n.timeout,n),o}},{key:"clearTimeout",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){var e,r=g(this.timeouts);try{for(r.s();!(e=r.n()).done;){var n=p(e.value,2),i=(n[0],n[1]);clearTimeout(i.timeout),this.timeouts.delete(i.timeout)}}catch(t){r.e(t)}finally{r.f()}})},{key:"onInterval",value:function(t,e){var r=setInterval(e,t);return this.intervals.push({timeout:r,callback:e,time:t,paused:!1}),r}},{key:"clearInterval",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){for(var e in this.intervals)t===this.intervals[e].timeout&&(clearInterval(this.intervals[e].timeout),delete this.intervals[e])})},{key:"pause",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(void 0===t&&(this.paused=!this.paused),this.paused=t,this.paused){var e,r=g(this.timeouts);try{for(r.s();!(e=r.n()).done;){var n=p(e.value,2),i=(n[0],n[1]);i.fired?this.timeouts.delete(i.timeout):(clearTimeout(i.timeout),i.paused=!0,i.time=Math.max(0,i.time-(Date.now()-i.created)))}}catch(t){r.e(t)}finally{r.f()}for(var o in this.intervals)clearInterval(this.intervals[o].timeout)}else{var a,s=g(this.timeouts);try{for(s.s();!(a=s.n()).done;){var c=p(a.value,2),u=(c[0],c[1]);u.paused&&(u.fired?this.timeouts.delete(u.timeout):(u.timeout=setTimeout(u.callback,u.time),u.paused=!1))}}catch(t){s.e(t)}finally{s.f()}for(var l in this.intervals)this.intervals[l].timeout.paused&&(this.intervals[l].timeout.paused=!1,this.intervals[l].timeout=setInterval(this.intervals[l].callback,this.intervals[l].time));var f,h=g(this.unpauseCallbacks);try{for(h.s();!(f=h.n()).done;){(0,p(f.value,2)[1])()}}catch(t){h.e(t)}finally{h.f()}this.unpauseCallbacks.clear()}var d,y=g(this.viewLists);try{for(y.s();!(d=y.n()).done;){var b=p(d.value,2);b[0];b[1].pause(!!t)}}catch(t){y.e(t)}finally{y.f()}for(var v in this.tags)if(Array.isArray(this.tags[v]))for(var m in this.tags[v])this.tags[v][m].pause(!!t);else this.tags[v].pause(!!t)}},{key:"render",value:function(){var t,e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(r instanceof P&&(r=r.firstNode.parentNode),n instanceof P&&(n=n.firstNode),this.firstNode)return this.reRender(r,n);this.dispatchEvent(new CustomEvent("render"));var i=this.template instanceof DocumentFragment?this.template.cloneNode(!0):P.templates.has(this.template),o=i?this.template instanceof DocumentFragment?i:P.templates.get(this.template).cloneNode(!0):document.createRange().createContextualFragment(this.template);if(i||this.template instanceof DocumentFragment||P.templates.set(this.template,o.cloneNode(!0)),this.mainView||this.preRuleSet.apply(o,this),this.mapTags(o),this.mainView||this.ruleSet.apply(o,this),!0===window.devMode?(this.firstNode=document.createComment("Template ".concat(this._id," Start")),this.lastNode=document.createComment("Template ".concat(this._id," End"))):(this.firstNode=document.createTextNode(""),this.lastNode=document.createTextNode("")),(t=this.nodes).push.apply(t,[this.firstNode].concat(h(Array.from(o.childNodes)),[this.lastNode])),this.postRender(r),this.dispatchEvent(new CustomEvent("rendered")),this.dispatchAttach()){if(r){var a=r.getRootNode();if(n?(r.insertBefore(this.firstNode,n),r.insertBefore(this.lastNode,n)):(r.appendChild(this.firstNode),r.appendChild(this.lastNode)),r.insertBefore(o,this.lastNode),0,a.isConnected)this.attached(a,r),this.dispatchAttached(a,r);else{r.addEventListener("cvDomAttached",function t(n){n.target.isConnected&&(e.attached(a,r),e.dispatchAttached(a,r),r.removeEventListener("cvDomAttached",t))})}}return this.renderComplete(this.nodes),this.nodes}}},{key:"dispatchAttach",value:function(){return this.dispatchEvent(new CustomEvent("attach",{cancelable:!0,target:this}))}},{key:"dispatchAttached",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.dispatchEvent(new CustomEvent("attached",{detail:{view:r||this,node:e,root:t,mainView:this}})),this.dispatchDomAttached(r);var n,i=g(this.nodesAttached.items());try{for(i.s();!(n=i.n()).done;){(0,n.value)(t,e)}}catch(t){i.e(t)}finally{i.f()}}},{key:"dispatchDomAttached",value:function(t){var e=this;this.nodes.filter(function(t){return t.nodeType!==Node.COMMENT_NODE}).forEach(function(r){r.matches&&(o.Dom.mapTags(r,!1,function(r,n){r.matches&&r.dispatchEvent(new CustomEvent("cvDomAttached",{target:r,detail:{view:t||e,mainView:e}}))}),r.dispatchEvent(new CustomEvent("cvDomAttached",{target:r,detail:{view:t||e,mainView:e}})))})}},{key:"reRender",value:function(t,e){if(this.dispatchEvent(new CustomEvent("reRender"),{cancelable:!0,target:this})){var r=new DocumentFragment;if(this.firstNode.isConnected){var n=this.nodesDetached.items();for(var i in n)n[i]()}if(r.append.apply(r,h(this.nodes)),t){e?(t.insertBefore(this.firstNode,e),t.insertBefore(this.lastNode,e)):(t.appendChild(this.firstNode),t.appendChild(this.lastNode)),t.insertBefore(r,this.lastNode),this.dispatchEvent(new CustomEvent("reRendered"),{cancelable:!0,target:this});var o=t.getRootNode();o.isConnected&&(this.attached(o,t),this.dispatchAttached(o,t))}return this.nodes}}},{key:"mapTags",value:function(t){var e=this;o.Dom.mapTags(t,!1,function(t,r){t[O]||(t=t.matches?(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=e.mapInterpolatableTag(t)).matches("[cv-template]")&&e.mapTemplateTag(t)||t).matches("[cv-slot]")&&e.mapSlotTag(t)||t).matches("[cv-prerender]")&&e.mapPrendererTag(t)||t).matches("[cv-link]")&&e.mapLinkTag(t)||t).matches("[cv-attr]")&&e.mapAttrTag(t)||t).matches("[cv-expand]")&&e.mapExpandableTag(t)||t).matches("[cv-ref]")&&e.mapRefTag(t)||t).matches("[cv-on]")&&e.mapOnTag(t)||t).matches("[cv-each]")&&e.mapEachTag(t)||t).matches("[cv-bind]")&&e.mapBindTag(t)||t).matches("[cv-with]")&&e.mapWithTag(t)||t).matches("[cv-if]")&&e.mapIfTag(t)||t).matches("[cv-view]")&&e.mapViewTag(t)||t:e.mapInterpolatableTag(t))!==r.currentNode&&(r.currentNode=t)})}},{key:"mapExpandableTag",value:function(e){var r=e[j];r&&(r(),e[j]=!1);var n=p(t.Bindable.resolve(this.args,e.getAttribute("cv-expand"),!0),2),i=n[0],o=n[1];return e.removeAttribute("cv-expand"),i[o]||(i[o]={}),i[o]=t.Bindable.make(i[o]),this.onRemove(e[j]=i[o].bindTo(function(t,r,n,i,o){i||void 0===t?e.removeAttribute(r,t):null!==t?e.setAttribute(r,t):e.setAttribute(r,"")})),e}},{key:"compileExpandableTag",value:function(e){return function(r){var n=e.cloneNode(!0),i=n.getAttribute("cv-expand"),o=t.Bindable.make(r.args[i]||{});n.removeAttribute("cv-expand");var a=function(e){if("name"===e||"type"===e)return"continue";var i=o.bindTo(e,function(t,e){return function(r){t.setAttribute(e,r)}}(n,e));r.onRemove(function(){i(),o.isBound()&&t.Bindable.clearBindings(o)})};for(var s in o)a(s);return n}}},{key:"mapAttrTag",value:function(t){var e=this.compileAttrTag(t)(this);return t.replaceWith(e),e}},{key:"compileAttrTag",value:function(e){var r=e.getAttribute("cv-attr").split(",").map(function(t){return t.split(":")});return e.removeAttribute("cv-attr"),function(n){var i=e.cloneNode(!0),o=function(e){var o=r[e][1]||r[e][0],a=p(t.Bindable.resolve(n.args,o,!0),2),s=a[0],c=a[1],u=r[e][0];n.onRemove(s.bindTo(c,function(t,e,r,n){n||void 0===t?i.removeAttribute(u,t):null!==t?i.setAttribute(u,t):i.setAttribute(u,"")}))};for(var a in r)o(a);return i}}},{key:"mapInterpolatableTag",value:function(e){var r=this,n=this.interpolateRegex;if(e.nodeType===Node.TEXT_NODE){var i=e.nodeValue;if(!this.interpolatable(i))return e;for(var o,s=0,c=function(){var n=o[2],c=!1,u=!1,l=n.split("|"),h=!1;if(l.length>1&&(h=r.stringTransformer(l.slice(1)),n=l[0]),"$$"===n.substr(0,2)&&(c=!0,u=!0,n=n.substr(2)),"$"===n.substr(0,1)&&(c=!0,n=n.substr(1)),"000"===n.substr(0,3))return expand=!0,n=n.substr(3),"continue";var g=i.substring(s,o.index);s=o.index+o[1].length;var d=document.createTextNode(g);d[O]=!0,e.parentNode.insertBefore(d,e);var y=void 0;(y=c?document.createElement("div"):document.createTextNode(""))[O]=!0;var b=r.args,v=n;if(n.match(/\./)){var m=p(t.Bindable.resolve(r.args,n,!0),2);b=m[0],v=m[1]}if(e.parentNode.insertBefore(y,e),"object"!==f(b))return"break";var w=(b=t.Bindable.make(b)).bindTo(v,function(t,n,i){if(i[n]!==t&&(i[n]instanceof P||i[n]instanceof Node||i[n]instanceof a.Tag)&&(i[n].preserve||i[n].remove()),y.nodeValue="",u&&!(t instanceof P)){var o,s=null!==(o=t)&&void 0!==o?o:"";(t=new P(r.args,r)).template=s}if(h&&(t=h(t)),t instanceof P){var l=function(e,n){t.dispatchAttached(e,n,r)};r.nodesAttached.add(l),t.render(e.parentNode,y);var f=function(){t.preserve||t.remove()};r.onRemove(f),t.onRemove(function(){r.nodesAttached.remove(l),r._onRemove.remove(f)})}else t instanceof Node?(e.parentNode.insertBefore(t,y),r.onRemove(function(){return t.remove()})):t instanceof a.Tag?t.node?(e.parentNode.insertBefore(t.node,y),r.onRemove(function(){return t.remove()})):t.remove():(t instanceof Object&&t.__toString instanceof Function&&(t=t.__toString()),c?y.innerHTML=t:y.nodeValue=t);y[O]=!0});r.onRemove(w)};o=n.exec(i);){var u=c();if("continue"!==u&&"break"===u)break}var l=i.substring(s),h=document.createTextNode(l);h[O]=!0,e.parentNode.insertBefore(h,e),e.nodeValue=""}else if(e.nodeType===Node.ELEMENT_NODE)for(var g=function(i){if(!r.interpolatable(e.attributes[i].value))return"continue";for(var o=0,a=void 0,s=e.attributes[i].value,c=e.attributes[i],u={},l=[];a=n.exec(s);)l.push(s.substring(o,a.index)),u[a[2]]||(u[a[2]]=[]),u[a[2]].push(l.length),l.push(a[1]),o=a.index+a[1].length;l.push(s.substring(o));var f=function(n){var i=r.args,o=n,a=n.split("|"),s=!1,f=n;if(a.length>1&&(s=r.stringTransformer(a.slice(1)),o=a[0]),o.match(/\./)){var h=p(t.Bindable.resolve(r.args,o,!0),2);i=h[0],o=h[1]}u[f];r.onRemove(i.bindTo(o,function(t,n,i,a){for(var h in s&&(t=s(t)),u)for(var p in u[f])l[u[f][p]]=i[h],n===o&&(l[u[f][p]]=t);r.paused?r.unpauseCallbacks.set(c,function(){return e.setAttribute(c.name,l.join(""))}):e.setAttribute(c.name,l.join(""))})),r.onRemove(function(){i.isBound()||t.Bindable.clearBindings(i)})};for(var h in u)f(h)},d=0;d<e.attributes.length;d++)g(d);return e}},{key:"mapRefTag",value:function(t){var e=p(t.getAttribute("cv-ref").split(":"),3),r=e[0],n=e[1],i=void 0===n?null:n,o=e[2],s=void 0===o?null:o,c=a.Tag;i&&(c=this.stringToClass(i)),t.removeAttribute("cv-ref"),Object.defineProperty(t,"___tag___",{enumerable:!1,writable:!0}),this.onRemove(function(){t.___tag___=null,t.remove()});var u=this;this.viewList&&(u=this.viewList.parent);var l=new c(t,this,r,void 0,this);for(t.___tag___=l,this.tags[r]=l;u;){var f=this.args[s];if(void 0!==f?(u.tags[r]||(u.tags[r]=[]),u.tags[r][f]=l):u.tags[r]=l,!u.parent)break;u=u.parent}return t}},{key:"mapBindTag",value:function(e){var r=this,n=e.getAttribute("cv-bind"),i=this.args,s=n,c=null;if(n.match(/\./)){var u=p(t.Bindable.resolve(this.args,n,!0),3);i=u[0],s=u[1],c=u[2]}i!==this.args&&(this.subBindings[n]=this.subBindings[n]||[],this.onRemove(this.args.bindTo(c,function(){for(;r.subBindings.length;)r.subBindings.shift()()})));var l=!1;"$"===s.substr(0,1)&&(s=s.substr(1),l=!0);var f=i.bindTo(s,function(t,n,i,s,c){(c instanceof P||c instanceof Node||c instanceof a.Tag)&&c!==t&&c.remove();var u=new CustomEvent("cvAutoChanged",{bubbles:!0});if(["INPUT","SELECT","TEXTAREA"].includes(e.tagName)){var f=e.getAttribute("type");if(f&&"checkbox"===f.toLowerCase())e.checked=!!t,e.dispatchEvent(u);else if(f&&"radio"===f.toLowerCase())e.checked=t==e.value,e.dispatchEvent(u);else if("file"!==f){if("SELECT"===e.tagName){var h=function(){for(var r=0;r<e.options.length;r++){e.options[r].value==t&&(e.selectedIndex=r)}};h(),r.nodesAttached.add(h)}else e.value=null==t?"":t;e.dispatchEvent(u)}}else if(t instanceof P){var p,d=g(e.childNodes);try{for(d.s();!(p=d.n()).done;){p.value.remove()}}catch(t){d.e(t)}finally{d.f()}var y=function(e){t.dispatchDomAttached(r)};r.nodesAttached.add(y),t.render(e),t.onRemove(function(){return r.nodesAttached.remove(y)})}else if(t instanceof Node)e.insert(t);else if(t instanceof a.Tag)e.append(t.node);else if(l){if(e.innerHTML!==t){if(t=String(t),e.innerHTML===t.substring(0,e.innerHTML.length))e.innerHTML+=t.substring(e.innerHTML.length);else{var b,v=g(e.childNodes);try{for(v.s();!(b=v.n()).done;){b.value.remove()}}catch(t){v.e(t)}finally{v.f()}e.innerHTML=t}o.Dom.mapTags(e,!1,function(t){return t[O]=!0})}}else if(e.textContent!==t){var m,w=g(e.childNodes);try{for(w.s();!(m=w.n()).done;){m.value.remove()}}catch(t){w.e(t)}finally{w.f()}e.textContent=t}});i!==this.args&&this.subBindings[n].push(f),this.onRemove(f);var h=e.getAttribute("type"),d=e.getAttribute("multiple"),y=function(r){if(r.target===e)if(h&&"checkbox"===h.toLowerCase())e.checked?i[s]=r.target.getAttribute("value"):i[s]=!1;else if(r.target.matches("[contenteditable=true]"))i[s]=r.target.innerHTML;else if("file"===h&&d){var n=Array.from(r.target.files),o=i[s]||t.Bindable.onDeck(i,s);if(o&&n.length){var a=function(t){if(n[t]!==o[t])return n[t].toJSON=function(){return{name:file[t].name,size:file[t].size,type:file[t].type,date:file[t].lastModified}},o[t]=n[t],"break"};for(var c in n){if("break"===a(c))break}}else i[s]=n}else if("file"===h&&!d&&r.target.files.length){var u=r.target.files.item(0);u.toJSON=function(){return{name:u.name,size:u.size,type:u.type,date:u.lastModified}},i[s]=u}else i[s]=r.target.value};return"file"===h||"radio"===h?e.addEventListener("change",y):(e.addEventListener("input",y),e.addEventListener("change",y),e.addEventListener("value-changed",y)),this.onRemove(function(){"file"===h||"radio"===h?e.removeEventListener("change",y):(e.removeEventListener("input",y),e.removeEventListener("change",y),e.removeEventListener("value-changed",y))}),e.removeAttribute("cv-bind"),e}},{key:"mapOnTag",value:function(t){var e=this;return String(t.getAttribute("cv-on")).split(";").map(function(t){return t.split(":")}).forEach(function(r){var n,i=(r=r.map(function(t){return t.trim()})).length,o=String(r.shift()).trim(),a=String(r.shift()||o).trim(),s=String(r.shift()||"").trim(),c=[],u=/(\w+)(?:\(([$\w\s-'",]+)\))?/.exec(a);u&&(a=u[1].replace(/(^[\s\n]+|[\s\n]+$)/,""),u[2]&&(c=u[2].split(",").map(function(t){return t.trim()}))),c.length||c.push("$event"),o&&1!==i||(o=a);for(var l=e,f=function(){var t=l.controller;return"function"==typeof t[a]?(n=function(){t[a].apply(t,arguments)},"break"):"function"==typeof l[a]?(n=function(){var t;(t=l)[a].apply(t,arguments)},"break"):l.parent?void(l=l.parent):"break"};l;){if("break"===f())break}var p=function(r){var i=c.map(function(n){var i;return Number(n)==n?n:"event"===n||"$event"===n?r:"$view"===n?l:"$controller"===n?controller:"$tag"===n?t:"$parent"===n?e.parent:"$subview"===n?e:n in e.args?e.args[n]:(i=/^['"]([\w-]+?)["']$/.exec(n))?i[1]:void 0});if("function"!=typeof n)throw new Error("".concat(a," is not defined on View object.")+"\nTag:\n"+"".concat(t.outerHTML));n.apply(void 0,h(i))},g={};switch(s.includes("p")?g.passive=!0:s.includes("P")&&(g.passive=!1),s.includes("c")?g.capture=!0:s.includes("C")&&(g.capture=!1),s.includes("o")?g.once=!0:s.includes("O")&&(g.once=!1),o){case"_init":p();break;case"_attach":e.nodesAttached.add(p);break;case"_detach":e.nodesDetached.add(p);break;default:t.addEventListener(o,p,g),e.onRemove(function(){t.removeEventListener(o,p,g)})}return[o,a,c]}),t.removeAttribute("cv-on"),t}},{key:"mapLinkTag",value:function(t){var e=t.getAttribute("cv-link");t.setAttribute("href",e);var r=function(r){r.preventDefault(),"http"!==e.substring(0,4)&&"//"!==e.substring(0,2)?i.Router.go(t.getAttribute("href")):window.open(t.getAttribute("href",e))};return t.addEventListener("click",r),this.onRemove(function(t,e){return function(){t.removeEventListener("click",e),t=void 0,e=void 0}}(t,r)),t.removeAttribute("cv-link"),t}},{key:"compileLinkTag",value:function(t){var e=t.getAttribute("cv-link");return t.removeAttribute("cv-link"),function(r){var n=t.cloneNode(!0);return n.setAttribute("href",e),n}}},{key:"mapPrendererTag",value:function(t){var e=t.getAttribute("cv-prerender"),r=window.prerenderer||navigator.userAgent.match(/prerender/i);return r&&(window.prerenderer=window.prerenderer||!0),("never"===e&&r||"only"===e&&!r)&&t.parentNode.removeChild(t),t}},{key:"mapWithTag",value:function(e){var r=this,n=e.getAttribute("cv-with"),i=e.getAttribute("cv-carry"),o=e.getAttribute("cv-view");e.removeAttribute("cv-with"),e.removeAttribute("cv-carry"),e.removeAttribute("cv-view");var a=o?this.stringToClass(o):P,s=new DocumentFragment;h(e.childNodes).forEach(function(t){return s.appendChild(t)});var c=[];i&&(c=i.split(",").map(function(t){return t.trim()}));var u=this.args.bindTo(n,function(n,i,o,u){for(r.withViews.has(e)&&r.withViews.delete(e);e.firstChild;)e.removeChild(e.firstChild);var l=new a({},r);r.onRemove(function(t){return function(){t.remove()}}(l)),l.template=s;var h=function(t){var e=r.args.bindTo(c[t],function(t,e){l.args[e]=t});l.onRemove(e),r.onRemove(function(){e(),l.remove()})};for(var p in c)h(p);var g=function(e){if("object"!==f(n))return"continue";var i=(n=t.Bindable.make(n)).bindTo(e,function(t,e,r,n){n?e in l.args&&delete l.args[e]:l.args[e]=t});l.args.bindTo(e,function(t,e,r,i){i?e in n&&delete n[e]:n[e]=t});r.onRemove(function(){i(),n.isBound()||t.Bindable.clearBindings(n),l.remove()}),l.onRemove(function(){i(),n.isBound()||t.Bindable.clearBindings(n)})};for(var d in n)g(d);l.render(e),r.withViews.set(e,l)});return this.onRemove(function(){r.withViews.delete(e),u()}),e}},{key:"mapViewTag",value:function(t){var e=this,r=t.getAttribute("cv-view");t.removeAttribute("cv-view");var n=new DocumentFragment;h(t.childNodes).forEach(function(t){return n.appendChild(t)});var i=r.split(":"),o=i.pop()?this.stringToClass(r):P,a=i.shift(),s=new o(this.args,this);return this.views.set(t,s),a&&this.views.set(a,s),this.onRemove(function(r){return function(){r.remove(),e.views.delete(t),e.views.delete(a)}}(s)),s.template=n,s.render(t),t}},{key:"mapEachTag",value:function(e){var r=this,i=e.getAttribute("cv-each"),o=e.getAttribute("cv-view");e.removeAttribute("cv-each"),e.removeAttribute("cv-view");var a=o?this.stringToClass(o):P,c=new DocumentFragment;h(e.childNodes).forEach(function(t){return c.appendChild(t)});var u=p(i.split(":"),3),l=u[0],f=u[1],g=u[2],d=this.args,y=l;if(l.match(/\./)){var b=p(t.Bindable.resolve(this.args,l,!0),2);d=b[0],y=b[1]}var v=d.bindTo(y,function(t,i,o,u,l){t instanceof s.Bag&&(t=t.list),r.viewLists.has(e)&&r.viewLists.get(e).remove();var h=new n.ViewList(c,f,t,r,g,a),p=function(){return h.remove()};r.onRemove(p),h.onRemove(function(){return r._onRemove.remove(p)});var d=r.args.bindTo(function(t,e,r,n){"_id"!==e&&(n?e in h.subArgs&&delete h.subArgs[e]:h.subArgs[e]=t)}),y=h.args.bindTo(function(t,e,n,i,o){"_id"!==e&&"value"!==e&&"___"!==String(e).substring(0,3)&&(i?delete r.args[e]:e in r.args&&(r.args[e]=t))});for(h.onRemove(d),h.onRemove(y),r.onRemove(d),r.onRemove(y);e.firstChild;)e.removeChild(e.firstChild);r.viewLists.set(e,h),h.render(e)});return this.onRemove(v),e}},{key:"mapIfTag",value:function(e){var r=this,n=e,i=n.getAttribute("cv-view"),a=n.getAttribute("cv-if"),c=n.getAttribute("cv-is"),u=!1,l=!1;n.removeAttribute("cv-view"),n.removeAttribute("cv-if"),n.removeAttribute("cv-is");var f=i?this.stringToClass(i):P;"!"===a.substr(0,1)&&(a=a.substr(1),u=!0),"?"===a.substr(0,1)&&(a=a.substr(1),l=!0);var g=new DocumentFragment;h(n.childNodes).forEach(function(t){return g.appendChild(t)});var d=this,y=new DocumentFragment,b=new f(Object.assign({},this.args),d);b.tags.bindTo(function(t,e){return r.tags[e]=t},{removeWith:this}),b.template=g;var v=d.args,m=a;if(a.match(/\./)){var w=p(t.Bindable.resolve(d.args,a,!0),2);v=w[0],m=w[1]}b.render(y);var S=v.bindTo(m,function(t,n){var i=t;l&&(t=null!==t&&void 0!==t),t instanceof s.Bag&&(t=t.list),Array.isArray(t)&&(t=!!t.length),null!==c&&(t=i==c),u&&(t=!t),t?(e.appendChild(y),h(y.childNodes).forEach(function(t){return o.Dom.mapTags(t,!1,function(t,e){t.matches&&t.dispatchEvent(new CustomEvent("cvDomAttached",{target:t,detail:{view:b||r,mainView:r}}))})})):(b.nodes.forEach(function(t){return y.appendChild(t)}),o.Dom.mapTags(y,!1,function(t,e){t.matches&&new CustomEvent("cvDomDetached",{target:t,detail:{view:b||r,mainView:r}})}))},{children:Array.isArray(v[m])});d.onRemove(S);var O=this.args.bindTo(function(t,e,r,n){"_id"!==e&&(n?e in b.args&&delete b.args[e]:b.args[e]=t)}),j=b.args.bindTo(function(t,e,n,i,o){"_id"!==e&&"___"!==String(e).substring(0,3)&&e in r.args&&(i?delete r.args[e]:r.args[e]=t)});return d.onRemove(function(){S(),O(),j(),d._onRemove.remove(S)}),this.onRemove(function(){O(),j(),b.remove(),d!==r&&d.remove()}),e}},{key:"compileIfTag",value:function(e){var r=e.getAttribute("cv-if"),n=!1;e.removeAttribute("cv-if"),"!"===r.substr(0,1)&&(r=r.substr(1),n=!0);var i=new DocumentFragment;return h(e.childNodes).forEach(function(t){return i.appendChild(t.cloneNode(!0))}),function(o){var a=e.cloneNode(),s=new DocumentFragment,c=new P({},o);c.template=i,o.syncBind(c);var u=o.args,l=r;if(r.match(/\./)){var f=p(t.Bindable.resolve(o.args,r,!0),2);u=f[0],l=f[1]}var h=!1,g=u.bindTo(l,function(t,e){if(!h){var r=o.args[l]||n?a:s;return c.render(r),void(h=!0)}Array.isArray(t)&&(t=!!t.length),n&&(t=!t),t?a.appendChild(s):c.nodes.forEach(function(t){return s.appendChild(t)})});o.onRemove(g);var d=function(){u.isBound()||t.Bindable.clearBindings(u)};return c.onRemove(function(){g(),d(),o._onRemove.remove(g),o._onRemove.remove(d)}),a}}},{key:"mapTemplateTag",value:function(t){var e=t.getAttribute("cv-template");return t.removeAttribute("cv-template"),this.templates[e]=function(){return"TEMPLATE"===t.tagName?t.content.cloneNode(!0):new DocumentFragment(t.innerHTML)},this.rendered.then(function(){return t.remove()}),t}},{key:"mapSlotTag",value:function(t){var e=t.getAttribute("cv-slot"),r=this.templates[e];if(!r){for(var n=this;n&&!(r=n.templates[e]);)n=this.parent;if(!r)return void console.error("Template ".concat(e," not found."))}var i=r();for(t.removeAttribute("cv-slot");t.firstChild;)t.firstChild.remove();return t.appendChild(i),t}},{key:"syncBind",value:function(t){var e=this,r=this.args.bindTo(function(e,r,n,i){"_id"!==r&&t.args[r]!==e&&(t.args[r]=e)}),n=t.args.bindTo(function(t,r,n,i,o){if("_id"!==r){var a=t,s=o;a instanceof P&&(a=a.___ref___),s instanceof P&&(s=s.___ref___),a!==s&&s instanceof P&&o.remove(),r in e.args&&(e.args[r]=t)}});this.onRemove(r),this.onRemove(n),t.onRemove(function(){e._onRemove.remove(r),e._onRemove.remove(n)})}},{key:"postRender",value:function(t){}},{key:"attached",value:function(t){}},{key:"interpolatable",value:function(t){return!!String(t).match(this.interpolateRegex)}},{key:"remove",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.dispatchEvent(new CustomEvent("remove",{detail:{view:this},cancelable:!0}))){var r=function(){for(var e in t.tags)Array.isArray(t.tags[e])?(t.tags[e]&&t.tags[e].forEach(function(t){return t.remove()}),t.tags[e].splice(0)):(t.tags[e]&&t.tags[e].remove(),t.tags[e]=void 0);for(var r in t.nodes)t.nodes[r]&&t.nodes[r].dispatchEvent(new Event("cvDomDetached")),t.nodes[r]&&t.nodes[r].remove(),t.nodes[r]=void 0;t.nodes.splice(0),t.firstNode=t.lastNode=void 0};e?r():requestAnimationFrame(r);var n,i=g(this._onRemove.items());try{for(i.s();!(n=i.n()).done;){var o=n.value;o(),this._onRemove.remove(o)}}catch(t){i.e(t)}finally{i.f()}var a,s=g(this.cleanup);try{for(s.s();!(a=s.n()).done;){var c=a.value;c&&c()}}catch(t){s.e(t)}finally{s.f()}this.cleanup.length=0;var u,l=g(this.viewLists);try{for(l.s();!(u=l.n()).done;){var f=p(u.value,2);f[0];f[1].remove()}}catch(t){l.e(t)}finally{l.f()}this.viewLists.clear();var h,d=g(this.timeouts);try{for(d.s();!(h=d.n()).done;){var y=p(h.value,2),b=(y[0],y[1]);clearTimeout(b.timeout),this.timeouts.delete(b.timeout)}}catch(t){d.e(t)}finally{d.f()}var v,m=g(this.intervals);try{for(m.s();!(v=m.n()).done;){var w=v.value;clearInterval(w)}}catch(t){m.e(t)}finally{m.f()}this.intervals.length=0;var S,O=g(this.frames);try{for(O.s();!(S=O.n()).done;){(0,S.value)()}}catch(t){O.e(t)}finally{O.f()}this.frames.length=0,this.preRuleSet.purge(),this.ruleSet.purge(),this.removed=!0,this.dispatchEvent(new CustomEvent("removed",{detail:{view:this},cancelable:!0}))}}},{key:"findTag",value:function(t){for(var e in this.nodes){var r;if(this.nodes[e].querySelector){if(this.nodes[e].matches(t))return new a.Tag(this.nodes[e],this,void 0,void 0,this);if(r=this.nodes[e].querySelector(t))return new a.Tag(r,this,void 0,void 0,this)}}}},{key:"findTags",value:function(t){var e=this;return this.nodes.filter(function(t){return t.querySelectorAll}).map(function(e){return h(e.querySelectorAll(t))}).flat().map(function(t){return new a.Tag(t,e,void 0,void 0,e)})||[]}},{key:"onRemove",value:function(t){t instanceof Event||this._onRemove.add(t)}},{key:"update",value:function(){}},{key:"beforeUpdate",value:function(t){}},{key:"afterUpdate",value:function(t){}},{key:"stringTransformer",value:function(t){var e=this;return function(r){for(var n in t){for(var i=e,o=t[n];i&&!i[o];)i=i.parent;if(!i)return;r=i[t[n]](r)}return r}}},{key:"stringToClass",value:function(t){if(P.refClasses.has(t))return P.refClasses.get(t);var e=t.split("/"),n=e[e.length-1],i=r(t);return P.refClasses.set(t,i[n]),i[n]}},{key:"preventParsing",value:function(t){t[O]=!0}},{key:"toString",value:function(){return this.nodes.map(function(t){return t.outerHTML}).join(" ")}},{key:"listen",value:function(t,e,r,n){var i=this;if("string"==typeof t&&(n=r,r=e,e=t,t=this),t instanceof P)return this.listen(t.nodes,e,r,n);if(Array.isArray(t))return t.map(function(t){return i.listen(t,e,r,n)}).forEach(function(t){return t()});if(t instanceof a.Tag)return this.listen(t.element,e,r,n);t.addEventListener(e,r,n);var o=function(){return t.removeEventListener(e,r,n)},s=function(){o(),o=function(){}};return this.onRemove(function(){return s()}),s}},{key:"detach",value:function(){for(var t in this.nodes)this.nodes[t].remove();return this.nodes}}],S=[{key:"from",value:function(t){var e=new this(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2&&void 0!==arguments[2]?arguments[2]:null);return e.template=t,e}},{key:"isView",value:function(){return P}},{key:"uuid",value:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})}}],y&&b(d.prototype,y),S&&b(d,S),Object.defineProperty(d,"prototype",{writable:!1}),P}();e.View=x,Object.defineProperty(x,"templates",{value:new Map}),Object.defineProperty(x,"refClasses",{value:new Map})}()}),require.register("curvature/base/ViewList.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ViewList=void 0;var t=r("./Bindable"),n=r("./SetMap"),i=r("./Bag");function o(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t){"@babel/helpers - typeof";return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=function(){function e(r,n,o,a){var c=this,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.removed=!1,this.args=t.Bindable.makeBindable({}),this.args.value=t.Bindable.makeBindable(o||{}),this.subArgs=t.Bindable.makeBindable({}),this.views=[],this.cleanup=[],this.viewClass=l,this._onRemove=new i.Bag,this.template=r,this.subProperty=n,this.keyProperty=u,this.tag=null,this.downDebind=[],this.upDebind=[],this.paused=!1,this.parent=a,this.rendered=new Promise(function(t,e){Object.defineProperty(c,"renderComplete",{configurable:!1,writable:!0,value:t})}),this.willReRender=!1,this.args.___before(function(t,e,r,n,i){"bindTo"!=e&&(c.paused=!0)}),this.args.___after(function(t,e,r,n,i){"bindTo"!=e&&(c.paused=r.length>1,c.reRender())});var f=this.args.value.bindTo(function(t,e,r,n){if(!c.paused){var i=e;if("symbol"!==s(e))if(isNaN(e)&&(i="_"+e),n)for(var o in c.views[i]&&c.views[i].remove(),delete c.views[i],c.views)isNaN(o)?c.views[o].args[c.keyProperty]=o.substr(1):c.views[o].args[c.keyProperty]=o;else c.views[i]?c.views[i]&&c.views[i].args&&(c.views[i].args[c.keyProperty]=e,c.views[i].args[c.subProperty]=t):(cancelAnimationFrame(c.willReRender),c.willReRender=requestAnimationFrame(function(){c.reRender()}))}});this._onRemove.add(f),Object.preventExtensions(this)}var r,a,u;return r=e,(a=[{key:"render",value:function(t){var e,r=this,n=[],i=o(this.views);try{var a=function(){var r=e.value;r.render(t),n.push(r.rendered.then(function(){return r}))};for(i.s();!(e=i.n()).done;)a()}catch(t){i.e(t)}finally{i.f()}this.tag=t,Promise.all(n).then(function(t){return r.renderComplete(t)}),this.parent.dispatchEvent(new CustomEvent("listRendered",{detail:{detail:{key:this.subProperty,value:this.args.value}}}))}},{key:"reRender",value:function(){var t=this;if(!this.paused&&this.tag){var e=[],r=new n.SetMap;for(var i in this.views){var a=this.views[i],s=a.args[this.subProperty];r.add(s,a),e[i]=a}var c=[],u=new Set;this.downDebind.length&&this.downDebind.forEach(function(t){return t&&t()}),this.upDebind.length&&this.upDebind.forEach(function(t){return t&&t()}),this.upDebind.length=0,this.downDebind.length=0;var l=1/0,f=1/0,h=function(e){var n=!1,i=e;if(isNaN(i)?i="_"+e:String(i).length&&(i=Number(i)),void 0!==t.args.value[e]&&r.has(t.args.value[e])){var o=r.getOne(t.args.value[e]);o&&(o.args[t.keyProperty]=e,c[i]=o,u.add(o),n=!0,isNaN(i)||(l=Math.min(l,i),i>0&&(f=Math.min(f,i))),r.remove(t.args.value[e],o))}if(!n){var a={},s=c[i]=new t.viewClass(a,t.parent);isNaN(i)||(l=Math.min(l,i),i>0&&(f=Math.min(f,i))),c[i].template=t.template,c[i].viewList=t,c[i].args[t.keyProperty]=e,c[i].args[t.subProperty]=t.args.value[e],t.upDebind[i]=a.bindTo(t.subProperty,function(e,r,n,i){var o=a[t.keyProperty];i?delete t.args.value[o]:t.args.value[o]=e}),t.downDebind[i]=t.subArgs.bindTo(function(t,e,r,n){n?delete a[e]:a[e]=t});var h=function(){t.upDebind.filter(function(t){return t}).forEach(function(t){return t()}),t.upDebind.length=0},p=function(){t.downDebind.filter(function(t){return t}).forEach(function(t){return t()}),t.downDebind.length=0};s.onRemove(function(){t._onRemove.remove(h),t._onRemove.remove(p),t.upDebind[i]&&t.upDebind[i](),t.downDebind[i]&&t.downDebind[i](),delete t.upDebind[i],delete t.downDebind[i]}),t._onRemove.add(h),t._onRemove.add(p),a[t.subProperty]=t.args.value[e]}};for(var p in this.args.value)h(p);for(var g in e)u.has(e[g])||e[g].remove();if(Array.isArray(this.args.value)){var d=0===l&&void 0!==c[1]&&c.length>1||f===1/0?l:f;this.rendered=function e(){for(var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=c.length-r-1;n>d&&void 0===c[n];)n--;if(n<d)return Promise.resolve();if(c[n]===t.views[n])return c[n]&&!c[n].firstNode?(c[n].render(t.tag,c[n+1]),c[n].rendered.then(function(){return e(Number(r)+1)})):0===r||r%500?e(Number(r)+1):new Promise(function(t){return requestAnimationFrame(function(){return t(e(Number(r)+1))})});return c[n].render(t.tag,c[n+1]),t.views.splice(n,0,c[n]),c[n].rendered.then(function(){return e(r+1)})}()}else{var y,b=[],v=Object.assign({},c),m=function(t){return parseInt(t)===t-0},w=o(Object.keys(c).sort(function(t,e){return m(t)&&m(e)?Math.sign(t-e):m(t)||m(e)?!m(t)&&m(e)?-1:m(t)&&!m(e)?1:void 0:0}));try{var S=function(){var e=y.value;if(delete v[e],c[e].firstNode&&c[e]===t.views[e])return"continue";c[e].render(t.tag),b.push(c[e].rendered.then(function(){return c[e]}))};for(w.s();!(y=w.n()).done;)S()}catch(t){w.e(t)}finally{w.f()}for(var O in v)delete this.args.views[O],v.remove();this.rendered=Promise.all(b)}for(var j in c)isNaN(j)?c[j].args[this.keyProperty]=j.substr(1):c[j].args[this.keyProperty]=j;this.views=Array.isArray(this.args.value)?[].concat(c):c,u.clear(),this.willReRender=!1,this.rendered.then(function(){t.parent.dispatchEvent(new CustomEvent("listRendered",{detail:{detail:{key:t.subProperty,value:t.args.value,tag:t.tag}}})),t.tag.dispatchEvent(new CustomEvent("listRendered",{detail:{detail:{key:t.subProperty,value:t.args.value,tag:t.tag}}}))})}}},{key:"pause",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];for(var e in this.views)this.views[e].pause(t)}},{key:"onRemove",value:function(t){this._onRemove.add(t)}},{key:"remove",value:function(){for(var e in this.views)this.views[e].remove();var r=this._onRemove.items();for(var n in r)this._onRemove.remove(r[n]),r[n]();for(;this.cleanup.length;)this.cleanup.pop()();for(this.views=[];this.tag&&this.tag.firstChild;)this.tag.removeChild(this.tag.firstChild);this.subArgs&&t.Bindable.clearBindings(this.subArgs),t.Bindable.clearBindings(this.args),this.args.value&&!this.args.value.isBound()&&t.Bindable.clearBindings(this.args.value),this.removed=!0}}])&&c(r.prototype,a),u&&c(r,u),Object.defineProperty(r,"prototype",{writable:!1}),e}();e.ViewList=u}()}),require.register("curvature/input/Keyboard.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Keyboard=void 0;var t=r("../base/Bindable");function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=function(){function e(){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.maxDecay=120,this.comboTime=500,this.listening=!1,this.focusElement=document.body,this[t.Bindable.NoGetters]=!0,Object.defineProperty(this,"combo",{value:t.Bindable.make([])}),Object.defineProperty(this,"whichs",{value:t.Bindable.make({})}),Object.defineProperty(this,"codes",{value:t.Bindable.make({})}),Object.defineProperty(this,"keys",{value:t.Bindable.make({})}),Object.defineProperty(this,"pressedWhich",{value:t.Bindable.make({})}),Object.defineProperty(this,"pressedCode",{value:t.Bindable.make({})}),Object.defineProperty(this,"pressedKey",{value:t.Bindable.make({})}),Object.defineProperty(this,"releasedWhich",{value:t.Bindable.make({})}),Object.defineProperty(this,"releasedCode",{value:t.Bindable.make({})}),Object.defineProperty(this,"releasedKey",{value:t.Bindable.make({})}),Object.defineProperty(this,"keyRefs",{value:t.Bindable.make({})}),document.addEventListener("keyup",function(t){r.listening&&(r.keys[t.key]>0||!r.focusElement||document.activeElement===r.focusElement||r.focusElement.contains(document.activeElement)&&!document.activeElement.matches("input,textarea"))&&(t.preventDefault(),r.releasedWhich[t.which]=Date.now(),r.releasedCode[t.code]=Date.now(),r.releasedKey[t.key]=Date.now(),r.whichs[t.which]=-1,r.codes[t.code]=-1,r.keys[t.key]=-1)}),document.addEventListener("keydown",function(t){r.listening&&(!r.focusElement||document.activeElement===r.focusElement||r.focusElement.contains(document.activeElement)&&!document.activeElement.matches("input,textarea"))&&(t.preventDefault(),t.repeat||(r.combo.push(t.code),clearTimeout(r.comboTimer),r.comboTimer=setTimeout(function(){return r.combo.splice(0)},r.comboTime),r.pressedWhich[t.which]=Date.now(),r.pressedCode[t.code]=Date.now(),r.pressedKey[t.key]=Date.now(),r.keys[t.key]>0||(r.whichs[t.which]=1,r.codes[t.code]=1,r.keys[t.key]=1)))});var n=function(t){for(var e in r.keys)r.keys[e]<0||(r.releasedKey[e]=Date.now(),r.keys[e]=-1);for(var n in r.codes)r.codes[n]<0||(r.releasedCode[n]=Date.now(),r.codes[n]=-1);for(var i in r.whichs)r.whichs[i]<0||(r.releasedWhich[i]=Date.now(),r.whichs[i]=-1)};window.addEventListener("blur",n),window.addEventListener("visibilitychange",function(){"visible"!==document.visibilityState&&n()})}var r,i,o;return r=e,o=[{key:"get",value:function(){return this.instance=this.instance||t.Bindable.make(new this)}}],(i=[{key:"getKeyRef",value:function(e){return this.keyRefs[e]=this.keyRefs[e]||t.Bindable.make({})}},{key:"getKeyTime",value:function(t){var e=this.releasedKey[t],r=this.pressedKey[t];return r?!e||e<r?Date.now()-r:-1*(Date.now()-e):0}},{key:"getCodeTime",value:function(t){var e=this.releasedCode[t],r=this.pressedCode[t];return r?!e||e<r?Date.now()-r:-1*(Date.now()-e):0}},{key:"getWhichTime",value:function(t){var e=this.releasedWhich[t],r=this.pressedWhich[t];return r?!e||e<r?Date.now()-r:-1*(Date.now()-e):0}},{key:"getKey",value:function(t){return this.keys[t]?this.keys[t]:0}},{key:"getKeyCode",value:function(t){return this.codes[t]?this.codes[t]:0}},{key:"reset",value:function(){for(var t in this.keys)delete this.keys[t];for(var t in this.codes)delete this.codes[t];for(var t in this.whichs)delete this.whichs[t]}},{key:"update",value:function(){for(var t in this.keys)this.keys[t]>0?this.keys[t]++:this.keys[t]>-this.maxDecay?this.keys[t]--:delete this.keys[t];for(var t in this.codes){var e=this.releasedCode[t],r=this.pressedCode[t],n=this.getKeyRef(t);if(this.codes[t]>0){if(n.frames=this.codes[t]++,n.time=r?Date.now()-r:0,n.down=!0,!e||e<r)return;return-1*(Date.now()-e)}this.codes[t]>-this.maxDecay?(n.frames=this.codes[t]--,n.time=e-Date.now(),n.down=!1):(n.frames=0,n.time=0,n.down=!1,delete this.codes[t])}for(var t in this.whichs)this.whichs[t]>0?this.whichs[t]++:this.whichs[t]>-this.maxDecay?this.whichs[t]--:delete this.whichs[t]}}])&&n(r.prototype,i),o&&n(r,o),Object.defineProperty(r,"prototype",{writable:!1}),e}();e.Keyboard=i}()}),require.register("curvature/input/Sequence.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Sequence=void 0;var n,i=r("../base/Bindable"),o=r("../base/Mixin"),a=r("../mixin/EventTargetMixin");function s(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=p(e);if(r){var o=p(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}(this,n)}}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}n=i.Bindable.NoGetters;var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(p,o.Mixin["with"](a.EventTargetMixin));var e,r,i,c=f(p);function p(t){var e,r=t.callback,i=t.keys,o=t.timing,a=t.gamepad;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),g(h(e=c.call(this)),n,!0),g(h(e),"lastTap",!1),g(h(e),"recent",[]),g(h(e),"callback",function(){}),g(h(e),"timing",500),g(h(e),"keys","");var s=[r,o,i,a];return e.callback=s[0],e.timing=s[1],e.keys=s[2],e.gamepad=s[3],e}return e=p,(r=[{key:"check",value:function(t){var e=this.recent,r=Date.now();r+-this.lastTap>this.timing&&e.splice(0),e.push({code:t,time:Date.now()});var n=e.map(function(t){return t.code}).join(","),i=this.keys.join(",");this.lastTap=r;var o=[];for(var a in e){e[a];var c=e.slice(a),u=c.map(function(t){return t.code}).join(",");if(u===i.substr(0,u.length)){o.push.apply(o,s(c)),this.dispatchEvent(new CustomEvent("advance",{detail:{matched:o,recent:e,keys:this.keys,length:c.length}}));break}}o.length?i===n.substr(-i.length)&&this.dispatchEvent(new CustomEvent("complete",{detail:{matched:o,recent:e,keys:this.keys,length:o.length}})):this.dispatchEvent(new CustomEvent("cancel",{detail:{matched:o,recent:e,keys:this.keys,length:o.length}}))}}])&&u(e.prototype,r),i&&u(e,i),Object.defineProperty(e,"prototype",{writable:!1}),p}();e.Sequence=d}()}),require.register("curvature/mixin/EventTargetMixin.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventTargetMixin=void 0;var t,n=r("../base/Mixin");function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=Symbol("Target"),a=(i(t={},n.Mixin.Constructor,function(){try{this[o]=new EventTarget}catch(t){this[o]=document.createDocumentFragment()}}),i(t,"dispatchEvent",function(){for(var t,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r[0];"string"==typeof i&&(i=new CustomEvent(i),r[0]=i),(t=this[o]).dispatchEvent.apply(t,r);var a="on".concat(i.type[0].toUpperCase()+i.type.slice(1));return"function"==typeof this[a]&&this[a](i),i.returnValue}),i(t,"addEventListener",function(){var t;(t=this[o]).addEventListener.apply(t,arguments)}),i(t,"removeEventListener",function(){var t;(t=this[o]).removeEventListener.apply(t,arguments)}),t);e.EventTargetMixin=a}()}),require.register("curvature/mixin/PromiseMixin.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PromiseMixin=void 0;var t,n=r("../base/Mixin");function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=Symbol("Promise"),a=Symbol("Accept"),s=Symbol("Reject"),c=(i(t={},n.Mixin.Constructor,function(){var t=this;this[o]=new Promise(function(e,r){t[a]=e,t[s]=r})}),i(t,"then",function(){var t;return(t=this[o]).then.apply(t,arguments)}),i(t,"catch",function(){var t;return(t=this[o]).catch.apply(t,arguments)}),i(t,"finally",function(){var t;return(t=this[o]).finally.apply(t,arguments)}),t);e.PromiseMixin=c,Object.defineProperty(c,"Reject",{value:s}),Object.defineProperty(c,"Accept",{value:a})}()}),require.register("curvature/model/Database.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Database=void 0;var n=r("../base/Bindable"),i=r("../base/Mixin"),o=r("../mixin/EventTargetMixin");function a(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=h(e);if(r){var o=h(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}(this,n)}}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=Symbol("BeforeWrite"),g=Symbol("AfterWrite"),d=Symbol("BeforeDelete"),y=Symbol("AfterDelete"),b=Symbol("BeforeInsert"),v=Symbol("AfterInsert"),m=Symbol("BeforeUpdate"),w=Symbol("AfterUpdate"),S=Symbol("BeforeRead"),O=Symbol("AfterRead"),j=Symbol("PrimaryKey"),k=Symbol("Connection"),x=Symbol("Instances"),P=(Symbol("HighWater"),Symbol("Metadata")),_=Symbol("Timers"),M=Symbol("Target"),R=(Symbol("Store"),Symbol("Each")),T=Symbol("Name"),A=Symbol("Bank"),E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(p,i.Mixin["with"](o.EventTargetMixin));var e,r,s,h=l(p);function p(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),e=h.call(this),Object.defineProperty(f(e),k,{value:t}),Object.defineProperty(f(e),T,{value:t.name}),Object.defineProperty(f(e),_,{value:{}}),Object.defineProperty(f(e),P,{value:{}}),Object.defineProperty(f(e),A,{value:{}}),e}return e=p,s=[{key:"open",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this[x][t]?this[x][t]:this[x][t]=new Promise(function(n,i){var o=indexedDB.open(t,r);o.onerror=function(t){p.dispatchEvent(new CustomEvent("error",{detail:{database:e[T],error:t,store:void 0,type:"read",subType:"select"}})),i(t)},o.onsuccess=function(t){var r=new e(t.target.result);n(r)},o.onupgradeneeded=function(t){var n=t.target.result;n.addEventListener("error",function(t){return console.error(t)});for(var i=new e(n),o=t.oldVersion+1;o<=r;o+=1)i["_version_"+o](n)}})}},{key:"getPrimaryKey",value:function(t){return t[j]?t[j]:null}},{key:"destroyDatabase",value:function(){var t=this;return new Promise(function(e,r){var n=indexedDB.delete(dbName);n.onerror=function(t){p.dispatchEvent(new CustomEvent("error",{detail:{database:dbName,error:t,type:"destroy"}})),r(t)},n.onsuccess=function(r){delete t[x][dbName],e(dbName)}})}}],(r=[{key:"select",value:function(t){var e=this,r=t.store,n=t.index,i=t.range,o=void 0===i?null:i,a=t.ranges,s=void 0===a?[]:a,c=t.direction,u=void 0===c?"next":c,l=t.limit,f=void 0===l?0:l,h=t.offset,p=void 0===h?0:h,g=t.type,d=void 0!==g&&g,y=t.origin,b=void 0===y?void 0:y,v=t.map,m=void 0===v?void 0:v,w=this[k].transaction(r,"readonly").objectStore(r),S=n?w.index(n):w;return s&&s.length||(s=[o]),{each:this[R](d,S,u,s,f,p,b,m),one:this[R](d,S,u,s,1,p,b,m),then:function(t){return e[R](d,S,u,s,f,p,b,m)(function(t){return t}).then(t)}}}},{key:"insert",value:function(t,e){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this[A][t]=this[A][t]||{};var o=this[k].transaction([t],"readwrite"),a=o.objectStore(t),s=this[A][t],c=!0;Array.isArray(e)||(e=[e],c=!1);var u,l=e.map(function(e){return new Promise(function(c,u){e=n.Bindable.make(e);var l={database:r[T],record:e,store:t,type:"write",subType:"insert",origin:i},f=e[p.BeforeWrite]?e[p.BeforeWrite](l):null,h=e[p.BeforeInsert]?e[p.BeforeInsert](l):null,g=a.add(Object.assign({},n.Bindable.shuck(e)));!1!==f&&!1!==h&&(g.onerror=function(t){r.dispatchEvent(new CustomEvent("writeError",{detail:l})),u(t)},g.onsuccess=function(n){var a=n.target.result;s[a]=e;if(l.key=p.getPrimaryKey(e),r.dispatchEvent(new CustomEvent("write",{cancelable:!0,detail:l}))){if(e[j]=Symbol.for(a),r[P][t]||(r[P][t]=r.getStoreMeta(t,"store",{})),r[P][t]){var u=r.checkHighWaterMark(t,e),f=r.checkLowWaterMark(t,e),h=r[P][t],g=e[h.highWater];i.setHighWater&&u<g&&r.setHighWaterMark(t,e,i,"insert"),i.setLowWater&&f>g&&r.setLowWaterMark(t,e,i,"insert")}e[p.AfterInsert]&&e[p.AfterInsert](l),e[p.AfterWrite]&&e[p.AfterWrite](l)}else o.abort();c(e)})})});return u=c?Promise.allSettled(l):l[0],Promise.all(l).then(function(){return o.commit&&o.commit()}),u}},{key:"update",value:function(t,e){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e[j])throw Error("Value provided is not a DB record!");return new Promise(function(o,a){var s=r[k].transaction([t],"readwrite"),c=s.objectStore(t),u={database:r[T],key:p.getPrimaryKey(e),record:e,store:t,type:"write",subType:"update",origin:i};e[p.AfterInsert]&&e[p.AfterInsert](u),e[p.AfterWrite]&&e[p.AfterWrite](u);var l=e[p.BeforeWrite]?e[p.BeforeWrite](u):null,f=e[p.BeforeUpdate]?e[p.BeforeUpdate](u):null;if(!1!==l&&!1!==f){var h=c.put(Object.assign({},n.Bindable.shuck(e)));h.onerror=function(t){r.dispatchEvent(new CustomEvent("writeError",{detail:u})),a(t)},h.onsuccess=function(n){if(r.dispatchEvent(new CustomEvent("write",{cancelable:!0,detail:u}))){if(r[P][t]||(r[P][t]=r.getStoreMeta(t,"store",{})),r[P][t]){var a=r.checkHighWaterMark(t,e),c=r.checkLowWaterMark(t,e),l=r[P][t],f=e[l.highWater];i.setHighWater&&a<f&&r.setHighWaterMark(t,e,i,"insert"),i.setLowWater&&c>f&&r.setLowWaterMark(t,e,i,"insert")}s.commit&&s.commit()}else s.abort();o(n)}}})}},{key:"delete",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(!e[j])throw Error("Value provided is not a DB record!");return new Promise(function(i,o){var a=r[k].transaction([t],"readwrite"),s=a.objectStore(t),c={database:r[T],record:e,key:p.getPrimaryKey(e),store:t,type:"write",subType:"delete",origin:n};if(!1!==(e[p.BeforeDelete]?e[p.BeforeDelete](c):null)){var u=s.delete(e.id);e[j]=void 0,e[p.AfterDelete]&&e[p.AfterDelete](c),u.onerror=function(t){c.original=t;var e=new CustomEvent("writeError",{detail:c});r.dispatchEvent(e),o(t)},u.onsuccess=function(t){c.original=t;var e=new CustomEvent("write",{detail:c});r.dispatchEvent(e),a.commit&&a.commit(),i(e)}}})}},{key:"clear",value:function(t){var e=this;return new Promise(function(r,n){var i=e[k].transaction([t],"readwrite"),o=i.objectStore(t).clear(),a={database:e[T],store:t,type:"write",subType:"clear",origin:origin};o.onerror=function(t){a.original=t;var r=new CustomEvent("writeError",{detail:a});e.dispatchEvent(r),n(t)},o.onsuccess=function(t){a.original=t;var n=new CustomEvent("write",{detail:a});e.dispatchEvent(n),i.commit&&i.commit(),r(n)}})}},{key:"listStores",value:function(){return a(this[k].objectStoreNames)}},{key:"listIndexes",value:function(t){return a(this[k].transaction([t]).objectStore(t).indexNames)}},{key:R,value:function(t,e,r,i,o,a,s,c){var u=this;return function(l){return Promise.all(i.map(function(i){return new Promise(function(f,h){var g=0;e.openCursor(i,r).addEventListener("success",function(r){var i=r.target.result;if(!i)return f({record:null,result:null,index:g});u[A][S]=u[A][S]||{};var h=u[A][S],d=i.primaryKey,y=t?t.from(i.value):i.value,b=n.Bindable.makeBindable(y),v={database:u[T],key:p.getPrimaryKey(b),record:y,store:e.name,type:"read",subType:"select",origin:s},m=y[p.BeforeRead]?y[p.BeforeRead](v):null;if(a>g++||!1===m)return i.continue();h[d]?Object.assign(h[d],y):(y[j]=Symbol.for(d),h[d]=y);var w=i.source,S=w.objectStore?w.objectStore.name:e.name;v.record=y,h[d][p.AfterRead]&&h[d][p.AfterRead](v);if(u.dispatchEvent(new CustomEvent("read",{detail:v,cancelable:!0}))){var O=t?t.from(h[d]):h[d];O[j]=Symbol.for(d);var k=c?c(O):O,x=l?l(k,g):k;if(o&&g-a>=o)return a+=o,f({mapped:k,result:x,index:g})}i.continue()})})})).then(function(t){return 1===t.length?t[0]:t})}}},{key:"setStoreMeta",value:function(t,e,r){localStorage.setItem("::::cvdb::".concat(t,"::").concat(e),JSON.stringify(r))}},{key:"getStoreMeta",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=localStorage.getItem("::::cvdb::".concat(t,"::").concat(e)),i=null!==n?JSON.parse(n):r;return null===i?r:i}},{key:"createObjectStore",value:function(t,e){var r=this[k].createObjectStore(t,e);return this.setStoreMeta(t,"store",e),r}},{key:"deleteObjectStore",value:function(t){return this[k].deleteObjectStore(t)}},{key:"checkHighWaterMark",value:function(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.getStoreMeta(t,"highWater",0)}},{key:"setHighWaterMark",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=e[this[P][t].highWater],o=this.getStoreMeta(t,"highWater",0);this.setStoreMeta(t,"highWater",i),this.dispatchEvent(new CustomEvent("highWaterMoved",{detail:{database:this[T],record:e,store:t,type:"highWaterMoved",subType:n,origin:r,oldValue:o,value:i}}))}},{key:"checkLowWaterMark",value:function(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.getStoreMeta(t,"lowWater",1/0)}},{key:"setLowWaterMark",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=e[this[P][t].highWater],o=this.getStoreMeta(t,"lowWater",null);this.setStoreMeta(t,"lowWater",i),this.dispatchEvent(new CustomEvent("lowWaterMoved",{detail:{database:this[T],record:e,store:t,type:"lowWaterMoved",subType:n,origin:r,oldValue:o,value:i}}))}}])&&c(e.prototype,r),s&&c(e,s),Object.defineProperty(e,"prototype",{writable:!1}),p}();e.Database=E,Object.defineProperty(E,x,{value:[]});try{Object.defineProperty(E,M,{value:new EventTarget})}catch(t){Object.defineProperty(E,M,{value:document.createDocumentFragment()})}Object.defineProperty(E,"BeforeDelete",{value:d}),Object.defineProperty(E,"AfterDelete",{value:y}),Object.defineProperty(E,"BeforeWrite",{value:p}),Object.defineProperty(E,"AfterWrite",{value:g}),Object.defineProperty(E,"BeforeInsert",{value:b}),Object.defineProperty(E,"AfterInsert",{value:v}),Object.defineProperty(E,"BeforeUpdate",{value:m}),Object.defineProperty(E,"AfterUpdate",{value:w}),Object.defineProperty(E,"BeforeRead",{value:S}),Object.defineProperty(E,"AfterRead",{value:O}),Object.defineProperty(E,"PKSymbol",{value:j});var C=function(t){Object.defineProperty(E,t,{value:function(){var e;return(e=E[M])[t].apply(e,arguments)}})};for(var B in["addEventListener","removeEventListener","dispatchEvent"])C(B)}()}),require.register("curvature/net/Elicit.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Elicit=void 0;var n=r("curvature/base/Mixin"),i=r("curvature/mixin/EventTargetMixin"),o=r("curvature/mixin/PromiseMixin");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=u(e);if(r){var o=u(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e)}(this,n)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=Symbol("IterateDownload"),f=Symbol("Retry"),h=Symbol("HandleFirstByte"),p=Symbol("HandleProgress"),g=Symbol("HandleComplete"),d=Symbol("HandleHeaders"),y=Symbol("HandleClose"),b=Symbol("HandleError"),v=Symbol("HandleOpen"),m=Symbol("HandleFail"),w=Symbol("LastChunkSize"),S=Symbol("LastChunkTime"),O=Symbol("Options"),j=Symbol("Fetch"),k=Symbol("Type"),x=Symbol("Url"),P=Symbol("RetriesLeft"),_=Symbol("TimeoutLeft"),M=Symbol("Timeout"),R=Symbol("Timer"),T=Symbol("Canecller"),A=Symbol("Caneclled"),E=Symbol("Paused"),C=Symbol("Received"),B=Symbol("Length"),D=Symbol("Opened"),I=Symbol("Closed"),F=Symbol("Start"),L=Symbol("First"),N=Symbol("End"),q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(W,n.Mixin["with"](i.EventTargetMixin,o.PromiseMixin));var e,r,u,q=c(W);function W(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,W),(e=q.call(this))[P]=r.retries||5,e[M]=r.timeout||4500,e[_]=r.maxTimeout||e[M]*e[P],e[S]=0,e[w]=0,e[A]=!1,e[C]=0,e[E]=!1,e[I]=0,e[O]=Object.assign({},r),e[x]=t,r.defer||e.open(),e}return e=W,(r=[{key:"open",value:function(){var t=this;if(!this[D]||this[I]){this[F]||(this[F]=Date.now()),this[T]=new AbortController,this[O].signal=this[T].signal,this[D]=Date.now(),this[I]=0,this[L]=0,this[j]=fetch(this[x],this[O]).then(function(e){return t[v](e)}).catch(function(e){return t[b](e)});this[R]=setTimeout(function(){if(!t[L]){if(t[T].abort(),t[y](),t[_]=Math.max(0,t[_]-t[M]),!t[_])return;t[m](new Error("Timed out."))}},this[M])}}},{key:"headers",value:function(){return this[j].then(function(t){var e=t.response;t.stream;return e.headers})}},{key:"json",value:function(){var t=this;return this[j].then(function(e){e.response;var r=e.stream;return new Response(r,{headers:{"Content-Type":t.type}}).json()})}},{key:"text",value:function(){var t=this;return this[j].then(function(e){e.response;var r=e.stream;return new Response(r,{headers:{"Content-Type":t.type}}).text()})}},{key:"css",value:function(){return this.text().then(function(t){var e=new CSSStyleSheet;return e.replace(t),e})}},{key:"blob",value:function(){var t=this;return this[j].then(function(e){e.response;var r=e.stream;return new Response(r,{headers:{"Content-Type":t.type}}).blob()})}},{key:"buffer",value:function(){return this.blob().then(function(t){return t.arrayBuffer()})}},{key:"bytes",value:function(){return this.buffer().then(function(t){return new Uint8Array(t)})}},{key:"objectUrl",value:function(){return this.blob().then(function(t){return URL.createObjectURL(t)})}},{key:"cancel",value:function(){this.emitCancelEvent()&&(this[T].abort(),this[A]=!0,this.emitCancelledEvent())}},{key:"pause",value:function(){this[N]||this[E]||this[I]||this.emitPauseEvent()&&(this[E]=!0,this.emitPausedEvent())}},{key:"unpause",value:function(){!this[N]&&this[E]&&this.emitUnpauseEvent()&&(this[E]=!1,this.emitUnpausedEvent())}},{key:"done",get:function(){return!!this[N]}},{key:"type",get:function(){return this[k]}},{key:"totalTime",get:function(){return this[N]?this[N]-this[F]:Date.now()-this[F]}},{key:"waitTime",get:function(){return this[L]?this[L]-this[D]:Date.now()-this[D]}},{key:"loadTime",get:function(){return this[D]?this[I]?this[I]-this[L]:Date.now()-this[L]:0}},{key:"speed",get:function(){return this[D]?((t=this[N]?this[N]-this[S]:Date.now()-this[S])||(t=.01),this[w]/t):0;var t}},{key:"received",get:function(){return this[C]}},{key:"length",get:function(){return this[B]}},{key:"isPaused",get:function(){return this[E]}},{key:l,value:function(t,e,r){var n=this;this[p](r,0,null);var i=Date.now(),o=1,a=function(t){var a=t.done,c=t.value;return a?(e.close(),n[g]()):(e.enqueue(c),n[C]+=c.length,n[L]||n[h](c),n[p](r,n[C]),n[S]=i,n[w]=o,i=Date.now(),o=c.length,s())},s=function e(){return n[A]?t.cancel():n[E]?new Promise(function(t){setTimeout(function(){return t(e())},100)}):t.read().then(function(t){return a(t)}).catch(function(t){return n[b](t)})};return s()}},{key:f,value:function(){if(this.emitRetryEvent()&&!(this[P]<=0))return this[T].abort(),this[y](),this[C]=0,this[P]--,this.open()}},{key:v,value:function(t){var e=t.body.getReader(),r=this[B]||Number(t.headers.get("Content-Length")),n=this[n]||t.headers.get("Content-Type");this[B]=r,this[k]=n,this[d](t.headers);var i=this;return{response:t,stream:new ReadableStream({start:function(t){i[l](e,t,r)}})}}},{key:y,value:function(){this[I]=Date.now(),this.emitCloseEvent()}},{key:d,value:function(t){this.emitHeadersEvent(t)}},{key:p,value:function(t,e,r){this.emitProgressEvent(t,e,r)}},{key:g,value:function(){this[N]=Date.now(),this[y](),this.emitCompleteEvent(),this[o.PromiseMixin.Accept]()}},{key:b,value:function(t){return console.warn(t),this.emitErrorEvent(t)?this[m](t):this[f]()}},{key:m,value:function(t){return this[N]=Date.now(),this[y](),this.emitFailEvent(t),this[o.PromiseMixin.Reject](t)}},{key:h,value:function(t){clearInterval(this[R]),this[L]=Date.now(),this.emitFirstByteEvent(t)}},{key:"emitProgressEvent",value:function(t,e,r){var n=t?e/t:0,i=this.totalTime,o=this.loadTime,a=this.waitTime,s=this.speed;return this.dispatchEvent(new CustomEvent("progress",{detail:{length:t,received:e,done:n,speed:s,loadTime:o,waitTime:a,totalTime:i,value:r}}))}},{key:"emitOpenEvent",value:function(){return this.dispatchEvent(new CustomEvent("open"))}},{key:"emitCloseEvent",value:function(){return this.dispatchEvent(new CustomEvent("close"))}},{key:"emitFirstByteEvent",value:function(t){return this.dispatchEvent(new CustomEvent("firstByte",{detail:{received:t}}))}},{key:"emitHeadersEvent",value:function(t){return this.dispatchEvent(new CustomEvent("headers",{detail:{headers:t}}))}},{key:"emitCompleteEvent",value:function(){return this.dispatchEvent(new CustomEvent("complete"))}},{key:"emitErrorEvent",value:function(){return this.dispatchEvent(new CustomEvent("error",{cancelable:this[P]>0}))}},{key:"emitRetryEvent",value:function(){return this.dispatchEvent(new CustomEvent("retry",{cancelable:!0}))}},{key:"emitFailEvent",value:function(){return this.dispatchEvent(new CustomEvent("fail"))}},{key:"emitPauseEvent",value:function(){return this.dispatchEvent(new CustomEvent("pause",{cancelable:!0}))}},{key:"emitPausedEvent",value:function(){this.dispatchEvent(new CustomEvent("paused"))}},{key:"emitUnpauseEvent",value:function(){return this.dispatchEvent(new CustomEvent("unpause",{cancelable:!0}))}},{key:"emitUnpausedEvent",value:function(){this.dispatchEvent(new CustomEvent("unpaused"))}},{key:"emitCancelEvent",value:function(){return this.dispatchEvent(new CustomEvent("cancel",{cancelable:!0}))}},{key:"emitCancelledEvent",value:function(){return this.dispatchEvent(new CustomEvent("cancelled"))}}])&&a(e.prototype,r),u&&a(e,u),Object.defineProperty(e,"prototype",{writable:!1}),W}();e.Elicit=q}()}),require.register("sixgram/Actions.js",function(e,r,n){r=t(r,{},"sixgram"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HOME=e.LEAVE=e.ENTER=e.INSERT=e.IGNORE=void 0;e.IGNORE=0;e.INSERT=1;e.ENTER=2;e.LEAVE=3;e.HOME=4}()}),require.register("sixgram/Chunk.js",function(e,r,n){r=t(r,{},"sixgram"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Chunk=void 0;e.Chunk=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.depth=0,this.match=null,this.type="normal",this.list=[]}}()}),require.register("sixgram/Parser.js",function(e,r,n){r=t(r,{},"sixgram"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Parser=void 0;var t=r("./Chunk"),n=r("./Actions");function i(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function a(t){"@babel/helpers - typeof";return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=function(){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.tokens=t||{},this.modes=r||{}}var r,o,c;return r=e,(o=[{key:"parse",value:function(e){if(this.index=0,this.mode="normal",this.stack=[],!(this.mode in this.modes))throw new Error("Mode ".concat(this.mode," does not exist on parser."),this);var r=new t.Chunk,o=this.modes[this.mode];for(r.type=this.mode;this.index<e.length;){var s=!1;for(var c in o){var u=this.tokens[c],l=u.exec(e.substr(this.index));if(l&&!(l.index>0)){if(!o[c])throw new Error('Invalid token type "'.concat(c,'" found in mode "').concat(this.mode,'".'));var f=l[0],h="object"===a(o[c])?o[c]:[o[c]];s=!0,this.index+=f.length;var p="normal";for(var g in h){var d=h[g];if("string"!=typeof d)switch(d){case n.INSERT:r.list.push(f);break;case n.ENTER:var y=new t.Chunk;y.depth=r.depth+1,y.match=f,y.groups=i(f.match(u)).slice(1),y.mode=p,y.type=c,r.list.push(y),this.stack.push(r),r=y;break;case n.LEAVE:this.stack.length&&(r=this.stack.pop(),this.mode=r.type,o=this.modes[this.mode]);break;case n.HOME:this.stack.splice(0),o=this.modes.normal}else{if(!(d in this.modes))throw new Error('Mode "'.concat(d,'" does not exist.'));this.mode=d,o=this.modes[this.mode],p=d}}break}}if(!s)break}if(this.stack.length)throw new Error("Did not return to top of stack!");return this.stack.shift()||r}}])&&s(r.prototype,o),c&&s(r,c),e}();e.Parser=c}()}),require.register("sixgram/Renderer.js",function(e,r,n){r=t(r,{},"sixgram"),function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Renderer=void 0;var r=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.ops=t||{}}var r,n,i;return r=e,(n=[{key:"process",value:function(t){var e="";for(var r in t.list){var n=t.list[r];if(this.ops[t.type]){var i=this.ops[t.type](n,t);!1!==i&&(e+=i)}else!1!==n&&(e+=n)}return e}}])&&t(r.prototype,n),i&&t(r,i),e}();e.Renderer=r}()}),require.register("subspace-console/Console.js",function(e,r,n){r=t(r,{},"subspace-console"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Console=void 0;var t=r("curvature/base/View"),n=r("curvature/base/Bag"),i=r("./view/MeltingText"),o=r("./view/EchoMessage"),a=r("./Task"),s=r("./Path"),c=r("./ansi/Renderer"),u=r("./ansi/Parser");function l(t){"@babel/helpers - typeof";return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,n=y(t);if(e){var i=y(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var b=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(v,t.View);var r,h,y,b=d(v);function v(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v),t=b.call(this,r);var i={init:!1,path:s.Path},o=Object.assign({},i,e);return t.template='<div class = "terminal [[inverted]]" cv-on = "click:focus(event);:keydown(event):c;:keyup(event)c">\n\t<div class = "output" cv-each = "output:line:l" cv-ref = "output:curvature/base/Tag">\n\t\t<p>[[line]]</p>\n\t</div>\n\t<div class = "bottom">\n\t\t<div>[[prompt]]&nbsp;</div>\n\t\t<div>\n\t\t\t<form cv-on = "submit:cancel(event)">\n\t\t\t\t<textarea\n\t\t\t\t\tcv-bind = "input"\n\t\t\t\t\tcv-ref  = "input:curvature/base/Tag"\n\t\t\t\t\trow     = "1"\n\t\t\t\t></textarea>\n\t\t\t</form>\n\n\t\t\t<form cv-on = "submit:cancel(event)">\n\t\t\t\t<input\n\t\t\t\t\tautocomplete = "one-time-code"\n\t\t\t\t\tname    = "pw-input"\n\t\t\t\t\ttype    = "password"\n\t\t\t\t\tcv-bind = "input"\n\t\t\t\t\tcv-ref  = "password:curvature/base/Tag"\n\t\t\t\t/>\n\t\t\t</form>\n\n\t\t\t<input\n\t\t\t\tcv-on  = "input:fileLoaded(event)"\n\t\t\t\tcv-ref = "file:curvature/base/Tag"\n\t\t\t\tname   = "file-input"\n\t\t\t\ttype   = "file"\n\t\t\t\tstyle  = "display: none"\n\t\t\t/>\n\t\t</div>\n\t</div>\n</div>\n\n<div class = "scanlines"></div>\n',t.args.input="",t.args.output=[],t.args.inverted="",t.localEcho=!0,t.postToken=null,t.args.prompt="::",t.routes={},t.args.passwordMode=!1,t.tasks=[],t.taskList=new n.Bag,t.taskList.type=a.Task,t.max=10,t.historyCursor=-1,t.history=[],t.env=new Map,t.args.output.___after(function(e,r,n,i){"push"===r&&t.onNextFrame(function(){return t.scrollToBottom()})}),o.init&&t.runScript(o.init),t.scroller=o.scroller||document.body,t.path=o.path||{},t.originalInput="",t}return r=v,(h=[{key:"runCommand",value:function(t){var e=this;return 0!=this.historyCursor&&this.history.unshift(t),new Promise(function(r){var n;if("/"===t.substring(0,1)){if(!e.args.passwordMode){var i=new o.EchoMessage({message:t});e.args.output.push(i)}var s=e.unescape(t.substr(1));n=e.interpret(s)}else if(e.tasks.length){if(!e.args.passwordMode){var c=new o.EchoMessage({message:t,prompt:e.tasks[0].prompt});e.args.output.push(c)}var u=e.unescape(t);n=e.tasks[0].write(u)||Promise.resolve()}else{e.args.passwordMode||e.args.output.push(":: ".concat(t));var l=e.unescape(t);n=e.interpret(l)}n instanceof a.Task||n instanceof Promise||(n=Promise.resolve(n),e.args.output.push(":: ".concat(t))),e.historyCursor=-1,e.originalInput=e.args.input="",n.then(function(t){return r(t)})}).catch(function(t){e.args.output.push("Unexpected error: ".concat(t))})}},{key:"runScript",value:function(t){var e=this;fetch(t+"?api=txt").then(function(t){return t.text()}).then(function(t){!function t(r){if(r.length){var n=r.shift();n&&"!"==n[0]?(e.args.output.push(n.substring(1)),t(r)):n?e.runCommand(n).then(function(){return t(r)}):t(r)}}(t.split("\n"))})}},{key:"postRender",value:function(){var t=this,e=this.tags.input.element,r=this.tags.password.element;this.args.bindTo("input",function(t){},{frame:1}),this.args.bindTo("passwordMode",function(t){t?(e.style.display="none",r.style.display="unset"):(e.style.display="unset",r.style.display="none")}),this.args.bindTo("passwordMode",function(e){t.focus(null,e)},{frame:1})}},{key:"focus",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t&&t.preventDefault(),t&&t.target&&t.target.matches("input,textarea")||window.getSelection().toString()||(e||this.args.passwordMode?this.tags.password.element.focus():this.tags.input.element.focus())}},{key:"interpret",value:function(t){var e=this;this.historyCursor=-1;var r,n=null,i=f(t.split(/\s*\;\s*/));try{var o=function(){var t=r.value,i=e.pipe(t.split(/\s*\|\s*/));if(i){e.tasks.unshift(i);var o=function(t){var r=t.detail;if("object"===l(r))e.args.output.push(r);else{var n=i.outPrompt||i.prompt||e.args.prompt||"::",o=e.parseAnsi(r,n);e.args.output.push(o)}},a=function(t){console.error(t);var r=t.detail,n=i.errorPrompt||"!!",o=e.parseAnsi(r,n);e.args.output.push(o)};i.addEventListener("output",o),i.addEventListener("error",a),i.execute(),i.catch(function(t){return console.error(t)}),i.catch(function(t){return e.args.output.push("!! ".concat(t))}),e.args.prompt=i.prompt,i.finally(function(t){i.removeEventListener("error",a),i.removeEventListener("output",o),e.tasks.shift(),e.tasks.length?e.args.prompt=e.tasks[0].prompt:e.args.prompt="::"})}n=i};for(i.s();!(r=i.n()).done;)o()}catch(t){i.e(t)}finally{i.f()}return n}},{key:"pipe",value:function(t,e){var r=null,n=t.shift().trim().split(" "),o=n.shift().trim();if(!(o.length>1&&"?"==o.substr(-1))){if(o in this.path)r=new(0,this.path[o])(n,e,this);else switch(o){case"clear":this.args.output.splice(0);break;case"z":this.args.output.splice(0),this.args.output.push(new i.MeltingText({input:"!!!"}));break;case"commands":case"?":for(var a in this.args.output.push("   Subspace Console 0.29a 2018-2021 Sean Morris"),this.path)this.args.output.push(" * ".concat(a," - ").concat(this.path[a].helpText)),this.path[a].useText&&this.args.output.push("   ".concat(this.path[a].useText)),this.args.output.push("  ");break;default:this.args.output.push("!! Bad command: ".concat(o))}return t.length?this.pipe(t,r):r}(o=o.substr(0,o.length-1))in this.path&&(this.args.output.push("?? ".concat(this.path[o].helpText)),this.args.output.push("?? ".concat(this.path[o].useText)))}},{key:"keydown",value:function(t,e){switch(t.key){case"Tab":if(e)break;t.preventDefault();break;case"Enter":t.ctrlKey||t.preventDefault()}}},{key:"keyup",value:function(t,e){var r=this;switch(t.key){case"ArrowDown":if(this.onNextFrame(function(){return r.scrollToBottom()}),this.historyCursor--,this.historyCursor<=-1)return this.historyCursor=-1,void(this.args.input=this.originalInput);this.args.input=this.history[this.historyCursor];var n=this.tags.input.element;n.selectionStart=n.value.length,n.selectionEnd=n.value.length,t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault();break;case"ArrowUp":if(this.onNextFrame(function(){return r.scrollToBottom()}),-1==this.historyCursor&&(this.originalInput=this.args.input),this.historyCursor++,this.historyCursor>=this.history.length)return void this.historyCursor--;this.args.input=this.history[this.historyCursor];var i=this.tags.input.element;i.selectionStart=i.value.length,i.selectionEnd=i.value.length,t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault();break;case"Escape":this.tasks.length&&(console.log(a.Task.KILL),this.tasks[0].finally(function(){return r.args.output.push(":: Killed.")}),this.tasks[0].signal(a.Task.KILL),this.tasks[0].signal("kill")),this.args.passwordMode=!1;break;case"Tab":if(t.preventDefault(),!this.args.input||"/"!==this.args.input[0])break;var o=this.args.input.substr(1);for(var s in this.path)if(!(s.length<o.length)&&o===s.substr(0,o.length)){this.args.input="/"+s;break}break;case"Enter":if(t.ctrlKey)return;t.preventDefault(),this.runCommand(this.args.input),this.args.input="";break;default:this.historyCursor=-1,this.scrollToBottom()}}},{key:"cancel",value:function(t){t.preventDefault(),t.stopPropagation()}},{key:"scrollToBottom",value:function(){var t=(this.scroller===document.body?window:this.scroller)||window,e=(this.scroller===document.body?this.scroller:document.body).scrollHeight;this.onNextFrame(function(){t.scrollTo({behavior:"smooth",left:0,top:e})})}},{key:"parseAnsi",value:function(e,r){e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;");var n=new c.Renderer,i=u.Parser.parse(e),o=n.process(i);if(!r)return t.View.from('<span class ="ansi">'.concat(o,"</span>"));var a=r.replace(/</g,"&lt;").replace(/>/g,"&gt;");return t.View.from("".concat(a,' <span class ="ansi">').concat(o,"</span>"))}},{key:"unescape",value:function(t){return t.replace(/\\n/gm,"\n").replace(/\\r/gm,"\r").replace(/\\t/gm,"\t").replace(/\\e/gm,"").replace(/\\u001b/gm,"")}},{key:"write",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n=0,i=e;n<i.length;n++){var o=i[n];if("string"!=typeof o)this.args.output.push(o);else{var a=this.unescape(o),s=this.parseAnsi(a);this.args.output.push(s)}}}}])&&p(r.prototype,h),y&&p(r,y),v}();e.Console=b}()}),require.register("subspace-console/Path.js",function(e,r,n){r=t(r,{},"subspace-console"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Path=void 0;r("subspace-console/Task");e.Path={}}()}),require.register("subspace-console/Task.js",function(e,n,i){n=t(n,{},"subspace-console"),function(){"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Task=void 0;n("curvature/base/Bindable");var i=n("curvature/base/Mixin"),o=n("./mixin/Target"),a=n("./mixin/TaskSignals");function s(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,n=g(t);if(e){var i=g(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,r){return!r||"object"!==t(r)&&"function"!=typeof r?p(e):r}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var y=0,b=(Symbol("target"),Symbol("accept")),v=Symbol("reject"),m=Symbol("execute"),w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(w,i.Mixin["with"](o.Target,a.TaskSignals));var e,n,c,g=f(w);function w(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,w),d(p(t=g.call(this)),"title","Generic Task"),d(p(t),"prompt","::"),t.args=e,t.prev=r,t.term=n,t.status=-1,t.thread=new Promise(function(e,r){t[b]=e,t[v]=r}),t.id=y++,h(t,p(t))}return e=w,(n=[{key:"then",value:function(t){return this.thread.then(t)}},{key:"catch",value:function(t){return this.thread.catch(t)}},{key:"finally",value:function(t){return this.thread.finally(t)}},{key:"print",value:function(t){this.dispatchEvent(new CustomEvent("output",{detail:t}))}},{key:"printErr",value:function(t){this.dispatchEvent(new CustomEvent("error",{detail:t}))}},{key:"write",value:function(t){return this.main(t)}},{key:"signal",value:function(t){switch(this["signal::".concat(t)]&&this["signal::".concat(t)](),t){case"close":this.dispatchEvent(new CustomEvent("close"))&&(this.status>0?this[v]():this[b]());break;case"kill":this.status>0?this[v]():this[b]()}}},{key:"execute",value:function(){return this[m](this.prev)}},{key:m,value:function(){var t=this,e=function(e){var r=e.detail;return t.write(r)},n=this.init.apply(this,s(this.args)),i=this.prev;return i&&i.addEventListener("output",e),n instanceof Promise||(n=Promise.resolve(n)),i?(i[m](),Promise.allSettled([i,n]).finally(function(){return i.then(function(e){return t[b](e)}),i.catch(function(e){return t[v](r)}),i.removeEventListener("output",e),t.done()})):Promise.allSettled([n]).then(function(e){try{t.main(void 0),t[b]()}catch(e){t[v]()}t.done()})}},{key:"init",value:function(){}},{key:"main",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]}},{key:"done",value:function(t){return this.status}}])&&u(e.prototype,n),c&&u(e,c),w}();e.Task=w}()}),require.register("subspace-console/ansi/Colors255.js",function(e,r,n){r=t(r,{},"subspace-console"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Colors255=void 0;e.Colors255={0:{r:0,g:0,b:0},1:{r:128,g:0,b:0},2:{r:0,g:128,b:0},3:{r:128,g:128,b:0},4:{r:0,g:0,b:128},5:{r:128,g:0,b:128},6:{r:0,g:128,b:128},7:{r:192,g:192,b:192},8:{r:128,g:128,b:128},9:{r:255,g:0,b:0},10:{r:0,g:255,b:0},11:{r:255,g:255,b:0},12:{r:0,g:0,b:255},13:{r:255,g:0,b:255},14:{r:0,g:255,b:255},15:{r:255,g:255,b:255},16:{r:0,g:0,b:0},17:{r:0,g:0,b:95},18:{r:0,g:0,b:135},19:{r:0,g:0,b:175},20:{r:0,g:0,b:215},21:{r:0,g:0,b:255},22:{r:0,g:95,b:0},23:{r:0,g:95,b:95},24:{r:0,g:95,b:135},25:{r:0,g:95,b:175},26:{r:0,g:95,b:215},27:{r:0,g:95,b:255},28:{r:0,g:135,b:0},29:{r:0,g:135,b:95},30:{r:0,g:135,b:135},31:{r:0,g:135,b:175},32:{r:0,g:135,b:215},33:{r:0,g:135,b:255},34:{r:0,g:175,b:0},35:{r:0,g:175,b:95},36:{r:0,g:175,b:135},37:{r:0,g:175,b:175},38:{r:0,g:175,b:215},39:{r:0,g:175,b:255},40:{r:0,g:215,b:0},41:{r:0,g:215,b:95},42:{r:0,g:215,b:135},43:{r:0,g:215,b:175},44:{r:0,g:215,b:215},45:{r:0,g:215,b:255},46:{r:0,g:255,b:0},47:{r:0,g:255,b:95},48:{r:0,g:255,b:135},49:{r:0,g:255,b:175},50:{r:0,g:255,b:215},51:{r:0,g:255,b:255},52:{r:95,g:0,b:0},53:{r:95,g:0,b:95},54:{r:95,g:0,b:135},55:{r:95,g:0,b:175},56:{r:95,g:0,b:215},57:{r:95,g:0,b:255},58:{r:95,g:95,b:0},59:{r:95,g:95,b:95},60:{r:95,g:95,b:135},61:{r:95,g:95,b:175},62:{r:95,g:95,b:215},63:{r:95,g:95,b:255},64:{r:95,g:135,b:0},65:{r:95,g:135,b:95},66:{r:95,g:135,b:135},67:{r:95,g:135,b:175},68:{r:95,g:135,b:215},69:{r:95,g:135,b:255},70:{r:95,g:175,b:0},71:{r:95,g:175,b:95},72:{r:95,g:175,b:135},73:{r:95,g:175,b:175},74:{r:95,g:175,b:215},75:{r:95,g:175,b:255},76:{r:95,g:215,b:0},77:{r:95,g:215,b:95},78:{r:95,g:215,b:135},79:{r:95,g:215,b:175},80:{r:95,g:215,b:215},81:{r:95,g:215,b:255},82:{r:95,g:255,b:0},83:{r:95,g:255,b:95},84:{r:95,g:255,b:135},85:{r:95,g:255,b:175},86:{r:95,g:255,b:215},87:{r:95,g:255,b:255},88:{r:135,g:0,b:0},89:{r:135,g:0,b:95},90:{r:135,g:0,b:135},91:{r:135,g:0,b:175},92:{r:135,g:0,b:215},93:{r:135,g:0,b:255},94:{r:135,g:95,b:0},95:{r:135,g:95,b:95},96:{r:135,g:95,b:135},97:{r:135,g:95,b:175},98:{r:135,g:95,b:215},99:{r:135,g:95,b:255},100:{r:135,g:135,b:0},101:{r:135,g:135,b:95},102:{r:135,g:135,b:135},103:{r:135,g:135,b:175},104:{r:135,g:135,b:215},105:{r:135,g:135,b:255},106:{r:135,g:175,b:0},107:{r:135,g:175,b:95},108:{r:135,g:175,b:135},109:{r:135,g:175,b:175},110:{r:135,g:175,b:215},111:{r:135,g:175,b:255},112:{r:135,g:215,b:0},113:{r:135,g:215,b:95},114:{r:135,g:215,b:135},115:{r:135,g:215,b:175},116:{r:135,g:215,b:215},117:{r:135,g:215,b:255},118:{r:135,g:255,b:0},119:{r:135,g:255,b:95},120:{r:135,g:255,b:135},121:{r:135,g:255,b:175},122:{r:135,g:255,b:215},123:{r:135,g:255,b:255},124:{r:175,g:0,b:0},125:{r:175,g:0,b:95},126:{r:175,g:0,b:135},127:{r:175,g:0,b:175},128:{r:175,g:0,b:215},129:{r:175,g:0,b:255},130:{r:175,g:95,b:0},131:{r:175,g:95,b:95},132:{r:175,g:95,b:135},133:{r:175,g:95,b:175},134:{r:175,g:95,b:215},135:{r:175,g:95,b:255},136:{r:175,g:135,b:0},137:{r:175,g:135,b:95},138:{r:175,g:135,b:135},139:{r:175,g:135,b:175},140:{r:175,g:135,b:215},141:{r:175,g:135,b:255},142:{r:175,g:175,b:0},143:{r:175,g:175,b:95},144:{r:175,g:175,b:135},145:{r:175,g:175,b:175},146:{r:175,g:175,b:215},147:{r:175,g:175,b:255},148:{r:175,g:215,b:0},149:{r:175,g:215,b:95},150:{r:175,g:215,b:135},151:{r:175,g:215,b:175},152:{r:175,g:215,b:215},153:{r:175,g:215,b:255},154:{r:175,g:255,b:0},155:{r:175,g:255,b:95},156:{r:175,g:255,b:135},157:{r:175,g:255,b:175},158:{r:175,g:255,b:215},159:{r:175,g:255,b:255},160:{r:215,g:0,b:0},161:{r:215,g:0,b:95},162:{r:215,g:0,b:135},163:{r:215,g:0,b:175},164:{r:215,g:0,b:215},165:{r:215,g:0,b:255},166:{r:215,g:95,b:0},167:{r:215,g:95,b:95},168:{r:215,g:95,b:135},169:{r:215,g:95,b:175},170:{r:215,g:95,b:215},171:{r:215,g:95,b:255},172:{r:215,g:135,b:0},173:{r:215,g:135,b:95},174:{r:215,g:135,b:135},175:{r:215,g:135,b:175},176:{r:215,g:135,b:215},177:{r:215,g:135,b:255},178:{r:215,g:175,b:0},179:{r:215,g:175,b:95},180:{r:215,g:175,b:135},181:{r:215,g:175,b:175},182:{r:215,g:175,b:215},183:{r:215,g:175,b:255},184:{r:215,g:215,b:0},185:{r:215,g:215,b:95},186:{r:215,g:215,b:135},187:{r:215,g:215,b:175},188:{r:215,g:215,b:215},189:{r:215,g:215,b:255},190:{r:215,g:255,b:0},191:{r:215,g:255,b:95},192:{r:215,g:255,b:135},193:{r:215,g:255,b:175},194:{r:215,g:255,b:215},195:{r:215,g:255,b:255},196:{r:255,g:0,b:0},197:{r:255,g:0,b:95},198:{r:255,g:0,b:135},199:{r:255,g:0,b:175},200:{r:255,g:0,b:215},201:{r:255,g:0,b:255},202:{r:255,g:95,b:0},203:{r:255,g:95,b:95},204:{r:255,g:95,b:135},205:{r:255,g:95,b:175},206:{r:255,g:95,b:215},207:{r:255,g:95,b:255},208:{r:255,g:135,b:0},209:{r:255,g:135,b:95},210:{r:255,g:135,b:135},211:{r:255,g:135,b:175},212:{r:255,g:135,b:215},213:{r:255,g:135,b:255},214:{r:255,g:175,b:0},215:{r:255,g:175,b:95},216:{r:255,g:175,b:135},217:{r:255,g:175,b:175},218:{r:255,g:175,b:215},219:{r:255,g:175,b:255},220:{r:255,g:215,b:0},221:{r:255,g:215,b:95},222:{r:255,g:215,b:135},223:{r:255,g:215,b:175},224:{r:255,g:215,b:215},225:{r:255,g:215,b:255},226:{r:255,g:255,b:0},227:{r:255,g:255,b:95},228:{r:255,g:255,b:135},229:{r:255,g:255,b:175},230:{r:255,g:255,b:215},231:{r:255,g:255,b:255},232:{r:8,g:8,b:8},233:{r:18,g:18,b:18},234:{r:28,g:28,b:28},235:{r:38,g:38,b:38},236:{r:48,g:48,b:48},237:{r:58,g:58,b:58},238:{r:68,g:68,b:68},239:{r:78,g:78,b:78},240:{r:88,g:88,b:88},241:{r:98,g:98,b:98},242:{r:108,g:108,b:108},243:{r:118,g:118,b:118},244:{r:128,g:128,b:128},245:{r:138,g:138,b:138},246:{r:148,g:148,b:148},247:{r:158,g:158,b:158},248:{r:168,g:168,b:168},249:{r:178,g:178,b:178},250:{r:188,g:188,b:188},251:{r:198,g:198,b:198},252:{r:208,g:208,b:208},253:{r:218,g:218,b:218},254:{r:228,g:228,b:228},255:{r:238,g:238,b:238}}}()}),require.register("subspace-console/ansi/Parser.js",function(e,r,n){r=t(r,{},"subspace-console"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Parser=void 0;var t=r("sixgram/Actions"),n=r("sixgram/Parser"),i={normal:{reset:[t.IGNORE,t.ENTER,t.LEAVE],escaped:[t.IGNORE,t.ENTER,t.LEAVE],graphics:[t.IGNORE,t.ENTER,t.LEAVE],characters:[t.INSERT]}},o=new n.Parser({reset:/\u001b\[(0);?m/,graphics:/\u001b\[(\d+);?(\d+)?;?([\d;]*)?./,escaped:/\\([^e])/,characters:/[\s\S]+?(?=\x1B|$)/},i);e.Parser=o}()}),require.register("subspace-console/ansi/Renderer.js",function(e,r,n){r=t(r,{},"subspace-console"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Renderer=void 0;var t=r("sixgram/Renderer"),n=r("./pallete"),i=r("./Colors255");function o(t){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,n=h(t);if(e){var i=h(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;return f(t)}(this,r)}}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=new AudioContext,g=p.createGain();g.connect(p.destination),g.gain.value=.1;var d=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(y,t.Renderer);var r,s,h,d=l(y);function y(){var t,e,r,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),t=d.call(this,{normal:function(e,r){return t.setGraphicsMode(e,r)}}),e=f(t),n={},(r="style")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t}return r=y,(s=[{key:"reset",value:function(){for(var t=0,e=Object.entries(this.style);t<e.length;t++){var r=a(e[t],1)[0];delete this.style[r]}}},{key:"beep",value:function(){var t=p.createOscillator();t.connect(g),t.frequency.value=840,t.type="square",t.start(p.currentTime),t.stop(p.currentTime+.2)}},{key:"setGraphicsMode",value:function(t,e){if("string"==typeof t){if(""===t)return!1;for(var r="",s=0,c=Object.entries(this.style);s<c.length;s++){var u=a(c[s],2),l=u[0],f=u[1];r+="".concat(l,": ").concat(f,"; ")}return'<span class = "ansi" style = "'.concat(r,'">').concat(t,"</span>")}if("object"===o(t)){if("escaped"===t.type&&"a"===t.groups[0]&&this.beep(),"graphics"===t.type||"reset"===t.type)for(var h=0;h<t.groups.length;h++){var p=Number(t.groups[h]);if(""===t.groups[h])return!1;switch(p){case 0:for(var g in this.style)delete this.style[g];break;case 1:this.style.filter="contrast(1.25)",this.style["font-weight"]="bold",this.style.opacity=1;break;case 2:this.style.filter="brightness(0.85)",this.style["font-weight"]="light",this.style.opacity=.75;break;case 3:this.style["font-style"]="italic";break;case 4:this.style["text-decoration"]="underline";break;case 5:this.style.animation="var(--ansiBlink)";break;case 7:this.style.filter="invert(1)";break;case 8:this.style.filter="contrast(0.5)",this.style.opacity=.1;break;case 9:this.style["text-decoration"]="line-through";break;case 10:this.style["font-family"]="var(--base-font))";break;case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:this.style["font-family"]="var(--alt-font-no-".concat(p,")");break;case 20:this.style["font-family"]="var(--alt-font-fraktur)",this.style["font-size"]="1.1rem";break;case 21:case 22:this.style["font-weight"]="initial";break;case 23:this.style["font-weight"]="initial",this.style["font-style"]="initial";break;case 24:this.style["text-decoration"]="none",this.style["font-family"]="sans-serif",this.style["font-size"]="12pt";break;case 25:this.style.animation="none";break;case 26:this.style["text-transform"]="full-width";break;case 27:this.style.filter="initial";break;case 28:this.style.opacity="initial";break;case 29:this.style["text-decoration"]="initial";break;case 30:this.style.color=n.pallete.black;break;case 31:this.style.color=n.pallete.red;break;case 32:this.style.color=n.pallete.green;break;case 33:this.style.color=n.pallete.yellow;break;case 34:this.style.color=n.pallete.blue;break;case 35:this.style.color=n.pallete.magenta;break;case 36:this.style.color=n.pallete.cyan;break;case 37:this.style.color=n.pallete.white;break;case 38:if(2==t.groups[1+h]){var d=a(t.groups[2+h].split(";"),3),y=d[0],b=d[1],v=d[2];this.style.color="rgb(".concat(y,",").concat(b,",").concat(v,")")}if(5==t.groups[1+h]){var m=i.Colors255[Number(t.groups[2+h])],w=m.r,S=m.g,O=m.b;this.style.color="rgb(".concat(w,",").concat(S,",").concat(O,")")}h+=2;break;case 39:this.style.color="var(--fgColor)";break;case 40:this.style["background-color"]=n.pallete.black;break;case 41:this.style["background-color"]=n.pallete.red;break;case 42:this.style["background-color"]=n.pallete.green;break;case 43:this.style["background-color"]=n.pallete.yellow;break;case 44:this.style["background-color"]=n.pallete.blue;break;case 45:this.style["background-color"]=n.pallete.magenta;break;case 46:this.style["background-color"]=n.pallete.cyan;break;case 47:this.style["background-color"]=n.pallete.white;break;case 48:if(2==t.groups[1+h]){var j=a(t.groups[2+h].split(";"),3),k=j[0],x=j[1],P=j[2];this.style["background-color"]="rgb(".concat(k,",").concat(x,",").concat(P,")")}if(5==t.groups[1+h]){var _=i.Colors255[Number(t.groups[2+h])],M=_.r,R=_.g,T=_.b;this.style["background-color"]="rgb(".concat(M,",").concat(R,",").concat(T,")")}h+=2;break;case 49:this.style["background-color"]="var(--bgColor)";break;case 50:this.style["text-transform"]="initial";break;case 51:this.style.border="1px solid currentColor";break;case 52:this.style.border="1px solid currentColor",this.style["border-radius"]="1em";break;case 53:this.style["text-decoration"]="overline";break;case 54:case 55:this.style.border="initial"}}return!1}}}])&&c(r.prototype,s),h&&c(r,h),y}();e.Renderer=d}()}),require.register("subspace-console/ansi/pallete.js",function(e,r,n){r=t(r,{},"subspace-console"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.pallete=void 0;e.pallete={black:"var(--ansi-black, #000000)",dBlack:"var(--ansi-black-dark, #343434)",bBlack:"var(--ansi-black-light, #888888)",red:"var(--ansi-red, #c0002c)",dRed:"var(--ansi-red-dark, #4a132b)",bRed:"var(--ansi-red-light, #ff7869)",green:"var(--ansi-green, #80a763)",dGreen:"var(--ansi-green-dark, #326f38)",bGreen:"var(--ansi-green-light, #93d393)",yellow:"var(--ansi-yellow, #e3c651)",dYellow:"var(--ansi-yellow-dark, #baa447)",bYellow:"var(--ansi-yellow-light, #fdc253)",blue:"var(--ansi-blue, #5485c0)",dBlue:"var(--ansi-blue-dark, #38577d)",bBlue:"var(--ansi-blue-light, #77aff2)",magenta:"var(--ansi-magenta, #C61B6E)",dMagenta:"var(--ansi-magenta-dark, #935894)",bMagenta:"var(--ansi-magenta-light, #bf83c0)",cyan:"var(--ansi-cyan, #57c2c0)",dCyan:"var(--ansi-cyan-dark, #2d5695)",bCyan:"var(--ansi-cyan-light, #cef6f5)",white:"var(--ansi-cyan, #e0e0e0)",dWhite:"var(--ansi-cyan-dark, #b0b0b0)",bWhite:"var(--ansi-cyan-light, #ffffff)"}}()}),require.register("subspace-console/mixin/Target.js",function(e,r,n){r=t(r,{},"subspace-console"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Target=void 0;var t,n=r("curvature/base/Mixin");function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=Symbol("target"),a=0,s=(i(t={},n.Mixin.Constructor,function(){try{this[o]=new EventTarget}catch(t){this[o]=document.createDocumentFragment()}this[o].x=a++}),i(t,"dispatchEvent",function(){var t;(t=this[o]).dispatchEvent.apply(t,arguments)}),i(t,"addEventListener",function(){var t;(t=this[o]).addEventListener.apply(t,arguments)}),i(t,"removeEventListener",function(){var t;(t=this[o]).removeEventListener.apply(t,arguments)}),t);e.Target=s}()}),require.register("subspace-console/mixin/TaskSignals.js",function(e,r,n){r=t(r,{},"subspace-console"),function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Object.defineProperty(e,"__esModule",{value:!0}),e.TaskSignals=void 0;var n=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,n,i;return r=e,(n=[{key:"signal::kill",value:function(){console.log("KILL!"),this.status>0?this[Reject]():this[Accept]()}},{key:"signal::close",value:function(){this.dispatchEvent(new CustomEvent("error",{detail:detail}))&&(this.status>0?this[Reject]():this[Accept]())}}])&&t(r.prototype,n),i&&t(r,i),e}();e.TaskSignals=n,r(n,"KILL","kill"),r(n,"CLOSE","close")}()}),require.register("subspace-console/view/EchoMessage.js",function(e,r,n){r=t(r,{},"subspace-console"),function(){"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.EchoMessage=void 0;var n=r("curvature/base/View");function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=a(e);if(r){var o=a(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e)}(this,n)}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var s=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(r,n.View);var e=o(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(t=e.call(this,n)).args.prompt=t.args.prompt||"<<",t.template='<span>[[prompt]]&nbsp;</span><span class = "text">[[message]]</span>',t}return r}();e.EchoMessage=s}()}),require.register("subspace-console/view/MeltingText.js",function(e,r,n){r=t(r,{},"subspace-console"),function(){"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.MeltingText=void 0;var n=r("curvature/base/View");function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=s(e);if(r){var o=s(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e)}(this,n)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(u,n.View);var e,r,s,c=a(u);function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=c.call(this,t)).last=e.init=Date.now(),e.charUp=["","",""],e.charMid=["","","","","","","","","","","","","","","","","","","","",""],e.charDown=["","","",""],e.template='\n\t\t\t<div cv-bind = "output" class = "melting"></div>\n\t\t',e.args.input="Magic is no more than the art of employing consciously invisible means to produce visible effects. Will, love, and imagination are magic powers that everyone possesses; and whoever knows how to develop them to their fullest extent is a magician. Magic has but one dogma, namely, that the seen is the measure of the unseen\n",e.args.output="uh.",e.corruptors=[],e.maxMaxCorrupt=25,e.maxCorrupt=0,e.type="",e.onFrame(function(){e.typewriter(e.args.input)}),e.onInterval(64,function(){var t=window.getSelection();t.anchorOffset===t.focusOffset&&t.anchorNode===t.focusNode&&(e.args.output=e.corrupt(e.type))}),e.args.bindTo("input",function(t){e.type="",e.corruptors=[]}),e}return e=u,(r=[{key:"age",value:function(){return this.init-Date.now()}},{key:"lastFrame",value:function(){return this.last-Date.now()}},{key:"corrupt",value:function(t){if(1.15*t.length<this.args.input.length)return this.type;var e=t.split(""),r=function(t){return parseInt(Math.random()*t)};for(var n in r(1024)<256&&this.maxCorrupt<this.maxMaxCorrupt&&(this.maxCorrupt+=5),e)if(this.corruptors[n]=this.corruptors[n]||[],!e[n].match(/\W/)){var i=[this.charDown,this.charMid],o=i[r(i.length)];r(8192)<1&&this.corruptors[n].unshift(o[r(o.length)]),this.corruptors[n].length<this.maxCorrupt&&this.corruptors[n].unshift(o[r(o.length)]),r(2048)<1&&this.maxCorrupt>25&&this.corruptors[n].splice(5*r(5)),this.corruptors[n].push(this.corruptors[n].shift())}for(var a in e)this.corruptors[a]&&(e[a]+=this.corruptors[a].join(""));return e.join("")}},{key:"typewriter",value:function(t){return this.type=this.type||"",this.type===t||(this.type+=t.substr(this.type.length,1),this.onTimeout(150,function(){var t=window.scrollY+window.innerHeight;document.body.scrollHeight>t&&window.scrollTo({top:document.body.scrollHeight,left:0,behavior:"smooth"})}),!1)}}])&&i(e.prototype,r),s&&i(e,s),u}();e.MeltingText=c}()}),require.register("BackdropPalette.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackdropPalette=void 0;var n=e("backdrop/MarbleGarden"),i=e("backdrop/ProtoLabrynth"),o=e("backdrop/Industrial"),a=e("backdrop/MysticCave"),s=e("backdrop/WestSideCloudy"),c=e("backdrop/WestSide"),u=e("backdrop/Wood"),l=e("backdrop/Underground"),f=e("backdrop/Moon"),h=e("backdrop/SouthRidge"),p={"west-side-cloudy":s.WestSideCloudy,"west-side":c.WestSide,wood:u.Wood,moon:f.Moon,"south-ridge":h.SouthRidge,"proto-labrynth":i.ProtoLabrynth,"marble-garden":n.MarbleGarden,industrial:o.Industrial,"mystic-cave":a.MysticCave,underground:l.Underground};t.BackdropPalette=p}),require.register("Classifier.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Classifier=void 0;var i=e("curvature/base/Mixin"),o=e("curvature/mixin/EventTargetMixin");function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||c(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=c(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function c(t,e){if(t){if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(u,i.Mixin["with"](o.EventTargetMixin));var e,r,n,c=h(u);function u(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t,e){return e instanceof t};for(var n in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=c.call(this)).compare=r,e.index=new Map,t)e.index.set(t[n],new Set);return e}return e=u,(r=[{key:"add",value:function(t){var e=new CustomEvent("adding",{detail:{object:t}});if(this.dispatchEvent(e)){var r,n=new Set,i=s(this.index.entries());try{for(i.s();!(r=i.n()).done;){var o=a(r.value,2),c=o[0],u=o[1];this.compare(c,t)&&(n.add(c),u.add(t))}}catch(t){i.e(t)}finally{i.f()}var l=new CustomEvent("added",{detail:{object:t,indexes:n}});this.dispatchEvent(l)}}},{key:"remove",value:function(t){var e=new CustomEvent("removing",{detail:{object:t}});if(this.dispatchEvent(e)){var r,n=new Set,i=s(this.index.entries());try{for(i.s();!(r=i.n()).done;){var o=a(r.value,2),c=o[0],u=o[1];this.compare(c,t)&&(n.add(c),u.delete(t))}}catch(t){i.e(t)}finally{i.f()}var l=new CustomEvent("added",{detail:{object:t,indexes:n}});this.dispatchEvent(l)}}},{key:"clear",value:function(){this.index.clear()}},{key:"get",value:function(t){return this.index.get(t)}},{key:"count",value:function(t){return this.index.has(t)&&this.get(t).size}},{key:"has",value:function(t){return!!this.count(t)}}])&&l(e.prototype,r),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.Classifier=g}),require.register("Menu/CharacterPreview.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterPreview=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.View);var e,r,n,u=s(f);function f(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),l(c(r=u.call(this,t,e)),"preserve",!0),l(c(r),"template",'<div class = "character-preview" data-character = "[[setting]]">\n\t<div class = "character"></div>\n\t<div class = "emeralds" cv-each = "emeralds:emerald">[[emerald]]</div>\n\t<div class = "rings"></div>\n\t<div class = "score"></div>\n</div>'),r.args.emeralds=[i.View.from('<img style = "--x:[[x]];--y:[[y]];" src = "/Sonic/emerald-super-red-alt-mini.png" />'),i.View.from('<img style = "--x:[[x]];--y:[[y]];" src = "/Sonic/emerald-super-purple-mini.png" />'),i.View.from('<img style = "--x:[[x]];--y:[[y]];" src = "/Sonic/emerald-super-pink-mini.png" />'),i.View.from('<img style = "--x:[[x]];--y:[[y]];" src = "/Sonic/emerald-super-yellow-mini.png" />'),i.View.from('<img style = "--x:[[x]];--y:[[y]];" src = "/Sonic/emerald-super-cyan-mini.png" />'),i.View.from('<img style = "--x:[[x]];--y:[[y]];" src = "/Sonic/emerald-super-green-mini.png" />'),i.View.from('<img style = "--x:[[x]];--y:[[y]];" src = "/Sonic/emerald-super-white-mini.png" />')],r.onFrame(function(){var t=0;r.args.emeralds.forEach(function(e){var r=Date.now()/300,n=t++*(2*Math.PI)/7+r;e.args.x=Math.cos(n),e.args.y=Math.sin(n)})}),r}return e=f,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.CharacterPreview=f}),require.register("Menu/MainMenu.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MainMenu=void 0;var i=e("../audio/Bgm"),o=(e("../intro/Card"),e("../effects/Cylinder"),e("../effects/Pinch")),a=(e("../effects/Droop"),e("../effects/Twist")),s=e("./Menu"),c=(e("./SavestateMenu"),e("./SettingsMenu")),u=(e("../tileMap/TileMap"),e("../ui/CharacterString")),l=e("./CharacterPreview");function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=y(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=y(t);if(e){var o=y(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return d(t)}(this,r)}}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}(m,s.Menu);var r,n,b,v=g(m);function m(t,r){var n,i,o,a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,m),n=v.call(this,t,r),i=d(n),o="template",a=e("./main-menu.html"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n.args.cardName="main-menu",n.args.haveToken=!1,n.args.joinGame=!1,n.args.hostGame=!1,n.args.copy="copy",n.font="small-menu-font",n.args.title=new u.CharacterString({value:"Sonic 3000",font:n.font}),n.args.ok=new u.CharacterString({value:" ok",font:n.font}),n.args.back=new u.CharacterString({value:" back",font:n.font}),n.args.select=new u.CharacterString({value:" select",font:n.font}),n.refreshConnection();var s={input:"select",options:["Sonic","Tails","Knuckles","Robotnik","EggRobo","Mecha-Sonic","Seymour","Chalmers","Sean"],locked:["Robotnik","EggRobo","Mecha-Sonic","Seymour","Chalmers","Sean"],default:"Sonic",set:function(t){return n.parent.args.selectedChar=t},get:function(){var t;return null!==(t=n.parent.args.selectedChar)&&void 0!==t?t:"Sonic"}};return s.prefix=new l.CharacterPreview(s),n.items=n.args.items={"Single Player":{available:"available",children:{Character:s,"Sonic Control Tutorial":{subtext:"Learn the controls for Sonic",characters:["Sonic"],callback:function(){n.parent.loadMap({mapUrl:"/map/sonic-movement.json"}),n.accept()}},"Tails Control Tutorial":{subtext:"Learn the controls for Tails",characters:["Tails"],callback:function(){n.parent.loadMap({mapUrl:"/map/tails-movement.json"}),n.accept()}},"Knuckles Control Tutorial":{subtext:"Learn the controls for Knuckles",characters:["Knuckles"],callback:function(){n.parent.loadMap({mapUrl:"/map/knuckles-movement.json"}),n.accept()}},"Radical City Zone":{subtext:"Gotta go fast!",characters:["Sonic","Tails","Knuckles","Robotnik"],children:{"Act 1":{callback:function(){n.parent.loadMap({mapUrl:"/map/empty-zone.json"}),n.accept()}},"Act 2":{subtext:"Incomplete!!!",callback:function(){n.parent.loadMap({mapUrl:"/map/empty-zone-2.json"}),n.accept()}}}},"Seaview Park Zone":{characters:["Sonic","Tails","Knuckles","Robotnik"],callback:function(){n.parent.loadMap({mapUrl:"/map/west-side-zone.json"}),n.accept()}},"Misty Ruins Test Zone":{characters:["Sonic","Tails","Knuckles","Robotnik"],subtext:"Testing art, layout and physics for Misty Ruins Zone",callback:function(){n.parent.loadMap({mapUrl:"/map/ruins-test.json"}),n.accept()}},"Underground Test":{characters:["Sonic","Tails","Knuckles","Robotnik"],subtext:"Testing art, layout and physics for Underground Zone",callback:function(){n.parent.loadMap({mapUrl:"/map/underground-test.json"}),n.accept()}},"Terrain Test":{characters:["Sonic","Tails","Knuckles","Robotnik"],subtext:"Testing different terrain types",callback:function(){n.parent.loadMap({mapUrl:"/map/bendy-bridges.json"}),n.accept()}},"Moon Test":{characters:["Sonic","Tails","Knuckles","Robotnik"],callback:function(){n.parent.loadMap({mapUrl:"/map/moon-test.json"}),n.accept()}},"Space Pinball Test":{characters:["Sonic","Tails","Knuckles","Robotnik"],callback:function(){n.parent.loadMap({mapUrl:"/map/pinball-test.json"}),n.accept()}},"Belt and Wheel Test":{characters:["Sonic","Tails","Knuckles","Robotnik"],callback:function(){n.parent.loadMap({mapUrl:"/map/belt-test.json"}),n.accept()}},"See-Saw Test":{characters:["Sonic","Tails","Knuckles","Robotnik"],callback:function(){n.parent.loadMap({mapUrl:"/map/see-saw-test.json"}),n.accept()}},"Vehicle Test":{characters:["Sonic","Tails","Knuckles","Robotnik"],callback:function(){n.parent.loadMap({mapUrl:"/map/vehicle-test.json"}),n.accept()}},"Spotlight Test":{characters:["Sonic","Tails","Knuckles","Robotnik"],callback:function(){n.parent.loadMap({mapUrl:"/map/visor-test.json"}),n.accept()}},"Flickie Test":{characters:["Sonic","Tails","Knuckles","Robotnik"],callback:function(){n.parent.loadMap({mapUrl:"/map/flickie-test.json"}),n.accept()}},"Light Dash Test":{characters:["Sonic"],callback:function(){n.parent.loadMap({mapUrl:"/map/light-dash-test.json"}),n.accept()}},"Block Test":{characters:["Sonic","Tails","Knuckles","Robotnik"],callback:function(){n.parent.loadMap({mapUrl:"/map/block-test.json"}),n.accept()}},"Half Pipe Test":{characters:["Sonic","Tails","Knuckles","Robotnik"],callback:function(){n.parent.loadMap({mapUrl:"/map/half-pipe-test.json"}),n.accept()}},"Water Test":{characters:["Sonic","Tails","Knuckles","Robotnik"],callback:function(){n.parent.loadMap({mapUrl:"/map/water-test.json"}),n.accept()}},"Arch Test":{characters:["Sonic","Tails","Knuckles","Robotnik"],callback:function(){n.parent.loadMap({mapUrl:"/map/arc-test.json"}),n.accept()}}}},"2 Player P2P":{children:{"Host a game":{callback:function(){n.args.hostOutput="",n.args.hostGame=!0,n.args.copy="copy"}},"Join a game":{callback:function(){n.args.joinOutput="",n.args.joinGame=!0,n.args.copy="copy",n.client.offer().then(function(t){var e=JSON.stringify(t),r="s3ktp://request/".concat(btoa(e));n.args.joinOutput=r,n.args.haveToken=!0})}}}},"Connect To Server":{available:"unavailable"},Settings:(0,c.SettingsMenu)(r),About:{callback:function(){window.open("/about.html")}},Back:{callback:function(){return r.quit(!0)}}},n}return r=m,(n=[{key:"clear",value:function(){this.args.input="",this.args.joinOutput="",this.args.hostOutput=""}},{key:"input",value:function(t){if(h(y(m.prototype),"input",this).call(this,t),this.args.pinch){var e=t.axes[2]?t.axes[2].magnitude:0,r=t.axes[3]?t.axes[3].magnitude:0,n=0;t.buttons[6]&&(n=.25+t.buttons[6].pressure-t.buttons[7].pressure),this.args.pinch.args.scale=256*n,this.args.pinch.args.dx=103.552*e,this.args.pinch.args.dy=64*r}}},{key:"disconnect",value:function(){this.clear(),this.args.hostGame?this.server.close():this.args.joinGame&&this.client.close(),this.args.connected=!1,this.args.hostGame=!1,this.args.joinGame=!1,this.refreshConnection()}},{key:"onRendered",value:function(){i.Bgm.play("MENU_THEME",!0),h(y(m.prototype),"onRendered",this).call(this,event),this.args.pinch=new a.Twist({id:"menu-twist",scale:64,width:Math.floor(103.552),height:64}),this.args.pinch=new o.Pinch({id:"menu-pinch",scale:64,width:Math.floor(103.552),height:64})}},{key:"back",value:function(){h(y(m.prototype),"back",this).call(this),this.disconnect()}},{key:"focus",value:function(t){h(y(m.prototype),"focus",this).call(this,t),t.scrollIntoView({behavior:"smooth",block:"center"})}},{key:"answer",value:function(){var t=this,e=this.args.input,r=/^s3ktp:\/\/request\/(.+)/.exec(e);r&&(e=atob(r[1]));var n=JSON.parse(e),i=this.server.answer(n);return i.then(function(e){var r=JSON.stringify(e),n="s3ktp://accept/".concat(btoa(r));t.args.hostOutput=n,t.args.haveToken=!0}),i}},{key:"acceptRtp",value:function(){var t=this.args.input,e=/^s3ktp:\/\/accept\/(.+)/.exec(t);e&&(t=atob(e[1]));var r=JSON.parse(t);this.client.accept(r)}},{key:"select",value:function(){this.args.hostGame?this.tags.hostOutput.select():this.args.joinGame&&this.tags.joinOutput.select()}},{key:"copy",value:function(){if(this.args.hostGame){if(!this.args.input)return;this.tags.hostOutput.select()}else if(this.args.joinGame){if(!this.args.joinOutput)return;this.tags.joinOutput.select()}document.execCommand("copy"),this.args.copy="copied!"}},{key:"paste",value:function(t){var e=this;navigator.clipboard.readText().then(function(t){e.args.hostGame&&t.match(/^s3ktp:\/\/request\//)&&(e.args.input=t,e.answer().then(function(t){e.copy()})),e.args.joinGame&&t.match(/^s3ktp:\/\/accept\//)&&(e.args.input=t,e.acceptRtp())})}},{key:"refreshConnection",value:function(){var t=this;this.server=this.parent.getServer(!0),this.client=this.parent.getClient(!0);var e=this.server,r=this.client,n=function(e){t.parent.loadMap({mapUrl:"/map/empty-zone-2.json",networked:!0}).then(function(){return console.log("Peer connection opened!")})},i=function(e){return t.disconnect()};this.listen(e,"open",n),this.listen(e,"close",i),this.listen(r,"open",n),this.listen(r,"close",i)}},{key:"play",value:function(){var t=this;h(y(m.prototype),"play",this).call(this);var e=this.done;return e.then(function(){return t.onTimeout(250,function(){return t.remove()})}),e}}])&&f(r.prototype,n),b&&f(r,b),Object.defineProperty(r,"prototype",{writable:!1}),m}();t.MainMenu=b}),require.register("Menu/Menu.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Menu=void 0;var i=e("../intro/Card"),o=(e("../effects/Cylinder"),e("../effects/Pinch"),e("../ui/CharacterString")),a=e("../audio/Sfx");function s(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}(this,r)}}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(g,i.Card);var r,n,c,p=f(g);function g(t,r){var n,i,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),n=p.call(this,t,r),i=h(n),o="template",a=e("./main-menu.html"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n.font="small-menu-font",n.args.cardName="menu",n.args.items={},n.currentItem=null,n.include="a, button, input, textarea, select, details, [tabindex]",n.exclude='[tabindex="-1"]',n.onRemove(function(){return r.focus()}),n}return r=g,(n=[{key:"onRendered",value:function(t){var e=this;this.args.bindTo("items",function(t){for(var r in t){var n=t[r];n._title=new o.CharacterString({value:r,font:e.font}),n._value=new o.CharacterString({value:"",font:e.font}),n.get&&(n.setting=n.get()),"boolean"===n.input?(n._value.args.value=n.setting?"ON":"OFF",n._boolValue=n._value):"select"===n.input&&(n._selectValue=n._value)}}),this.args.bindTo("items",function(t){if(t&&Object.keys(t).length){e.args.items&&(e.currentItem=null);var r=e.findNext(e.currentItem,e.tags.bound.node);r&&e.focus(r)}},{wait:10}),this.focusFirst()}},{key:"focusFirst",value:function(){if(this.tags.bound){var t=this.findNext(null,this.tags.bound);t&&this.focus(t)}}},{key:"findNext",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.querySelectorAll(this.include);if(n.length){var i,o=!1,a=null,c=null,u=s(n);try{for(u.s();!(i=u.n()).done;){var l=i.value;if(!l.matches(this.exclude)){if(!a){if(!t&&!r)return l;a=l}if(!r&&o)return l;if(l===t){if(r&&c)return c;o=!0}c=l}}}catch(t){u.e(t)}finally{u.f()}return r?c:this.findNext(void 0,e,r)}}},{key:"focus",value:function(t){var e=this;this.currentItem&&this.currentItem!==t&&this.blur(this.currentItem),t&&(t.classList.add("focused"),t.focus(),t.addEventListener("blur",function(){return e.blur(t)},{once:!0})),this.currentItem=t}},{key:"blur",value:function(t){t.classList.remove("focused"),t.blur()}},{key:"input",value:function(t){if(this.zeroMe=t,this.tags.bound){var e,r=function(e){return t.buttons[e]&&(1===t.buttons[e].time||t.buttons[e].time>=140&&t.buttons[e].time%5==1||t.buttons[e].time>30&&t.buttons[e].time<140&&t.buttons[e].time%15==1)};r(12)?(e=this.findNext(this.currentItem,this.tags.bound.node,!0),this.beep()):r(13)?(e=this.findNext(this.currentItem,this.tags.bound.node),this.focus(e),this.beep()):r(14)?(this.currentItem&&this.contract(this.currentItem),this.beep()):r(15)&&(this.currentItem&&this.expand(this.currentItem),this.beep()),t.buttons[0]&&1===t.buttons[0].time?(this.currentItem&&this.currentItem.click(),this.args.last="A",this.beep()):t.buttons[1]&&1===t.buttons[1].time&&(this.back(),this.args.last="B",this.beep()),e&&this.focus(e)}}},{key:"beep",value:function(){this.parent.args.audio&&a.Sfx.play("SWITCH_HIT")}},{key:"run",value:function(t,e){var r=this;if(this.zeroMe&&this.zeroMe.zero(),"unavailable"!==t.available){if(t.input&&this.focus(t.input),t.children){var n=this.args.items,i={_title:new o.CharacterString({value:"back",font:"small-menu-font"}),callback:function(){r.args.items=n,r.args.currentKey=n._title?n._title.args.value:"",r.onNextFrame(function(){return r.focusFirst()})}};this.args.items=t.children,this.args.currentKey=t._title.args.value,this.args.items.back=this.args.items.back||i,this.onNextFrame(function(){return r.focusFirst()})}t.callback&&t.callback()}}},{key:"back",value:function(){this.args.items.back&&this.args.items.back.callback()}},{key:"expand",value:function(t){var e=t.querySelector("input"),r=t.getAttribute("data-title"),n=this.args.items[r];n&&("number"===n.input?(n.setting=Number(n.setting)+1,n.setting>n.max&&(n.setting=n.max),n.set&&n.set(n.setting)):"boolean"===n.input?(n.setting=!n.setting,n._value.args.value=n.setting?"ON":"OFF",n.set&&n.set(n.setting)):n&&"select"===n.input?this.cycleSelect(n,r,1):e&&e.focus())}},{key:"contract",value:function(t){var e=t.getAttribute("data-title"),r=this.args.items[e];"number"===r.input?(r.setting=Number(r.setting)-1,r.setting<r.min&&(r.setting=r.min),r.set&&r.set(r.setting)):"boolean"===r.input?(r.setting=!r.setting,r._value.args.value=r.setting?"ON":"OFF",r.set&&r.set(r.setting)):r&&"select"===r.input?this.cycleSelect(r,e,-1):this.focus(t)}},{key:"keyup",value:function(t,e){if(("ArrowUp"===t.key||"ArrowDown"===t.key)&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),"INPUT"===t.currentTarget.tagName)){var r=this.findNext(this.currentItem,this.tags.bound.node,"ArrowUp"===t.key);if(r)return void this.focus(r)}}},{key:"change",value:function(t,e){var r=this.args.items[e];r&&(r.setting=t.target.value,this.selectListChanged(r,e),r.set(r.setting))}},{key:"toggle",value:function(t,e,r,n,i){t.preventDefault(),e.setting=!e.setting,e._value.args.value=e.setting?"ON":"OFF",e.set&&e.set(e.setting)}},{key:"cycleSelect",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=!1,i=void 0,o=void 0,a=[];if(Object.assign(a,t.options),-1===r)a.reverse();else if(1!==r)return;for(var s=0,c=a;s<c.length;s++){var u,l=c[s];if(i=null!==(u=i)&&void 0!==u?u:l,l!==t.setting){if(n){t.setting=l,o=void 0;break}o=l}else n=!0}void 0!==o&&(t.setting=i),this.selectListChanged(t,e),t.set(t.setting)}},{key:"selectListRendered",value:function(t,e,r,n,i,o){if("select"===e.input){var a;e.setting=null!==(a=e.get?e.get():e.default)&&void 0!==a?a:void 0;var s=0;for(var c in e.options)e.options[c]===e.setting&&(s=c);void 0===e.setting&&e.options.length&&(s=0,e.setting=e.options[0]);var u=i.findTag("select");i.findTag("option");u.selectedIndex=s,e._value.args.value=e.setting,this.selectListChanged(e,r,!0)}else"boolean"===e.input&&e.element&&(e.element.selectedIndex=e.setting?0:1,e._value.args.value=e.setting?"ON":"OFF")}},{key:"selectListChanged",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("boolean"===t.input?(t._value.args.value=t.setting?"ON":"OFF",this.selectListChanged(t,e,!0)):"select"===t.input&&t._value&&(t.locked&&t.locked.includes(t.setting)?t._value.args.value="Locked":t._value.args.value=t.setting),"Character"===e)for(var n=0,i=Object.values(this.args.items);n<i.length;n++){var o,a,s=i[n];s._available=null!==(o=null!==(a=s._available)&&void 0!==a?a:s.available)&&void 0!==o?o:"available",s.characters&&!s.characters.includes(t.setting)?s.available="unavailable":s.available=s._available}this.parent.args.audio&&!r&&this.beep()}}])&&u(r.prototype,n),c&&u(r,c),Object.defineProperty(r,"prototype",{writable:!1}),g}();t.Menu=g}),require.register("Menu/PauseMenu.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PauseMenu=void 0;e("../intro/Card"),e("../effects/Cylinder"),e("../effects/Pinch");var i=e("./Menu"),o=e("./SettingsMenu"),a=(e("./SaveMenu"),e("../ui/CharacterString"));function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return f(t)}(this,r)}}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(d,i.Menu);var r,n,p,g=l(d);function d(t,r){var n,i,s,c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),n=g.call(this,t,r),i=f(n),s="template",c=e("./pause-menu.html"),s in i?Object.defineProperty(i,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):i[s]=c,n.args.cardName="pause-menu",n.args.animation="",n.args.title=new a.CharacterString({value:"Sonic 3000",font:"small-menu-font"}),n.items=n.args.items={Continue:{callback:function(){return r.unpauseGame()}},Reset:{children:{"Last Checkpoint":{subtext:"Restart and record your run.",callback:function(){r.unpauseGame(),r.reset(),r.startLevel()}},"Level Start":{subtext:"Restart and record your run.",callback:function(){r.clearCheckpoints(),r.unpauseGame(),r.reset(),r.startLevel()}}}},Demos:{children:{record:{callback:function(){return n.parent.record()},subtext:"Restart and record your run."},stop:{callback:function(){return n.parent.stop()},subtext:"Replay your run."},replay:{callback:function(){return n.parent.playback()},subtext:"Replay your run."}}},Settings:(0,o.SettingsMenu)(r),Quit:{children:{No:{callback:function(){return n.args.items.back.callback()}},Yes:{callback:function(){n.args.items.back.callback(),r.unpauseGame(),r.quit()}}}}},n}return r=d,(n=[{key:"run",value:function(t,e){t.stopPropagation(),t.stopImmediatePropagation(),c(h(d.prototype),"run",this).call(this,e)}},{key:"input",value:function(t){if(t.buttons[1011]&&t.buttons[1011].active){var e=t.buttons[1011].time;(1===e||e>30&&e%15==1)&&(this.parent.focus(),this.parent.args.paused=1,this.args.hideMenu="pause-menu-hide")}this.args.hideMenu?t.buttons[9]&&t.buttons[9].active&&(this.args.hideMenu=""):c(h(d.prototype),"input",this).call(this,t),t.buttons[1012]&&t.buttons[1012].time>0?(this.parent.focus(),this.args.hideMenu="pause-menu-hide"):t.buttons[1012]&&t.buttons[1012].time<0&&(this.args.hideMenu="")}},{key:"reset",value:function(){this.args.items=this.items}}])&&s(r.prototype,n),p&&s(r,p),Object.defineProperty(r,"prototype",{writable:!1}),d}();t.PauseMenu=p}),require.register("Menu/SaveMenu.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SaveMenu=void 0;var n=e("../savestates/SavestateDatabase");t.SaveMenu=function(t){return{children:{Save:{callback:function(){if(t.controlActor){var e=t.controlActor,r={currentMap:t.currentMap,character:e.args.canonical,checkpoint:t.getCheckpoint(e.args.id)};console.log(r),n.SavestateDatabase.open("savestates",1).then(function(t){t.insert("savestates",r).then(function(e){console.log(e);var r={store:"savestates",index:"id"};t.select(r).each(function(t){return console.log(t)}).then(function(t){return console.log(t)})})})}}}}}}}),require.register("Menu/SavestateMenu.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SavestateMenu=void 0;var n=e("../savestates/SavestateDatabase");t.SavestateMenu=function(t){var e={};return n.SavestateDatabase.open("savestates",1).then(function(r){var n={store:"savestates",index:"id"};r.select(n).each(function(r){var n=r.id,i=r.character;e["".concat(n," ").concat(i)]={callback:function(){var e,n,o;console.log(r),t.setCheckpoint(r.currentMap,(e={},n=i,o=r.checkpoint,n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e)),t.loadMap({mapUrl:r.currentMap})}}}).then(function(t){return console.log(t)})}),{children:e}}}),require.register("Menu/SettingsMenu.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SettingsMenu=void 0;t.SettingsMenu=function(t){return{children:{Video:{children:{"Motion Blur Effects":{input:"boolean",subtext:"Enable/Disable motion blur effects",set:function(e){return t.settings.blur=e},get:function(){return t.settings.blur}},"Displacement Effects":{input:"boolean",subtext:"Enable/Disable displacement effects",set:function(e){return t.settings.displace=e},get:function(){return t.settings.displace}},"Outline Thickness":{input:"number",subtext:"Change the outline thickness",set:function(e){return t.settings.outline=e},get:function(){return t.settings.outline},max:15,min:0},"Display HUD":{input:"boolean",subtext:"Enable/Disable the HUD",set:function(e){return t.settings.showHud=e},get:function(){return t.settings.showHud}},"Debug OSD":{input:"boolean",subtext:"Enable/Disable debug OSD",set:function(e){return t.settings.debugOsd=e},get:function(){return t.settings.debugOsd}},"FPS Meter":{input:"boolean",subtext:"Enable/Disable the FPS meter",set:function(e){return t.settings.showFps=e},get:function(){return t.settings.showFps}},"Mute/Fullscreen":{input:"boolean",subtext:"Show the mute & fullscreen controls in the bottom right.",set:function(e){return t.settings.shortcuts=e},get:function(){return t.settings.shortcuts}}}},Input:{children:{"Button Select Test":{input:"select",options:["","","","","","","","","","","","","","","","","","","","","","","","","","",""],set:function(e){return t.settings.buttonTest=e},get:function(){return t.settings.buttonTest}},Rumble:{input:"boolean",subtext:"Enable/Disable controller vibration",set:function(e){return t.settings.rumble=e},get:function(){return t.settings.rumble}}}},Network:{children:{Username:{input:"string",subtext:"Name to display in online games",set:function(e){return t.settings.username=e},get:function(){return t.settings.username},max:15,min:0},"Subspace Hub Servers":{},"ICE Servers":{children:{"ICE Server #1":{input:"string",subtext:"ICE candidate server.",available:"unavailable"},"ICE Server #2":{input:"string",subtext:"ICE candidate server.",available:"unavailable"},"ICE Server #3":{input:"string",subtext:"ICE candidate server.",available:"unavailable"},"ICE Server #4":{input:"string",subtext:"ICE candidate server.",available:"unavailable"}}}}},Audio:{children:{"Music Volume":{input:"number",subtext:"Background music volume - 0% - 100%",set:function(e){return t.settings.musicVol=e},get:function(){return t.settings.musicVol},max:100,min:0},SFX:{input:"number",subtext:"Sound effect music volume - 0% - 100%",set:function(e){return t.settings.sfxVol=e},get:function(){return t.settings.sfxVol},max:100,min:0},"Mono / Stereo":{available:"unavailable"}}}}}}}),require.register("Menu/main-menu.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]]">\n\n\t<div class = "menu-scroller"></div>\n\n\t[[pinch]]\n\t[[twist]]\n\n\t<section class = "buttons">\n\t\t<span>[[select]]</span>\n\t\t<span>[[ok]]</span>\n\t\t<span>[[back]]</span>\n\t</section>\n\n\t<section class = "contents" cv-if = "!connected">\n\t\t<div class = "menu-container" data-current-menu = "[[currentKey]]">\n\n\t\t\t<div>\n\t\t\t\t[[title]]\n\t\t\t</div>\n\n\t\t\t<div>\n\n\t\t\t\t<ul cv-ref = "bound" cv-each = "items:item:title">\n\n\t\t\t\t\t<li data-title = "[[title]]" class = "[[item.available]]" cv-on = "click:run(item, event); keyup(event, item):c" tabindex="0">\n\t\t\t\t\t\t[[item.prefix]]\n\t\t\t\t\t\t<span class = "title">[[item._title]]</span>\n\t\t\t\t\t\t<span class = "subtext">[[item.subtext]]</span>\n\t\t\t\t\t\t<span cv-if = "item.input" cv-is = "string" class = "field">\n\t\t\t\t\t\t\t: <span data-wraps = "string"><input cv-ref = "string" cv-bind = "item.setting" cv-on = "keyup(event);input:change(event, title)" tabindex="-1" /></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span cv-if = "item.input" cv-is = "number" class = "field">\n\t\t\t\t\t\t\t: <span data-wraps = "number"><input cv-ref = "number" cv-bind = "item.setting" type = "number" cv-on = "keyup(event);change(event, title)" tabindex="-1" max = "[[item.max]]" min = "[[item.min]]" /></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span cv-if = "item.input" cv-is = "boolean" class = "field">\n\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t<span data-wraps = "select">\n\t\t\t\t\t\t\t\t[[item._boolValue]]\n\t\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\t\tcv-on    = "cvDomAttached:selectListRendered(event, item, title, $view, $subview, $parent);mousedown:toggle(event, item, $view, $subview, $parent); input:change(event, title)" cv-ref = "boolean"\n\t\t\t\t\t\t\t\t\tcv-bind = "item.setting"\n\t\t\t\t\t\t\t\t\ttabindex="-1">\n\t\t\t\t\t\t\t\t<option value = "1">on</option>\n\t\t\t\t\t\t\t\t<option value = "0">off</option>\n\t\t\t\t\t\t\t</select></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span cv-if = "item.input" cv-is = "select" class = "field">\n\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t<span data-wraps = "select">\n\t\t\t\t\t\t\t\t[[item._selectValue]]\n\t\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\t\tcv-on    = "input:change(event, title); listRendered:selectListRendered(event, item, title, $view, $subview, $parent);"\n\t\t\t\t\t\t\t\t\tcv-ref   = "options"\n\t\t\t\t\t\t\t\t\tcv-bind  = "item.setting"\n\t\t\t\t\t\t\t\t\ttabindex = "-1"\n\t\t\t\t\t\t\t\t\tcv-each  = "item.options:option">\n\t\t\t\t\t\t\t\t\t<option value = "[[option]]">[[option]]</option>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t[[item.suffix]]\n\t\t\t\t\t</li>\n\n\n\t\t\t\t</ul>\n\n\t\t\t</div>\n\n\t\t</div>\n\t</section>\n\n\t<section class = "contents" cv-if = "!connected">\n\n\t\t<section class = "contents" cv-if = "hostGame">\n\t\t\t<div class = "token-exchange" data-have-token = "[[haveToken]]">\n\n\t\t\t\t<label>\n\t\t\t\t\t<p>Input the token from your friend here.</p>\n\t\t\t\t\t<textarea cv-bind = "input" cv-on = "click:paste(event)"></textarea>\n\t\t\t\t\t<button cv-on = "click:answer">go!</button>\n\t\t\t\t</label>\n\n\t\t\t\t<label>\n\t\t\t\t\t<p>Send this token to your friend to get started.</p>\n\t\t\t\t\t<textarea cv-on = "click:copy" cv-ref = "hostOutput" cv-bind = "hostOutput" readonly = "true"></textarea>\n\t\t\t\t\t<button cv-on = "click:copy">[[copy]]</button>\n\n\t\t\t\t\t<div class = "close" cv-on = "click:disconnect"></div>\n\t\t\t\t</label>\n\n\t\t\t</div>\n\t\t</section>\n\n\t\t<section class = "contents" cv-if = "joinGame">\n\t\t\t<div class = "token-exchange">\n\n\t\t\t\t<label cv-if = "haveToken">\n\t\t\t\t\t<p>Send this token to your friend to get started.</p>\n\t\t\t\t\t<textarea cv-on = "click:copy" cv-ref = "joinOutput" cv-bind = "joinOutput" readonly = "true"></textarea>\n\t\t\t\t\t<button cv-on = "click:copy">[[copy]]</button>\n\t\t\t\t</label>\n\n\t\t\t\t<label cv-if = "haveToken">\n\t\t\t\t\t<p>Input the token they send back here.</p>\n\t\t\t\t\t<textarea cv-bind = "input" cv-on = "click:paste(event)"></textarea>\n\t\t\t\t\t<button cv-on = "click:acceptRtp">go!</button>\n\t\t\t\t\t<div class = "close" cv-on = "click:disconnect"></div>\n\t\t\t\t</label>\n\n\t\t\t</div>\n\t\t</section>\n\n\t</section>\n</div>\n'}),require.register("Menu/menu.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]]">\n\n\t<div class = "menu-scroller"></div>\n\n\t[[warp]]\n\n\t<div class = "menu-container" data-current-menu = "[[currentKey]]">\n\t\t<ul cv-ref = "bound" cv-each = "items:item:title">\n\t\t\t<li data-title = "[[title]]" class = "[[item.available]]" cv-on = "click:run(item);" tabindex="0">\n\t\t\t\t<span class = "title">[[item._title]]</span>\n\t\t\t\t<span class = "subtext">[[item.subtext]]</span>\n\t\t\t\t<span cv-if = "item.input" cv-is = "string">\n\t\t\t\t\t: <span data-wraps = "string"><input cv-ref = "string" cv-bind = "item.setting" cv-on = "keyup(event);input:change(event)" tabindex="-1" /></span>\n\t\t\t\t</span>\n\t\t\t\t<span cv-if = "item.input" cv-is = "number">\n\t\t\t\t\t: <span data-wraps = "number"><input cv-ref = "number" cv-bind = "item.setting" type = "number" cv-on = "keyup(event);change(event)" tabindex="-1" max = "[[item.max]]" min = "[[item.min]]" /></span>\n\t\t\t\t</span>\n\t\t\t\t<span cv-if = "item.input" cv-is = "boolean">\n\t\t\t\t\t: <span data-wraps = "select"><select cv-on = "mousedown:toggle(event, item);change(event)" cv-ref = "boolean" cv-bind = "item.setting" tabindex="-1">\n\t\t\t\t\t\t<option value = "1">on</option>\n\t\t\t\t\t\t<option value = "0">off</option>\n\t\t\t\t\t</select></span>\n\t\t\t\t</span>\n\t\t\t\t<span cv-if = "item.input" cv-is = "select">\n\t\t\t\t\t: <span data-wraps = "select"><select cv-on = "change(event)" cv-ref = "select" cv-bind = "item.setting" tabindex="-1" cv-each = "options:option:o">\n\t\t\t\t\t\t<option value = "[[o]]">[[o]]</option>\n\t\t\t\t\t</select></span>\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n\n</div>\n'}),require.register("Menu/pause-menu.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]] [[hideMenu]]">\n\n\t<div class = "menu-scroller"></div>\n\n\t[[warp]]\n\n\t<section class = "contents" cv-if = "!connected">\n\n\t\t<div class = "menu-container" data-current-menu = "[[currentKey]]">\n\n\t\t\t<div>[[title]]</div>\n\n\t\t\t<ul cv-ref = "bound" cv-each = "items:item:title">\n\n\t\t\t\t<li data-title = "[[title]]" class = "[[item.available]]" cv-on = "click:run(event, item):c; keyup(event, item):c;" tabindex="0">\n\t\t\t\t\t[[item.prefix]]\n\t\t\t\t\t<span class = "title">[[item._title]]</span>\n\t\t\t\t\t<span class = "subtext">[[item.subtext]]</span>\n\t\t\t\t\t<span cv-if = "item.input" cv-is = "string">\n\t\t\t\t\t\t: <input cv-ref = "string" cv-bind = "item.setting" cv-on = "keyup(event);input:change(event)" tabindex="-1" />\n\t\t\t\t\t</span>\n\t\t\t\t\t<span cv-if = "item.input" cv-is = "number">\n\t\t\t\t\t\t: <input cv-ref = "number" cv-bind = "item.setting" type = "number" cv-on = "keyup(event);change(event)" tabindex="-1" max = "[[item.max]]" min = "[[item.min]]" />\n\t\t\t\t\t</span>\n\t\t\t\t\t<span cv-if = "item.input" cv-is = "boolean">\n\t\t\t\t\t\t: <select cv-on = "mousedown:toggle(event, item);change(event)" cv-ref = "boolean" cv-bind = "item.setting" tabindex="-1">\n\t\t\t\t\t\t\t<option value = "1">on</option>\n\t\t\t\t\t\t\t<option value = "0">off</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span cv-if = "item.input" cv-is = "select" class = "field">\n\t\t\t\t\t\t:\n\t\t\t\t\t\t<span data-wraps = "select">\n\t\t\t\t\t\t\t[[item._selectValue]]\n\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\tcv-on    = "input:change(event, title); listRendered:selectListRendered(event, item, title, $view, $subview, $parent);"\n\t\t\t\t\t\t\t\tcv-ref   = "options"\n\t\t\t\t\t\t\t\tcv-bind  = "item.setting"\n\t\t\t\t\t\t\t\ttabindex = "-1"\n\t\t\t\t\t\t\t\tcv-each  = "item.options:option">\n\t\t\t\t\t\t\t\t<option value = "[[option]]">[[option]]</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t[[item.suffix]]\n\t\t\t\t</li>\n\t\t</ul>\n\n\t\t</div>\n\n\t</section>\n\n</div>\n'}),require.register("ObjectPalette.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectPalette=void 0;e("./actor/PointActor");var n=e("./actor/LayerSwitch"),i=e("./region/Region"),o=e("./region/ShadeRegion"),a=(e("./region/BgShadeRegion"),e("./region/FgShadeRegion"),e("./region/WaterRegion")),s=e("./region/DarkRegion"),c=e("./region/LavaRegion"),u=e("./region/RollingRegion"),l=e("./region/GrindingRegion"),f=e("./region/ForceRegion"),h=e("./region/CorkscrewRegion"),p=e("./region/BossRegion"),g=e("./region/ExitRegion"),d=e("./region/ExplodingRegion"),y=e("./region/SwitchRegion"),b=e("./region/RainRegion"),v=e("./region/WaterfallRegion"),m=e("./actor/CompanionBlock"),w=e("./actor/QuestionBlock"),S=e("./actor/MarbleBlock"),O=e("./actor/BreakableBlock"),j=e("./actor/Stopper"),k=e("./actor/Zipline"),x=e("./actor/Block"),P=(e("./actor/Monitor"),e("./actor/monitor/WebMonitor")),_=e("./actor/monitor/RingMonitor"),M=e("./actor/monitor/SheildStarMonitor"),R=e("./actor/monitor/SheildNormalMonitor"),T=e("./actor/monitor/SheildFireMonitor"),A=e("./actor/monitor/SheildWaterMonitor"),E=e("./actor/monitor/SheildElectricMonitor"),C=e("./actor/Bumper"),B=e("./actor/Flipper"),D=e("./actor/SeeSaw"),I=e("./actor/Cinematic"),F=e("./actor/Flickie"),L=e("./actor/Bubbles"),N=e("./actor/Redz"),q=e("./actor/GuardBot"),W=e("./actor/CrabMeat"),U=e("./actor/BuzzBomber"),V=e("./actor/MechaFroggy"),H=e("./actor/DrainFly"),G=e("./actor/GohlaBall"),z=e("./actor/Voltorb"),Y=e("./actor/Explosion"),K=e("./actor/StarPost"),J=e("./actor/ArrowSign"),X=e("./actor/Emerald"),$=e("./actor/FakeEmerald"),Z=e("./actor/Window"),Q=e("./actor/Spring"),tt=(e("./actor/BrokenMonitor"),e("./actor/Ring")),et=e("./actor/Coin"),rt=e("./actor/WaterFall"),nt=e("./actor/WaterJet"),it=e("./actor/PowerupGlow"),ot=e("./actor/Projectile"),at=e("./actor/TextActor"),st=e("./actor/EggMobile"),ct=e("./actor/SnowBoard"),ut=e("./actor/DrillCar"),lt=e("./actor/Tornado"),ft=e("./actor/RailCar"),ht=e("./actor/EggWalker"),pt=e("./actor/EggShuttle"),gt=e("./actor/NuclearSuperball"),dt=e("./actor/MechaSonic"),yt=e("./actor/Eggrobo"),bt=e("./actor/Eggman"),vt=e("./actor/Sonic"),mt=e("./actor/Tails"),wt=e("./actor/Knuckles"),St=e("./actor/Seymour"),Ot=e("./actor/Chalmers"),jt=e("./actor/Sean"),kt=e("./actor/Rocks"),xt=e("./actor/Switch"),Pt=e("./actor/HeavyDutySwitch"),_t=e("./actor/Balloon"),Mt=e("./actor/StarBalloon"),Rt=e("./actor/Spinner"),Tt=e("./actor/Springboard"),At=e("./actor/GrapplePoint"),Et=e("./actor/WoodenCrate"),Ct=e("./actor/SteelCrate"),Bt=e("./actor/ChaoCrate"),Dt=e("./actor/UnbreakableCrate"),It=e("./actor/Rocket"),Ft=e("./actor/WindStone"),Lt=e("./actor/RoadBarrier"),Nt=e("./actor/Spikes"),qt=e("./actor/SpikesSmall"),Wt=e("./actor/Cone"),Ut=e("./actor/Fountain"),Vt=e("./actor/CautionSign"),Ht=e("./actor/RollingSign"),Gt=e("./actor/Bell"),zt=e("./actor/Torch"),Yt=e("./actor/Signpost"),Kt=e("./actor/RedEyeJet"),Jt=e("./actor/MiniMace"),Xt=e("./actor/MegaMace"),$t=e("./actor/Beelzebub"),Zt=e("./actor/MiniBoss"),Qt=e("./actor/Magnet"),te=e("./actor/Pulley"),ee=e("./actor/PulleySmall"),re=e("./actor/Orb"),ne=e("./actor/Egg"),ie=e("./actor/Chao"),oe=e("./actor/EggShellTop"),ae=e("./actor/EggShellBottom"),se=e("./actor/BackdropSwapper"),ce=e("./actor/LayerController"),ue=e("./actor/WaterController"),le=e("./actor/TilesetSwapper"),fe=e("./actor/CutScene"),he=e("./actor/HtmlFrame"),pe=e("./actor/Panel"),ge=e("./actor/Tester"),de=(e("./actor/Cursor"),e("./actor/Spawner")),ye={player:gt.NuclearSuperball,cinematic:I.Cinematic,spring:Q.Spring,"layer-switch":n.LayerSwitch,"layer-controller":ce.LayerController,"water-controller":ue.WaterController,"backdrop-swapper":se.BackdropSwapper,"tileset-swapper":le.TilesetSwapper,"star-post":K.StarPost,"arrow-sign":J.ArrowSign,projectile:ot.Projectile,block:x.Block,"q-block":w.QuestionBlock,"marble-block":S.MarbleBlock,"companion-block":m.CompanionBlock,"breakable-block":O.BreakableBlock,stopper:j.Stopper,zipline:k.Zipline,bumper:C.Bumper,flipper:B.Flipper,"see-saw":D.SeeSaw,"drill-car":ut.DrillCar,"rail-car":ft.RailCar,tornado:lt.Tornado,"egg-walker":ht.EggWalker,"snow-board":ct.SnowBoard,"egg-mobile":st.EggMobile,"egg-shuttle":pt.EggShuttle,"rocks-tall":kt.Rocks,"rocks-med":kt.Rocks,"rocks-short":kt.Rocks,"mecha-sonic":dt.MechaSonic,sonic:vt.Sonic,tails:mt.Tails,knuckles:wt.Knuckles,eggman:bt.Eggman,robotnik:bt.Eggman,eggrobo:yt.Eggrobo,seymour:St.Seymour,chalmers:Ot.Chalmers,sean:jt.Sean,switch:xt.Switch,"heavy-duty-switch":Pt.HeavyDutySwitch,window:Z.Window,emerald:X.Emerald,"fake-emerald":$.FakeEmerald,"base-region":i.Region,region:a.WaterRegion,"lava-region":c.LavaRegion,"dark-region":s.DarkRegion,"shade-region":o.ShadeRegion,"force-region":f.ForceRegion,"corkscrew-region":h.CorkscrewRegion,"rolling-region":u.RollingRegion,"grinding-region":l.GrindingRegion,"exploding-region":d.ExplodingRegion,"boss-region":p.BossRegion,"exit-region":g.ExitRegion,"switch-region":y.SwitchRegion,"rain-region":b.RainRegion,"waterfall-region":v.WaterfallRegion,ring:tt.Ring,coin:et.Coin,"powerup-glow":it.PowerupGlow,explosion:Y.Explosion,"text-actor":at.TextActor,"water-jet":nt.WaterJet,"water-fall":rt.WaterFall,balloon:_t.Balloon,"star-balloon":Mt.StarBalloon,"web-monitor":P.WebMonitor,"ring-monitor":_.RingMonitor,"sheild-fire-monitor":T.SheildFireMonitor,"sheild-normal-monitor":R.SheildNormalMonitor,"sheild-star-monitor":M.SheildStarMonitor,"sheild-water-monitor":A.SheildWaterMonitor,"sheild-electric-monitor":E.SheildElectricMonitor,flickie:F.Flickie,crabmeat:W.CrabMeat,redz:N.Redz,"guard-bot":q.GuardBot,"mecha-froggy":V.MechaFroggy,"buzz-bomber":U.BuzzBomber,bubbles:L.Bubbles,drainfly:H.DrainFly,"gohla-ball":G.GohlaBall,voltorb:z.Voltorb,"grapple-point":At.GrapplePoint,rocket:It.Rocket,spinner:Rt.Spinner,springboard:Tt.Springboard,"wooden-crate":Et.WoodenCrate,"steel-crate":Ct.SteelCrate,"chao-crate":Bt.ChaoCrate,"unbreakable-crate":Dt.UnbreakableCrate,"road-barrier":Lt.RoadBarrier,signpost:Yt.Signpost,"red-eye-jet":Kt.RedEyeJet,beelzebub:$t.Beelzebub,"mini-boss":Zt.MiniBoss,"mini-mace":Jt.MiniMace,"mega-mace":Xt.MegaMace,magnet:Qt.Magnet,pulley:te.Pulley,"pulley-small":ee.PulleySmall,spikes:Nt.Spikes,"spikes-small":qt.SpikesSmall,cone:Wt.Cone,"wind-stone":Ft.WindStone,fountain:Ut.Fountain,"caution-sign":Vt.CautionSign,"rolling-sign":Ht.RollingSign,bell:Gt.Bell,torch:zt.Torch,orb:re.Orb,chao:ie.Chao,egg:ne.Egg,"egg-shell-top":oe.EggShellTop,"egg-shell-bottom":ae.EggShellBottom,"cut-scene":fe.CutScene,"html-frame":he.HtmlFrame,panel:pe.Panel,tester:ge.Tester,spawner:de.Spawner};t.ObjectPalette=ye}),require.register("QuadCell.js",function(t,e,r){"use strict";function n(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,a=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Object.defineProperty(t,"__esModule",{value:!0}),t.QuadCell=void 0;var s=Symbol("CellRef"),c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),a(this,"position",{}),a(this,"size",{}),a(this,"divided",!1),a(this,"parent",null),a(this,"leafPoint",{x:null,y:null}),a(this,"leafRefs",null),a(this,"ld",null),a(this,"rd",null),a(this,"lu",null),a(this,"ru",null),a(this,"cells",[]),this.parent=n,this.position.x=e.x,this.position.y=e.y,this.size.x=r.x,this.size.y=r.y,Object.seal(this)}var e,r,i;return e=t,(r=[{key:"empty",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!this.divided)return!this.leafRefs||!this.leafRefs.size;for(var e in this.cells)if(!this.cells[e].empty(t+1))return!1;return!0}},{key:"insert",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0};if(!this.contains(e))return!1;if(!this.leafRefs&&!this.divided)return this.leafRefs=new Set,this.leafPoint.x=e.x,this.leafPoint.y=e.y,this.leafRefs.add(t),t[s]=this,!0;this.leafRefs&&e.x===this.leafPoint.x&&e.y===this.leafPoint.y?(this.leafRefs.add(t),t[s]=this):this.divided||this.divide();var r,i=n(this.cells);try{for(i.s();!(r=i.n()).done;){if(r.value.insert(t,e))return!0}}catch(t){i.e(t)}finally{i.f()}return!1}},{key:"move",value:function(t,e){var r=t[s];if(r){if(r.leafPoint.x===e.x&&r.leafPoint.y===e.y)return;t[s]=null,r.leafRefs.delete(t),r.parent&&r.parent.join()}this.insert(t,e)}},{key:"remove",value:function(t){var e=t[s];e&&(t[s]=null,e.leafRefs.delete(t),e.parent&&e.parent.join())}},{key:"join",value:function(){var t=this;if(!this.empty())return!1;var e,r=null,i=n(this.cells);try{for(i.s();!(e=i.n()).done;){var o=e.value;if(!o.empty()){if(r)return!1;r=o}}}catch(t){i.e(t)}finally{i.f()}this.ld=null,this.rd=null,this.lu=null,this.ru=null,this.cells=[],this.divided=!1,r&&r.leafRefs.forEach(function(e){return t.insert(e)}),this.parent&&this.parent.join()}},{key:"divide",value:function(){if(this.divided)return!1;var t=this.position,e=this.size;if(this.ld=new this.constructor({x:t.x-e.x/4,y:t.y-e.y/4},{x:e.x/2,y:e.y/2},this),this.rd=new this.constructor({x:t.x+e.x/4,y:t.y-e.y/4},{x:e.x/2,y:e.y/2},this),this.lu=new this.constructor({x:t.x-e.x/4,y:t.y+e.y/4},{x:e.x/2,y:e.y/2},this),this.ru=new this.constructor({x:t.x+e.x/4,y:t.y+e.y/4},{x:e.x/2,y:e.y/2},this),this.cells.push(this.ld,this.rd,this.lu,this.ru),this.divided=!0,!this.leafRefs.size)return!0;var r,i=n(this.leafRefs);try{t:for(i.s();!(r=i.n()).done;){var o,a=r.value,s=n(this.cells);try{for(s.s();!(o=s.n()).done;){if(o.value.insert(a,this.leafPoint)){this.leafRefs.delete(a);continue t}}}catch(t){s.e(t)}finally{s.f()}}}catch(t){i.e(t)}finally{i.f()}}},{key:"contains",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},e=this.position.x-this.size.x/2,r=this.position.x+this.size.x/2;if(t.x<e||t.x>r)return!1;var n=this.position.y-this.size.y/2,i=this.position.y+this.size.y/2;return!(t.y<n||t.y>i)}},{key:"select",value:function(t,e,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(this.empty())return[];if(r/2+this.size.x/2<Math.abs(t-this.position.x))return[];if(i/2+this.size.y/2<Math.abs(e-this.position.y))return[];if(this.divided){var a,s=new Set,c=n(this.cells);try{for(c.s();!(a=c.n()).done;){var u,l=n(a.value.select(t,e,r,i,o+1));try{for(l.s();!(u=l.n()).done;){var f=u.value;s.add(f)}}catch(t){l.e(t)}finally{l.f()}}}catch(t){c.e(t)}finally{c.f()}return s}return this.leafRefs?this.leafRefs:[]}}])&&o(e.prototype,r),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.QuadCell=c}),require.register("World.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.World=void 0;var n=e("curvature/base/Bag"),i=e("curvature/base/Bindable"),o=e("tileMap/TileMap");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var c=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,"tileMap",new o.TileMap),this.viewports=new n.Bag(function(t,r,n){switch(n){case BAG.ITEM_ADDED:t.world=e;break;case BAG.ITEM_REMOVED:t.world=null}}),this.actors=new n.Bag(function(t,r,n){switch(n){case BAG.ITEM_ADDED:t.world=e;break;case BAG.ITEM_REMOVED:t.world=null}})}var e,r,i;return e=t,(r=[{key:"getOnScreenObjects",value:function(t){}},{key:"update",value:function(){}}])&&a(e.prototype,r),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.World=c,s(c,"globals",i.Bindable.make({}))}),require.register("abilities/LightDash.js",function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.LightDash=void 0;var i=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)});t.LightDash=i}),require.register("actor/ArrowSign.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ArrowSign=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag");e("../actor/Projectile"),e("./Monitor"),e("./monitor/RingMonitor"),e("./monitor/SheildFireMonitor"),e("./monitor/SheildWaterMonitor"),e("./monitor/SheildElectricMonitor");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(h,i.PointActor);var e,r,n,f=c(h);function h(t,e){var r,n,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(i=f.call(this,t,e)).args.type="actor-item actor-arrow-sign",i.args.float=null!==(r=i.args.float)&&void 0!==r?r:-1,i.args.static=null===(n=i.args.static)||void 0===n||n,i.args.width=t.width||32,i.args.height=t.height||64,i}return e=h,n=[{key:"fromDef",value:function(t){var e=u(l(h),"fromDef",this).call(this,t);return e.args.rotation=t.rotation,e.args.height=t.height,e}}],(r=[{key:"onAttached",value:function(){var t=this;this.headBox||(this.sprite=this.findTag("div.sprite"),this.box=this.findTag("div"),this.headBox=new o.Tag('<div class = "arrow-sign-head-box">'),this.post=new o.Tag('<div class = "arrow-sign-post">'),this.head=new o.Tag('<div class = "arrow-sign-head">'),this.sprite.appendChild(this.post.node),this.headBox.appendChild(this.head.node),this.sprite.appendChild(this.headBox.node),this.args.bindTo(["point","height"],function(e,r){var n,i,o;t.headBox.style((o=e,(i="--"+r)in(n={})?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,n))}))}},{key:"solid",get:function(){return!1}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.ArrowSign=f}),require.register("actor/BackdropController.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BackdropController=void 0;var i=e("./PointActor");e("../BackdropPalette");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.hidden=!0,r}return e=u,(r=[{key:"activate",value:function(t,e){}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.BackdropController=u}),require.register("actor/BackdropSwapper.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BackdropSwapper=void 0;var i=e("./PointActor");e("../BackdropPalette");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.hidden=!0,r}return e=u,(r=[{key:"activate",value:function(t,e){}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.BackdropSwapper=u}),require.register("actor/Balloon.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Balloon=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.type="actor-item actor-balloon",t.args.width=32,t.args.height=33,t.args.float=-1,t.args.airAngle=-Math.PI,t}return e=u,(r=[{key:"collideA",value:function(t){t.controllable}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.Balloon=u}),require.register("actor/Beelzebub.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Beelzebub=void 0;var i=e("curvature/base/Tag"),o=e("./PointActor"),a=e("curvature/base/Mixin"),s=(e("../mixin/CanPop"),e("./CutScene")),c=e("../audio/Sfx");function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(d,a.Mixin.from(o.PointActor));var e,r,n,g=h(d);function d(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),(r=g.call(this,t,e)).args.type="actor-item actor-beelzebub",r.args.width=64,r.args.height=32,r.args.float=-1,r.args.damagers=new Map,r.args.phase="idle",r.args.hitPoints=8,r.args.noseAngle=Math.PI/2*3,r.args.drillPush=0,r.args.phaseFrameId=0,r.args.frameId=0,r.args.direction=-1,r.args.facing="left",r.args.bindTo("phase",function(t){return r.args.phaseFrameId=0}),r.clearScene=new s.CutScene({src:"/cutscenes/clear-seaview.json"}),r}return e=d,(r=[{key:"onAttached",value:function(){this.autoStyle.get(this.box)["--nose-angle"]="noseAngle",this.autoStyle.get(this.box)["--drill-push"]="drillPush",this.autoAttr.get(this.box)["data-phase"]="phase",this.drill=new i.Tag('<div class = "drill">'),this.body=new i.Tag('<div class = "body">'),this.nose=new i.Tag('<div class = "nose">'),this.eyeBack=new i.Tag('<div class = "eye-back">'),this.eyeFore=new i.Tag('<div class = "eye-fore">'),this.body.appendChild(this.eyeBack.node),this.body.appendChild(this.eyeFore.node),this.body.appendChild(this.nose.node),this.sprite.appendChild(this.body.node),this.nose.appendChild(this.drill.node),this.attractor=null,this.clearScene.viewport=this.viewport}},{key:"update",value:function(){if(this.args.phaseFrameId++,this.args.frameId++,this.viewport){var t=this.viewport;t.auras.add(this);var e=this.viewport.controlActor;if(e){this.attractor||(this.attractor={},this.attractor.x=this.x,this.attractor.y=this.y);var r=Math.abs(this.x-this.attractor.x),n=Math.abs(this.y-this.attractor.y),o=Math.sign(this.x-this.attractor.x),a=Math.sign(this.y-this.attractor.y);switch(this.args.phase){case"idle":this.args.xSpeed=0,this.args.ySpeed=0;break;case"intro":this.args.phaseFrameId>30&&(this.args.phase="stalking");break;case"alert":this.args.phaseFrameId>4&&(this.args.drillPush=1,this.args.falling=!0,this.args.float=-1,this.y>this.args.alertTo?this.args.ySpeed--:(this.args.y=this.args.alertTo,this.args.ySpeed=0)),this.args.phaseFrameId>0&&(this.args.phase="stalking");break;case"damaged":this.args.hitPoints>0?this.args.phaseFrameId>20&&(this.args.phase="stalking"):this.args.phaseFrameId>6&&(this.args.phase="dead");break;case"knocked":this.args.xSpeed=0,this.args.phaseFrameId>30&&(this.args.phase="stalking");break;case"dead":this.args.float=0;break;case"stalking":this.args.xSpeed=-o*Math.max(1,r/25),this.args.ySpeed=-a*Math.max(1,n/25),this.args.ySpeed+=3*Math.sin(this.args.frameId/3),this.pointIsSafe(e.x,e.y-128)&&(this.attractor.x=e.x,this.attractor.y=e.y-128),this.args.noseAngle=Math.PI/2*3,this.args.drillPush=0,this.args.phaseFrameId>10&&(this.args.noseAngle=this.angleTo({x:e.x,y:Math.max(this.y,e.y)})),this.args.phaseFrameId>20&&(this.args.drillPush=.5),this.args.phaseFrameId>25&&(this.args.phase="ready");break;case"buzzing":this.pointIsSafe(e.x,e.y+-e.args.height+-34)&&(this.attractor.x=e.x,this.attractor.y=e.y+-e.args.height+-34),this.args.xSpeed=-o*Math.max(1,r/15),this.args.ySpeed=-a*Math.max(1,n/15),this.args.noseAngle=Math.PI/2*3,this.args.drillPush=1,this.args.phaseFrameId>10&&(this.args.drillPush=.5),this.args.phaseFrameId>20&&(this.args.noseAngle=this.angleTo({x:e.x,y:Math.max(this.y,e.y)})),this.args.phaseFrameId>30&&(this.args.phase="ready");break;case"ready":if(this.args.phaseFrameId<10&&(this.readySide=Math.sign(e.xSpeedLast||e.gSpeedLast)),this.pointIsSafe(e.x+128*this.readySide,e.y+-e.args.height+-128)&&(this.attractor.x=e.x+128*this.readySide,this.attractor.y=e.y+-e.args.height+-128),this.args.xSpeed=-o*Math.max(1,r/15),this.args.ySpeed=-a*Math.max(1,n/15),this.args.ySpeed+=3*Math.sin(this.args.frameId/3),this.args.drillPush=.75,this.args.phaseFrameId>30){var s=Math.random();e.args.falling?this.args.phase=s>.5?"buzzing":"stalking":this.args.phase=s>.5?"swooping":"attacking"}break;case"attacking":this.args.float=-1,this.args.falling=!0,this.args.phaseFrameId>100&&(this.args.phase="stalking"),this.args.phaseFrameId<50?(this.pointIsSafe(e.x+256*(this.readySide||1),e.y-32)&&(this.attractor.x=e.x+256*(this.readySide||1),this.attractor.y=e.y-32),this.args.noseAngle=0):(this.pointIsSafe(e.x+256*(-this.readySide||-1),e.y-16)&&(this.attractor.x=e.x+256*(-this.readySide||-1),this.attractor.y=e.y-16),this.args.noseAngle=this.angleTo({x:e.x,y:Math.max(this.y,e.y)})),this.args.drillPush=1,this.args.float=-1;var u=e.args.xSpeed||e.args.gSpeed;this.args.xSpeed=-o*Math.max(1,r/10)+1.1*u,this.args.ySpeed=-a*Math.max(1,n/10);break;case"swooping":this.pointIsSafe(e.x,e.y-32)&&(this.attractor.x=e.x,this.attractor.y=e.y-32),this.args.xSpeed+=-o*Math.max(1,r/1e4),this.args.ySpeed+=-a*Math.max(1,n/1e4),this.args.noseAngle=this.angleTo({x:e.x,y:Math.max(this.y,e.y)}),this.args.drillPush=1,this.args.float=-1,this.args.phaseFrameId>180&&(this.args.phase="stalking");e.args.xSpeed||e.args.gSpeed;break;case"exploding":if(90===this.args.phaseFrameId&&(this.args.falling=!0,this.args.ySpeed=-14,this.args.xSpeed=0,this.args.gSpeed=0,this.noClip=!0,this.viewport.auras.delete(this),this.args.phase="exploded",this.clearScene.activate(e,this,!0),c.Sfx.play("OBJECT_DESTROYED")),this.args.phaseFrameId>90)return;if(t&&t.args.frameId%3==0){var f=new i.Tag('<div class = "particle-explosion">');c.Sfx.play("BOSS_DAMAGED");var h=this.args.width*Math.random()-this.args.width/2,g=this.args.height*Math.random()-this.args.height/2;f.style({"--x":this.x+h,"--y":this.y+g+-16}),t.particles.add(f),setTimeout(function(){return t.particles.remove(f)},512)}}"knocked"!==this.args.phase&&this.args.ySpeed<0&&!this.pointIsSafe(this.x,this.y+-this.args.height+this.args.ySpeed+-1)&&(this.args.ySpeed=0),l(p(d.prototype),"update",this).call(this)}}}},{key:"updateEnd",value:function(){if(l(p(d.prototype),"updateEnd",this).call(this),this.viewport){var t=this.viewport.controlActor;if(t){var e=Math.abs(this.args.x-t.x),r=Math.abs(this.args.y-t.y),n=Math.sign(this.args.x-t.x),i=Math.sign(this.args.y-t.y);switch(this.args.phase){case"attacking":case"swooping":case"stalking":case"knocked":case"damaged":case"ready":e>384&&(this.args.x=t.x+384*n),r>192&&(this.args.y=t.y+192*i),this.args.hitPoints<=0&&(this.viewport.auras.delete(this),this.args.phase="dead",this.noClip=!1,this.args.float=0,"function"==typeof ga&&ga("send","event",{eventCategory:"boss",eventAction:"defeated",eventLabel:"".concat(this.viewport.args.actName,"::").concat(this.args.id)}))}switch(this.args.xSpeed<0?this.args.facing="left":this.args.xSpeed>0&&(this.args.facing="right"),this.args.groundAngle=0,this.args.phase){case"attacking":case"swooping":case"stalking":case"ready":this.checkBelow(this.x,this.y)&&(this.args.falling=!0,this.args.ySpeed=-4,this.args.y--)}}}}},{key:"collideA",value:function(t,e){var r=this;if("exploded"===this.args.phase||t.args.mercy)return!1;if(!t.controllable&&!t.hazard)return!0;if(-1!==e){var n=Math.sign(this.x-t.x),i=(Math.sign(this.y-t.y),Math.max(Math.abs(t.args.xSpeed),5));Math.sign(t.args.xSpeed);if(this.args.hitPoints>0&&t.controllable&&!(t.args.jumping||t.args.rolling||t.dashed))return t.damage(),this.args.phase="ready","function"==typeof ga&&ga("send","event",{eventCategory:"boss",eventAction:"damaged-player",eventLabel:"".concat(this.viewport.args.actName,"::").concat(this.args.id,"::").concat(t.args.id)}),!0;if("dead"===this.args.phase){if(!(t.args.jumping||t.args.rolling||t.dashed))return!0;this.args.explodeFrame=this.viewport.args.frameId,this.args.phase="exploding"}if(1!==e&&3!==e||(t.args.falling?this.ignores.set(t,15):(t.args.gSpeed=4*-Math.sign(this.x-t.x),t.args.rolling&&this.onNextFrame(function(){t.args.gSpeed=-Math.sign(r.x-t.x),t.args.rolling=!0,t.args.direction=Math.sign(t.args.gSpeed)})),this.args.ySpeed=0,this.args.hitPoints>0&&this.damage(t),this.args.hitPoints>0?(t.args.xSpeed=-n*i,this.args.xSpeed=n*i):(t.args.xSpeed=-n,this.args.xSpeed=n)),2===e&&(this.viewport.args.audio&&c.Sfx.play("BOSS_DUDHIT"),t.args.falling&&(this.args.ySpeed=2.5*t.args.ySpeed,t.args.controllable&&(t.args.ySpeed=Math.max(7,Math.abs(t.args.ySpeed)))),this.args.xSpeed=0,this.args.hitPoints>0&&(this.args.phase="knocked"),this.ignores.set(t,15)),0===e){if(t.args.falling&&this.ignores.set(t,15),t.controllable){t.args.y=this.y-this.args.height;t.args.animation;var o=t.args.ySpeed;this.onNextFrame(function(){t.args.ySpeed=-Math.floor(Math.abs(o))||-4})}this.args.xSpeed=0,this.damage(t)}return t.args.ignore=1,this.args.hitPoints||(t.args.ignore=-2),!0}}},{key:"damage",value:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(this.args.hitPoints<=0)){var e=this.args.damagers.get(t);this.args.frameId-e<5||(this.args.hitPoints--,this.args.damagers.set(t,this.args.frameId),this.args.phase="damaged",c.Sfx.play("BOSS_DAMAGED"))}}},{key:"pointIsSafe",value:function(t,e){return!this.viewport.actorsAtPoint(t,e).filter(function(t){return t.hazard}).length}},{key:"solid",get:function(){return!1}},{key:"rotateLock",get:function(){return!0}}])&&u(e.prototype,r),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),d}();t.Beelzebub=g}),require.register("actor/Bell.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Bell=void 0;var i=e("curvature/base/Mixin"),o=e("./PointActor"),a=e("../mixin/Constrainable"),s=e("./Ring");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(g,i.Mixin.from(o.PointActor,a.Constrainable));var e,r,n,p=f(g);function g(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=p.call.apply(p,[this].concat(r))).args.z=100,t.args.width=64,t.args.height=64,t.args.type="actor-item actor-bell",t.cooldown=0,t.noClip=!0,t.args.gravity=.4,t}return e=g,(r=[{key:"update",value:function(){var t=this;this.xLast=this.x,this.yLast=this.y,u(h(g.prototype),"update",this).call(this),this.cooldown>0&&this.cooldown--,this.cooldown<1&&(this.cooldown=0);this.args.tiedTo;this.setPos(),this.args.falling=!0;var e=this.x-this.xLast;if(Math.abs(e)>1?this.args.animation=["ring-left","","ring-right"][1+Math.sign(this.x-this.xLast)]:this.args.animation="",!this.cooldown&&(Math.abs(this.args.xSpeed)>2||Math.abs(this.args.ySpeed)>6)){var r=new s.Ring({x:this.x,y:this.y});r.dropped=!0,r.delay=15,r.args.static=!1,r.args.ignore=10,r.args.xSpeed=.75*this.args.xSpeed,r.args.ySpeed=this.args.ySpeed;var n=this.rotatePoint(0,32);r.args.x+=n[0],r.args.y+=n[1],this.viewport.spawn.add({object:r}),this.cooldown=45*Math.random()+15,this.viewport.onFrameOut(120,function(){t.viewport.actors.remove(r)})}}},{key:"updateEnd",value:function(){Math.abs(this.args.xSpeed)<3&&Math.abs(this.args.ySpeed)<3?this.viewport&&!this.viewport.auras.has(this)&&this.viewport.auras.add(this):this.viewport.auras.delete(this),u(h(g.prototype),"updateEnd",this).call(this)}},{key:"collideB",value:function(t){t.controllable&&(this.args.xSpeed=t.args.xSpeed,this.args.ySpeed=t.args.ySpeed,t.args.xSpeed*=.99,this.viewport.args.backdrop.args.sunrise=1)}}])&&c(e.prototype,r),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),g}();t.Bell=p}),require.register("actor/Block.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Block=void 0;var i=e("./PointActor"),o=(e("curvature/base/Tag"),e("./Ring"));e("curvature/animate/ease/QuintInOut"),e("curvature/animate/ease/CubicInOut");function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||c(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=c(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function c(t,e){if(t){if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function p(){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(u,i.PointActor);var e,r,n,c=h(u);function u(){var t,e,r,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(i=c.call(this,o,a)).args.yForce=0,i.args.yLean=0,i.args.z=null!==(t=i.args.z)&&void 0!==t?t:100,i.args.type="actor-item actor-block",i.args.width=o.width||32,i.args.height=o.height||32,i.args.convey=null!==(e=o.convey)&&void 0!==e?e:0,i.args.conveyed=0,i.args.ySpeedMax=16,i.originalX=i.args.x,i.originalY=i.args.y,i.args.solid=null===(r=i.args.solid)||void 0===r||r,i.args.gravity=.4,i.args.collapse=null!==(n=o.collapse)&&void 0!==n&&n,i.args.active=-1,i.weighted=!1,i}return e=u,n=[{key:"fromDef",value:function(t){var e=p(g(u),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.height=t.height,e.args.y=e.originalY=t.y,e}}],(r=[{key:"onAttached",value:function(t){if(this.viewport){if(this.args.match&&(this.match=this.viewport.actorsById[this.args.match]),!this.viewport)return t.preventDefault(),!1;if(this.args.spriteSheet=this.args.spriteSheet||"/Sonic/marble-zone-block.png",this.droop(0),this.args.collapse&&this.tags.sprite.classList.add("collapse"),this.args.platform&&this.tags.sprite.classList.add("platform"),this.args.hidden)return t&&t.preventDefault(),!1;this.setTile()}}},{key:"collideA",value:function(t,e){var r=this;if(t.isRegion||t.noClip)return!1;if(t.args.standingOn===this&&(this.weighted=!0),t instanceof this.constructor&&!t.args.falling)return!1;if(!t.args.falling&&this.args.droop&&t.args.ySpeed>=0&&t.args.standingOn!==this)return!0;if(this.args.droop&&t.controllable&&(0===e||2===e)&&t.args.ySpeed>=0){var n=this.originalY+-this.args.height,i=Math.floor(this.args.width/2),a=t.args.gSpeed;if(Math.abs(a)>i)return this.args.y=this.originalY,t.args.y=n+-1,this.args.yForce=0,this.args.yLean=0,!0;var s=(this.x+-t.x+-2*a)/i,c=.9*Number(this.args.droop);if(Math.abs(s)>=.9)return this.args.yForce=0,this.args.yLean=this.args.yLean/100,!0;var u=Math.round(c*(1-Math.abs(s))/2);this.args.yForce+=Math.max(t.ySpeedLast,0),this.args.yForce=Math.min(u,this.args.yForce),this.args.yForce=Math.max(this.args.yForce,-u),this.droopPos=this.x-t.x}if(-1===e&&!this.args.platform&&t.controllable&&t.args.ySpeed)return t.args.y<this.args.y&&(t.args.y=this.y+-this.args.height+this.args.ySpeed,t.args.ySpeed=this.args.ySpeed),void this.onNextFrame(function(){t.args.y=r.y+-r.args.height,t.args.falling=!1});if(this.args.platform&&!(t instanceof o.Ring)){t.y,t.args.height;var l=this.y-this.args.height,f=this.args.width/2;return t.args.falling&&t.y-l<16&&t.args.ySpeed>=0&&!t.args.float&&Math.abs(t.x-this.x)<f-16&&(t.controllable?t.args.y=-1+l:t.args.y=l),t.y<=l&&(!1===t.args.falling||t.args.ySpeed>0)?!0:(t.args.npc&&!t.args.falling&&this.args.falling&&!this.args.float&&t.startle(),!1)}if(!t.controllable&&!t.isVehicle)return!0;if(!this.switch&&this.args.collapse&&(0===e||2===e)&&this.args.float<=0)if(t.args.ySpeed>15){this.args.float=1,this.args.goBack=!1;var h=t.args.ySpeed;this.onNextFrame(function(){r.args.falling||r.args.float?(r.args.ySpeed=h,r.args.float=1):(r.args.ySpeed=-1,r.args.float=1),r.args.falling=!0})}else(t.args.ySpeed>0||t.args.gSpeed)&&(this.args.float=this.args.float>=0?this.args.float:this.args.delay||0);return!0}},{key:"onAttach",value:function(t){}},{key:"activate",value:function(){this.args.active=!0}},{key:"deactivate",value:function(){this.args.active=!1}},{key:"update",value:function(){var t=this;if(this.viewport){if(this.args.switch&&!this.switch&&(this.switch=this.viewport.actorsById[this.args.switch]),this.args.collapse&&(this.args.gSpeed=0,this.switch&&this.switch.args.active&&(this.args.float=this.args.float>=0?this.args.float:this.args.delay||0,this.args.float||(this.args.ySpeed=this.args.ySpeed||12))),this.match&&(this.args.convey=-this.match.args.convey),this.xLast=this.args.x,this.yLast=this.args.y,this.args.float&&(this.args.oscillateX||this.args.oscillateY)){var e=Math.pow(Math.cos(Math.pow(Math.sin(this.viewport.args.frameId/90),5)),16.665);if(this.args.oscillateX){var r=Math.round(e*this.args.oscillateX);this.args.x=this.originalX-r}if(this.args.oscillateY){var n=Math.round(e*this.args.oscillateY);this.args.y=this.originalY-n}}if(!this.switch&&this.args.collapse){if(this.reset||this.args.once||(this.reset=!0,this.viewport.onFrameOut(300,function(){t.args.groundAngle=0,t.args.falling=!0,t.args.goBack=!0,t.args.float=-1,t.reset=!1})),!this.args.worm&&this.args.goBack){this.args.float=-1,this.noClip=!0;var i=this.originalX-this.args.x,o=this.originalY-this.args.y;this.args.xSpeed=0,this.args.ySpeed=0,this.args.gSpeed=0,Math.abs(i)>3?this.args.x+=3*Math.sign(i):this.args.x=this.originalX,Math.abs(o)>3?this.args.y+=3*Math.sign(o):this.args.y=this.originalY,this.args.x===this.originalX&&this.args.y===this.originalY&&(this.args.goBack=!1,this.noClip=!1),this.args.groundAngle=0,this.args.airAngle=0}}else if(this.args.droop){if(this.snapBack=this.snapBack||!1,!this.args.colliding&&this.args.yForce&&this.viewport&&this.viewport.onFrameOut(4,function(){t.args.colliding||(t.snapBack=!0)}),!this.args.colliding&&this.args.yForce&&this.snapBack&&(this.args.yForce*=.15),Math.abs(this.args.yForce)<=1&&(this.snapBack=!1),this.args.yForce!==this.args.yLean){var a=this.args.yLean-this.args.yForce,s=this.args.yForce>this.args.yLean?.666*Math.abs(a):.333*Math.abs(a);this.args.yLean-=Math.sign(a)*s,Math.abs(a)<s&&(this.args.yLean=this.args.yForce)}this.args.yLean?(this.args.y=Math.ceil(this.originalY+this.args.yLean)||this.originalY,this.droop(-1*this.args.yLean,this.droopPos||0)):this.args.y=this.originalY}this.box&&this.box.style({"--convey":Math.abs(this.args.convey)}),this.box&&this.box.style({"--conveyDir":Math.sign(this.args.conveyed)}),this.args.conveyed+=this.args.convey,this.box&&this.box.style({"--conveyed":.8*this.args.conveyed}),p(g(u.prototype),"update",this).call(this)}}},{key:"updateStart",value:function(){this.args.float&&this.args.settle&&(this.weighted&&this.args.y<this.def.get("y")+this.args.settle&&(this.args.y+=Math.min(Math.abs(this.args.settle),64)/8*Math.sign(this.args.settle)),!this.weighted&&this.y>this.def.get("y")&&(this.args.y-=Math.min(Math.abs(this.args.settle),32)/8*Math.sign(this.args.settle))),this.weighted=!1}},{key:"updateEnd",value:function(){if(p(g(u.prototype),"updateEnd",this).call(this),this.viewport&&this.viewport.collisions.has(this)){var t=this.viewport.collisions.get(this);if(this.args.treadmill){this.args.convey=0;var e,r=0,n=0,i=s(t);try{for(i.s();!(e=i.n()).done;){var o=a(e.value,2),c=o[0];o[1];c.args.standingOn===this&&(c.args.gSpeed&&(r++,n+=c.args.gSpeed))}}catch(t){i.e(t)}finally{i.f()}r&&(this.args.convey=-n/r)}if(this.args.convey){var l,f=s(t);try{for(f.s();!(l=f.n()).done;){var h=a(l.value,2),d=h[0];h[1];if(d.controllable&&!d.args.falling){var y=d.findNextStep(this.args.convey);y[3]||(y[2]&&(d.args.xSpeed=this.args.convey,d.args.ySpeed=0,d.args.falling=!0,d.args.y=-1+this.y-this.args.height),d.args.x+=y[0],d.args.y+=y[1])}}}catch(t){f.e(t)}finally{f.f()}}}}},{key:"sleep",value:function(){this.args.collapse&&this.args.once&&!this.args.float&&this.viewport.actors.remove(this)}},{key:"popOut",value:function(t){this.args.platform||p(g(u.prototype),"popOut",this).call(this,t)}},{key:"rotateLock",get:function(){return!0}},{key:"canStick",get:function(){return!this.args.platform}},{key:"solid",get:function(){return this.args.solid&&(!this.args.collapse||0!==this.args.float||!this.args.goBack)}}])&&l(e.prototype,r),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.Block=d}),require.register("actor/Block3d.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Block3d=void 0;var i=e("./MarbleBlock");e("../region/LavaRegion");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.MarbleBlock);var e,r,n,c=s(u);function u(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(t=c.call(this,e)).args.type="actor-item actor-block-3d",t}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.Block3d=u}),require.register("actor/BreakableBlock.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BreakableBlock=void 0;var i=e("./Block"),o=e("./Orb"),a=e("curvature/base/Tag"),s=e("../audio/Sfx");function c(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(d,i.Block);var e,r,n,u=p(d);function d(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),(t=u.call(this,e,r)).args.type="actor-item actor-breakable-block",t.args.collapse&&(t.args.type="actor-item actor-breakable-block collapsible-block"),t.args.static=!0,t.args.strength=Number(t.args.strength),t.fragmentsX=new a.Tag('<div class = "fragmentsX">'),t.fragmentsY=new a.Tag('<div class = "fragmentsY">'),t.fragmentTopLeft=new a.Tag('<div class = "fragment fragment-top-left">'),t.fragmentTopRight=new a.Tag('<div class = "fragment fragment-top-right">'),t.fragmentBottomLeft=new a.Tag('<div class = "fragment fragment-bottom-left">'),t.fragmentBottomRight=new a.Tag('<div class = "fragment fragment-bottom-right">'),t.fragmentsY.append(t.fragmentTopLeft.node),t.fragmentsY.append(t.fragmentTopRight.node),t.fragmentsY.append(t.fragmentBottomLeft.node),t.fragmentsY.append(t.fragmentBottomRight.node),t.fragmentsX.append(t.fragmentsY.node),t.broken=!1,t}return e=d,(r=[{key:"onRendered",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.box.append(this.fragmentsX.node),f(g(d.prototype),"onRendered",this).call(this)}},{key:"updateStart",value:function(){f(g(d.prototype),"updateStart",this).call(this),this.switch&&this.switch.args.active&&!this.broken&&this.break()}},{key:"update",value:function(){f(g(d.prototype),"update",this).call(this)}},{key:"callCollideHandler",value:function(){var t;if(this.broken)return!1;for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f(g(d.prototype),"callCollideHandler",this)).call.apply(t,[this].concat(r))}},{key:"collideA",value:function(t,e){if(t instanceof i.Block&&(t.args.float||this.args.float))return!1;if(!(t instanceof o.Orb||t.isVehicle||t.controllable||t.args.rolling))return!this.broken;if(this.args.collapse)return!this.broken&&t.y<=this.y-this.args.height?(this.fragmentsX.style({"--xSpeed":0}),t.args.falling||(this.args.worm?this.delayedBreak(5):this.delayedBreak(25)),!0):!this.broken&&(!t.args.falling||t.args.ySpeed>0&&t.y<this.y-this.args.height);if(-1===this.args.strength)return!0;if(1===this.args.strength&&"knuckles"===t.args.name&&(t.args.falling||Math.abs(t.args.gSpeed)>4))return this.broken||this.break(t),!1;if(1===this.args.strength){if("knuckles"!==t.args.name&&!t.isVehicle)return!0;if("knuckles"!==t.args.name||t.args.falling||Math.abs(t.args.gSpeed)>4)return this.broken||this.break(t),!1}if(2===this.args.strength)return!t.isVehicle||(this.broken||this.break(t),!1);if(!(t.args.rolling&&t.args.mode||t.isVehicle||t.args.spinning)&&(t.args.falling&&!t.dashed&&!t.args.jumping||!t.args.falling&&0===e))return!this.broken;if(!(t instanceof o.Orb||t.falling||t.isVehicle||t.args.gSpeed||t.args.xSpeed||t.args.ySpeed))return!this.broken;if(t instanceof o.Orb||t.args.spinning||t.args.dashed||t.punching){var r=this.y-this.args.height;return this.args.bounceBack&&t.args.jumping&&t.y<r&&(t.args.ySpeed*=-bounceBack,t.args.y=r),this.break(t),!1}return!this.broken}},{key:"sleep",value:function(){this.viewport&&(this.args.dontRestore||(this.args.collapse&&(this.args.static=!0,this.args.falling=!1,this.args.float=-1,this.args.ySpeed=0,this.noClip=!1,this.args.ySpeed=0,this.box.classList.remove("broken"),this.box.classList.remove("breaking"),this.broken=!1),this.args.worm?this.args.x+=this.args.worm:this.args.x=this.def.get("x"),this.args.y=this.def.get("y")+1,this.box.classList.remove("broken"),this.args.active=0,this.broken=!1,this.viewport.setColCell(this)))}},{key:"delayedBreak",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;r&&r.args.falling||this.viewport.onFrameOut(e,function(){return t.break(r)})}},{key:"break",value:function(t){var e=this;if(this.box&&(this.box.classList.add("breaking"),this.box.classList.add("broken")),this.broken||this.viewport.onFrameOut(Math.floor(3*Math.random()),function(){return s.Sfx.play("BLOCK_DESTROYED")}),this.viewport.onFrameOut(4,function(){e.box&&e.box.classList.remove("breaking")}),!this.args.collapse&&t&&t.args.mode%2==0){var r=t.args.xSpeed||t.args.gSpeed;t.isVehicle?this.fragmentsX.style({"--xSpeed":Math.round(1.1*r)}):this.fragmentsX.style({"--xSpeed":Math.round(r)})}if(this.refresher||(this.refresher=!0),this.args.active=1,this.args.collapse&&!this.broken){var n=this.viewport.actorsAtPoint(this.x-this.args.width,this.y),i=this.viewport.actorsAtPoint(this.x+this.args.width,this.y);if(Array.isArray(n)&&!Math.sign(this.args.worm)){var o,a=c(n);try{for(a.s();!(o=a.n()).done;){var u=o.value;u instanceof d&&(u.args.collapse&&(u.broken||u.delayedBreak(8)))}}catch(t){a.e(t)}finally{a.f()}}if(Array.isArray(i)&&!Math.sign(this.args.worm)){var l,f=c(i);try{for(f.s();!(l=f.n()).done;){var h=l.value;h instanceof d&&(h.args.collapse&&(h.broken||h.delayedBreak(8)))}}catch(t){f.e(t)}finally{f.f()}}}this.viewport.settings.rumble&&!this.broken&&t&&t.controller&&t.controller.rumble&&(t.controller&&t.controller.rumble&&t.controller.rumble({duration:140,strongMagnitude:1,weakMagnitude:1}),this.onTimeout(140,function(){t.controller.rumble({duration:100,strongMagnitude:0,weakMagnitude:.25})})),this.broken=!0}},{key:"damage",value:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.break(t)}},{key:"solid",get:function(){return!this.broken}}])&&l(e.prototype,r),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),d}();t.BreakableBlock=d}),require.register("actor/BrokenMonitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BrokenMonitor=void 0;var i=e("./PointActor");e("../actor/Explosion"),e("../actor/Monitor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-monitor actor-monitor-broken",t.args.width=28,t.args.height=32,t}return e=f,(r=[{key:"collideA",value:function(t){return a(u(f.prototype),"collideA",this).call(this,t),!0}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.BrokenMonitor=l}),require.register("actor/Bubbles.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Bubbles=void 0;var i=e("curvature/base/Mixin"),o=e("curvature/base/Tag"),a=(e("./Flickie"),e("./PointActor")),s=e("../behavior/SkidDust"),c=e("../mixin/CanPop"),u=(e("../actor/Explosion"),e("../actor/Projectile"),e("../powerups/ElectricSheild"));function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(y,i.Mixin.from(a.PointActor,c.CanPop));var e,r,n,d=p(y);function y(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=d.call.apply(d,[this].concat(r))).behaviors.add(new s.SkidDust),t.args.type="actor-item actor-bubbles",t.args.animation="standing",t.args.accel=.1,t.args.decel=.5,t.args.gSpeedMax=5,t.args.jumpForce=5,t.args.gravity=.5,t.args.width=32,t.args.height=32,t.willStick=!1,t.stayStuck=!1,t.args.float=-1,t.args.static=!0,t.aiming=!1,t}return e=y,(r=[{key:"onAttached",value:function(){this.shield=new u.ElectricSheild,this.args.electric&&(this.inventory.add(this.shield),this.args.currentSheild=this.shield),this.autoAttr.get(this.box)["data-gold"]="gold",this.autoAttr.get(this.box)["data-fade"]="fade",this.chain=new o.Tag('<div class = "bubbles-flame">'),this.sprite.appendChild(this.chain.node)}},{key:"update",value:function(){var t=this;if(this.viewport&&this.viewport.controlActor){if(this.args.gold&&!this.args.fading&&Math.abs(this.viewport.controlActor.x-this.x)<256&&Math.abs(this.viewport.controlActor.y-this.y)<128){this.args.fading=!0;var e=this.viewport;e.onFrameOut(25,function(){return t.args.fade=!0}),e.onFrameOut(55,function(){return e.actors.remove(t)})}this.viewport&&this.args.electric&&this.viewport.args.frameId%100==0&&(this.args.currentSheild=this.args.currentSheild?null:this.shield),this.box&&this.box.setAttribute("data-animation","standing"),this.args.falling=!0,this.args.flying=!0,f(g(y.prototype),"update",this).call(this)}}},{key:"hold_1",value:function(){this.aiming=!0}},{key:"release_1",value:function(){this.aiming=!1}},{key:"effect",value:function(t){f(g(y.prototype),"effect",this).call(this,t)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}}])&&l(e.prototype,r),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),y}();t.Bubbles=d}),require.register("actor/Bumper.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Bumper=void 0;var i=e("./PointActor"),o=e("../audio/Sfx");function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||s(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){if(t){if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return p(t)}(this,r)}}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(d,i.PointActor);var e,r,n,c=h(d);function d(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=c.call.apply(c,[this].concat(o)),e=p(t),n=-1,(r="float")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="actor-item actor-bumper",t.args.width=16,t.args.height=16,t.ignores=new Map,t}return e=d,(r=[{key:"update",value:function(){l(g(d.prototype),"update",this).call(this);var t,e=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=s(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw o}}}}(this.ignores);try{for(e.s();!(t=e.n()).done;){var r=a(t.value,2),n=r[0],i=r[1];this.ignores.set(n,-1+i),0===i&&this.ignores.delete(n)}}catch(t){e.e(t)}finally{e.f()}}},{key:"collideA",value:function(t){var e=this;if(!(t.static||t.isRegion||this.ignores.has(t)||t.noClip)){if(this.args.type="actor-item actor-bumper actor-bumper-active",this.viewport.onFrameOut(3,function(){return e.args.type="actor-item actor-bumper"}),t.args.falling){o.Sfx.play("BUMPER_BOUNCE");var r=this.x-t.x,n=this.y-t.y,i=Math.max(12,Math.sqrt(Math.pow(t.args.xSpeed,2),Math.pow(t.args.ySpeed,2))),a=Math.atan2(n,r);t.args.width;t.args.x=this.x,t.args.y=this.y,t.args.xSpeed=-i*Math.cos(a),t.args.ySpeed=-i*Math.sin(a)}else t.args.gSpeed*=-1,Math.abs(t.args.gSpeed)<7&&(t.args.gSpeed=7*Math.sign(t.args.gSpeed));this.ignores.set(t,8),this.viewport.settings.rumble&&t&&t.controller&&t.controller.rumble&&(t.controller.rumble({duration:120,strongMagnitude:1,weakMagnitude:1}),this.onTimeout(120,function(){t.controller.rumble({duration:120,strongMagnitude:0,weakMagnitude:1})}))}}},{key:"canStick",get:function(){return!1}},{key:"rotateLock",get:function(){return!0}},{key:"solid",get:function(){return!0}}])&&u(e.prototype,r),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),d}();t.Bumper=d}),require.register("actor/BuzzBomber.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BuzzBomber=void 0;e("./Flickie");var i=e("curvature/base/Mixin"),o=e("curvature/base/Tag"),a=e("./PointActor"),s=e("../behavior/SkidDust"),c=e("../mixin/CanPop"),u=(e("../actor/Explosion"),e("../actor/Projectile"));function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(y,i.Mixin.from(a.PointActor,c.CanPop));var e,r,n,d=p(y);function y(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=d.call.apply(d,[this].concat(r))).behaviors.add(new s.SkidDust),t.args.type="actor-item actor-buzz-bomber",t.args.animation="standing",t.args.accel=.1,t.args.decel=.5,t.args.gSpeedMax=5,t.args.jumpForce=5,t.args.gravity=.5,t.args.width=32,t.args.height=16,t.willStick=!1,t.stayStuck=!1,t.args.float=-1,t.aiming=!1,t}return e=y,(r=[{key:"onRendered",value:function(){if(f(g(y.prototype),"onRendered",this).call(this),this.flame=new o.Tag('<div class = "buzz-bomber-flame">'),this.wings=new o.Tag('<div class = "buzz-bomber-wings">'),this.sprite.appendChild(this.flame.node),this.sprite.appendChild(this.wings.node),this.aiming)this.box.setAttribute("data-animation","aiming");else{var t=this.args.direction;Math.sign(this.args.gSpeed)!==t&&Math.abs(this.args.gSpeed-t)>5?this.box.setAttribute("data-animation","skidding"):this.args.moving&&this.args.gSpeed?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}}},{key:"update",value:function(){var t=this;this.args.ySpeed=this.yAxis,this.flame,0===this.args.xSpeed&&this.viewport&&this.viewport.onFrameOut(10,function(){t.attack()}),this.args.falling=!0,this.args.flying=!0,f(g(y.prototype),"update",this).call(this)}},{key:"command_1",value:function(){this.aiming=!this.aiming}},{key:"command_2",value:function(){if(this.aiming&&this.viewport){var t=[0,-24],e=new u.Projectile({direction:this.args.direction,x:this.args.x+t[0]+(this.args.xSpeed||this.args.gSpeed),y:this.args.y+t[1],owner:this,xSpeed:this.args.xSpeed||this.args.gSpeed,YSpeed:this.args.YSpeed});e.impulse(18,1.57+Math.PI/4*1),this.viewport.auras.add(e),this.viewport.spawn.add({object:e})}}},{key:"effect",value:function(t){f(g(y.prototype),"effect",this).call(this,t)}},{key:"wakeUp",value:function(){if(this.viewport){this.viewport;this.sleeping=!1,this.attack()}}},{key:"attack",value:function(){var t=this;if(!this.sleeping&&!this.attacking&&this.viewport){var e=this.viewport;this.args.direction=-1,this.args.facing="left",this.args.xSpeed=-10,this.aiming=!1,this.attacking=!0,e.onFrameOut(5,function(){t.aiming=!0,e.onFrameOut(5,function(){var r=2,n=e.onFrameInterval(5,function(){t.command_2(),r--||n()})})}),e.onFrameOut(50,function(){var r=t.args.xSpeed;t.args.xSpeed=.5*-r,e.onFrameOut(100,function(){t.aiming=!1,t.attacking=!1,t.args.xSpeed=0,t.args.ySpeed=0})})}}},{key:"sleep",value:function(){var t=this;this.args.x=this.def.get("x"),this.args.y=this.def.get("y"),this.onNextFrame(function(){t.viewport&&(t.args.x=t.def.get("x"),t.args.y=t.def.get("y"),t.viewport.setColCell(t),t.args.xSpeed=0,t.args.ySpeed=0,t.args.pushed=0,t.args.float=0,t.attacking=!1,t.sleeping=!0)})}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}}])&&l(e.prototype,r),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),y}();t.BuzzBomber=d}),require.register("actor/CautionSign.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CautionSign=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.width=20,t.args.height=60,t.args.type="actor-item actor-caution-sign",t}return e=u,(r=[{key:"solid",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.CautionSign=u}),require.register("actor/Chalmers.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Chalmers=void 0;var i=e("./PointActor"),o=(e("curvature/base/Tag"),e("../behavior/SkidDust"));function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).behaviors.add(new o.SkidDust),t.args.type="actor-item actor-chalmers",t.args.normalHeight=45,t.args.rollingHeight=23,t.args.accel=.25,t.args.decel=.4,t.args.gSpeedMax=18,t.args.jumpForce=11,t.args.gravity=.5,t.args.width=18,t.args.height=32,t}return e=h,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div")}},{key:"update",value:function(){var t=this.args.falling;if(this.box){if(t)this.args.standingOn&&this.args.standingOn.isVehicle?this.box.setAttribute("data-animation","standing"):this.args.jumping&&this.box.setAttribute("data-animation","jumping");else{this.yAxis>0?this.args.crouching=!0:this.args.crouching=!1;var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;this.args.rolling?this.box.setAttribute("data-animation","rolling"):Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?this.box.setAttribute("data-animation","standing"):n>.25*i?this.box.setAttribute("data-animation","running"):this.args.moving&&r?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}s(l(h.prototype),"update",this).call(this)}else s(l(h.prototype),"update",this).call(this)}},{key:"solid",get:function(){return!1}},{key:"canRoll",get:function(){return!0}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.Chalmers=f}),require.register("actor/Chao.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Chao=void 0;var i=e("../sprite/Png"),o=e("./PointActor");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(p,o.PointActor);var e,r,n,h=u(p);function p(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return t=h.call.apply(h,[this].concat(a)),e=l(t),r="png",n=new i.Png("/DBurraki/chao-normal.png"),r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="actor-item actor-chao",t.args.spriteSheet=t.spriteSheet="/DBurraki/chao-normal.png",t.args.width=14,t.args.height=18,t.emotes=["normal","alert","inquire","like","love","angry"],t.emoteIndex=0,t.args.animation="standing",t.bindTo("carriedBy",function(e){if(t.cX&&(t.cX(),t.cX=null),t.cY&&(t.cY(),t.cY=null),e)t.cX=e.args.bindTo("x",function(r){return t.args.x=r+8*e.args.direction}),t.cY=e.args.bindTo("y",function(e){return t.args.y=e+-16}),e.carrying.add(l(t)),t.args.float=-1;else if(t.carriedBy){var r=t.carriedBy;t.carriedBy=null,t.args.xSpeed=r.args.xSpeed,t.args.ySpeed=r.args.ySpeed,t.args.xSpeed+=4*Math.sign(r.args.gSpeed||r.args.xSpeed),t.args.ySpeed-=4,r.carrying.delete(l(t)),t.args.falling=!0,t.args.float=0}}),t.args.direction=1,t.args.currentState="sitting",t.args.bindTo("currentState",function(){t.args.stateTime=0}),t}return e=p,(r=[{key:"onAttached",value:function(t){var e=this;this.setAutoAttr("emote","data-emote"),this.setAutoAttr("alignment","data-alignment"),this.setAutoAttr("direction","data-direction"),this.viewport.onInterval(1500,function(){e.emoteIndex>=e.emotes.length&&(e.emoteIndex=0),e.args.emote=e.emotes[e.emoteIndex],e.emoteIndex++,e.viewport.onTimeout(500,function(){e.args.emote="normal"})});var r={addef8:"e4e0e4","2ebee9":"c0bde4","0e6d89":"9c99c0",ecde2f:"addef8",dcb936:"2ebee9",985000:"0e6d89",ffa3b1:"ffa3b1",fa6379:"fa6379",e4e0e4:"cdeef8",f8f820:"9c99c0"},n={addef8:"485070","2ebee9":"303058","0e6d89":"202020",ecde2f:"b70000",dcb936:"770000",985000:"420000",ffa3b1:"ffa3b1",fa6379:"fa6379",e4e0e4:"e4e0e4",f8f820:"bf999c",606080:"202020"},i={addef8:"ff7575","2ebee9":"e00000","0e6d89":"800000",ecde2f:"b70000",dcb936:"770000",985000:"420000",ffa3b1:"ffa3b1",fa6379:"fa6379",e4e0e4:"e4e0e4",606080:"202020"},o={addef8:"e08000","2ebee9":"b76900","0e6d89":"7d4800",ecde2f:"b44800",dcb936:"844221",985000:"630000",ffa3b1:"ffa3b1",fa6379:"fa6379",e4e0e4:"e4e0e4",606080:"202020"},a={addef8:"80e000","2ebee9":"69b700","0e6d89":"487d00",ecde2f:"48b400",dcb936:"428421",985000:"006300",ffa3b1:"ffa3b1",fa6379:"fa6379",e4e0e4:"e4e0e4",606080:"202020"},s={addef8:"485070","2ebee9":"303058","0e6d89":"202020",ecde2f:"c0bde4",dcb936:"9c99c0",985000:"606080",ffa3b1:"ffa3b1",fa6379:"fa6379",e4e0e4:"e4e0e4",f8f820:"9c99c0",606080:"202020"},c={addef8:"c0bde4","2ebee9":"9c99c0","0e6d89":"606080",ecde2f:"485070",dcb936:"303058",985000:"202020",ffa3b1:"ffa3b1",fa6379:"fa6379",e4e0e4:"e4e0e4",f8f820:"9c99c0",606080:"202020"},u={addef8:"c0bde4","2ebee9":"9c99c0","0e6d89":"606080",ecde2f:"e4e0e4",dcb936:"c0bde4",985000:"9c99c0",ffa3b1:"ffa3b1",fa6379:"fa6379",e4e0e4:"e4e0e4",f8f820:"9c99c0",606080:"202020"},l={addef8:"80e000","2ebee9":"69b700","0e6d89":"487d00",ecde2f:"b70000",dcb936:"770000",985000:"420000",ffa3b1:"ffa3b1",fa6379:"fa6379",e4e0e4:"e4e0e4",606080:"202020"};this.png.ready.then(function(){e.heroSheet=e.png.recolor(r).toUrl(),e.darkSheet=e.png.recolor(n).toUrl(),e.rubySheet=e.png.recolor(i).toUrl(),e.tangySheet=e.png.recolor(o).toUrl(),e.limeSheet=e.png.recolor(a).toUrl(),e.coalSheet=e.png.recolor(s).toUrl(),e.mimeSheet=e.png.recolor(c).toUrl(),e.whiteSheet=e.png.recolor(u).toUrl(),e.limeRubySheet=e.png.recolor(l).toUrl()})}},{key:"lift",value:function(t){if(this.carriedBy===t)return this.carriedBy=null,void(this.args.currentState="standing");this.carriedBy=t,this.args.currentState="held"}},{key:"onClick",value:function(t){this.args.spriteSheet===this.heroSheet?(this.args.spriteSheet=this.darkSheet,this.args.alignment="dark"):this.args.spriteSheet===this.darkSheet?(this.args.spriteSheet=this.rubySheet,this.args.alignment="normal"):this.args.spriteSheet===this.rubySheet?(this.args.spriteSheet=this.tangySheet,this.args.alignment="normal"):this.args.spriteSheet===this.tangySheet?(this.args.spriteSheet=this.limeSheet,this.args.alignment="normal"):this.args.spriteSheet===this.limeSheet?(this.args.spriteSheet=this.coalSheet,this.args.alignment="normal"):this.args.spriteSheet===this.coalSheet?(this.args.spriteSheet=this.whiteSheet,this.args.alignment="normal"):this.args.spriteSheet===this.whiteSheet?(this.args.spriteSheet=this.mimeSheet,this.args.alignment="normal"):this.args.spriteSheet===this.mimeSheet?(this.args.spriteSheet=this.limeRubySheet,this.args.alignment="normal"):this.args.spriteSheet===this.limeRubySheet?(this.args.spriteSheet=this.spriteSheet,this.args.alignment="normal"):(this.args.spriteSheet=this.heroSheet,this.args.alignment="hero")}},{key:"onRightClick",value:function(t){t.preventDefault(),t.stopPropagation(),"dark"===this.args.alignment?this.args.alignment="normal":"normal"===this.args.alignment?this.args.alignment="hero":this.args.alignment="dark"}},{key:"onRendered",value:function(){var t=this;s(f(p.prototype),"onRendered",this).call(this),this.listening||(this.box.addEventListener("click",function(e){return t.onClick(e)}),this.box.addEventListener("contextmenu",function(e){return t.onRightClick(e)}),this.listening=!0)}},{key:"solid",get:function(){return!1}},{key:"update",value:function(){switch(this.args.currentState){case"held":this.args.falling=!1,this.args.stateTime<15?this.args.emote="like":this.args.stateTime<60?(this.args.emote="love",this.args.animation="walking"):61===this.args.stateTime&&(this.args.emote="normal",this.args.animation="searching");break;case"standing":this.args.animation="standing",this.args.stateTime>120&&(this.args.currentState="thinking");break;case"thinking":this.args.animation="thinking",this.args.stateTime>60?this.args.currentState="searching":0==this.args.stateTime&&(this.args.emote="inquire");break;case"searching":this.args.animation="searching",this.args.emote="inquire",this.args.stateTime>90?this.args.emote="alert":this.args.emote="inquire",this.args.stateTime>120&&(this.args.direction=Math.sign(Math.random()-.5),Math.random()>.25?this.args.currentState="sitting":this.args.currentState="walking");break;case"walking":this.args.animation="walking",this.args.stateTime<15?this.args.emote="alert":16===this.args.stateTime&&(this.args.emote="normal"),this.args.gSpeed=.01*this.args.direction,this.args.stateTime>40&&(this.args.currentState="flying");break;case"flying":this.args.animation="flying",this.args.stateTime<45?this.args.falling?this.args.ySpeed>=0&&(this.args.currentState="flying"):(this.args.falling=!0,this.args.direction=Math.sign(Math.random()-.5),this.args.ySpeed=-Math.sin(this.args.stateTime/.05),this.args.xSpeed=1.25*this.args.direction,this.args.float=45):this.args.currentState="thinking";break;case"sitting":this.args.animation="sitting",this.args.stateTime>120&&(this.args.currentState="thinking")}s(f(p.prototype),"update",this).call(this),this.args.stateTime++}},{key:"stateStanding",value:function(){}},{key:"stateThinking",value:function(){}},{key:"stateWalking",value:function(){}},{key:"stateFlying",value:function(){}},{key:"stateSitting",value:function(){}},{key:"stateSwimming",value:function(){}},{key:"stateFlyingLooking",value:function(){}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.Chao=h}),require.register("actor/ChaoCrate.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ChaoCrate=void 0;var i=e("./BreakableBlock"),o=e("./Egg");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.BreakableBlock);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-breakable-block actor-chao-crate",t.args.width=60,t.args.height=60,t.args.static=!1,t}return e=h,(r=[{key:"collideA",value:function(t,e){return!(0!==e||!t.controllable)||(t.spindashCharge?(this.break(),!0):-1!==e||t.args.gSpeed||t.args.falling||!t.controllable?1!==e&&3!==e||t.y<=this.y-this.args.height||(t.args.rolling||2===e?(this.break(),!1):!!this.viewport&&(-1!==e&&!t.args.rolling||s(l(h.prototype),"collideA",this).call(this,t,e))):(this.break(),!1))}},{key:"break",value:function(){var t=this;if(!this.broken)for(var e=function(e){var r=new o.Egg({x:t.x,y:t.y});t.viewport.spawn.add({object:r}),t.onNextFrame(function(){r.args.falling=!0,r.args.xSpeed=6*(-.5+Math.random()),r.args.ySpeed=-7})},r=0;r<5;r++)e();s(l(h.prototype),"break",this).call(this),this.viewport.onTimeout(1e3,function(){t.viewport&&t.viewport.actors.remove(t)})}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.ChaoCrate=f}),require.register("actor/Cinematic.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Cinematic=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(p,i.PointActor);var e,r,n,h=c(p);function p(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),f(u(r=h.call(this,t,e)),"noClip",!0),f(u(r),"panSpeed",9),r.args.float=-1,r.target=null,r.targets=[[250,6500],[5900,6600],[250,6500],[7700,7800],[6800,4200],[6800,4200],[8e3,4300],[1450,1800]],r}return e=p,(r=[{key:"setCameraMode",value:function(){this.args.cameraMode="cinematic"}},{key:"update",value:function(){if(a(l(p.prototype),"update",this).call(this),this.args.selected){if(!this.target||this.x===this.target[0]&&this.y===this.target[1])return this.targets.length||this.remove(),void(this.target=this.targets.shift());var t=this.target;if(this.x!==t[0]){var e=t[0]-this.x;this.args.x+=Math.sign(e)*this.panSpeed,Math.abs(e)<this.panSpeed&&(this.args.x=t[0])}if(this.y!==t[1]){var r=t[1]-this.y;this.args.y+=Math.sign(r)*this.panSpeed,Math.abs(r)<this.panSpeed&&(this.args.y=t[1])}}}},{key:"isGhost",get:function(){return!0}},{key:"controllable",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.Cinematic=h}),require.register("actor/Coin.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Coin=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(h,i.PointActor);var e,r,n,f=c(h);function h(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=f.call.apply(f,[this].concat(o)),e=u(t),n=-1,(r="float")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="actor-item actor-coin",t.args.width=32,t.args.height=32,t.args.gone=!1,t}return e=h,(r=[{key:"update",value:function(){a(l(h.prototype),"update",this).call(this),this.viewport.args.audio&&!this.sample&&(this.sample=new Audio("/mario/smw_coin.wav"),this.sample.volume=1)}},{key:"collideA",value:function(t){var e=this;if(a(l(h.prototype),"collideA",this).call(this,t),!this.args.gone){if(this.args.type="actor-item actor-coin collected",!this.args.gone){this.viewport.args.audio&&this.sample&&this.sample.play(),this.viewport.onFrameOut(40,function(){e.args.type="actor-item actor-coin collected gone"}),this.viewport.onFrameOut(80,function(){e.viewport.actors.remove(e),e.remove()});this.x,this.y;t.args.owner?t.args.owner.args.coins+=1:t.occupant?t.occupant.args.coins+=1:t.args.coins+=1}this.args.gone=!0}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.Coin=f}),require.register("actor/CompanionBlock.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CompanionBlock=void 0;var i=e("./MarbleBlock"),o=e("../region/LavaRegion"),a=e("../audio/Sfx");function s(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(g,i.MarbleBlock);var e,r,n,c=h(g);function g(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),(t=c.call(this,e)).args.type="actor-item actor-marble-companion-block",t.args.density=t.args.density||9.5,t.played=!1,t}return e=g,(r=[{key:"collideA",value:function(t,e){return!(this.args.falling&&t.y>8+this.y+-this.args.height)&&(this.args.falling&&t.y>this.y-this.args.height?t.args.y=this.y-this.args.height:this.args.falling&&t.args.modeTime<3&&(t.args.gSpeed=0),l(p(g.prototype),"collideA",this).call(this,t,e))}},{key:"update",value:function(){var t,e=!1,r=s(this.regions);try{for(r.s();!(t=r.n()).done;){t.value instanceof o.LavaRegion&&(e=!0,this.played||(this.onTimeout(50,function(){a.Sfx.play("PLAYER_DAMAGED")}),"function"==typeof ga&&ga("send","event",{eventCategory:"companion-block",eventAction:"pushed",eventLabel:"".concat(this.viewport.args.actName,"::").concat(this.args.id)}),this.played=!0))}}catch(t){r.e(t)}finally{r.f()}var n=this.args.x;(l(p(g.prototype),"update",this).call(this),this.args.pushed)&&(e&&(this.viewport.tileMap.getSolid(this.x+this.args.width/2*(this.args.pushed||0),this.y)?this.args.pushed=0:this.args.x=n+this.args.pushed))}},{key:"sleep",value:function(){var t=this;this.args.x=this.def.get("x"),this.args.y=this.def.get("y"),this.onNextFrame(function(){t.args.x=t.def.get("x"),t.args.y=t.def.get("y"),t.viewport.setColCell(t),t.args.xSpeed=0,t.args.ySpeed=0,t.args.pushed=0,t.args.float=0})}}])&&u(e.prototype,r),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),g}();t.CompanionBlock=g}),require.register("actor/Cone.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Cone=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.width=16,t.args.height=32,t.args.type="actor-item actor-cone",t}return e=u,(r=[{key:"solid",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.Cone=u}),require.register("actor/CrabMeat.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CrabMeat=void 0;e("./Flickie");var i=e("curvature/base/Mixin"),o=(e("curvature/base/Tag"),e("./PointActor")),a=e("../behavior/SkidDust"),s=e("../mixin/CanPop");e("../actor/Explosion"),e("../actor/Projectile");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(g,i.Mixin.from(o.PointActor,s.CanPop));var e,r,n,p=f(g);function g(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=p.call.apply(p,[this].concat(r))).behaviors.add(new a.SkidDust),t.args.type="actor-item actor-crabmeat",t.args.animation="standing",t.args.accel=.1,t.args.decel=.5,t.args.gSpeedMax=5,t.args.jumpForce=5,t.args.gravity=.5,t.args.width=24,t.args.height=32,t.willStick=!1,t.stayStuck=!1,t}return e=g,(r=[{key:"update",value:function(){var t=this.args.direction;this.box&&(Math.sign(this.args.gSpeed)!==t&&Math.abs(this.args.gSpeed-t)>5?this.box.setAttribute("data-animation","skidding"):this.args.moving&&this.args.gSpeed?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")),u(h(g.prototype),"update",this).call(this)}},{key:"effect",value:function(t){u(h(g.prototype),"effect",this).call(this,t)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}}])&&c(e.prototype,r),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),g}();t.CrabMeat=p}),require.register("actor/Cursor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Cursor=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),c.apply(this,arguments)}return e=u,(r=[{key:"update",value:function(){}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.Cursor=u}),require.register("actor/CutScene.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CutScene=void 0;var i=e("./PointActor");function o(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(l,i.PointActor);var e,r,n,a=u(l);function l(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),r=a.call(this,t,e),t.src?r.fetcher=fetch(t.src).then(function(t){return t.json()}):t.frames&&(r.fetcher=Promise.resolve(t.frames)),r.args.hidden=!0,r}return e=l,(r=[{key:"playSample",value:function(t){new Audio(t.source).play()}},{key:"activate",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t.controllable&&(!t.args.falling||n)&&"Sonic"===t.args.canonical){var i=this.viewport;i&&!this.args.running&&(this.args.running=!0,t.args.gSpeed=0,i.args.cutScene=!0,t.controller.zero(),this.fetcher.then(function(e){var n,a=0,s=o(e);try{var c=function(){var e=n.value,o=function(){switch(e.event){case"dialog":i.showDialog(e.lines,e.classes);break;case"audio":r.playSample(e);break;case"face":t.args.direction=e.direction,t.args.facing=e.direction>0?"right":"left";break;case"input":e.axes&&t.controller.replay({axes:e.axes}),e.buttons&&t.controller.replay({buttons:e.buttons}),t.readInput();break;case"superdrop":t.dropDashCharge=30;break;case"clearAct":i.clearAct(e.message);break;case"clear":i.clearDialog();break;case"message":i.showCenterMessage(e.message);break;case"hide":i.hideCenterMessage(),i.hideDialog();break;case"wait":i.args.cutScene=!1,i.hideCenterMessage(),i.hideDialog()}};a?i.onFrameOut(a,o):o(),a+=e.time||0};for(s.s();!(n=s.n()).done;)c()}catch(t){s.e(t)}finally{s.f()}}))}}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),l}();t.CutScene=f}),require.register("actor/DrainFly.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.DrainFly=void 0;var i=e("./PointActor"),o=e("curvature/base/Mixin"),a=e("../mixin/CanPop");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(p,o.Mixin.from(i.PointActor,a.CanPop));var e,r,n,h=l(p);function p(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(r=h.call(this,t,e)).args.type="actor-item actor-drainfly",r.args.width=16,r.args.height=16,r.args.float=-1,r.args.gravity=0,r.args.phase="idle",r}return e=p,(r=[{key:"update",value:function(){if(c(f(p.prototype),"update",this).call(this),this.viewport){var t=this.viewport.controlActor;if(t){switch(this.args.phase){case"idle":this.args.alertTo=this.y-64,t.x+-this.x>-128&&(this.args.phase="alert");break;case"alert":this.y>this.args.alertTo?this.args.ySpeed--:(this.args.phase="attacking",this.args.y=this.args.alertTo,this.args.ySpeed=0);break;case"attacking":var e=Math.sign(t.x+-this.x),r=Math.sign(t.y+-this.y+-24);this.args.xSpeed+=.2*e-Math.random()/10,this.args.ySpeed+=.5*r-Math.random()/10,Math.abs(this.args.xSpeed)>6&&(this.args.xSpeed=4*e),Math.abs(this.args.ySpeed)>8&&(this.args.ySpeed=4*r),this.checkBelow(this.x,this.y)&&(this.args.ySpeed=-1,this.args.y-=1)}this.args.facing=this.args.xSpeed>0?"left":"right",this.args.float=-1}else this.args.phase="idle"}}},{key:"solid",get:function(){return!1}},{key:"rotateLock",get:function(){return!0}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.DrainFly=h}),require.register("actor/DrillCar.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.DrillCar=void 0;var i=e("./Vehicle"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(p,i.Vehicle);var e,r,n,h=u(p);function p(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=h.call.apply(h,[this].concat(o)),e=l(t),n=["Jump ","Fly +"],(r="instructions")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="actor-item actor-drill-car",t.args.width=38,t.args.height=48,t.removeTimer=null,t.args.gSpeedMax=26,t.args.decel=.3,t.args.accel=.75,t.args.seatHeight=34,t.args.skidTraction=.95,t.dustCount=0,t.args.particleScale=2,t}return e=p,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.backSprite=new o.Tag('<div class = "sprite-back sprite">'),this.drill=new o.Tag('<div class = "drill-car-drill">'),this.seat=new o.Tag('<div class = "drill-car-seat">'),this.windsheild=new o.Tag('<div class = "drill-car-windsheild">'),this.copterCap=new o.Tag('<div class = "drill-car-copter-cap">'),this.copterBladeA=new o.Tag('<div class = "drill-car-copter-blade-a">'),this.copterBladeB=new o.Tag('<div class = "drill-car-copter-blade-b">'),this.frontWheelA=new o.Tag('<div class = "drill-car-tire drill-car-tire-front-a">'),this.frontWheelB=new o.Tag('<div class = "drill-car-tire drill-car-tire-front-b">'),this.backWheelA=new o.Tag('<div class = "drill-car-tire drill-car-tire-back-a">'),this.backWheelB=new o.Tag('<div class = "drill-car-tire drill-car-tire-back-b">'),this.sprite.appendChild(this.drill.node),this.backSprite.appendChild(this.copterCap.node),this.backSprite.appendChild(this.copterBladeA.node),this.backSprite.appendChild(this.copterBladeB.node),this.sprite.appendChild(this.windsheild.node),this.backSprite.appendChild(this.seat.node),this.sprite.appendChild(this.frontWheelA.node),this.backSprite.appendChild(this.frontWheelB.node),this.sprite.appendChild(this.backWheelA.node),this.backSprite.appendChild(this.backWheelB.node),this.box.appendChild(this.backSprite.node)}},{key:"update",value:function(){var t=this.args.falling;if(this.viewport.args.audio&&!this.flyingSound&&(this.flyingSound=new Audio("/Sonic/drill-car-copter.wav"),this.flyingSound.volume=.35+-.2*Math.random(),this.flyingSound.loop=!0),this.flyingSound&&(this.flyingSound.paused||(this.flyingSound.volume=.25+-.2*Math.random()),this.flyingSound.currentTime>.2&&(this.flyingSound.currentTime=0)),this.box){if(t)this.args.flying?this.box.setAttribute("data-animation","flying"):this.args.falling&&(this.flyingSound&&this.flyingSound.pause(),this.box.setAttribute("data-animation","jumping"));else{this.flyingSound&&this.flyingSound.pause();var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;if(this.dustCount>0&&this.dustCount--,Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5){this.box.setAttribute("data-animation","skidding");var a=this.viewport,c=new o.Tag('<div class = "particle-dust">'),u=this.rotatePoint(this.args.gSpeed,0);c.style({"--x":u[0]+this.x,"--y":u[1]+this.y,"z-index":0,opacity:2*Math.random()});var l=new o.Tag('<div class = "particle-dust">'),h=this.rotatePoint(this.args.gSpeed+40*this.args.direction,0);l.style({"--x":h[0]+this.x,"--y":h[1]+this.y,"z-index":0,opacity:2*Math.random()}),a.particles.add(c),a.particles.add(l),setTimeout(function(){a.particles.remove(c),a.particles.remove(l)},350)}else this.args.moving&&n>.75*i?this.box.setAttribute("data-animation","running"):this.args.moving&&n?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}0==this.args.copterCoolDown?this.args.ySpeed>5&&(this.flyingSound&&this.flyingSound.pause(),this.args.flying=!1):this.args.copterCoolDown>0&&this.args.copterCoolDown--,s(f(p.prototype),"update",this).call(this)}else s(f(p.prototype),"update",this).call(this)}},{key:"command_0",value:function(){if(!this.args.falling)return this.args.copterCoolDown=15,void s(f(p.prototype),"command_0",this).call(this);this.args.copterCoolDown>0||this.args.ySpeed>-16&&(this.args.flying||this.flyingSound&&this.flyingSound.play(),this.args.flying=!0,0==this.args.copterCoolDown&&(this.args.copterCoolDown=7),this.args.ySpeed=-1,this.args.ySpeed=-4,this.args.float=8)}},{key:"sleep",value:function(){this.flyingSound&&this.flyingSound.pause()}},{key:"solid",get:function(){return!this.occupant}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.DrillCar=h}),require.register("actor/Egg.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Egg=void 0;var i=e("./PointActor"),o=(e("curvature/base/Bindable"),e("./EggShellTop")),a=e("./Chao");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-egg",t.args.width=15,t.args.height=20,t.broken=!1,t.args.bindTo("falling",function(e){var r=t.ySpeedLast;if(!(e||t.broken||r<12)){t.args.type="actor-item actor-egg actor-egg-shell-bottom";var n=new o.EggShellTop({ySpeed:.4*-r,xSpeed:.6*t.xSpeedLast,x:t.x,y:t.y-10}),i=new a.Chao({ySpeed:.4*-r,xSpeed:.4*t.xSpeedLast,x:t.x,y:t.y-10});t.args.gSpeed=.2*t.xSpeedLast,t.viewport.spawn.add({object:n}),t.viewport.spawn.add({object:i}),t.broken=!0}}),t.bindTo("carriedBy",function(e){if(t.cX&&(t.cX(),t.cX=null),t.cY&&(t.cY(),t.cY=null),e)t.cX=e.args.bindTo("x",function(r){return t.args.x=r+12*e.args.direction}),t.cY=e.args.bindTo("y",function(e){return t.args.y=e+-12}),e.carrying.add(l(t)),t.args.float=-1;else if(t.carriedBy){var r=t.carriedBy;t.carriedBy=null,t.args.xSpeed=r.args.xSpeed,t.args.ySpeed=r.args.ySpeed,t.args.xSpeed+=4*Math.sign(r.args.gSpeed||r.args.xSpeed),t.args.ySpeed-=4,t.args.xSpeed+=2*r.xAxis,r.carrying.delete(l(t)),t.args.falling=!0,t.args.float=0}}),t}return e=h,(r=[{key:"lift",value:function(t){this.carriedBy!==t?this.carriedBy=t:this.carriedBy=null}},{key:"solid",get:function(){return!1}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.Egg=h}),require.register("actor/EggMobile.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.EggMobile=void 0;var i=e("./Vehicle");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.Vehicle);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-vehicle actor-eggmobile",t.args.accel=.15,t.args.decel=.8,t.args.gSpeedMax=15,t.args.xSpeedMax=45,t.args.ySpeedMax=45,t.args.jumpForce=12,t.args.gravity=.6,t.args.width=28,t.args.height=20,t.args.yMargin=42,t.args.falling=!0,t.args.flying=!0,t.args.float=-1,t}return e=f,(r=[{key:"update",value:function(){if(this.checkBelow(this.x,this.y)&&this.args.y--,Math.abs(this.yAxis)>.5){if(Math.abs(this.args.ySpeed)<this.args.ySpeedMax){var t=this.args.ySpeed;Math.sign(this.yAxis)===Math.sign(this.args.ySpeed)?t+=this.yAxis*this.args.accel*3:t+=this.yAxis*this.args.accel*6,t=t>0?Math.floor(1e3*t)/1e3:Math.ceil(1e3*t)/1e3,this.args.ySpeed=t}}else this.args.ySpeed=this.args.ySpeed*this.args.decel;this.xAxis||(Math.abs(this.args.xSpeed)<=1&&(this.args.xSpeed=0),this.args.xSpeed>0?this.args.xSpeed=Math.floor(this.args.xSpeed*this.args.decel):this.args.xSpeed=Math.ceil(this.args.xSpeed*this.args.decel)),this.occupant||(this.args.xSpeed=0,this.args.ySpeed=0),this.args.falling=!0,this.args.flying=!0,this.args.mode=0,this.args.cameraMode="aerial",a(u(f.prototype),"update",this).call(this)}},{key:"solid",get:function(){return!this.occupant}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.EggMobile=l}),require.register("actor/EggShellBottom.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.EggShellBottom=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(l,i.PointActor);var e,r,n,u=s(l);function l(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=u.call.apply(u,[this].concat(r))).args.type="actor-item actor-egg-shell-bottom",t.args.width=15,t.args.height=20,t.bindTo("carriedBy",function(e){if(t.cX&&(t.cX(),t.cX=null),t.cY&&(t.cY(),t.cY=null),e)t.cX=e.args.bindTo("x",function(r){return t.args.x=r+12*e.args.direction}),t.cY=e.args.bindTo("y",function(e){return t.args.y=e+-12}),e.carrying.add(c(t)),t.args.float=-1;else if(t.carriedBy){var r=t.carriedBy;t.carriedBy=null,t.args.xSpeed=r.args.xSpeed,t.args.ySpeed=r.args.ySpeed,t.args.xSpeed+=4*Math.sign(r.args.gSpeed||r.args.xSpeed),t.args.ySpeed-=4,r.carrying.delete(c(t)),t.args.falling=!0,t.args.float=0}}),t}return e=l,(r=[{key:"lift",value:function(t){this.carriedBy!==t?this.carriedBy=t:this.carriedBy=null}},{key:"solid",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),l}();t.EggShellBottom=l}),require.register("actor/EggShellTop.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.EggShellTop=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(l,i.PointActor);var e,r,n,u=s(l);function l(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=u.call.apply(u,[this].concat(r))).args.type="actor-item actor-egg-shell-top",t.args.width=15,t.args.height=20,t.bindTo("carriedBy",function(e){if(t.cX&&(t.cX(),t.cX=null),t.cY&&(t.cY(),t.cY=null),e)t.cX=e.args.bindTo("x",function(r){return t.args.x=r+12*e.args.direction}),t.cY=e.args.bindTo("y",function(e){return t.args.y=e+-12}),e.carrying.add(c(t)),t.args.float=-1;else if(t.carriedBy){var r=t.carriedBy;t.carriedBy=null,t.args.xSpeed=r.args.xSpeed,t.args.ySpeed=r.args.ySpeed,t.args.xSpeed+=4*Math.sign(r.args.gSpeed||r.args.xSpeed),t.args.ySpeed-=4,r.carrying.delete(c(t)),t.args.falling=!0,t.args.float=0}}),t}return e=l,(r=[{key:"lift",value:function(t){this.carriedBy!==t?this.carriedBy=t:this.carriedBy=null}},{key:"solid",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),l}();t.EggShellTop=l}),require.register("actor/EggShuttle.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.EggShuttle=void 0;var i=e("curvature/base/Tag"),o=e("./Vehicle");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,o.Vehicle);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-vehicle actor-egg-shuttle",t.args.accel=.15,t.args.decel=.8,t.args.gSpeedMax=15,t.args.xSpeedMax=15,t.args.ySpeedMax=15,t.args.jumpForce=3,t.args.gravity=.6,t.args.width=96,t.args.height=308,t.args.yMargin=42,t.args.falling=!0,t.args.flying=!0,t.args.float=-1,t.args.seatHeight=t.args.height-40,t.args.seatForward=-16,t.args.seatAngle=Math.PI/2,t.args.thrustAngle=-Math.PI/2,t.args.bindTo("boosting",function(e){t.boost&&t.boost.setAttribute("data-active",!!e)}),t.args.crashAngle=0,t.args.bindTo("falling",function(e){Math.abs(t.args.groundAngle)<Math.PI/4||(t.args.crashAngle=t.args.groundAngle)}),t}return e=h,(r=[{key:"onRendered",value:function(t){s(l(h.prototype),"onRendered",this).call(this,t),this.autoStyle.get(this.box)["--crash-angle"]="crashAngle"}},{key:"updateStart",value:function(){s(l(h.prototype),"updateStart",this).call(this),this.args.falling&&(this.args.groundAngle=-(this.args.thrustAngle+Math.PI/2))}},{key:"updateEnd",value:function(){if(s(l(h.prototype),"updateEnd",this).call(this),this.args.falling||(this.args.groundAngle=0),this.args.crashAngle&&(this.args.groundAngle=this.args.crashAngle,this.occupant)){var t=this.occupant;t.args.standingOn=!1,t.args.falling=!0,t.args.xSpeed=2*Math.sign(this.xSpeedLast),t.args.ySpeed=-12,t.args.y+=-12}}},{key:"update",value:function(){this.sprite&&!this.windshield&&(this.windshield=new i.Tag('<div class = "shuttle-windshield">'),this.boost=new i.Tag('<div class = "shuttle-boost">'),this.sprite.appendChild(this.windshield.node),this.sprite.appendChild(this.boost.node)),this.occupant?(this.args.type="actor-item actor-vehicle actor-egg-shuttle actor-egg-shuttle-occupied",this.args.float=1):(this.args.type="actor-item actor-vehicle actor-egg-shuttle",this.args.float=0),this.args.gSpeed=0,this.args.facing="right",s(l(h.prototype),"update",this).call(this),this.args.falling?(this.args.cameraMode="rocket",this.args.thrustAngle+=.02*this.xAxis,this.args.thrustAngle<7*-Math.PI/8&&(this.args.thrustAngle=7*-Math.PI/8),this.args.thrustAngle>1*-Math.PI/8&&(this.args.thrustAngle=1*-Math.PI/8)):(this.args.cameraMode="normal",this.args.cameraBias=0,this.args.boosting=!1,this.args.thrustAngle=-Math.PI/2)}},{key:"processInputDirect",value:function(){}},{key:"command_0",value:function(t){}},{key:"release_0",value:function(t){this.args.boosting=!1}},{key:"hold_0",value:function(t){if(this.args.x+=this.viewport.args.frameId%2?-1:1,this.args.falling||!(t.time<60)){this.args.falling=!0;var e=this.args.gravity*(1+.002*Math.min(-60+t.time,150));this.args.xSpeed+=e*Math.cos(this.args.thrustAngle),this.args.ySpeed+=e*Math.sin(this.args.thrustAngle),Math.abs(this.args.xSpeed)>this.args.xSpeedMax&&(this.args.xSpeed=this.args.xSpeedMax*Math.sign(this.args.xSpeed)),Math.abs(this.args.ySpeed)>this.args.ySpeedMax&&(this.args.ySpeed=this.args.ySpeedMax*Math.sign(this.args.ySpeed)),this.args.boosting=!0}}},{key:"collideA",value:function(t,e){if(this.args.crashAngle)return!1;s(l(h.prototype),"collideA",this).call(this,t,e)}},{key:"solid",get:function(){return!this.args.crashAngle&&!this.occupant}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.EggShuttle=f}),require.register("actor/EggWalker.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.EggWalker=void 0;var i=e("./Vehicle"),o=e("./Projectile"),a=e("curvature/base/Tag");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return f(t)}(this,r)}}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(g,i.Vehicle);var e,r,n,p=l(g);function g(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=p.call.apply(p,[this].concat(o)),e=f(t),n=[],(r="instructions")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="actor-item actor-egg-walker",t.args.width=32,t.args.height=64,t.args.weight=1500,t.removeTimer=null,t.args.gSpeedMax=2.5,t.args.decel=.05,t.args.accel=.1,t.args.seatHeight=48,t.args.jumpForce=12,t.args.skidTraction=.9,t.dustCount=0,t.args.particleScale=2,t.args.bindTo("falling",function(e){e||!t.crouching||t.ySpeedLast<8||(t.viewport.args.shakeY=7)}),t}return e=g,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.backSprite=new a.Tag('<div class = "sprite-back sprite">'),this.body=new a.Tag('<div class = "egg-walker-body">'),this.sprite.appendChild(this.body.node),this.punch=new a.Tag('<div class = "egg-walker-punch">'),this.sprite.appendChild(this.punch.node),this.legFront=new a.Tag('<div class = "egg-walker-leg">'),this.sprite.appendChild(this.legFront.node),this.boostFront=new a.Tag('<div class = "egg-boost">'),this.legFront.appendChild(this.boostFront.node),this.legBack=new a.Tag('<div class = "egg-walker-leg egg-walker-leg-back">'),this.backSprite.appendChild(this.legBack.node),this.boostBack=new a.Tag('<div class = "egg-boost">'),this.legBack.appendChild(this.boostBack.node),this.chair=new a.Tag('<div class = "egg-walker-chair">'),this.backSprite.appendChild(this.chair.node),this.gun=new a.Tag('<div class = "egg-walker-gun">'),this.backSprite.appendChild(this.gun.node),this.box.appendChild(this.backSprite.node)}},{key:"update",value:function(){c(h(g.prototype),"update",this).call(this),this.boosting?(this.args.type="actor-item actor-egg-walker egg-walker-boosting",this.args.ySpeed>0&&(this.args.ySpeed-=(Math.sin(this.viewport.args.frameId/10)+.9)/2*1.25+.5)):this.args.type="actor-item actor-egg-walker",this.boosting=!1,this.yAxis>.55&&(!this.xAxis||this.falling&&this.args.ySpeed>0)?(this.crouching&&(this.args.y+=.001,this.args.y-=.001),this.args.falling&&!this.crouching&&(this.args.ySpeed+=4),this.args.gSpeed=0,this.args.animation="crouching",this.crouching=!0,this.args.seatHeight=30,this.args.height=48):(this.crouching||(this.args.y+=.001,this.args.y-=.001),this.crouching=!1,this.args.seatHeight=48,this.args.height=64,this.args.falling?this.args.animation="falling":Math.sign(this.args.gSpeed)===this.args.direction?this.args.animation="walking":this.args.animation="standing")}},{key:"hold_0",value:function(){!this.args.falling&&this.args.ySpeed<0||this.checkBelow(this.x,this.y+1)||this.yAxis>.55||(this.boosting=!0)}},{key:"hold_2",value:function(){var t=this;if(!this.shooting){var e,r,n,i=Math.sign(this.args.direction),a=this.args.groundAngle;switch(this.args.mode){case 0:n=-a-Math.PI/2+Math.PI/4*i,r=-a;break;case 1:n=-a+Math.PI/4*i,r=-a+Math.PI/2;break;case 2:n=-a+Math.PI/2+Math.PI/4*i,r=-a-Math.PI;break;case 3:n=-a-Math.PI+Math.PI/4*i,r=-a-Math.PI/2}e=[32*Math.cos(n),120*Math.sin(n)];var s=new o.Projectile({direction:this.args.direction,x:this.args.x+e[0]+(this.args.xSpeed||this.args.gSpeed),y:this.args.y+e[1]-(this.crouching?-20:0),owner:this,xSpeed:this.args.xSpeed||this.args.gSpeed,float:10});s.impulse(8,r+(i<0?Math.PI:0),!0),s.update(),this.viewport.auras.add(s),this.viewport.spawn.add({object:s}),this.box.setAttribute("data-shoot","true"),this.shooting=!0,this.viewport.onFrameOut(1,function(){t.box.setAttribute("data-shoot","false")}),this.viewport.onFrameOut(6,function(){t.shooting=!1})}}},{key:"command_0",value:function(){this.crouching||c(h(g.prototype),"command_0",this).call(this)}},{key:"command_1",value:function(){var t=this;this.punching||(this.box.setAttribute("data-punch","true"),this.punching=!0,this.viewport.onFrameOut(12,function(){t.box.setAttribute("data-punch","false")}),this.viewport.onFrameOut(25,function(){t.punching=!1}))}},{key:"solid",get:function(){return!this.occupant}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),g}();t.EggWalker=p}),require.register("actor/Eggman.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Eggman=void 0;var i=e("./PointActor"),o=(e("curvature/base/Tag"),e("../behavior/SkidDust"));function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(h,i.PointActor);var e,r,n,f=c(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).behaviors.add(new o.SkidDust),t.args.type="actor-item actor-eggman",t.accelNormal=.15,t.accelSuper=.3,t.args.weight=200,t.args.accel=.15,t.args.decel=.3,t.args.normalHeight=40,t.args.rollingHeight=28,t.gSpeedMaxNormal=18,t.gSpeedMaxSuper=28,t.args.gSpeedMax=t.gSpeedMaxNormal,t.args.normalHeight=57,t.args.rollingHeight=29,t.jumpForceNormal=11,t.jumpForceSuper=18,t.args.jumpForce=t.jumpForceNormal,t.args.gravity=.5,t.args.width=18,t.args.height=57,t.args.lookingUp=!1,t.args.spriteSheet=t.spriteSheet="/Sonic/eggman.png",t.superSpriteSheet="/Sonic/eggman-super.png",t}return e=h,n=[{key:"fromDef",value:function(t){var e=u(l(h),"fromDef",this).call(this,t);return e.args.name="Robotnik",e}}],(r=[{key:"onAttached",value:function(){this.box=this.findTag("div")}},{key:"update",value:function(){var t=this.args.falling;if(this.box){this.yAxis>.5&&!this.args.ignore?(this.args.crouching=!0,this.args.lookTime--,this.args.lookTime<-45&&(this.args.cameraBias=-.5)):this.yAxis<-.5&&!this.args.ignore?(this.args.lookingUp=!0,this.args.lookTime++,this.args.lookTime>45&&(this.args.cameraBias=.25)):this.args.lookingUp=this.args.crouching=!1;var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;t?(this.args.jumping&&this.box.setAttribute("data-animation","jumping"),this.args.height=this.args.rollingHeight):this.args.rolling?(this.args.height=this.args.rollingHeight,this.args.direction!==Math.sign(this.args.gSpeed)&&(this.args.direction=Math.sign(this.args.gSpeed),this.args.direction<0?this.args.facing="left":this.args.facing="right"),this.box.setAttribute("data-animation","rolling")):(this.args.height=this.args.normalHeight,Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?this.box.setAttribute("data-animation","skidding"):n>i/2?this.box.setAttribute("data-animation","running"):this.args.moving&&r?this.box.setAttribute("data-animation","walking"):this.args.lookingUp?this.box.setAttribute("data-animation","lookingUp"):this.args.crouching||this.args.standingOn&&this.args.standingOn.isVehicle?this.box.setAttribute("data-animation","crouching"):this.box.setAttribute("data-animation","standing")),this.args.grinding&&(this.args.rolling=!1,this.args.animation="grinding"),this.args.hangingFrom&&(this.args.animation="hanging"),u(l(h.prototype),"update",this).call(this)}else u(l(h.prototype),"update",this).call(this)}},{key:"command_3",value:function(){var t=this;this.isSuper=!this.isSuper,this.onTimeout(150,function(){0===t.args.rings&&t.setProfile()}),this.setProfile()}},{key:"setProfile",value:function(){this.isSuper?(this.args.spriteSheet=this.superSpriteSheet,this.args.gSpeedMax=this.gSpeedMaxSuper,this.args.jumpForce=this.jumpForceSuper,this.args.accel=this.accelSuper):(this.args.spriteSheet=this.spriteSheet,this.args.gSpeedMax=this.gSpeedMaxNormal,this.args.jumpForce=this.jumpForceNormal,this.args.accel=this.accelNormal)}},{key:"solid",get:function(){return!1}},{key:"canRoll",get:function(){return!0}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.Eggman=f}),require.register("actor/Eggrobo.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Eggrobo=void 0;var i=e("./PointActor"),o=e("./Projectile"),a=e("curvature/base/Tag"),s=e("../behavior/SkidDust"),c=e("../audio/Sfx");function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(d,i.PointActor);var e,r,n,g=h(d);function d(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=g.call.apply(g,[this].concat(r))).behaviors.add(new s.SkidDust),t.args.type="actor-item actor-eggrobo",t.args.accel=.125,t.args.decel=.3,t.args.gSpeedMax=14,t.args.jumpForce=11,t.args.gravity=.5,t.args.width=18,t.args.height=57,t}return e=d,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.flame=new a.Tag('<div class = "eggrobo-flame">'),this.muzzleFlash=new a.Tag('<div class = "eggrobo-muzzle-flash">'),this.sprite.appendChild(this.flame.node),this.sprite.appendChild(this.muzzleFlash.node)}},{key:"update",value:function(){var t=this.args.falling;if(this.viewport.args.audio&&!this.shootingSample&&(this.thrusterSound=new Audio("/Sonic/mecha-sonic-thruster.wav"),this.thrusterSound.loop=!0),this.thrusterSound&&(this.thrusterSound.currentTime>.4+Math.random()/10&&(this.thrusterSound.currentTime=.05),this.thrusterSound.volume=.2+-.05*Math.random()),this.box){if(t)this.args.crouching=!1,this.args.jumping&&this.box.setAttribute("data-animation","jumping");else{this.yAxis>0?this.args.crouching=!0:this.args.crouching=!1;var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?(this.thrusterSound&&this.thrusterSound.pause(),this.box.setAttribute("data-animation","skidding")):n>i/2?(this.thrusterSound&&this.thrusterSound.pause(),this.box.setAttribute("data-animation","running")):this.args.moving&&r?this.box.setAttribute("data-animation","walking"):this.args.crouching||this.standingOn&&this.standingOn.isVehicle?this.box.setAttribute("data-animation","crouching"):this.box.setAttribute("data-animation","standing")}this.args.falling||(this.args.flying=!1),this.args.flying?this.box.setAttribute("data-animation","flying"):this.args.falling&&this.box.setAttribute("data-animation","jumping"),this.args.shotCoolDown>0&&this.args.shotCoolDown--,0==this.args.rocketCoolDown&&this.thrusterSound&&this.thrusterSound.pause(),this.args.rocketCoolDown>0&&this.args.rocketCoolDown--,0==this.args.rocketCoolDown&&(this.args.flying=!1),l(p(d.prototype),"update",this).call(this)}else l(p(d.prototype),"update",this).call(this)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"hold_0",value:function(){this.args.falling?(this.args.ySpeed>1||this.args.flying)&&(this.args.flying=!0,this.args.rocketCoolDown<=1&&(this.thrusterSound&&this.thrusterSound.play(),this.args.rocketCoolDown=3),this.args.ySpeed=.999*this.args.ySpeed,this.args.float=3):this.args.rocketCoolDown=5}},{key:"hold_2",value:function(){var t=this;if(!(this.args.shotCoolDown>0)){var e,r,n,i=Math.sign(this.args.direction),a=this.args.groundAngle;switch(this.args.mode){case 0:n=-a-Math.PI/2+Math.PI/4*i,r=-a;break;case 1:n=-a+Math.PI/4*i,r=-a+Math.PI/2;break;case 2:n=-a+Math.PI/2+Math.PI/4*i,r=-a-Math.PI;break;case 3:n=-a-Math.PI+Math.PI/4*i,r=-a-Math.PI/2}e=[50*Math.cos(n),50*Math.sin(n)],(this.args.falling||this.args.crouching)&&(r=0,e=[26*i,-26]);var s=new o.Projectile({direction:this.args.direction,x:this.args.x+e[0]+(this.args.xSpeed||this.args.gSpeed),y:this.args.y+e[1],owner:this,xSpeed:this.args.xSpeed||this.args.gSpeed,YSpeed:this.args.YSpeed});s.impulse(20,r+(i<0?Math.PI:0),!0),s.update(),this.viewport.auras.add(s),this.viewport.spawn.add({object:s}),this.box.setAttribute("data-shooting","true"),this.onTimeout(140,function(){t.box.setAttribute("data-shooting","false")}),c.Sfx.play("SHOT_FIRED"),this.args.shotCoolDown=4}}},{key:"canFly",get:function(){return!0}},{key:"controllable",get:function(){return!0}}])&&u(e.prototype,r),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),d}();t.Eggrobo=g}),require.register("actor/Emerald.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Emerald=void 0;var i=e("./PointActor"),o=e("../audio/Sfx");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-emerald emerald-"+(t.args.color||"white"),t.args.width=12,t.args.height=12,t}return e=h,(r=[{key:"update",value:function(){s(l(h.prototype),"update",this).call(this);this.viewport}},{key:"collideA",value:function(t){s(l(h.prototype),"collideA",this).call(this,t),this.args.gone||(this.args.type="actor-item actor-emerald collected emerald-"+(this.args.color||"white"),this.args.gone||(o.Sfx.play("EMERALD_COLLECTED"),this.args.type="actor-item actor-emerald collected gone emerald-"+(this.args.color||"white"),t.args.owner?t.args.owner.args.emeralds+=1:t.occupant?t.occupant.args.emeralds+=1:t.args.emeralds+=1,this.viewport.args.emeralds.includes(this.args.color)||this.viewport.args.emeralds.push(this.args.color),this.viewport.actors.remove(this),this.remove()),this.args.gone=!0)}},{key:"solid",get:function(){return!1}},{key:"effect",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.Emerald=f}),require.register("actor/Explosion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Explosion=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(h,i.PointActor);var e,r,n,f=c(h);function h(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=f.call.apply(f,[this].concat(o)),e=u(t),n=-1,(r="float")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="actor-item actor-explosion",t.args.width=48,t.args.height=48,t.removeTimer=null,t}return e=h,(r=[{key:"update",value:function(){if(a(l(h.prototype),"update",this).call(this),!this.removeTimer){this.viewport;this.removeTimer=this.onTimeout(360,function(){})}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.Explosion=f}),require.register("actor/FakeEmerald.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.FakeEmerald=void 0;var i=e("./BreakableBlock");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.BreakableBlock);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.width=64,t.args.height=34,t.args.type="actor-item actor-breakable-block actor-fake-emerald",t.args.z=128,t.args.float=-1,t.breakable=!1,t}return e=f,(r=[{key:"updateStart",value:function(){}},{key:"update",value:function(){a(u(f.prototype),"update",this).call(this),this.switch&&this.switch.args.active&&(this.breakable=!0)}},{key:"collideA",value:function(t,e){return!!this.breakable&&a(u(f.prototype),"collideA",this).call(this,t,e)}},{key:"solid",get:function(){return this.breakable}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.FakeEmerald=l}),require.register("actor/Flickie.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Flickie=void 0;var i=e("./Follower");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Follower);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.type="actor-item actor-flickie",r.args.palletShift=Math.floor(8*Math.random()),r}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.Flickie=u}),require.register("actor/Flipper.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Flipper=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(t,e){var r,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=c.call(this,t,e)).args.width=64,n.args.height=48,n.noClip=!0,n.args.float=-1,n.args.direction=n.args.direction||1,n.args.power=null!==(r=n.args.power)&&void 0!==r?r:12,n.args.type="actor-item actor-flipper",n.args.bindTo("direction",function(t){return n.args.type=t<0?"actor-item actor-flipper actor-flipper-right":"actor-item actor-flipper actor-flipper-left"}),n.flipped=new WeakSet,n}return e=u,(r=[{key:"collideA",value:function(t,e){var r=this;if(!(t.y<=this.y-this.args.height||this.flipped.has(t))){var n=this.x-this.args.direction*this.args.width;if(t.args.rolling=!0,t.willJump=!1,t.buttons[0]&&1===t.buttons[0].time){var i=this.roundAngle(-t.args.groundAngle+-Math.PI/2,16,!0);this.args.animation="flipping",t.args.xSpeed=0,t.args.ySpeed=0,t.args.gSpeed=0;var o=(t.x-n)/this.args.width*.5*this.args.direction;return t.impulse(this.args.power*o,i,!0),this.viewport.onFrameOut(3,function(){return r.args.animation="unflipping"}),t.args.jumping=!1,t.args.falling=!0,this.flipped.add(t),this.viewport.onFrameOut(1,function(){return t.willJump=!1}),this.viewport.onFrameOut(3,function(){return t.args.jumping=!1}),void this.viewport.onFrameOut(5,function(){return r.flipped.delete(t)})}Math.abs(t.args.gSpeed)<3?t.args.gSpeed=Math.min(2,Math.abs(t.args.gSpeed)||1)*Math.sign(t.args.gSpeed||this.args.direction):t.args.gSpeed*=.5}}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.Flipper=u}),require.register("actor/Follower.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Follower=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(h,i.PointActor);var e,r,n,f=c(h);function h(t,e){var r,n,i,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),r=f.call(this,t,e),n=u(r),o=1,(i="noClip")in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,r.args.type="actor-item actor-follower",r.args.float=-1,r.args.width=16,r.args.height=16,r.stopSwapZ=0,r.args.z=-1,r}return e=h,(r=[{key:"update",value:function(){a(l(h.prototype),"update",this).call(this),this.stopSwapZ>0&&this.stopSwapZ--,this.args.standingOn=!1;var t=this.viewport.controlActor;if(t){this.args.falling=!0,this.args.float=-1;var e=Math.random(),r=Math.random(),n=t.x+-this.x,i=t.y+-this.y,o=Math.atan2(i,n),s=Math.sqrt(Math.pow(i,2)+Math.pow(n,2)),c=1.1*Math.max(Math.abs(t.args.gSpeed),Math.abs(t.args.xSpeed),Math.abs(t.args.ySpeed),1),u=this.args.xSpeed-(t.args.xSpeed||t.args.gSpeed),f=c+3,p=null;s<64?(Math.abs(this.args.xSpeed)<1&&(this.args.xSpeed=1*Math.sign(-.5+Math.random())),Math.abs(this.args.ySpeed)<1&&(this.args.ySpeed=1*Math.sign(-.5+Math.random()))):s>=256&&(this.args.x=Math.floor(t.x-256*Math.cos(o)),this.args.y=Math.floor(t.y-256*Math.sin(o)),this.args.xSpeed=n/60+(t.args.xSpeed||t.args.gSpeed),this.args.ySpeed=0,this.viewport.setColCell(this),p=this.x>t.x?"left":"right",f*=4);var g=Math.sign(n),d=Math.sign(i),y=Math.sign(this.args.xSpeed)===g,b=this.args.ySpeed&&Math.sign(this.args.ySpeed)===d,v=.35*Math.max(e)*(y?.85:.55),m=.1*Math.max(e)*(y?.75:1.5);if(!y||Math.abs(this.args.xSpeed)<f){var w=v*g*r,S=this.args.xSpeed+w;if(Math.abs(this.args.xSpeed)>f&&(S=f*Math.sign(this.args.xSpeed)),this.args.xSpeed=S,s>=256){var O=t.args.xSpeed||t.args.gSpeed,j=t.args.ySpeed;p&&(this.args.xSpeed=n/90+O,this.args.ySpeed=i/90+j)}}if(!p&&this.args.xSpeed<0?p="left":p||(p="right"),!b||Math.abs(this.args.ySpeed)<f){var k=this.args.ySpeed+m*d;Math.abs(this.args.ySpeed)>f&&(k=f*Math.sign(this.args.ySpeed)),this.args.ySpeed=k}if(Math.sign(u)&&Math.sign(t.args.xSpeed||t.args.gSpeed)!==Math.sign(u)&&0===this.stopSwapZ&&(Math.abs(this.x-t.x)>64||Math.abs(this.y-t.y)>64)&&(this.args.z=this.args.z>-1e3?-1e5:1e5,this.stopSwapZ=30),p&&(this.args.facing=p),this.args.ySpeed>0){if(this.args.ySpeed<=0||c<1.5)return;this.box&&(this.box.classList.add("decending"),this.box.classList.remove("ascending"))}else this.box&&(this.box.classList.remove("decending"),this.box.classList.add("ascending"))}}},{key:"solid",get:function(){return!1}},{key:"isGhost",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.Follower=f}),require.register("actor/Fountain.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Fountain=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.width=72,t.args.height=120,t.args.float=-1,t.args.type="actor-item actor-fountain",t}return e=u,(r=[{key:"collideA",value:function(t){t.controllable&&t.args.falling&&(t.y>this.y+.5*-this.args.height&&(t.args.x=this.x),t.args.ySpeed>0&&(t.args.ySpeed*=.75),t.args.ySpeed>-20&&Math.abs(this.x-t.x)<8&&(t.args.ySpeed-=.6))}},{key:"solid",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.Fountain=u}),require.register("actor/GohlaBall.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.GohlaBall=void 0;e("./Flickie");var i=e("curvature/base/Mixin"),o=(e("curvature/base/Tag"),e("./PointActor")),a=e("../behavior/SkidDust"),s=e("../mixin/CanPop");e("../actor/Explosion"),e("../actor/Projectile");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(h,i.Mixin.from(o.PointActor,s.CanPop));var e,r,n,f=l(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).behaviors.add(new a.SkidDust),t.args.type="actor-item actor-gohla-ball",t.args.animation="standing",t.args.accel=.1,t.args.decel=.5,t.args.gSpeedMax=5,t.args.jumpForce=5,t.args.gravity=.5,t.args.width=16,t.args.height=16,t.willStick=!1,t.stayStuck=!1,t}return e=h,(r=[{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}}])&&c(e.prototype,r),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.GohlaBall=h}),require.register("actor/GrapplePoint.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.GrapplePoint=void 0;var i=e("./PointActor"),o=(e("curvature/base/Tag"),e("./Spring")),a=e("curvature/base/Mixin"),s=e("../mixin/Constrainable");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(g,a.Mixin.from(i.PointActor,s.Constrainable));var e,r,n,p=f(g);function g(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=p.call.apply(p,[this].concat(r))).args.width=22,t.args.height=32,t.args.type="actor-item actor-grapple-point",t.ignoreOthers=new Set,t.args.gravity=.6,t.noClip=!0,t[o.Spring.WontSpring]=!0,t}return e=g,(r=[{key:"updateEnd",value:function(){u(h(g.prototype),"update",this).call(this);var t=this.args._tiedTo;t?this.setPos():this.noClip=!0,t||this.unhook(),this.args.falling=!0,this.hooked&&(this.hooked.xAxis&&this.args.ySpeed>0&&(Math.sign(this.args.xSpeed)||Math.sign(this.args.xSpeed)===Math.sign(this.hooked.xAxis))&&(this.y>t.y?this.args.xSpeed+=.25*this.hooked.xAxis:this.args.xSpeed-=.25*this.hooked.xAxis),this.hooked.args.x=this.x,this.hooked.args.y=this.y+this.hooked.args.height+-5,this.hooked.args.xSpeed=0,this.hooked.args.ySpeed=0,this.hooked.args.groundAngle=0,this.hooked.xAxis>0?(this.hooked.args.facing="right",this.hooked.args.direction=1):this.hooked.xAxis<0&&(this.hooked.args.facing="left",this.hooked.args.direction=-1),this.hooked.args.cameraMode="hooked"),u(h(g.prototype),"updateEnd",this).call(this)}},{key:"update",value:function(){}},{key:"collideB",value:function(t){var e=this,r=this.args._tiedTo;if(!r||r.noClip)return!1;if(!t.args.hangingFrom&&!this.ignoreOthers.has(t)){if(this.args.ignore)return!1;if(!(Math.abs(t.y-this.y)>8||!t.controllable||this.hooked)&&(t.args.falling=!0,this.hooked=t,this.viewport.auras.add(this),this.args.xSpeed=t.args.xSpeed||t.args.gSpeed,this.args.ySpeed=t.args.ySpeed,t.args.xSpeed=0,t.args.ySpeed=0,t.args.gSpeed=0,t.args.ignore=-4,t.args.float=-1,t.xLast=t.x,t.yLast=t.y,t.args.x=this.x,t.args.y=this.y+t.args.height,t.args.hangingFrom=this,t.args.jumping=!1,this.args._tiedTo)){var n=this.args._tiedTo;n.dispatchEvent(new CustomEvent("hooked"),{detail:{hook:this,subject:t}}),n.activate&&n.activate();var i=function(){e.viewport&&e.hooked&&(e.unhook(),n.explode&&(e.hooked&&(e.hooked.args.gSpeed=0),n.explode(),e.args.x=e.def.get("x"),e.args.y=e.def.get("y"),e.viewport.setColCell(e)))};n.args.flightTime&&this.viewport.onFrameOut(n.args.flightTime,i),n.onRemove(i),n.addEventListener("exploded",i)}}}},{key:"unhook",value:function(){var t=this,e=this.hooked;if(this.hooked=null,e){var r=this.args._tiedTo;e.args.ignore=e.args.float=0,e.args.y++,e.args.xSpeed+=r.xSpeedLast||this.xSpeedLast||0,e.args.ySpeed+=r.ySpeedLast||this.ySpeedLast||0,e.args.groundAngle=0,e.args.hangingFrom=null,this.ignoreOthers.add(e),e.args.falling=!0,e.args.jumping=!0;var n=this.viewport;n.onFrameOut(15,function(){t.ignoreOthers.delete(e),n.auras.delete(t)})}}}])&&c(e.prototype,r),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),g}();t.GrapplePoint=p}),require.register("actor/GuardBot.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.GuardBot=void 0;e("./Flickie");var i=e("curvature/base/Mixin"),o=(e("curvature/base/Tag"),e("./PointActor")),a=e("../behavior/SkidDust"),s=e("../mixin/CanPop");e("../actor/Explosion"),e("../actor/Projectile");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(h,i.Mixin.from(o.PointActor,s.CanPop));var e,r,n,f=l(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).behaviors.add(new a.SkidDust),t.args.type="actor-item actor-guard-bot",t.args.animation="standing",t.args.accel=.1,t.args.decel=.5,t.args.gSpeedMax=5,t.args.jumpForce=5,t.args.gravity=.5,t.args.width=24,t.args.height=24,t.args.static=!0,t.willStick=!1,t.stayStuck=!1,t}return e=h,(r=[{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}}])&&c(e.prototype,r),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.GuardBot=h}),require.register("actor/HeavyDutySwitch.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.HeavyDutySwitch=void 0;var i=e("./Switch");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Switch);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.type="actor-item actor-switch actor-heavy-duty-switch",t.args.height=t.height=19,t}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.HeavyDutySwitch=u}),require.register("actor/HtmlFrame.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.HtmlFrame=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(h,i.PointActor);var e,r,n,f=c(h);function h(){var t,e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(e=f.call(this,r,n)).args.yForce=0,e.args.yLean=0,e.args.type="actor-item actor-html-frame",e.args.width=r.width||32,e.args.height=r.height||32,e.originalX=e.args.x,e.originalY=e.args.y,e.args.z=-1e3,e.args.static=!0,e.args.gravity=.5,e.args.collapse=null!==(t=r.collapse)&&void 0!==t&&t,e.args.url="https://www.youtube.com/embed/pxIofYrt0kE?controls=0&autoplay=1",e}return e=h,n=[{key:"fromDef",value:function(t){var e=u(l(h),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.height=t.height,e.args.tileId=t.gid,e.args.y=e.originalY=t.y,e}}],(r=[{key:"onRendered",value:function(t){var e=this;u(l(h.prototype),"onRendered",this).call(this,t),this.droop(0),this.screen||(this.screen=new o.Tag('<iframe width="560" height="315" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>'),this.sprite.appendChild(this.screen.node),this.screen.style({"pointer-events":"initial"}),this.args.spriteSheet=this.args.spriteSheet||"/Sonic/marble-zone-block.png",this.args.bindTo("url",function(t){return e.screen.src=t}),this.args.bindTo("html",function(t){return e.screen.srcDoc=t}))}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.HtmlFrame=f}),require.register("actor/Knuckles.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Knuckles=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag"),a=e("./KnuxBomb"),s=e("./Spring"),c=e("../behavior/SkidDust");function u(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=y(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=y(t);if(e){var o=y(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return d(t)}(this,r)}}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}(b,i.PointActor);var e,r,n,l=g(b);function b(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b),(r=l.call(this,t,e)).args.canonical="Knuckles",window.knuckles=d(r),r.behaviors.add(new c.SkidDust),r.args.type="actor-item actor-knuckles",r.jumpForceNormal=9.5,r.jumpForceSuper=10,r.accelNormal=.15,r.accelSuper=.22,r.args.accel=r.accelNormal,r.args.decel=.4,r.args.weight=150,r.args.gSpeedMax=18,r.args.jumpForce=r.jumpForceNormal,r.args.gravity=.5,r.args.punchCharge=0,r.args.width=15,r.args.height=41,r.args.normalHeight=41,r.args.rollingHeight=28,r.punchTime=0,r.punched=0,r.beforePunch="standing",r.bombsDropped=0,r.sparks=new Set,r.args.bindTo("falling",function(t){!t&&r.args.flying&&(1!==r.args.mode&&2!==r.args.mode&&3!==r.args.mode||(r.args.climbing=!0,r.args.gSpeed=0,r.args.xSpeed=0,r.args.ySpeed=0))}),r}return e=b,(r=[{key:"onAttached",value:function(){var t=this;this.box=this.findTag("div"),this.punchAura=new o.Tag('<div class = "punch-aura">'),this.punchAura.style({display:"none"}),this.sprite.appendChild(this.punchAura.node),this.args.bindTo("animation",function(e){return t.box.setAttribute("data-animation",e)})}},{key:"update",value:function(){var t=this,e=this.args.falling,r=this.args.gSpeed;if(this.box){if(this.throwing&&Date.now()-this.throwing>320){this.throwing=!1,this.holdBomb=!1;var n=new a.KnuxBomb({x:this.args.x,y:this.args.y-16,owner:this,xSpeed:10*this.args.direction+(2*Math.random()-1),ySpeed:-2*Math.random()});this.viewport.spawn.add({object:n})}if(this.readying=!1,!this.args.falling&&this.punchTime&&Date.now()-this.punchTime>(this.willPunch?1536:384)&&(this.punchMomentum=0,this.punchTime=!1,this.willPunch=!1,this.punching=!1,this.punched=0),this.punchTime&&Date.now()-this.punchTime>256&&(this.readying=!0),this.punchTime&&Date.now()-this.punchTime>128&&(this.punching=!0),this.punching&&(this.args.rolling=!1),this.punched&&Math.abs(this.args.gSpeed)>5&&!this.auraVisible&&(this.punched>=3||Math.abs(this.args.gSpeed)>15)&&(this.auraVisible=!0,this.viewport.onFrameOut(6,function(){t.punchAura.style({display:"none"}),t.auraVisible=!1}),this.punchAura.style({display:"initial"})),this.willPunch?(this.args.punchCharge<10&&(this.args.punchCharge+=1),this.punchMomentum=Math.sign(this.punchMomentum)*Math.max(Math.abs(this.punchMomentum),this.args.punchCharge*(.3*Math.min(this.punched,3)))):!this.punched&&this.args.punchCharge>4?this.args.punchCharge-=4:!this.punched&&this.args.punchCharge>0&&(this.args.punchCharge=0),this.willStick=!1,this.stayStuck=!1,e)this.springing&&(this.args.groundAngle=0),this.args.flying?this.args.animation="flying":this.args.jumping&&(this.willPunch||this.punching?(this.args.animation="uppercut",this.punched++,this.punchAura.style({display:"initial"}),this.auraVisible=!0,this.viewport.onFrameOut(15,function(){t.punchAura.style({display:"none"}),t.auraVisible=!1})):this.punched||(this.args.animation="jumping")),this.args.climbing&&!this.args.jumping&&(this.args.ySpeed=0,this.args.xSpeed=0,this.args.ignore=10,this.args.falling=!1,this.args.animation="walking",this.args.groundAngle=0,1===this.args.mode?this.args.x+=-4:3===this.args.mode&&(this.args.x+=4),this.args.mode=0);else{this.bombsDropped=0,this.springing=!1;var i=this.args.direction,s=this.args.gSpeed,c=Math.abs(s),l=this.args.gSpeedMax;this.args.flying&&(this.args.flying=!1,this.args.float=0),this.args.knucklesFlyCoolDown=15,this.args.flying=!1,this.args.rolling?this.args.animation="rolling":this.args.climbing?this.args.modeTime<2||0===this.yAxis?(this.args.animation="climbing",this.args.gSpeed=0):this.yAxis<0?(this.args.animation="climbing-up",Math.abs(this.args.gSpeed)<4&&(this.args.direction=1===this.args.mode?1:-1,this.args.gSpeed+=-this.args.direction)):this.yAxis>0&&(this.args.animation="climbing-down",Math.abs(this.args.gSpeed)<4&&(this.args.direction=1===this.args.mode?1:-1,this.args.gSpeed+=this.args.direction)):Math.sign(this.args.gSpeed)!==i&&Math.abs(this.args.gSpeed-i)>5?this.args.animation="skidding":this.holdBomb?this.args.animation="hold-bomb":this.throwing?this.args.animation="throw-bomb":this.readying||this.willPunch?this.args.animation="readying":!this.readying&&this.punched?this.punched%2?this.args.animation="jabbing":this.args.animation="punching":c>.75*l?this.args.animation="running":this.args.moving&&this.args.gSpeed?this.args.animation="walking":this.args.animation="standing",this.args.grinding&&(this.args.rolling=!1,this.args.animation="grinding")}if(this.args.flying){if(this.yAxis>0||this.checkBelow(this.x,this.y))return void(this.args.flying=!1);this.args.ySpeed>0&&(this.args.ySpeed=0),this.args.ySpeed<1&&(this.args.ySpeed+=1),this.args.ySpeed>1&&(this.args.ySpeed-=1),this.xAxis&&(this.args.flyDirection=Math.sign(this.xAxis)),this.args.direction=Math.sign(this.args.xSpeed),this.args.direction<0?this.args.facing="left":this.args.facing="right",this.args.flyDirection&&Math.abs(this.args.xSpeed)<16&&(this.args.flyDirection!==Math.sign(this.args.xSpeed)?this.args.xSpeed+=.15625*Math.sign(this.args.flyDirection)*4:this.args.xSpeed+=.15625*Math.sign(this.args.flyDirection)),Math.abs(this.args.xSpeed)>18&&(this.args.xSpeed=18*Math.sign(this.args.xSpeed)),this.args.float=3,this.willStick=!0,this.stayStuck=!0,this.args.groundAngle=0}else(this.args.mode%2==0||this.args.groundAngle)&&(this.args.flyDirection=0);if(this.args.knucklesFlyCoolDown>0&&this.args.knucklesFlyCoolDown--,h(y(b.prototype),"update",this).call(this),this.willPunch&&!r&&(this.args.gSpeed=0),0!==this.args.mode&&2!==this.args.mode||(this.args.climbing=!1),this.args.grinding&&!this.args.falling&&this.args.gSpeed){var f=new o.Tag('<div class = "particle-sparks">'),p=new o.Tag('<div class = "envelope-sparks">');p.appendChild(f.node);var g=this.rotatePoint(1.75*-this.args.gSpeed*this.args.direction,8),d=Math.sign(this.args.gSpeed);p.style({"--x":g[0]+this.x,"--y":g[1]+this.y+-3*Math.random,"z-index":0,"animation-delay":.25*-Math.random()+"s","--xMomentum":Math.max(Math.abs(this.args.gSpeed),4)*d,"--flip":d,"--angle":this.realAngle,opacity:2*Math.random()}),p.particle=f,this.viewport.particles.add(p),this.sparks.add(p),this.viewport.onFrameOut(30,function(){t.viewport.particles.remove(p),t.sparks.delete(p)})}if(this.args.grinding&&(this.args.rolling=!1,this.args.animation="grinding"),this.args.hangingFrom&&(this.args.animation="hanging"),this.args.falling&&this.springing&&this.args.ySpeed>=0?this.args.animation="dropping":this.args.falling&&this.springing&&(this.args.animation="springdash"),this.args.standingOn&&this.args.standingOn.isVehicle&&(this.args.animation=this.args.standingOn.ridingAnimation||"standing"),this.sparks.size){var v,m=u(this.sparks);try{for(m.s();!(v=m.n()).done;){var w=v.value,S=this.rotatePoint(1.75*this.args.direction,8);w.style({opacity:2*Math.random(),"--x":S[0]+this.x,"--y":S[1]+this.y})}}catch(t){m.e(t)}finally{m.f()}}this.box.style({"--punchCharge":this.args.punchCharge})}else h(y(b.prototype),"update",this).call(this)}},{key:"doJump",value:function(t){h(y(b.prototype),"doJump",this).call(this,t),this.willPunch&&(this.punchTime=Date.now(),this.punched++)}},{key:"startle",value:function(){var t=this;h(y(b.prototype),"startle",this).call(this),this.onNextFrame(function(){return t.args.animation="startle"})}},{key:"dropBomb",value:function(){this.args.falling&&(this.args.ySpeed=-8);var t=new a.KnuxBomb({x:this.args.x,y:this.args.y-16,owner:this,xSpeed:this.args.xSpeed,ySpeed:-3});this.viewport.spawn.add({object:t})}},{key:"release_0",value:function(){h(y(b.prototype),"release_0",this).call(this)}},{key:"command_0",value:function(){this.args.hangingFrom?h(y(b.prototype),"command_0",this).call(this):(h(y(b.prototype),"command_0",this).call(this),this.args.jumping&&!this.willPunch&&this.args.falling&&(this.args.flying=!0,this.args.xSpeed=9*this.args.direction,this.args.willJump=!1))}},{key:"readyStart",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!(this.args.flying||this.args.climbing||this.args.falling)){if(this.readyButton=e,this.punchTime&&Date.now()-this.punchTime<108)return this.punchMomentum=0,this.args.ignore=16,this.willPunch=!1,this.punchTime=!1,void(this.punched=0);this.willPunch=!0;var r=Math.sign(this.xAxis||t||this.args.direction);if(this.args.direction=Math.sign(r||this.punchMomentum),this.args.facing=r<0?"left":"right",this.punchTime)return this.args.ignore=15,this.args.gSpeed=0,void(this.punchTime=!1);this.punchMomentum=Math.abs(this.punchMomentum||this.args.gSpeed||4)*Math.sign(r||this.xAxis),this.args.ignore=15,this.args.gSpeed=0}}},{key:"readyStop",value:function(t,e){if(this.readyButton===e&&!(this.args.flying||this.args.climbing||this.args.falling)){if(this.punchTime&&Date.now()-this.punchTime<64)return this.willPunch=!1,this.punchMomentum=0,void(this.punched=0);var r=Math.sign(this.xAxis||t||this.args.direction);if(r&&Math.sign(r)!==Math.sign(this.punchMomentum)?r&&(this.punchMomentum=Math.abs(this.punchMomentum)*r,this.args.gSpeed=1*(r?Math.abs(this.punchMomentum)*r:this.punchMomentum)):this.args.gSpeed=r?Math.abs(this.punchMomentum)*r:this.punchMomentum,this.args.direction=Math.sign(r||this.punchMomentum),this.args.facing=r<0?"left":"right",this.punchTime=Date.now(),this.willPunch=!1,!this.args.falling&&this.args.gSpeed){var n=new o.Tag('<div class = "particle-dust">'),i=Math.sign(this.args.gSpeed)*this.dustDist||0,a=this.rotatePoint(this.args.gSpeed,0);n.style({"--x":a[0]+i+this.x,"--y":a[1]+this.y,"z-index":0,opacity:.5*Math.pow(Math.random(),2)+.5}),viewport.particles.add(n),viewport.onFrameOut(20,function(){viewport.particles.remove(n)})}this.throwing||this.args.climbing||this.punched++}}},{key:"command_1",value:function(){this.readyStart(0,1)}},{key:"release_1",value:function(){this.readyStop(0,1)}},{key:"command_4",value:function(){this.readyStart(-1,4)}},{key:"release_4",value:function(){this.readyStop(-1,4)}},{key:"command_5",value:function(){this.readyStart(1,5)}},{key:"release_5",value:function(){this.readyStop(1,5)}},{key:"command_2",value:function(){if(!this.args.ignore&&this.args.falling&&!this.args.flying&&this.bombsDropped<3)return this.dropBomb(),void this.bombsDropped++;this.args.falling||this.args.climbing||Math.abs(this.args.gSpeed)>3||this.punchTime||this.throwing||(this.holdBomb=Date.now(),this.args.ignore=-1,this.args.gSpeed=0)}},{key:"release_2",value:function(){this.args.falling||this.args.climbing||Math.abs(this.args.gSpeed)>3||this.holdBomb&&(this.args.ignore=4,this.holdBomb=!1,this.throwing=Date.now())}},{key:"setCameraMode",value:function(){this.args.climbing?this.args.cameraMode="aerial":h(y(b.prototype),"setCameraMode",this).call(this)}},{key:"collideA",value:function(t){var e=this;t instanceof s.Spring&&this.onNextFrame(function(){e.args.falling&&(e.springing=!0,e.args.animation="springdash")})}},{key:"solid",get:function(){return!1}},{key:"canRoll",get:function(){return!this.args.climbing}},{key:"canFly",get:function(){return!0}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!this.args.npc}}])&&f(e.prototype,r),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),b}();t.Knuckles=b}),require.register("actor/KnuxBomb.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.KnuxBomb=void 0;var i=e("./PointActor"),o=(e("../actor/Explosion"),e("curvature/base/Tag"));e("../region/Region"),e("./Spring");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-knux-bomb",t.args.width=16,t.args.height=16,t.removeTimer=null,t}return e=h,(r=[{key:"update",value:function(){var t=this;this.removed||(s(l(h.prototype),"update",this).call(this),this.args.xSpeed||this.args.ySpeed||this.args.gSpeed||(this.removeTimer=this.onTimeout(250,function(){return t.explode()})),this.removeTimer||(this.removeTimer=this.onTimeout(1500,function(){return t.explode()})))}},{key:"explode",value:function(){var t=this.viewport;if(t){var e=new o.Tag('<div class = "particle-explosion">');e.style({"--x":this.x,"--y":this.y}),t.particles.add(e),setTimeout(function(){return t.particles.remove(e)},350),this.viewport.actors.remove(this),this.remove()}}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!1}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.KnuxBomb=f}),require.register("actor/LayerController.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.LayerController=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(t,e){var r,n,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(i=c.call(this,t,e)).args.activated=!1,i.args.xLayer=0,i.args.yLayer=0,i.args.xLayerSpeed=0,i.args.yLayerSpeed=0,i.args.yLayerSpeedMax=i.args.yLayerSpeedMax||9,i.args.fall=null===(r=i.args.fall)||void 0===r||r,i.args.xLayerLimit=i.args.xLayerLimit||null,i.args.yLayerLimit=i.args.yLayerLimit||null,i.args.yQuake=null!==(n=i.args.yQuake)&&void 0!==n?n:5,i.args.static=!0,i.args.hidden=!0,i}return e=u,(r=[{key:"updateStart",value:function(){if(this.viewport){this.args.activated&&this.args.fall&&(this.args.yLayerSpeed+=.25),this.args.activated&&this.args.swim&&(this.args.xLayerSpeed+=1),this.args.yLayerSpeed>this.args.yLayerSpeedMax&&this.args.yLayerSpeedMax>0&&(this.args.yLayerSpeed=this.args.yLayerSpeedMax),this.args.xLayerSpeed>this.args.xLayerSpeedMax&&this.args.xLayerSpeedMax>0&&(this.args.xLayerSpeed=this.args.xLayerSpeedMax),this.args.yLayerSpeed&&(this.args.yLayer=Math.round(this.args.yLayer+this.args.yLayerSpeed||0)),this.args.xLayerSpeed&&(this.args.xLayer=Math.round(this.args.xLayer+this.args.xLayerSpeed||0));var t=this.viewport.tileMap.mapData.tileheight,e=this.viewport.tileMap.mapData.width,r=this.viewport.tileMap.mapData.height,n=this.viewport.tileMap.meta.wrapX?1/0:e*t,i=this.viewport.tileMap.meta.wrapY?1/0:r*t;if(this.args.yLayerLimit>0&&this.args.yLayer>i&&this.args.yLayer>this.args.yLayerLimit){this.args.yLayerSpeed=0,this.args.yLayer=this.args.yLayerLimit;var o=this.viewport.actorsById[this.args.target];this.viewport.auras.delete(o),this.viewport.auras.delete(this)}if(this.args.xLayerLimit>0&&(this.args.xLayer>n||this.args.xLayer>this.args.xLayerLimit)){this.args.xLayerSpeed=0,this.args.xLayer=this.args.xLayerLimit;var a=this.viewport.actorsById[this.args.target];this.viewport.auras.delete(a),this.viewport.auras.delete(this)}}}},{key:"activate",value:function(t,e){var r,n=this;if(!this.args.activated&&(this.viewport.auras.add(this),this.viewport.args.shakeY=this.args.yQuake,this.viewport.onFrameOut(60,function(){n.args.activated=!0}),this.args.yLayerLimit=null!==(r=this.args.yLayerLimit)&&void 0!==r?r:4096,this.args.target&&this.viewport.actorsById[this.args.target])){var i=this.viewport.actorsById[this.args.target];this.viewport.auras.add(i),i.activate(t,this)}}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.LayerController=u}),require.register("actor/LayerSwitch.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.LayerSwitch=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(h,i.PointActor);var e,r,n,f=s(h);function h(){var t,e,r,n,i,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var a=arguments.length,s=new Array(a),u=0;u<a;u++)s[u]=arguments[u];return r=f.call.apply(f,[this].concat(s)),n=c(r),o=-1,(i="float")in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,r.args.type="actor-item actor-layer-switch",r.args.width=32,r.args.height=32,r.static=!0,r.args.fromLayer=null!==(t=r.args.fromLayer)&&void 0!==t?t:1,r.args.toLayer=null!==(e=r.args.toLayer)&&void 0!==e?e:2,r}return e=h,n=[{key:"fromDef",value:function(t){var e=u(l(h),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.height=t.height,e}}],(r=[{key:"onAttach",value:function(t){return t&&t.preventDefault(),!1}},{key:"collideA",value:function(t,e){var r=this,n=t.args.gSpeed||t.args.xSpeed||t.args.direction||t.xAxis,i=!!Number(this.args.back),o=!!Number(this.args.roll),a=(2===t.args.mode||t.args.mode,this.args.width/2);if(!(t.x<this.x+-a+0||t.x>this.x+a+-0||t.y<this.y+-this.args.height||t.y>this.y)){if(o&&(!t.args.rolling||t.args.height>28))return t.args.layer=s===this.args.fromLayer?this.args.toLayer:this.args.fromLayer,!1;i&&t.args.falling&&(n=t.args.xSpeed||t.args.direction,i=!i);var s=t.args.layer;n>0&&(s=i?this.args.fromLayer:this.args.toLayer),n<0&&(s=i?this.args.toLayer:this.args.fromLayer),this.viewport.tileMap.getSolid(t.x,t.y,s)?this.viewport.onFrameOut(1,function(){r.viewport.tileMap.getSolid(t.x,t.y,s)||(t.args.layer=s)}):t.args.layer=s}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.LayerSwitch=f}),require.register("actor/Magnet.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Magnet=void 0;var i=e("./PointActor"),o=e("curvature/base/Mixin"),a=e("../mixin/Constrainable");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(p,o.Mixin.from(i.PointActor,a.Constrainable));var e,r,n,h=l(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=h.call.apply(h,[this].concat(r))).args.gravity=.8,t.args.width=48,t.args.height=28,t.args.type="actor-item actor-magnet",t}return e=p,(r=[{key:"collideA",value:function(t,e){}},{key:"collideB",value:function(t){t.controllable}},{key:"update",value:function(){c(f(p.prototype),"update",this).call(this),this.setPos()}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.Magnet=h}),require.register("actor/MarbleBlock.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MarbleBlock=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-block-marble",t.args.width=32,t.args.height=32,t.args.spriteSheet=t.args.spriteSheet||"/Sonic/marble-zone-block.png",t}return e=f,(r=[{key:"collideA",value:function(t,e){if(a(u(f.prototype),"collideA",this).call(this,t,e),t.isEffect)return!1;if(!this.isPushable)return!0;var r=Math.ceil(Math.abs(t.args.gSpeed||t.args.xSpeed))*Math.sign(t.args.gSpeed||t.args.xSpeed);if(!this.args.falling&&1===e&&r<=0)return!1;if(!this.args.falling&&3===e&&r>=0)return!1;var n=this.y-this.args.height;if((1===e||3===e)&&(t.y>=this.y||t.y>n)){if(!r)return!0;if(this.args.pushed=Math.sign(t.args.gSpeed)||this.args.pushed,this.args.pushed<0&&this.getMapSolidAt(this.x-Math.ceil(this.args.width/2)-1,this.y+-1))return!0;if(this.args.pushed>0&&this.getMapSolidAt(this.x+Math.ceil(this.args.width/2)+1,this.y+-1))return!0;var i=this.viewport.tileMap,o=1===e?1:3===e&&-1,s=this.scanBottomEdge(o);if(i.getSolid(this.x+Math.ceil(this.args.width/2)*o,this.y))return!0;var c=this.args.width/2;if(o>0&&0===s)this.args.falling=!0,t.args.ignore=t.args.ignore||1,t.args.gSpeed=0;else if(o<0&&0===s)this.args.falling=!0,t.args.ignore=t.args.ignore||1,t.args.gSpeed=0;else if(!this.args.falling||s>0){var l=this.findNextStep(o),h=this.findNextStep(o+c*Math.sign(o));if((!l[1]||l[2])&&!h[3]){var p=t.args.width/2,g=this.args.width/2;if(Math.abs(this.x-t.x)<=p+g){this.args.x=t.args.x+o*(g+p);var d=Math.sign(t.args.gSpeed);Math.sign(this.x-t.x)===d&&(t.args.pushing=d);var y=this.args.weight/t.args.weight;t.args.gSpeed-=.005*y*Math.sign(t.args.gSpeed)}return 0===s}return!0}}return!(t.args.ySpeed<0)}},{key:"onAttach",value:function(){this.args.spriteSheet=this.args.spriteSheet||"/Sonic/marble-zone-block.png",this.setTile()}},{key:"isPushable",get:function(){return!0}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!0}},{key:"rotateLock",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.MarbleBlock=l}),require.register("actor/Marker.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Marker=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.type="actor-item actor-marker",t.args.width=64,t.args.height=64,t.args.float=-1,t}return e=u,(r=[{key:"solid",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.Marker=u}),require.register("actor/MechaFroggy.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MechaFroggy=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag"),a=e("../behavior/SkidDust");e("../actor/Explosion"),e("../actor/Projectile");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(p,i.PointActor);var e,r,n,h=l(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=h.call.apply(h,[this].concat(r))).behaviors.add(new a.SkidDust),t.args.type="actor-item actor-mecha-froggy",t.args.animation="standing",t.args.accel=.7,t.args.decel=.5,t.args.gSpeedMax=10,t.args.jumpForce=15,t.args.gravity=.5,t.args.width=15,t.args.height=32,t.willStick=!1,t.stayStuck=!1,t}return e=p,(r=[{key:"update",value:function(){var t=this.args.direction;this.flame||(this.flame=new o.Tag('<div class = "mecha-froggy-flame">'),this.sprite.appendChild(this.flame.node)),this.args.jumping&&!this.args.falling||(Math.sign(this.args.gSpeed)!==t&&Math.abs(this.args.gSpeed-t)>5?this.box.setAttribute("data-animation","skidding"):this.args.moving&&this.args.gSpeed&&Math.abs(this.args.gSpeed)>=10?this.box.setAttribute("data-animation","running"):this.args.moving&&this.args.gSpeed&&Math.abs(this.args.gSpeed)?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")),this.args.jumping&&this.box.setAttribute("data-animation","jumping"),c(f(p.prototype),"update",this).call(this)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.MechaFroggy=h}),require.register("actor/MechaSonic.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MechaSonic=void 0;var i=e("./PointActor"),o=(e("./Vehicle"),e("curvature/base/Tag")),a=e("../audio/Sfx"),s=e("../behavior/SkidDust");function c(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(d,i.PointActor);var e,r,n,u=p(d);function d(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=u.call.apply(u,[this].concat(r))).behaviors.add(new s.SkidDust("particle-sparks")),t.args.type="actor-item actor-mecha-sonic",t.args.accel=.1,t.args.decel=.3,t.args.skidTraction=2,t.args.gSpeedMax=18,t.args.jumpForce=11,t.args.gravity=.5,t.args.takeoffPlayed=!1,t.args.rollingHeight=28,t.args.normalHeight=44,t.args.width=18,t.args.height=t.args.normalHeight,t.args.bindTo("falling",function(e){e||t.landSound()}),t}return e=d,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite")}},{key:"update",value:function(){var t=this;if(this.sprite){var e=this.args.falling;this.args.accel=.1;var r=this.args.direction,n=this.args.gSpeed,i=Math.abs(n),s=.5*this.args.gSpeedMax;this.flame||(this.sparks=new o.Tag('<div class = "mecha-sonic-sparks">'),this.flame=new o.Tag('<div class = "mecha-sonic-flame">'),this.sprite.appendChild(this.sparks.node),this.sprite.appendChild(this.flame.node)),this.viewport.args.audio&&!this.thrusterSound&&(this.thrusterSound=new Audio("/Sonic/mecha-sonic-thruster.wav"),this.scrapeSound=new Audio("/Sonic/mecha-sonic-scrape.wav"),this.scrapeSound.volume=.1,this.thrusterSound.loop=!0,this.scrapeSound.loop=!0),this.thrusterSound&&(this.thrusterSound.volume=.15+-.05*Math.random(),this.thrusterSound.currentTime>1.5&&(this.thrusterSound.currentTime=.5),this.scrapeSound.currentTime>1.5&&(this.scrapeSound.currentTime=.5)),e||(this.dashed=!1),this.args.rolling||e?this.args.rolling?(this.scrapeSound&&this.scrapeSound.pause(),"curling"!==this.args.animation&&"uncurling"!==this.args.animation&&"rolling"!==this.args.animation&&"jumping"!==this.args.animation&&(this.args.animation="crouching",this.onTimeout(200,function(){t.args.rolling&&(t.args.animation="rolling",t.closeThruster())}))):(this.scrapeSound&&this.scrapeSound.pause(),this.dashed?this.args.animation="running2":"rolling"!==this.args.animation&&"jumping"!==this.args.animation&&"uncurling"!==this.args.animation&&"curling"!==this.args.animation&&"crouching"!==this.args.animation?(this.args.animation="curling",this.onTimeout(200,function(){a.Sfx.play("MECHASONIC_SLAP"),t.args.falling&&(t.dashed?t.args.animation="running2":t.args.jumping&&(t.args.animation="jumping"),t.closeThruster())})):this.args.jumping||(this.args.animation="crouching")):(this.yAxis>0?this.args.crouching=!0:this.args.crouching=!1,Math.sign(this.args.gSpeed)!==r&&Math.abs(this.args.gSpeed-r)>5?(this.scrapeSound&&this.scrapeSound.play(),this.args.animation="skidding"):i>=s?(this.scrapeSound&&this.scrapeSound.pause(),this.args.animation="running2",this.thrusterSound&&this.thrusterSound.play(),this.args.takeoffPlayed||(this.args.takeoffPlayed=!0,a.Sfx.play("MECHASONIC_TAKEOFF")),this.args.accel=.75,i>75&&(this.args.accel=.03)):i>=10?(this.scrapeSound&&this.scrapeSound.play(),this.args.animation="running"):this.args.moving&&n?(this.scrapeSound&&this.scrapeSound.play(),"curling"===this.args.animation||"jumping"===this.args.animation||"rolling"===this.args.animation?(this.args.animation="uncurling",this.onTimeout(128,function(){t.args.animation="walking"})):"standing"!==this.args.animation&&"running"!==this.args.animation&&"running2"!==this.args.animation||(this.args.animation="walking")):this.args.crouching||this.standingOn&&this.standingOn.isVehicle?this.args.animation="crouching":(this.scrapeSound&&this.scrapeSound.pause(),"curling"===this.args.animation||"jumping"===this.args.animation||"rolling"===this.args.animation?(this.args.animation="uncurling",this.onTimeout(128,function(){t.args.animation="standing"})):"walking"!==this.args.animation&&"running"!==this.args.animation&&"running2"!==this.args.animation&&"skidding"!==this.args.animation&&"crouching"!==this.args.animation&&"rolling"!==this.args.animation||(this.args.animation="standing")),i<s&&this.closeThruster()),f(g(d.prototype),"update",this).call(this)}}},{key:"closeThruster",value:function(){this.args.takeoffPlayed&&this.landSound(),this.args.takeoffPlayed=!1,this.thrusterSound&&this.thrusterSound.pause()}},{key:"landSound",value:function(){a.Sfx.play("MECHASONIC_SLAP")}},{key:"sleep",value:function(){this.thrusterSound&&this.thrusterSound.pause(),this.scrapeSound&&this.scrapeSound.pause()}},{key:"command_5",value:function(){this.args.falling&&this.airDash(1)}},{key:"command_4",value:function(){this.args.falling&&this.airDash(-1)}},{key:"airDash",value:function(t){var e=this;if(!(this.dashed||this.args.ignore&&-2!==this.args.ignore)){t<0?(this.args.direction=-1,this.args.facing="left"):(this.args.direction=1,this.args.facing="right");var r=7*t;this.args.float=3,this.args.mode=0,this.args.float=2,this.args.rolling=!1,this.args.height=this.args.normalHeight,this.args.xSpeed&&Math.sign(this.args.xSpeed)!==Math.sign(t)&&(r=11*t,this.args.float=6,this.args.xSpeed=0),this.args.falling=!0;var n=this.args.xSpeed+r,i=this.scanForward(r,.5);i&&Math.abs(n)>Math.abs(i)&&(r=i*Math.sign(n));var o=this.castRay(n,n>0?0:Math.PI,function(t,r){if(e.getMapSolidAt.apply(e,c(r).concat([e.args.layer])))return t});!1!==o&&(r=o*Math.sign(r)),this.args.xSpeed=n,this.args.ySpeed=0,this.dashTimer=0,this.dashed=!0,this.args.mode=0,this.args.groundAngle=0,this.args.takeoffPlayed=!0,this.takeoffSound&&a.Sfx.play("MECHASONIC_TAKEOFF")}}},{key:"canRoll",get:function(){return!0}},{key:"controllable",get:function(){return!0}}])&&l(e.prototype,r),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),d}();t.MechaSonic=d}),require.register("actor/MegaMace.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MegaMace=void 0;var i=e("./PointActor"),o=e("curvature/base/Mixin"),a=e("../mixin/Constrainable"),s=e("../behavior/SkidDust");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(g,o.Mixin.from(i.PointActor,a.Constrainable));var e,r,n,p=f(g);function g(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=p.call.apply(p,[this].concat(r))).args.width=64,t.args.height=52,t.args.type="actor-item actor-mega-mace",t.behaviors.add(new s.SkidDust("particle-dust")),t.args.ropeLength=t.args._tiedTo?t.args.ropeLength:8,t.args.gravity=.8,t.alwaysSkidding=!0,t}return e=g,(r=[{key:"update",value:function(){this.args.tiedTo||u(h(g.prototype),"update",this).call(this)}},{key:"updateEnd",value:function(){this.viewport&&!this.viewport.auras.has(this)&&this.viewport.auras.add(this),this.args.tiedTo&&(u(h(g.prototype),"update",this).call(this),this.args._tiedTo||(this.args._tiedTo=this.viewport.actorsById[this.args.tiedTo]),this.args.tiedTo&&this.args._tiedTo.args.hitPoints?this.setPos():this.noClip=!0),u(h(g.prototype),"updateEnd",this).call(this)}},{key:"collideA",value:function(t){if(this.args._tiedTo&&!this.args._tiedTo===t)return!1}},{key:"collideB",value:function(t){if(this.args._tiedTo&&!this.args._tiedTo===t)return!1;this.args.tiedTo&&!this.args._tiedTo.args.hitPoints||(t.controllable||t.damage)&&t.damage()}}])&&c(e.prototype,r),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),g}();t.MegaMace=p}),require.register("actor/MiniBoss.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MiniBoss=void 0;var i=e("curvature/base/Tag"),o=e("./PointActor"),a=e("curvature/base/Mixin"),s=(e("../mixin/CanPop"),e("./CutScene"),e("../audio/Sfx"));function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(g,a.Mixin.from(o.PointActor));var e,r,n,p=f(g);function g(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),(r=p.call(this,t,e)).args.type="actor-item actor-mini-boss",r.args.width=48,r.args.height=48,r.args.float=-1,r.args.damagers=new Map,r.args.phase="idle",r.args.hitPoints=8,r.args.noseAngle=Math.PI/2*3,r.args.drillPush=0,r.args.phaseFrameId=0,r.args.frameId=0,r.args.direction=-1,r.args.facing="left",r.args.bindTo("phase",function(t){return r.args.phaseFrameId=0}),r}return e=g,(r=[{key:"onAttached",value:function(){this.autoAttr.get(this.box)["data-phase"]="phase",this.attractor=null}},{key:"update",value:function(){if(this.args.phaseFrameId++,this.args.frameId++,this.viewport){var t=this.viewport;if(t.auras.add(this),this.viewport.controlActor){this.attractor||(this.attractor={},this.attractor.x=this.x,this.attractor.y=this.y);Math.abs(this.x-this.attractor.x),Math.abs(this.y-this.attractor.y),Math.sign(this.x-this.attractor.x),Math.sign(this.y-this.attractor.y);switch(this.args.phase){case"damaged":this.args.hitPoints>0?this.args.phaseFrameId>20&&(this.args.phase="stalking"):this.args.phaseFrameId>6&&(this.args.phase="dead");break;case"dead":this.args.float=0;break;case"exploding":if(90===this.args.phaseFrameId&&(this.args.falling=!0,this.args.ySpeed=-14,this.args.xSpeed=0,this.args.gSpeed=0,this.noClip=!0,this.viewport.auras.delete(this),this.args.phase="exploded",s.Sfx.play("OBJECT_DESTROYED")),this.args.phaseFrameId>90)return;if(t&&t.args.frameId%3==0){var e=new i.Tag('<div class = "particle-explosion">');s.Sfx.play("BOSS_DAMAGED");var r=this.args.width*Math.random()-this.args.width/2,n=this.args.height*Math.random()-this.args.height/2;e.style({"--x":this.x+r,"--y":this.y+n+-16}),t.particles.add(e),setTimeout(function(){return t.particles.remove(e)},512)}}"knocked"!==this.args.phase&&this.args.ySpeed<0&&!this.pointIsSafe(this.x,this.y+-this.args.height+this.args.ySpeed+-1)&&(this.args.ySpeed=0),u(h(g.prototype),"update",this).call(this)}}}},{key:"updateEnd",value:function(){if(u(h(g.prototype),"updateEnd",this).call(this),this.viewport){var t=this.viewport.controlActor;if(t){Math.abs(this.x-t.x),Math.abs(this.y-t.y),Math.sign(this.x-t.x),Math.sign(this.y-t.y);switch(this.args.xSpeed<0?this.args.facing="left":this.args.xSpeed>0&&(this.args.facing="right"),this.args.groundAngle=0,this.args.phase){case"attacking":case"swooping":case"stalking":case"ready":this.checkBelow(this.x,this.y)&&(this.args.falling=!0,this.args.ySpeed=-4,this.args.y--)}}}}},{key:"collideA",value:function(t,e){var r=this,n=Math.sign(this.x-t.x);Math.sign(this.y-t.y),Math.max(Math.abs(t.args.xSpeed),5),Math.sign(t.args.xSpeed);if("dead"===this.args.phase){if(t.args.rolling&&(t.args.gSpeed=-n*Math.abs(t.args.gSpeed)),!(t.args.jumping||t.args.rolling||t.dashed))return!0;this.args.explodeFrame=this.viewport.args.frameId,this.args.phase="exploding"}if(1!==e&&3!==e||(this.onNextFrame(function(){t.args.xSpeed=-n*Math.max(5,Math.abs(t.xSpeedLast))}),t.args.falling?this.ignores.set(t,15):(t.args.gSpeed=4*-Math.sign(this.x-t.x),t.args.rolling&&this.onNextFrame(function(){t.args.gSpeed=-Math.sign(r.x-t.x),t.args.rolling=!0,t.args.direction=Math.sign(t.args.gSpeed)})),this.args.ySpeed=Math.min(0,this.args.ySpeed),this.damage(t)),2===e&&(this.viewport.args.audio&&s.Sfx.play("BOSS_DUDHIT"),t.args.falling&&(this.hitPoints<=0&&(this.args.ySpeed=2.5*-Math.abs(t.args.ySpeed)),t.controllable&&(t.args.ySpeed=Math.max(7,Math.abs(t.args.ySpeed)))),this.args.xSpeed=0,this.args.hitPoints>0&&(this.args.phase="knocked"),this.ignores.set(t,15)),0===e){if(t.args.falling&&this.ignores.set(t,15),t.controllable){t.args.y=this.y-this.args.height;t.args.animation;var i=t.args.ySpeed;this.onNextFrame(function(){t.args.ySpeed=-Math.floor(Math.abs(i))||-4})}this.args.xSpeed=0,this.damage(t)}return t.args.ignore=1,this.args.hitPoints||(t.args.ignore=-2),!0}},{key:"damage",value:function(t){var e=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(this.args.hitPoints<=0)){var r=this.args.damagers.get(t);this.args.frameId-r<5||(this.args.hitPoints--,this.args.damagers.set(t,this.args.frameId),this.onNextFrame(function(){return e.args.phase="damaged"}),s.Sfx.play("BOSS_DAMAGED"))}}},{key:"pointIsSafe",value:function(t,e){return!this.viewport.actorsAtPoint(t,e).filter(function(t){return t.hazard}).length}},{key:"solid",get:function(){return this.args.hitPoints>0}},{key:"rotateLock",get:function(){return!0}}])&&c(e.prototype,r),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),g}();t.MiniBoss=p}),require.register("actor/MiniMace.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MiniMace=void 0;var i=e("./PointActor"),o=e("curvature/base/Mixin"),a=e("../mixin/Constrainable");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(p,o.Mixin.from(i.PointActor,a.Constrainable));var e,r,n,h=l(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=h.call.apply(h,[this].concat(r))).args.width=32,t.args.height=32,t.args.type="actor-item actor-mini-mace",t.args.ropeLength=t.args._tiedTo?t.args.ropeLength:8,t.args.gravity=.6,t}return e=p,(r=[{key:"update",value:function(){this.args.tiedTo||c(f(p.prototype),"update",this).call(this)}},{key:"updateEnd",value:function(){this.viewport&&!this.viewport.auras.has(this)&&this.viewport.auras.add(this),this.args.tiedTo&&(c(f(p.prototype),"update",this).call(this),this.args._tiedTo||(this.args._tiedTo=this.viewport.actorsById[this.args.tiedTo]),this.args.tiedTo&&this.args._tiedTo.args.hitPoints?this.setPos():this.noClip=!0),c(f(p.prototype),"updateEnd",this).call(this)}},{key:"collideA",value:function(t){if(this.args._tiedTo&&!this.args._tiedTo===t)return!1}},{key:"collideB",value:function(t){if(this.args._tiedTo&&!this.args._tiedTo===t)return!1;this.args.tiedTo&&!this.args._tiedTo.args.hitPoints||t.controllable&&t.damage()}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.MiniMace=h}),require.register("actor/Monitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Monitor=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag"),a=(e("../actor/Explosion"),e("../actor/Projectile")),s=(e("../actor/BrokenMonitor"),e("../actor/Block")),c=e("../actor/Marker"),u=e("../audio/Sfx");function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(y,i.PointActor);var e,r,n,d=p(y);function y(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=d.call.apply(d,[this].concat(r))).args.type="actor-item actor-monitor",t.args.width=30,t.args.height=32,t.args.decel=.25,t.args.gone=!1,t}return e=y,(r=[{key:"onRendered",value:function(t){f(g(y.prototype),"onRendered",this).call(this,t),this.screen=new o.Tag('<div class = "monitor-screen">'),this.sprite&&this.sprite.appendChild(this.screen.node)}},{key:"update",value:function(){f(g(y.prototype),"update",this).call(this),this.viewport}},{key:"collideA",value:function(t,e){return!!t.args.static||!(!t.args.moving&&!t.args.falling)&&(!(t instanceof s.Block)&&(t instanceof c.Marker&&(t=t.owner),f(g(y.prototype),"collideA",this).call(this,t,e),1===e&&!t.args.spinning||(2===e&&this.args.float&&t.controllable?(t.args.ySpeed*=-1,this.args.ySpeed=-4,this.args.float=0,this.ignores.set(t,15),!0):2===e||!(t.args.ySpeed>0&&t.y<this.y||t.args.rolling)||this.args.falling&&-1!==this.args.float||this.args.gone||!this.viewport||!t.args.spinning?1!==e&&3!==e||!(t.args.rolling||t instanceof a.Projectile)||this.args.gone||!this.viewport?void 0:(this.pop(t),!1):void this.pop(t))))}},{key:"pop",value:function(t){var e=this,r=this.viewport;if(r&&!this.args.gone){var n=new o.Tag('<div class = "particle-explosion">');if(t&&(t.args.score+=100),n.style({"--x":this.x,"--y":this.y-16}),r.particles.add(n),setTimeout(function(){return r.particles.remove(n)},512),setTimeout(function(){return e.screen&&e.screen.remove()},1024),this.args.gone=!0,this.box&&this.box.setAttribute("data-animation","broken"),t&&(t.occupant&&(t=t.occupant),t.args.owner&&(t=t.args.owner),t.controllable&&this.effect(t)),u.Sfx.play("OBJECT_DESTROYED"),"function"==typeof ga&&ga("send","event",{eventCategory:"monitor",eventAction:"popped",eventLabel:"".concat(this.viewport.args.actName,"::").concat(this.args.id)}),t){var i=t.args.ySpeed;t.args.falling&&this.onNextFrame(function(){t.args.ySpeed=-i,t.args.falling=!0}),this.args.falling&&t.args.falling}this.onTimeout(1500,function(){e.viewport.actors.remove(e)}),this.viewport.settings.rumble&&t.controller&&t.controller.rumble&&(t.controller.rumble({duration:40,strongMagnitude:0,weakMagnitude:1}),this.viewport.onTimeout(40,function(){t.controller.rumble({duration:110,strongMagnitude:.75,weakMagnitude:1})}))}}},{key:"effect",value:function(){}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!1}}])&&l(e.prototype,r),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),y}();t.Monitor=d}),require.register("actor/NuclearSuperball.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.NuclearSuperball=void 0;var i=e("./PointActor");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.gSpeedMax=150,t.args.accel=2,t.args.jumpForce=20,t.willStick=!0,t.stayStuck=!0,t}return e=u,(r=[{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.NuclearSuperball=u}),require.register("actor/Orb.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Orb=void 0;var i=e("./PointActor"),o=e("curvature/base/Mixin");e("../mixin/Pushable");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,o.Mixin.from(i.PointActor));var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-orb",t.args.width=18,t.args.height=48,t.args.rolled=0,t.args.accel=.2,t.args.decel=0,t.args.bindTo("x",function(e,r,n,i,o){return t.args.rolled+=.5*Number(e-o||0)}),t.args.gravity=1.35,t}return e=h,(r=[{key:"onAttached",value:function(t){this.autoStyle.get(this.box)["--rolled"]="rolled"}},{key:"update",value:function(){var t=this;if(this.viewport&&this.viewport.controlActor){this.args.falling?this.viewport.onFrameOut(10,function(){t.args.falling&&t.viewport.auras.delete(t)}):this.viewport.auras.add(this);var e=this.viewport.controlActor,r=e.args.gSpeed,n=Math.sign(this.args.gSpeed||this.gSpeedLast||e.args.gSpeed),i=this.x-e.x;i<0&&(n&&this.args.mode===e.args.mode?(i>=-96&&(this.args.gSpeed=r*n*.75),i<-96&&(this.args.gSpeed=r*n),i<-128&&!this.args.mode&&!e.args.mode&&(this.args.x-=i+128,this.args.gSpeed=r*n)):this.args.mode!==e.args.mode&&(this.args.gSpeed=Math.max(r*n*.85,.95*this.args.gSpeed))),s(l(h.prototype),"update",this).call(this)}}},{key:"collideA",value:function(t){t.controllable&&t.loseRings(),t.controllable&&t.die()}},{key:"controllable",get:function(){return!1}},{key:"solid",get:function(){return!1}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.Orb=f}),require.register("actor/Panel.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Panel=void 0;var i=e("./PointActor");e("curvature/base/Bindable");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.type="actor-item actor-panel",r.args.width=64,r.args.height=8,r.args.float=-1,r.leaving=new Set,r.holding=new Set,r.cancels=new Map,r}return e=u,(r=[{key:"collideA",value:function(t,e){var r=this;if(t.canFly)return!1;if(this.leaving.has(t))return this.holding.has(t)&&(t.stayStuck=!1,t.willStick=!1,t.willJump=!1,t.args.gSpeed=0,this.holding.delete(t)),this.cancels.has(t)&&(this.cancels.get(t)(),this.cancels.delete(t)),this.cancels.set(t,this.viewport.onFrameOut(25,function(){r.holding.delete(t),r.leaving.delete(t)})),!1;if(!t.args.jumping&&!this.holding.has(t))return!1;if(this.holding.has(t)){if(t.args.mode=0,t.args.groundAngle=this.args.groundAngle,t.lastAngles.length=0,t.args.gSpeed=0,t.args.xSpeed=0,t.args.ySpeed=0,t.args.falling=!1,this.holding.has(t)&&t.willJump){var n=this.viewport.actorsById[this.args.next];if(t.args.falling=!0,n){t.stayStuck=!0,t.willStick=!0;var i=n.rotatePoint(0,0),o=t.angleTo({x:i[0]+n.x,y:i[1]+n.y});t.args.gSpeed=0,t.args.x-=16*Math.cos(o),t.args.y-=16*Math.sin(o),t.args.xSpeed=34*-Math.cos(o),t.args.ySpeed=34*-Math.sin(o),t.args.falling=!0,t.args.jumping=!0,t.args.float=45,this.leaving.add(t),this.holding.delete(t),t.args.ignore=45}else this.leaving.add(t),this.holding.delete(t),t.stayStuck=!1,t.willStick=!1,t.args.gSpeed=0,t.args.xSpeed=0,t.args.ySpeed=0,t.args.falling=!0,t.args.ignore=15;return!1}var a=this.rotatePoint(0,8);return t.args.x=this.x+a[0],t.args.y=this.y+a[1],t.args.ignore=0,!1}return!this.viewport.actorsById[this.args.next]||(this.holding.add(t),t.args.gSpeed=0,t.args.xSpeed=0,t.args.ySpeed=0,t.args.ignore=10,this.cancels.has(t)&&(this.cancels.get(t)(),this.cancels.delete(t)),this.cancels.set(t,this.viewport.onFrameOut(20,function(){r.holding.has(t)&&(r.holding.delete(t),r.leaving.add(t))})),!1)}},{key:"sleep",value:function(){this.leaving.clear(),this.holding.clear()}},{key:"solid",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.Panel=u}),require.register("actor/PogoSpring.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PogoSpring=void 0;var i=e("./Vehicle");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Vehicle);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.type="actor-item actor-pogo-spring",t.args.width=32,t.args.height=32,t.removeTimer=null,t.args.gSpeedMax=20,t.args.decel=.45,t.args.accel=.45,t.args.gravity=1,t.args.seatHeight=32,t.args.skidTraction=.05,t.args.jumpForce=8,t.dustCount=0,t.args.particleScale=2,t.args.started=!1,t}return e=u,(r=[{key:"onAttached",value:function(){}},{key:"update",value:function(){}},{key:"solid",get:function(){return!this.occupant}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.PogoSpring=u}),require.register("actor/PointActor.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PointActor=void 0;var n=e("curvature/base/Bindable"),i=e("curvature/base/View"),o=e("curvature/base/Tag"),a=e("../effects/Twist"),s=e("../effects/Droop"),c=e("../effects/Pinch"),u=e("../ui/CharacterString"),l=e("../Classifier"),f=e("../controller/Controller"),h=e("../powerups/Sheild"),p=e("../powerups/FireSheild"),g=e("../powerups/SuperSheild"),d=e("../powerups/BubbleSheild"),y=e("../powerups/NormalSheild"),b=e("../powerups/ElectricSheild"),v=e("../powerups/StarSheild");e("./LayerSwitch"),e("../viewport/Layer");function m(t){"@babel/helpers - typeof";return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(t){return function(t){if(Array.isArray(t))return k(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||j(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||j(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=j(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function j(t,e){if(t){if("string"==typeof t)return k(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k(t,e):void 0}}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function x(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,n=T(t);if(e){var i=T(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return M(this,r)}}function M(t,e){if(e&&("object"===m(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return R(t)}function R(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function T(t){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function A(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var E=0,C=100,B=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&P(t,e)}(T,i.View);var e,r,j,k=_(T);function T(){var t,e,r,i,o,a,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1?arguments[1]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,T),s[n.Bindable.NoGetters]=!0,A(R(a=k.call(this,s,c)),"template",'<div class  = "point-actor [[type]]">\n\t\t<div class = "sprite" cv-ref = "sprite">\n\t\t\t<div class = "labels" cv-ref = "labels" cv-each = "charStrings:charString:c">[[charString]]</div>\n\t\t</div>\n\t</div>'),A(R(a),"profiles",{normal:{height:1,width:1,decel:.85,accel:.2,gravity:.65,airAccel:.3,jumpForce:14,gSpeedMax:100}}),a[n.Bindable.NoGetters]=!0,a.defaultDisplay="initial",a.springing=!1,a.stepCache={},a.fallTime=0,a.args.weight=null!==(t=a.args.weight)&&void 0!==t?t:100,a.args.score=0,a.args.rings=0,a.args.mercy=!1,a.args.opacity=null!==(e=a.args.opacity)&&void 0!==e?e:1,a.args.pushing=!1,a.autoStyle=new Map,a.autoAttr=new Map,a.hanging=new Map,a.ignores=new Map,a.regions=new Set,a.powerups=new Set,a.behaviors=new Set,a.lastPointA=[],a.lastPointB=[],a.carrying=new Set,a.inventory=new l.Classifier([h.Sheild,p.FireSheild,d.BubbleSheild,b.ElectricSheild,y.NormalSheild]),a.noClip=!1,a.sheild=null,a.inventory.addEventListener("adding",function(t){var e=t.detail.object;if(a.inventory.has(e.constructor))t.preventDefault();else{if(a.powerups.add(e),a.controllable){var r="has".concat(e.type[0].toUpperCase()+e.type.substr(1));a.viewport.args[r]=r}e.acquire&&e.acquire(R(a)),a.args.currentSheild instanceof v.StarSheild||(a.args.currentSheild=e,e.equip&&e.equip(R(a)))}}),a.inventory.addEventListener("removing",function(t){var e=t.detail.object;if(a.powerups.delete(e),a.controllable){var r="has".concat(e.type[0].toUpperCase()+e.type.substr(1));a.viewport.args[r]=null}n.Bindable.make(e)===a.args.currentSheild&&(a.args.currentSheild=null)}),a.args.bindTo("currentSheild",function(t,e,r,n,i){i&&i.unequip&&i.unequip(R(a));var o,s=O(a.inventory.get(h.Sheild));try{for(s.s();!(o=s.n()).done;){var c=o.value;c instanceof g.SuperSheild||c.detach()}}catch(t){s.e(t)}finally{s.f()}t&&t.equip&&t.equip(R(a)),t&&t.render(a.sprite)}),a.args.type="actor-generic",a.args.modeTime=0,a.args.charStrings=[],a.args.display=a.args.display||"initial",a.args.emeralds=0,a.args.rings=0,a.args.coins=0,a.args.dead=!1,a.args.respawning=!1,a.ringSet=new Set,a.ringDoc=new DocumentFragment,a.args.yMargin=0,a.args.cameraMode="normal",a.args.cameraBias=0,a.args.layer=null!==(r=a.args.layer)&&void 0!==r?r:1,a.args.active=null!==(i=a.args.active)&&void 0!==i&&i,a.args.moving=!1,a.args.flySpeedMax=40,a.args.x=a.args.x||1280,a.args.y=a.args.y||32,a.args.z=a.args.z||0,a.args.xOff=0,a.args.yOff=0,a.args.width=a.args.width||1,a.args.height=a.args.height||1,a.args.direction=Number(a.args.direction)||1,a.args.xSpeed=a.args.xSpeed||0,a.args.ySpeed=a.args.ySpeed||0,a.args.gSpeed=a.args.gSpeed||0,a.args.hSpeed=0,a.args.xSpeed=a.args.xSpeed||0,a.args.ySpeed=a.args.ySpeed||0,a.args.angle=a.args.angle||0,a.args.groundAngle=a.args.groundAngle||0,a.args.displayAngle=0,a.args.airAngle=0,a.lastAngles=[],a.angleAvg=16,a.args.xSpeedMax=512,a.args.ySpeedMax=512,a.args.gSpeedMax=C,a.args.rollSpeedMax=23,a.args.gravity=.65,a.args.decel=.85,a.args.accel=.2,a.args.airAccel=.3,a.args.jumpForce=14,a.args.airTimeTotal=0,a.args.groundTimeTotal=0,a.args.jumping=!1,a.args.jumpedAt=null,a.args.deepJump=!1,a.args.highJump=!1,a.maxStep=8,a.backStep=0,a.frontStep=0,a.args.rolling=!1,a.args.skidTraction=2.25,a.args.skidTraction=5,a.args.fgFilter="none",a.args.bgFilter="none",a.args.falling=!0,a.args.running=!1,a.args.crawling=!1,a.args.climbing=!1,a.args.rotateFixed=!1,a.args.mode=a.args.mode||E,a.xAxis=0,a.yAxis=0,a.aAxis=0,a.bAxis=0,a.lAxis=0,a.rAxis=0,a.buttons={},a.willStick=!1,a.stayStuck=!1,a.args.startled=a.args.startled||0,a.args.halted=a.args.halted||0,a.args.ignore=a.args.ignore||0,a.args.float=a.args.float||0,a.colliding=!1,a.args.flyAngle=0,a.args.bindTo(["x","y"],function(t,e,r){isNaN(t)&&console.trace(e,t),a.stepCache={},a.args.idleTime=0}),a.args.bindTo(["xSpeed","ySpeed"],function(t,e,r){isNaN(t)&&console.trace(e,t)}),a.args.bindTo("gSpeed",function(t){a.gSpeedLast=t||a.gSpeedLast}),a.args.bindTo("xSpeed",function(t){a.airAngle=a.args.airAngle=Math.atan2(a.args.ySpeed,t),a.xSpeedLast=t||a.xSpeedLast}),a.args.bindTo("ySpeed",function(t){a.airAngle=a.args.airAngle=Math.atan2(t,a.args.xSpeed),a.ySpeedLast=t||a.ySpeedLast}),a.impulseMag=null,a.impulseDir=null,a.args.stopped=0,a.args.particleScale=1,a.dropDashCharge=0;var m,w=n.Bindable.make(R(a));(a.debindGroundX=null,a.debindGroundY=null,a.debindGroundA=null,a.debindGroundL=null,a.args.name=null!==(o=a.args.name)&&void 0!==o?o:"",a.controllable)&&(a.controller=new f.Controller({deadZone:.2}),a.args.charStrings=[new u.CharacterString({value:null!==(m=a.args.name)&&void 0!==m?m:""})],a.controller.zero());return a.debindGroundX=new Set,a.debindGroundY=new Set,a.debindGroundA=new Set,a.debindGroundL=new Set,a.args.bindTo(["mode","falling"],function(){a.args.modeTime=0}),a.args.bindTo("standingOn",function(t,e,r){if(!a.isGhost&&a.args.standingOn!==t){var n,i=O(a.debindGroundX);try{for(i.s();!(n=i.n()).done;){var o=n.value;a.debindGroundX.delete(o),o()}}catch(t){i.e(t)}finally{i.f()}var s,c=O(a.debindGroundY);try{for(c.s();!(s=c.n()).done;){var u=s.value;a.debindGroundY.delete(u),u()}}catch(t){c.e(t)}finally{c.f()}var l,f=O(a.debindGroundA);try{for(f.s();!(l=f.n()).done;){var h=l.value;a.debindGroundA.delete(h),h()}}catch(t){f.e(t)}finally{f.f()}var p,g=O(a.debindGroundL);try{for(g.s();!(p=g.n()).done;){var d=p.value;a.debindGroundL.delete(d),d()}}catch(t){g.e(t)}finally{g.f()}var y=r[e];if(y&&y.isVehicle&&(y.occupant=null,y.stayStuck=!1,y.willStick=!1,y.xAxis=0,y.yAxis=0,y.args.active=!1),t){if(a.controllable&&t.isVehicle){a.args.pushing=!1,t.args.active=!0;var b=t.args.bindTo("x",function(e,r){var n=t.args.direction*t.args.seatForward||0,i=t.args.seatHeight||t.args.height||0,o=S(t.rotatePoint(n,i),2),s=o[0],c=o[1];a.args.x=s+e,a.args.y=c+t.y,a.args.direction=t.args.direction}),v=t.args.bindTo("y",function(e,r){if(!a.args.jumping){var n=t.args.direction*t.args.seatForward||0,i=t.args.seatHeight||t.args.height||0,o=S(t.rotatePoint(n,i),2),s=o[0],c=o[1];a.args.x=s+t.x,a.args.y=c+e}}),m=t.args.bindTo("layer",function(t,e){a.args.layer=t});a.debindGroundX.add(b),a.debindGroundY.add(v),a.debindGroundL.add(m);var w=t.occupant;t.args.yMargin=a.args.height,w&&w!==R(a)&&(w.args.standingOn=null,w.args.y-=32,w.args.gSpeed=0,w.args.xSpeed=-5*a.args.direction,w.args.ySpeed=-8,w.args.falling=!0),a.args.gSpeed=0,a.args.xSpeed=0,a.args.ySpeed=0,a.args.falling=!1,t.occupant=R(a)}else if(!t.isVehicle&&a.y<=a.args.height+t.y-t.args.height){var j=t.args.bindTo("x",function(e,r){a.args.x+=e+-t.args.x}),k=t.args.bindTo("y",function(e,r){a.args.y=e+-t.args.height+(a.controllable||a.isPushable,0)}),x=t.args.bindTo("layer",function(t,e){a.args.layer=t});a.debindGroundX.add(j),a.debindGroundY.add(k),a.debindGroundL.add(x)}y&&y.isVehicle&&(y.occupant===R(a)&&(y.occupant=null,y.stayStuck=!1,y.willStick=!1),y.xAxis=0,y.yAxis=0),t.standBelow(R(a))}}}),M(a,w)}return e=T,j=[{key:"fromDef",value:function(t){var e,r={x:t.x+Math.floor(t.width/2),y:t.y-1,visible:t.visible,name:t.name,id:t.id},n=new Map;for(var i in r)"object"!==m(r[i])&&n.set(i,r[i]);for(var o in t.properties){var a=t.properties[o];r[a.name]=a.value,n.set(a.name,a.value)}r.tileId=t.gid;var s=new this(Object.assign({},r));return s.def=n,s.args.float=null!==(e=s.float)&&void 0!==e?e:s.args.float,s}}],(r=[{key:"onRendered",value:function(){var t=this;if(!this.init&&this.viewport){var e=this.viewport.objectPalette["base-region"];if(this.isRegion=this instanceof e,this.box=this.findTag("div"),this.autoStyle.set(this.box,{display:"display","--animation-bias":"animationBias","--bg-filter":"bgFilter","--sprite-sheet":"spriteSheetUrl","--direction":"direction","--sprite-x":"spriteX","--sprite-y":"spriteY","--angle":"angle","--palletShift":"palletShift","--fly-angle":"flyAngle","--display-angle":"groundAngle","--ground-angle":"groundAngle","--air-angle":"airAngle","--opacity":"opacity","--height":"height","--width":"width","--x":"x","--y":"y","--z":"z"}),this.autoAttr.set(this.box,{"data-camera-mode":"cameraMode","data-colliding":"colliding","data-respawning":"respawning","data-mercy":"mercy","data-selected":"selected","data-following":"following","data-carrying":"carrying","data-falling":"falling","data-moving":"moving","data-pushing":"pushing","data-facing":"facing","data-filter":"filter","data-angle":"angleDeg","data-driving":"driving","data-active":"active","data-layer":"layer","data-mode":"mode","data-id":"id"}),this.args.bindTo("spriteSheet",function(e){t.args.spriteSheetUrl=void 0!==e?t.urlWrap(e):void 0}),this.args.bindTo("angle",function(e){return t.args.angleDeg=t.rad2deg(e)}),this.sprite=this.findTag("div.sprite"),this.controllable){var r=new g.SuperSheild;r.equip(this),this.inventory.add(r)}this.init=!0,this.args.bindTo("animation",function(e){return t.box.setAttribute("data-animation",e)}),this.bindTo("isSuper",function(e){return t.box.setAttribute("data-super",e)}),this.bindTo("isHyper",function(e){return t.box.setAttribute("data-hyper",e)}),this.controllable&&this.sprite.parentNode.classList.add("controllable"),this.listen("click",function(){})}}},{key:"updateStart",value:function(){if(this.lastLayer=null,this.args.localCameraMode=null,!this.args.dead){if(this.args.standingLayer&&!this.args.static){var t,e=this.args.standingLayer.layer,r=!1,n=O(this.regions);try{for(n.s();!(t=n.n()).done;){t.value.grind&&(r=!0)}}catch(t){n.e(t)}finally{n.f()}this.controllable?e&&e.meta.grinding?(this.args.grinding=!0,this.args.direction=Math.sign(this.args.xSpeed||this.args.gSpeed)):r||(this.args.grinding=!1):this.args.grinding=!1,this.args.grinding&&this.args.falling&&(this.args.grinding=!1)}this.args.falling||(this.fallTime=0)}}},{key:"updateEnd",value:function(){var t=this;!this.args.static&&this.args.falling&&(this.args.standingLayer&&0===this.fallTime&&(this.args.xSpeed+=this.args.standingLayer.offsetXChanged||0,this.args.ySpeed+=this.args.standingLayer.offsetYChanged||0),this.args.standingLayer=null);var e=this.focused;this.args.falling||(this.focused=!1);var r,n=O(this.regions);try{for(n.s();!(r=n.n()).done;){var i=r.value;i.focus&&(this.viewport.auras.add(i.focus),this.focused=i.focus)}}catch(t){n.e(t)}finally{n.f()}e!==this&&e!==this.focused&&this.viewport&&this.viewport.auras.delete(e);var o,a=O(this.autoStyle);try{for(a.s();!(o=a.n()).done;){for(var s=S(o.value,2),c=s[0],u=s[1],l={},f=0,h=Object.entries(u);f<h.length;f++){var p=S(h[f],2),g=p[0],d=p[1];d in this.args&&(l[g]=this.args[d])}c.style(l)}}catch(t){a.e(t)}finally{a.f()}var y,b=O(this.autoAttr);try{for(b.s();!(y=b.n()).done;){for(var v=S(y.value,2),m=v[0],w=v[1],j={},k=0,x=Object.entries(w);k<x.length;k++){var P=S(x[k],2),_=P[0],M=P[1];M in this.args&&(j[_]=this.args[M])}m.attr(j)}}catch(t){b.e(t)}finally{b.f()}if(this.follower){var R=this.viewport.serializePlayer(),T=this.follower;this.viewport.onFrameOut(5,function(){R.input&&(T.controller&&T.controller.replay(R.input),T.readInput()),R.args&&(Object.assign(T.args,R.args),T.viewport&&T.viewport.setColCell(t))}),this.follower.args.dead&&(this.follower.args.dead=!1,this.follower.args.x=this.x,this.follower.args.y=this.y)}}},{key:"update",value:function(){var t=this;if("number"==typeof this.args.standingOn){var e=this.args.standingOn,r=this.viewport.actorsById[e];r&&(this.args.standingOn=r,this.args.x=r.x,this.args.y=r.y-r.args.height)}this.args.jumpBlocked=!1,this.viewport&&(this.age=this.viewport.args.frameId-this.startFrame),this.xAxis&&Math.sign(this.args.gSpeed)===this.args.pushing&&Math.sign(this.xAxis)===this.args.pushing||(this.args.pushing=!1);this.x,this.y;if(!this.noClip||this.controllable){if(!this.args.falling&&!this.args.rolling&&this.args.modeTime>=1&&(this.args.spinning=!1),(this.args.rolling||this.args.jumping||this.spindashCharge)&&(this.args.spinning=!0),this.viewport&&this.args.respawning&&!this.viewport.args.isRecording&&!this.viewport.args.isReplaying){var n,i,o=this.viewport.getCheckpoint(this.args.canonical);if(o&&o.checkpointId){var a=this.viewport.actorsById[o.checkpointId];n=a.x,i=a.y}else if(this.def)n=this.def.get("x"),i=this.def.get("y");else if(!this.canRoll&&this.viewport.defsByName.get("wide-player-start")){var s=this.viewport.defsByName.get("wide-player-start");n=s.x,i=s.y}else if(this.viewport.defsByName.has("player-start")){var c=this.viewport.defsByName.get("player-start");n=c.x,i=c.y}this.args.animation="dropping",this.args.standingLayer=null,this.args.standingOn=null,this.lastLayer=null;var u=this.args.x-n,l=this.args.y-i,f=Math.max(Math.abs(u/8),16),h=Math.max(Math.abs(l/8),16);this.args.x-=Math.sign(u)*f,this.args.y-=Math.sign(l)*h;var p=this.viewport;return Math.abs(u)<=f&&(this.args.x=n),Math.abs(l)<=h&&(this.args.y=i),Math.abs(u)<=f&&Math.abs(l)<=h&&this.viewport.onFrameOut(60,function(){t.viewport.args.networked?(t.args.dead=!1,t.noClip=!1,t.args.respawning=!1,t.args.display="initial",t.args.ignore=4,t.args.xSpeed=0,t.args.ySpeed=-3):(p.reset(),p.startLevel(!1)),p.args.paused=!1}),void(this.viewport&&this.viewport.setColCell(this))}if(this.viewport&&this.viewport.meta.deathLine&&!this.args.dead&&this.controllable&&this.y>this.viewport.meta.deathLine)this.die();else{if(this.controllable&&!this.args.dead){this.args.width,Math.sign(this.args.xSpeed);var g=Math.max(this.args.height,0),d=this.rotatePoint(0,.75*g),y=this.getMapSolidAt(this.x+d[0],this.y+d[1]);if(Array.isArray(y)&&(y=!!y.filter(function(t){return!t.args.platform&&!t.isVehicle}).length),this.args.rolling){var b=this.rotatePoint(0,g),v=this.getMapSolidAt(this.x+b[0],this.y+b[1]);Array.isArray(v)&&(v=!!v.filter(function(t){return!t.args.platform&&!t.isVehicle}).length,this.args.jumpBlocked=!!v),this.args.jumpBlocked=!!v}if(!this.args.hangingFrom&&!this.args.falling&&this.checkBelow(this.x,this.y)&&y)return void this.die();if(!this.args.falling&&0===this.args.mode){var j=this.castRay(this.maxStep,this.upAngle,this.findUpSpace);j&&(this.args.y-=j)}}var k,x=O(this.ignores);try{for(x.s();!(k=x.n()).done;){var P=S(k.value,2),_=P[0],M=P[1];M<=0?this.ignores.delete(_):this.ignores.set(_,-1+M)}}catch(t){x.e(t)}finally{x.f()}if(this.args.skimming=!1,this.args.falling){if(this.args.airAngle=this.airAngle,this.args.displayAngle!==this.args.groundAngle){var R=this.args.groundAngle+-this.args.displayAngle;this.args.displayAngle+=Math.sign(R)*(Math.abs(R)>1?1:Math.abs(R))*.5}}else this.args.airAngle=0,this.args.displayAngle=this.args.groundAngle;if(this.args.halted<1&&this.args.halted>0&&(this.args.halted=0),this.args.halted>0)this.args.halted--;else if(this.args.currentSheild&&"update"in this.args.currentSheild&&this.args.currentSheild.update(this),this.args.rolling?this.args.height=this.args.rollingHeight||this.args.height:this.args.jumping?this.args.height=this.args.rollingHeight||this.args.height:this.canRoll&&(this.args.height=this.args.normalHeight||this.args.height),this.args.dontJump>0&&this.args.dontJump--,this.args.dontJump<0&&(this.args.dontJump=0),this.viewport&&!this.removed){if(this.args.modeTime++,this.args.falling||(Math.abs(this.args.gSpeed)<1&&!this.impulseMag&&this.args.modeTime>3&&(this.args.rolling=!1),Math.abs(this.args.gSpeed)<.01?this.args.gSpeed=0:this.canRoll&&this.yAxis>.55&&!this.args.ignore&&(this.args.rolling=!0)),this.args.driving=!1,this.args.standingOn&&this.args.standingOn.isVehicle&&!this.isVehicle){var A=this.args.standingOn;if(this.args.groundTimeTotal++,this.args.falling=!0,this.args.flying=!1,this.args.jumping=!1,this.args.driving=!0,this.processInput(),this.args.cameraMode=A.args.cameraMode,this.willJump&&this.yAxis<0){var C=this.args.standingOn;this.args.standingLayer=!1,this.args.standingOn=!1,this.willJump=!1,C.occupant=null,this.args.falling=!0,this.args.jumping=!0,this.args.y-=16,this.args.xSpeed=2*A.args.direction*-Math.sign(A.args.seatAngle||-1),this.args.ySpeed=-this.args.jumpForce,A.args.ySpeed=0}return this.args.groundAngle=(A.args.groundAngle||0)+(A.args.seatAngle||0),void(this.willJump&&this.yAxis>=0&&(this.args.standingOn.falling=!1,this.willJump=!1,this.args.standingOn.command_0()))}if(null!==this.impulseMag){if(this.args.xSpeed+=Number(Number(Math.cos(this.impulseDir)*this.impulseMag).toFixed(3)),this.args.ySpeed+=Number(Number(Math.sin(this.impulseDir)*this.impulseMag).toFixed(3)),this.impulseFal)this.args.falling=this.impulseFal||this.args.falling;else switch(this.args.mode){case E:this.args.gSpeed=Math.cos(this.impulseDir)*this.impulseMag;break;case 2:this.args.gSpeed=-Math.cos(this.impulseDir)*this.impulseMag;break;case 1:this.args.gSpeed=-Math.sin(this.impulseDir)*this.impulseMag;break;case 3:this.args.gSpeed=Math.sin(this.impulseDir)*this.impulseMag}this.impulseMag=null,this.impulseDir=null,this.impulseFal=null}-2===this.args.ignore&&(!1===this.args.falling||this.args.ySpeed>64)&&(this.args.ignore=0),-3===this.args.ignore&&(!this.args.falling||this.args.ySpeed>=-10)&&this.onNextFrame(function(){return t.args.ignore=0}),this.args.ignore<1&&this.args.ignore>0&&(this.args.ignore=0),this.args.ignore>0&&this.args.ignore--,this.args.startled>0&&this.args.startled--,this.args.float>0&&this.args.float--,this.args.standingOn instanceof T&&this.args.standingOn.callCollideHandler(this),!this.args.float&&this.args.falling?this.args.standingOn&&this.args.standingOn.isVehicle||(this.args.standingOn=null,this.args.landed=!1,this.lastAngles=[],this.args.jumping&&this.args.jumpedAt<this.y?this.args.deepJump=!0:this.args.jumping&&this.args.jumpedAt>this.y+160?this.args.highJump=!0:this.args.jumping&&(this.args.deepJump=!1,this.args.highJump=!1)):this.args.jumping&&!this.args.falling&&(this.args.jumping=!1,this.args.deepJump=!1,this.args.highJump=!1,this.args.jumpedAt=null),!this.args.falling&&this.args.standingOn&&this.args.rolling&&this.args.modeTime<3&&!this.args.dropDashCharge&&this.args.standingOn.args.convey&&(this.args.gSpeed=.8*-this.args.standingOn.args.convey);var B=this.getLocalDrag(),D=new Set;if(!this.noClip){D=this.viewport.regionsAtPoint(this.x,this.y);var I,F=O(this.regions);try{for(F.s();!(I=F.n()).done;){I.value.updateActor(this)}}catch(t){F.e(t)}finally{F.f()}}this.args.gSpeedMax;if(!this.isRegion){var L,N=O(this.regions);try{for(N.s();!(L=N.n()).done;){var q=L.value;D.has(q)||(this.regions.delete(q),this.crossRegionBoundary(q,!1))}}catch(t){N.e(t)}finally{N.f()}var W,U=O(D);try{for(U.s();!(W=U.n()).done;){var V=W.value;if(this.args.density&&V.args.density&&this.args.density<V.args.density){V.args.density,this.args.density;var H=!1,G=this.getMapSolidAt(this.x,this.y-this.args.height);if(Array.isArray(G)&&(G.filter(function(t){return!w(D).includes(t)}),G.length&&(H=!0)),!H){var z=this.y-this.args.height,Y=V.y-V.args.height,K=Math.min((z+-Y+4)/this.args.height,1);this.args.float=1;var J=K*B;this.args.falling=!0,K>-1?(this.args.ySpeed-=J,this.args.ySpeed*=B):K<-1&&this.args.ySpeed<0&&Math.abs(K)<.25&&Math.abs(this.args.ySpeed)<1&&(this.args.ySpeed=0,this.args.y=-1+Y+this.args.height)}}this.regions.has(V)||(this.regions.add(V),this.crossRegionBoundary(V,!0))}}catch(t){U.e(t)}finally{U.f()}}if(!this.willJump||this.args.dontJump||this.args.falling&&!(this.falltime<2)){if(this.willJump=!1,this.viewport){if(this.noClip&&(this.args.falling=!0),!this.args.static){var X=this.groundPoint,$=this.viewport.regionsAtPoint(X[0],X[1]+1),Z=this.getMapSolidAt.apply(this,w(X));if(!this.isRegion&&this.args.mode===E&&$.size){var Q,tt=!Z,et=O($);try{for(et.s();!(Q=et.n()).done;){var rt=Q.value;if(this.broad||!this.args.falling&&(this.y===rt.y-rt.args.height||this.y+1===rt.y-rt.args.height)){if(Math.max(Math.abs(this.args.gSpeed),Math.abs(this.args.xSpeed))>=rt.skimSpeed){var nt=this.args.falling?Math.abs(this.args.xSpeed):Math.abs(this.args.gSpeed);this.args.gSpeed=nt*Math.sign(this.args.gSpeed||this.args.xSpeed),this.y-16<rt.y-rt.args.height?(this.args.skimming=!0,this.args.y=rt.y-rt.args.height-1,tt=!1,rt.skim(this)):this.broad&&this.args.ySpeed--;break}this.args.xSpeed=this.args.gSpeed||this.args.xSpeed}}}catch(t){et.e(t)}finally{et.f()}this.args.standingOn=null,this.args.falling=this.args.ySpeed>=0?tt:this.args.falling,this.args.falling?(this.args.xSpeed=this.args.xSpeed||this.args.gSpeed,this.args.standingLayer=null):this.args.gSpeed=this.args.gSpeed||this.args.xSpeed}else this.noClip||this.args.xSpeed||this.args.ySpeed||this.args.float||(this.args.falling=!this.checkBelow()||this.args.falling);if(this.noClip||!this.isRegion&&!this.isEffect&&this.args.falling&&this.viewport?(this.args.grinding&&(this.args.grinding=!1),this.args.mode=E,this.args.gSpeed=0,this.args.pushing=!1,(this.args.xSpeed||this.args.ySpeed)&&(this.args.hangingFrom?this.args.groundTimeTotal++:(this.updateAirPosition(),this.args.airTimeTotal++)),this.args.animationBias=Math.abs(this.args.airSpeed/this.args.flySpeedMax),this.args.animationBias>1&&(this.args.animationBias=1)):this.noClip&&!this.args.standingLayer&&(this.isRegion||this.isEffect||this.args.falling)||(this.args.xSpeed=0,this.args.ySpeed=0,this.xLast=this.args.x,this.yLast=this.args.y,this.args.grinding&&!this.args.gSpeed&&(this.args.gSpeed=Math.sign(this.args.direction||this.axis)),this.updateGroundPosition(),this.args.groundTimeTotal++,this.args.animationBias=Math.abs((.75*this.args.hSpeed||this.args.gSpeed)/this.args.gSpeedMax),this.args.animationBias>1&&(this.args.animationBias=1)),this.args.rolling&&this.args.pushing&&(this.args.gSpeed=0),!this.viewport)return}var it=Math.ceil(this.args.width/2),ot=Math.floor(this.args.height/2);if(!this.noClip&&!this.isRegion&&this.args.pushed){var at,st=function(e){switch(t.args.mode){case E:at=t.getMapSolidAt(t.x+it*e+(-1===e?0:-1),t.y-ot);break;case 2:at=t.getMapSolidAt(t.x+it*e+(-1===e?0:-1),t.y+ot);break;case 1:at=t.getMapSolidAt(t.x+ot*(-1===e?0:2),t.y);break;case 3:at=t.getMapSolidAt(t.x-ot*(-1===e?0:2),t.y)}return at&&Array.isArray(at)?at.filter(function(t){return!t.isVehicle}):at},ct=st(-1),ut=st(1);ut&&!ct&&(this.args.xSpeed>0&&(this.args.xSpeed=0),this.args.x--),ct&&!ut&&(this.args.xSpeed>0&&(this.args.xSpeed=0),this.args.x++)}if(this.viewport&&!this.removed){this.viewport.objectPalette["layer-switch"];var lt=[this.viewport.objectPalette["base-region"]];if(!this.isGhost&&!lt.some(function(e){return t instanceof e})){var ft;switch(this.args.mode){case 2:ft=viewport.actorsAtPoint(this.args.x,this.args.y+this.args.height,this.args.width,this.args.height);break;case 1:ft=viewport.actorsAtPoint(this.args.x+this.args.height/2,this.args.y+this.args.width/2,this.args.height,this.args.width);break;case 3:ft=viewport.actorsAtPoint(this.args.x-this.args.height/2,this.args.y+this.args.width/2,this.args.height,this.args.width);break;default:case E:ft=viewport.actorsAtPoint(this.args.x,this.args.y,this.args.width,this.args.height)}ft.forEach(function(e){return e.args!==t.args&&!e.isPushable&&e.callCollideHandler(t)})}if(this.viewport){this.viewport.tileMap;if(Math.abs(this.args.gSpeed)<2&&!this.args.falling){var ht=this.stayStuck;if(this.regions.forEach(function(t){ht=ht||t.args.sticky}),!ht&&!this.args.climbing){Math.floor(this.args.width/2);var pt=this.args.mode;if(this.args.mode===E&&this.args.groundAngle<=-Math.PI/4)this.args.gSpeed=1;else if(this.args.mode===E&&this.args.groundAngle>=Math.PI/4&&this.args.groundAngle<Math.PI)this.args.gSpeed=-1;else if(1===pt&&this.args.groundAngle<.15*Math.PI)this.lastAngles=[],this.args.mode=E,this.args.falling=!0,this.args.x+=this.args.width/2,this.args.ignore=30;else if(3===pt&&this.args.groundAngle>.15*-Math.PI)this.lastAngles=[],this.args.mode=E,this.args.falling=!0,this.args.x-=this.args.width/2,this.args.ignore=30;else if(2===pt){this.lastAngles=[],this.args.xSpeed=0,this.args.y+=this.args.height,this.args.ignore=8,this.args.falling=!0,this.willJump=!1;var gt=this.args.gSpeed;this.args.mode=E,this.onNextFrame(function(){t.args.mode=E,t.willJump=!1,t.args.xSpeed=-gt}),-1===Math.sign(this.xSpeedLast)?(this.args.facing="left",this.args.x++):1===Math.sign(this.xSpeedLast)&&(this.args.facing="right",this.args.x--)}}}if(this.args.landed=!0,this.controllable&&(this.args.x=this.args.x,this.args.y=this.args.y),this.controllable&&this.processInput(),this.args.falling||this.args.gSpeed?this.args.stopped=0:this.args.stopped++,this.lastAngles.length>0&&(this.args.groundAngle=this.lastAngles.map(function(t){return Number(t)}).reduce(function(t,e){return t+e})/this.lastAngles.length),isNaN(this.args.groundAngle)&&console.log(this.lastAngles,this.lastAngles.length),!this.args.float&&!this.args.static){var dt=this.getMapSolidAt.apply(this,w(this.groundPoint));if(Array.isArray(dt)&&dt.length&&!this.args.float){this.args.standingLayer=!1;var yt=dt.filter(function(e){return e.args!==t.args&&e.solid&&e.callCollideHandler(t)});if(yt.length){var bt,vt=O(yt);try{for(vt.s();!(bt=vt.n()).done;){var mt=bt.value;!mt.isVehicle&&this.y>1+mt.y+-mt.args.height||(this.args.groundAngle=mt.groundAngle||0,this.args.standingOn=mt)}}catch(t){vt.e(t)}finally{vt.f()}}}else dt?(this.args.standingOn=null,"object"===m(dt)?(this.args.standingLayer=dt,this.args.modeTime<1&&dt.xLayerSpeed&&(this.args.gSpeed=0)):this.args.standingLayer=null):this.args.standingOn=null}if(this.args.falling&&this.args.ySpeed<this.args.ySpeedMax){if(!this.args.float){var wt,St=1,Ot=O(this.regions);try{for(Ot.s();!(wt=Ot.n()).done;){var jt=wt.value;(jt.args.gravity||1===jt.args.gravity)&&(St*=jt.args.gravity)}}catch(t){Ot.e(t)}finally{Ot.f()}this.args.ySpeed+=this.args.gravity*St}this.args.landed=!1}this.args.falling||(this.checkDropDash(),this.args.jumping=!1);var kt,xt=O(this.behaviors);try{for(xt.s();!(kt=xt.n()).done;){kt.value.update(this)}}catch(t){xt.e(t)}finally{xt.f()}this.twister&&(this.twister.args.x=this.args.x,this.twister.args.y=this.args.y,this.twister.args.xOff=this.args.xOff,this.twister.args.yOff=this.args.yOff,this.twister.args.width=this.args.width,this.twister.args.height=this.args.height),this.pincherBg&&(this.pincherBg.args.x=this.args.x,this.pincherBg.args.y=this.args.y,this.pincherBg.args.xOff=this.args.xOff,this.pincherBg.args.yOff=this.args.yOff,this.pincherBg.args.width=this.args.width,this.pincherBg.args.height=this.args.height),this.pincherFg&&(this.pincherFg.args.x=this.args.x,this.pincherFg.args.y=this.args.y,this.pincherFg.args.xOff=this.args.xOff,this.pincherFg.args.yOff=this.args.yOff,this.pincherFg.args.width=this.args.width,this.pincherFg.args.height=this.args.height),this.args.falling?(this.args.rolling=!1,this.fallTime++):(this.args.idleTime++,(this.yAxis||this.xAxis)&&(this.args.idleTime=0)),this.args.carrying=!!this.carrying.size,this.args.carrying&&(Math.abs(this.args.gSpeed)>8&&(this.args.gSpeed=8*Math.sign(this.args.gSpeed)),this.args.idleTime=0,this.args.rolling=!1)}}}}else{this.willJump=!1;this.viewport.tileMap;var Pt=Math.max(this.args.height,32),_t=this.rotatePoint(0,Pt+1),Mt=this.getMapSolidAt(this.x+_t[0],this.y+_t[1]);if(Array.isArray(Mt)&&(Mt=!!Mt.filter(function(t){return!t.args.platform&&!t.isVehicle}).length),!Mt){var Rt=this.args.jumpForce*B;this.running?Rt*=1.5:this.crawling&&(Rt*=.5),this.doJump(Rt)}}}}}else{var Tt;switch(this.args.xSpeed&&(this.args.x+=this.args.xSpeed),this.args.ySpeed&&(this.args.y+=this.args.ySpeed),!this.args.float&&this.args.falling&&(this.args.ySpeed+=this.args.gravity),this.args.float>0&&this.args.float--,this.args.mode){case 2:Tt=viewport.actorsAtPoint(this.args.x,this.args.y+this.args.height,this.args.width,this.args.height);break;case 1:Tt=viewport.actorsAtPoint(this.args.x-this.args.height/2,this.args.y+this.args.width/2,this.args.height,this.args.width);break;case 3:Tt=viewport.actorsAtPoint(this.args.x+this.args.height/2,this.args.y+this.args.width/2,this.args.height,this.args.width);break;default:case E:Tt=viewport.actorsAtPoint(this.args.x,this.args.y,this.args.width,this.args.height)}if(Tt){var At,Et=O(Tt);try{for(Et.s();!(At=Et.n()).done;){var Ct=At.value;Ct.args!==this.args&&Ct.callCollideHandler(this)}}catch(t){Et.e(t)}finally{Et.f()}}}}},{key:"popOut",value:function(t){var e=this.args.width/2,r=t.args.width/2,n=this.y-this.args.height+1,i=this.y,o=this.x-t.x,a=e+r;this.solid&&Math.abs(o)<Math.abs(a)&&i>t.y&&t.y>n&&(t.args.x=this.x+a*-Math.sign(o))}},{key:"getLocalDrag",value:function(){var t,e=1,r=O(this.regions);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.skimmers.has(this)||i.skimmers.has(n.Bindable.make(this))||(i.args.drag||0===i.args.drag)&&i.args.drag<e&&(e=i.args.drag)}}catch(t){r.e(t)}finally{r.f()}return e}},{key:"updateGroundPosition",value:function(){var t=this,e=this.getLocalDrag();this.args.gSpeedMax;this.running||this.crawling;var r=[0,0],n=Math.ceil(this.args.width/2),i=this.paused;if(this.args.gSpeed){Math.abs(this.args.gSpeed);var o=Math.sign(this.args.gSpeed),a=Math.abs(this.args.gSpeed);this.pause(!0);var s=this.args.modeTime>10&&this.scanForward(this.args.gSpeed,1);if(!1===s||s>0)for(var c=0;c<a;c+=1){if(this.args.height>8&&this.args.modeTime>1){if(this.args.pushing=!1,!this.args.rolling){var u=this.rotatePoint(n*-o,this.args.height),l=this.getMapSolidAt(this.x+u[0],this.y+u[1]);if(Array.isArray(l)&&(l=l.filter(function(e){return e.args!==t.args&&e.callCollideHandler(t)&&e.solid}).length),l){2===this.args.mode&&(this.args.x+=n*Math.sign(this.args.gSpeed),this.args.y+=this.args.height,this.args.mode=E),this.args.pushing=Math.sign(this.args.gSpeed);break}}if(0===this.args.groundAngle){var f=this.rotatePoint(n*-o,.5*this.args.height),h=this.getMapSolidAt(this.x+f[0],this.y+f[1]);if(Array.isArray(h)&&(h=h.filter(function(e){return e.args!==t.args&&e.callCollideHandler(t)&&e.solid}).length),h){2===this.args.mode&&(this.args.x+=n*Math.sign(this.args.gSpeed),this.args.y+=this.args.rollingeight||this.args.height,this.args.mode=E),this.args.pushing=Math.sign(this.args.gSpeed);break}}}var p,g=O(this.behaviors);try{for(g.s();!(p=g.n()).done;){var d=p.value;d.movedGround&&d.movedGround(this)}}catch(t){g.e(t)}finally{g.f()}if(r=this.findNextStep(1*o),this.args.falling)return;if(!r)break;if(r[3]){this.args.moving=!1,this.args.gSpeed=.15*Math.sign(this.args.gSpeed),1!==this.args.mode&&3!==this.args.mode||(this.args.mode=E,this.lastAngles=[]);break}if(!0===r[2]){var y=this.args.gSpeed,b=this.args.groundAngle;this.args.standingLayer=null;var v=void 0;switch(this.args.mode){case E:v=this.args.width/2,Math.abs(y)<v?this.args.x+=v*Math.sign(y):this.args.x+=Math.sign(y),this.args.xSpeed=y*Math.cos(b),this.args.ySpeed=-y*Math.sin(b),this.args.float=this.args.float<0?this.args.float:1;var m=!!this.args.gSpeed;this.checkBelow(this.x,this.y)&&(this.args.gSpeed=y,this.args.xSpeed=0,this.args.ySpeed=0,m=!1,this.canRoll&&this.yAxis>.55&&(this.args.rolling=!0)),this.args.falling=m,this.args.ignore=2;break;case 2:this.args.y+=this.args.height,this.args.float=this.args.float<0?this.args.float:1,this.args.falling=!0,this.args.mode=E,this.args.xSpeed=-y*Math.cos(b),this.args.ySpeed=y*Math.sin(b),this.lastAngles.splice(0),this.args.direction*=-1,this.args.rolling||(this.args.facing="left"===this.args.facing?"right":"left"),this.args.ignore=3;break;case 1:v=this.args.width/2,this.args.height/2,this.args.climbing||(Math.abs(this.args.gSpeed)<2&&!this.args.rolling?this.args.gSpeed<0?(this.args.x-=this.args.direction,this.args.y-=this.args.gSpeed+-2,this.args.groundAngle=0):this.args.x+=v:(this.args.ignore=-3,this.args.x+=v),this.args.xSpeed=y*Math.sin(b),this.args.ySpeed=y*Math.cos(b)),this.args.falling=!0;break;case 3:v=this.args.width/2,this.args.height/2,this.args.climbing||(Math.abs(this.args.gSpeed)<2&&!this.args.rolling?this.args.gSpeed>0?(this.args.x-=this.args.direction,this.args.y-=this.args.gSpeed+2,this.args.groundAngle=0):this.args.x-=v:(this.args.ignore=-3,this.args.x-=v),this.args.xSpeed=-y*Math.sin(b),this.args.ySpeed=-y*Math.cos(b)),this.args.falling=!0}break}if(r[0]||r[1])!r[0]&&!r[1]||this.rotateLock||(this.args.moving=!0,this.args.angle=r[0]?Math.atan(r[1]/r[0]):Math.sign(r[1])*Math.PI/2,this.lastAngles.unshift(this.args.angle),this.lastAngles.splice(this.angleAvg));else switch(this.args.moving=!1,this.args.mode){case E:case 2:this.args.gSpeed=0}if(!this.rotateLock){switch(this.args.mode){case E:this.args.x+=r[0],this.args.y-=r[1];break;case 2:this.args.x-=r[0],this.args.y+=r[1];break;case 1:this.args.x+=r[1],this.args.y+=r[0];break;case 3:this.args.x-=r[1],this.args.y-=r[0]}if(this.args.angle>Math.PI/4&&this.args.angle<Math.PI/2){switch(this.lastAngles=this.lastAngles.map(function(t){return t-Math.PI/2}),this.args.mode){case E:this.args.mode=3;break;case 3:this.args.mode=2;break;case 2:this.args.mode=1;break;case 1:this.args.mode=E}this.args.groundAngle-=Math.PI/2}else if(this.args.angle<-Math.PI/4&&this.args.angle>-Math.PI/2){this.args.mode;switch(this.lastAngles=this.lastAngles.map(function(t){return Number(t)+Math.PI/2}),this.args.mode){case E:this.args.mode=1;break;case 3:this.args.mode=E;break;case 2:this.args.mode=3;break;case 1:this.args.mode=2}this.args.groundAngle=Number(this.args.groundAngle)+Math.PI/2}}}else this.args.pushing=Math.sign(this.args.gSpeed);var w=Math.round(this.args.height/2);if(!this.static&&this.args.mode===E){for(;(this.args.gSpeed<=0||this.args.modeTime<3)&&this.getMapSolidAt(this.x-n,this.y-w,!1);)this.args.x++;for(;(this.args.gSpeed>=0||this.args.modeTime<3)&&this.getMapSolidAt(this.x+n,this.y-w,!1);)this.args.x--}i||this.pause(!1);var S=this.xAxis&&Math.sign(this.xAxis)===Math.sign(this.args.gSpeed);if(this.args.mode===E||2===this.args.mode||this.args.gSpeed<0&&1===this.args.mode||this.args.gSpeed>0&&3===this.args.mode){var j=this.xAxis&&Math.sign(this.xAxis)!==Math.sign(this.args.gSpeed),k=this.args.decel*(this.args.rolling&&j?3:.75);this.args.climbing||!this.args.gSpeed||S&&!this.args.rolling||(this.args.grinding?this.yAxis>.5||(this.args.gSpeed-=1*k/e*.125*Math.sign(this.args.gSpeed)):this.args.rolling?this.args.gSpeed-=1*k/e*.06125*Math.sign(this.args.gSpeed):this.args.grinding||this.args.rolling||this.xAxis&&!j||(this.args.gSpeed-=1*k/e*Math.sign(this.args.gSpeed)),Math.abs(this.args.gSpeed)<.1&&(this.args.gSpeed=0))}!S&&Math.abs(this.args.gSpeed)<1&&(this.args.wallSticking||(this.args.gSpeed=0));var x=0;if(!this.args.climbing){switch(this.args.mode){case E:x=this.args.groundAngle/(Math.PI/2),o>0&&(x*=-1);break;case 2:x=-this.args.groundAngle/(Math.PI/2),o>0&&(x*=-1);break;case 3:o>0?(x=-1,x-=this.args.groundAngle/(Math.PI/2)):(x=1,x+=this.args.groundAngle/(Math.PI/2));break;case 1:o>0?(x=1,x-=this.args.groundAngle/(Math.PI/2)):(x=-1,x+=this.args.groundAngle/(Math.PI/2))}if(this.args.rolling)x>0?this.args.gSpeed+=2.2*x*this.args.accel*o:x<0&&this.args.modeTime<10&&(this.args.gSpeed+=1.6*x*this.args.decel*o);else if(this.args.grinding){var P=Math.abs(this.args.gSpeed),_=Math.sign(this.args.gSpeed||this.xSpeedLast||1);this.args.direction=_,P<6?this.args.gSpeed=6*_:P>40?this.args.gSpeed=40*_:x<0?this.args.gSpeed*=1-(0-x/2*.015):x>0?this.args.gSpeed*=1.0015*(1+x/2*.045):this.args.gSpeed+=.1*_}else this.stayStuck||(this.args.mode===E&&Math.abs(x)>.5&&(Math.abs(this.args.gSpeed)<1&&(this.args.gSpeed=4*Math.sign(x)),this.args.gSpeed+=.1*x),Math.abs(this.args.gSpeed))}}(!r||!1===r[0]&&!1===r[1])&&(this.args.ignore=this.args.ignore||1,this.args.falling&&(this.args.gSpeed=0))}},{key:"findAirPointA",value:function(t,e,r){if(r.viewport){var n=r.viewport,i=n.tileMap;if(n.actorsAtPoint(e[0],e[1]).filter(function(t){return t.args!==r.args&&t.callCollideHandler(r)&&t.solid}).length>0)return r.lastPointA;if(i.getSolid(e[0],e[1],r.args.layer))return r.lastPointA;Object.assign(r.lastPointA,e.map(Math.trunc))}}},{key:"findAirPointB",value:function(t,e,r){if(r.viewport){var n=r.viewport,i=n.tileMap;return n.actorsAtPoint(e[0],e[1]).filter(function(t){return t.args!==r.args&&t.callCollideHandler(r)&&t.solid}).length>0?r.lastPointB:i.getSolid(e[0],e[1],r.args.layer)?r.lastPointB:void Object.assign(r.lastPointB,e.map(Math.trunc))}}},{key:"updateAirPosition",value:function(){var t=this,e=this.args.xSpeed,r=this.args.ySpeed;this.args.standingLayer=null;this.viewport;var n=Math.ceil(this.args.width/2),i=Math.sign(this.args.xSpeed),o=this.viewport.tileMap,a=Math.pow(this.args.xSpeed,2)+Math.pow(this.args.ySpeed,2),s=a?Math.sqrt(a):0;if(this.args.airSpeed=s,s){if(this.controllable||this.isVehicle){var c=this.springing;this.args.groundAngle+=.001*-Math.sign(this.args.groundAngle)*(c?125:50)}if(Math.abs(this.args.groundAngle)<.04&&(this.args.groundAngle=0),this.noClip)return this.args.x+=this.args.xSpeed,void(this.args.y+=this.args.ySpeed);var u=(this.args.flying?this.args.height+this.args.yMargin:this.args.height)||1;this.upScan=!0;var l=this.args.ySpeed<0?-this.args.ySpeed+u:0,f=this.castRay(l,-Math.PI/2,[-this.args.width/2,0],this.findSolid),h=this.castRay(l,-Math.PI/2,[this.args.width/2,0],this.findSolid),p=(this.castRay(l,-Math.PI/2,[0,0],this.findSolid),!(!f&&!h)&&Math.min.apply(Math,w([f,h].filter(function(t){return!1!==t}))));this.upScan=!1;var g=[];if(!this.args.hLock){var d=this.args.xSpeed;g=[!!d&&this.scanForward(d,.9),!!d&&this.scanForward(d,.5),!!d&&this.scanForward(d,.1)].filter(function(t){return!1!==t})}if(this.args.ySpeed&&p&&this.lastLayer&&this.lastLayer.offsetYChanged)return this.args.y+=this.lastLayer.offsetYChanged+1,this.args.ySpeed=this.lastLayer.offsetYChanged+1,void(this.lastLayer=null);var y=!1;[f,h].some(function(t){return!1===t})||(y=Math.atan2(f-h,this.args.width));this.willStick||this.args.deepJump;var b=this.xLast-this.x;if(f&&h&&p<=l&&(!this.args.flying||this.canStick)&&Math.abs(y)<Math.PI/4&&this.args.ySpeed<=0)return this.args.y-=p-this.args.height,this.args.ySpeed&&(this.args.falling=!0),void(this.args.ySpeed=Math.max(0,this.args.ySpeed));if(!this.willStick&&g.length>1&&(!1===p||p<this.args.height)){var v=Math.sign(this.args.xSpeed),S=(Math.max.apply(Math,w(g)),-1+Math.min.apply(Math,w(g))),O=this.args.width,j=O+-S,k=j*-v;isNaN(k)||k&&!(j<O)&&Math.sign(k)!==Math.sign(this.args.xSpeed)||(this.args.x+=k,this.args.flySpeed=0,this.args.xSpeed=0,this.args.gSpeed=0,this.args.mode=E),this.viewport.actorsAtPoint(this.x+(0+n)*v,this.y,this.args.width,this.args.height).forEach(function(e){e!==t&&e.callCollideHandler(t,v<0?1:3)})}Object.assign(this.lastPointA,[this.x,this.y].map(Math.trunc)),Object.assign(this.lastPointB,[this.x,this.y].map(Math.trunc));var x=1+Math.ceil(s),P=this.castRay(x,this.airAngle,this.findAirPointA),_=this.rotateLock?P:this.castRay(x,this.airAngle,[0,-3*Math.sign(this.args.ySpeed||1)],this.findAirPointB);this.willJump=!1;var M=!1,R=!1;if([P,_].some(function(t){return!1===t})||(R=Math.atan2(P[1]-_[1],P[0]-_[0])),this.xLast=this.args.x,this.yLast=this.args.y,!1!==P){var A=!1;e<0&&(A=R<=Math.PI/2),e>0&&(A=R>=Math.PI/2);var C=A&&e<0,B=A&&e>0,D=this.checkBelow.apply(this,w(P));this.willStick||(this.args.gSpeed=e,D&&"object"===m(D)&&D.offsetXChanged&&(this.args.gSpeed-=D.offsetXChanged));var I=P[0],F=P[1];this.args.ySpeed&&Math.sign(F-this.y)!==Math.sign(this.args.ySpeed)?!0:(this.args.xSpeed=0,this.args.ySpeed=0),this.args.x=I,this.args.y=F,M=this.getMapSolidAt(this.x+i,this.y),Array.isArray(M)&&((M=M.filter(function(e){return e.callCollideHandler(t)})).length||(M=!1)),this.rotateLock||(!1!==y&&y<0?(this.args.gSpeed=0,this.args.mode=1,this.args.direction=1,this.args.facing="right"):!1!==y&&y>0?(this.args.gSpeed=0,this.args.mode=3,this.args.direction=-1,this.args.facing="left"):!this.willStick&&(C||B)||this.getMapSolidAt(this.x-i,this.y)||this.getMapSolidAt(this.x-i,this.y+1)||(C?(this.args.gSpeed=0,this.args.mode=1,this.args.direction=1,this.args.facing="right"):B?(this.args.gSpeed=0,this.args.mode=3,this.args.direction=-1,this.args.facing="left"):!1!==y&&(this.args.mode=2)));Math.floor(this.args.width/2);var L=this.findNextStep(-2),N=this.findNextStep(2);if(this.xSpeedLast>0&&N&&N[3])this.args.x-=this.args.width;else if(this.xSpeedLast<0&&L&&L[3])this.args.x+=this.args.width;else if(!N||!1!==N[0]&&!1!==N[1]||!L||!1!==L[0]&&!1!==L[1]){var q,W,U,V,H=0;if(N&&L)H=(r<0?-1:1)*Number(Math.atan2((null!==(q=N[1])&&void 0!==q?q:0)-(null!==(W=L[1])&&void 0!==W?W:0),(null!==(U=N[0])&&void 0!==U?U:0)-(null!==(V=L[0])&&void 0!==V?V:0)));if(isNaN(H))throw console.log(H),new Error("angle is NAN!");if(!N||!L||N[2]||L[2]||N[3]&&L[3]){if(!this.args.dead&&this.args.startled<175&&(N&&N[2]&&(!L||!L[3])||(!N||!N[3])&&L&&L[2]))return this.args.falling=!1,this.args.gSpeed=e,this.args.xSpeed=0,this.args.ySpeed=0,this.args.float=this.args.float||1,this.args.x+=e,void(this.args.y-=N[1]||L[1])}else{this.canRoll&&(this.yAxis>.55||this.args.dropDashCharge)&&(this.args.rolling=!0),this.args.startled<175&&(this.args.falling=!1),this.args.groundAngle=H,this.lastAngles.splice(0);var G=-this.args.groundAngle/(.4*Math.PI),z=0;z+=e||-b,z+=r*G,M&&M.length&&(z=0),this.args.mode%2==1&&(z*=-1),"object"===m(D)&&(this.args.standingLayer=D,D.offsetXChanged&&(z-=D.offsetXChanged,this.args.x+=D.offsetXChanged)),z&&(this.args.gSpeed=z)}Math.abs(this.args.gSpeed)}}else if(this.args.ySpeed>0){if(1===this.args.mode||3===this.args.mode){var Y=1===this.args.mode?-1:1;this.args.direction=Y,this.args.groundAngle=Math.PI/2*Y}e&&!this.args.falling&&(this.args.gSpeed=Math.floor(e)),P&&(yPointDir===ySpeedDir||!yPointDir&&1===ySpeedDir)&&(this.args.x=Number(P[0]),this.args.y=Number(P[1]),this.args.falling=!1)}if(o.getSolid(this.x+this.args.width/2*Math.sign(this.args.xSpeed),this.y,this.args.layer)||(Math.abs(this.args.xSpeed)>this.args.xSpeedMax&&(this.args.xSpeed=this.args.xSpeedMax*Math.sign(this.args.xSpeed)),Math.abs(this.args.ySpeed)>this.args.ySpeedMax&&(this.args.ySpeed=this.args.ySpeedMax*Math.sign(this.args.ySpeed))),!1===P){if(this.args.xSpeed){var K=!this.willStick&&this.getMapSolidAt(this.x+(1+n)*Math.sign(this.args.xSpeed),this.y-this.args.height/2),J=this.getMapSolidAt(this.x,this.y-24);K||(this.args.x=Number(this.args.x)+Number(this.args.xSpeed)),J&&(this.args.ySpeed+=J.yOffsetChanged,this.args.y+=this.args.height)}this.args.ySpeed&&(this.args.y=Number(Number(this.args.y)+Number(this.args.ySpeed)),this.args.flying&&this.args.ySpeed<0&&p>0&&(this.args.y+=u-p+4,this.args.ySpeed=0))}else this.viewport&&this.ySpeedLast>0&&this.viewport.tileMap.getSolid(this.args.x,this.args.y)&&!this.viewport.tileMap.getSolid(this.args.x,this.args.y-1)&&this.args.y--;if(this.args.standingOn instanceof T){var X=this.args.standingOn.y+-this.args.standingOn.args.height+-1;(this.y<X||this.args.ySpeed<0)&&(this.args.standingOn=null)}}}},{key:"checkDropDash",value:function(){var t=this;if(this.dropDashCharge&&this.args.mode===E){var e=this.dropDashCharge*Math.sign(this.args.direction);this.dropDashCharge=0,this.onNextFrame(function(){t.args.gSpeed+=e,t.args.rolling=!0});var r=this.viewport,n=new o.Tag('<div class = "particle-dust">'),i=this.rotatePoint(this.args.gSpeed,0);n.style({"--x":i[0]+this.x,"--y":i[1]+this.y,"z-index":0,opacity:2*Math.random()}),r.particles.add(n),setTimeout(function(){r.particles.remove(n)},350)}}},{key:"setCameraMode",value:function(){var t=this;if(this.viewport)if(this.focused)this.args.cameraMode="panning";else if(this.viewport.args.cutScene)this.args.cameraMode="cutScene";else if(this.args.bossMode)this.args.cameraMode="boss";else if(this.args.standingOn&&this.args.standingOn.isVehicle)this.args.cameraMode=this.args.standingOn.args.cameraMode;else if(this.args.localCameraMode)this.args.cameraMode=this.args.localCameraMode;else if(this.controllable)if(!this.args.falling&&this.args.rolling&&this.args.jumpBlocked)this.args.cameraMode="tube";else if(!this.args.falling||this.getMapSolidAt(this.x,this.y+24)){var e=this.getMapSolidAt(this.x+32*this.args.direction,this.y+24),r=(this.getMapSolidAt(this.x+32*this.args.direction,this.y+96),this.getMapSolidAt(this.x+0*this.args.direction,this.y+48));this.args.mode===E&&0===this.args.groundAngle?r||!e||this.args.grinding||this.args.skimming?this.args.cameraMode="normal":this.args.cameraMode="bridge":this.args.cameraMode="normal"}else this.getMapSolidAt(this.x+0*this.args.direction,this.y+64)?this.args.cameraMode="normal":this.fallTime>15&&(this.args.cameraMode="aerial"),this.viewport.onFrameOut(45,function(){"airplane"!==t.args.cameraMode&&t.args.falling&&Math.abs(t.args.xSpeed>25)&&!t.getMapSolidAt(t.x,t.y+480)&&(t.args.cameraMode="airplane")})}},{key:"callCollideHandler",value:function(t){if(this.ignores.has(t))return!1;if(t.ignores.has(this))return!1;if(!this.args.dead&&!t.args.dead){if(t===this.args.hangingFrom)return!1;var e;if(!this.isGhost&&!t.isGhost)if(t.y<=this.y-this.args.height?(this.args.collType="collision-top",e=0):t.x<this.x-Math.floor(this.args.width/2)?(this.args.collType="collision-left",e=1):t.x>=this.x+Math.floor(this.args.width/2)?(this.args.collType="collision-right",e=3):t.y>=this.y?(this.args.collType="collision-bottom",e=2):(this.args.collType="collision-intersect",e=-1),this.viewport){this.viewport.collisions.has(this)||this.viewport.collisions.set(this,new Map),this.viewport.collisions.has(t)||this.viewport.collisions.set(t,new Map);var r=e>-1?(e+2)%4:e,n=this.viewport.collisions.get(this,e),i=this.viewport.collisions.get(t,r);n.set(t,e),i.set(this,r),this.viewport.collisions.set(t,i),this.collideB(t,e),t.collideB(this,r);var o=this.collideA(t,e),a=t.collideA(this,r),s=o||a;return this.args.colliding=this.colliding=this.colliding||s||!1,s}}}},{key:"checkBelow",value:function(){var t,e,r=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n=null!==(t=n)&&void 0!==t?t:this.x,i=null!==(e=i)&&void 0!==e?e:this.y;var o=[],a=[];switch(this.args.mode){case E:o[0]=n+0,o[1]=i+1,a[0]=n-0,a[1]=i+1;break;case 1:o[0]=n-1,o[1]=i+0,a[0]=n-1,a[1]=i-0;break;case 2:o[0]=n-0,o[1]=i-1,a[0]=n+0,a[1]=i-1;break;case 3:o[0]=n+1,o[1]=i+0,a[0]=n+1,a[1]=i-0}var s=this.getMapSolidAt.apply(this,o);return Array.isArray(s)&&(s=s.filter(function(t){return t.callCollideHandler(r)}).length),s}},{key:"processInput",value:function(){if(this.controllable&&this.args.standingOn&&this.args.standingOn.isVehicle&&this===n.Bindable.make(this.args.standingOn.occupant)){if(this.args.modeTime<5)return;this.viewport.auras.add(this.args.standingOn);var t=this.args.standingOn;t.xAxis=this.xAxis,t.yAxis=this.yAxis,t.stayStuck=this.stayStuck,t.willStick=this.willStick,this.processInputVehicle(),this.args.direction=t.args.direction,this.args.facing=t.args.facing,this.args.layer=t.args.layer,this.args.mode=t.args.mode,this.args.angle=t.args.angle}else this.controllable&&this.processInputDirect()}},{key:"processInputDirect",value:function(){var t=this.xAxis,e=this.yAxis,r=this.args.gSpeedMax;this.running?r=1/0:this.crawling&&(r=1);var n=this.getLocalDrag();if(this.noClip)this.args.ignore||(this.args.xSpeed+=t*this.args.airAccel*n,this.args.ySpeed+=e*this.args.airAccel*n,t||(this.args.xSpeed=0),e||(this.args.ySpeed=0));else if(this.args.falling)this.args.falling&&t&&Math.abs(this.args.xSpeed)<this.args.xSpeedMax&&Math.abs(this.args.xSpeed)<this.args.gSpeedMax&&!this.args.ignore&&(this.args.xSpeed+=t*this.args.airAccel*n);else if(!this.args.rolling&&!this.yAxis&&!this.spindashCharge){var i=Math.sign(t),o=Math.sign(a),a=this.args.gSpeed;if(this.args.rolling||this.args.climbing||this.args.ignore||this.args.wallSticking||(i!==o&&o?this.args.ignore||(a+=t*this.args.accel*n*this.args.skidTraction):(a+=t*this.args.accel*n,2===Math.abs(i-o)&&(this.args.ignore=10))),Math.sign(this.args.gSpeed)&&Math.sign(this.args.gSpeed)!==Math.sign(a))return void(this.args.gSpeed=0);this.args.pushing&&Math.sign(t)!==Math.sign(this.args.pushing)?this.args.gSpeed=0:(!t||Math.abs(a)<r||Math.sign(a)!==Math.sign(t))&&(this.args.gSpeed=a)}t<0&&this.args.gSpeed&&!this.args.ignore&&(this.args.climbing||(this.args.facing="left"),(!this.args.grinding||Math.abs(this.args.gSpeed)<3)&&(this.args.direction=-1)),t>0&&this.args.gSpeed&&!this.args.ignore&&(this.args.climbing||(this.args.facing="right"),(!this.args.grinding||Math.abs(this.args.gSpeed)<3)&&(this.args.direction=1)),this.args.currentSheild instanceof v.StarSheild||(this.aAxis<-.75&&(this.inventory.has(b.ElectricSheild)?this.args.currentSheild=w(this.inventory.get(b.ElectricSheild))[0]:this.args.currentSheild=""),this.aAxis>.75&&(this.inventory.has(p.FireSheild)?this.args.currentSheild=w(this.inventory.get(p.FireSheild))[0]:this.args.currentSheild=""),this.bAxis<-.75&&(this.inventory.has(d.BubbleSheild)?this.args.currentSheild=w(this.inventory.get(d.BubbleSheild))[0]:this.args.currentSheild=""),this.bAxis>.75&&(this.inventory.has(y.NormalSheild)?this.args.currentSheild=w(this.inventory.get(y.NormalSheild))[0]:this.args.currentSheild=""))}},{key:"processInputVehicle",value:function(){this.args.standingOn.processInputDirect()}},{key:"collideA",value:function(t,e){return this.solid}},{key:"collideB",value:function(t){}},{key:"findDownSolid",value:function(t,e,r){if(r.viewport){var n=r.viewport,i=n.tileMap;if(0===r.args.groundAngle){var o,a=O(r.viewport.regionsAtPoint(e[0],e[1]));try{for(a.s();!(o=a.n()).done;){var s=o.value;if(r.args.mode===E&&-1+e[1]===s.y+-s.args.height&&Math.abs(r.args.gSpeed)>=s.skimSpeed)return-1+t}}catch(t){a.e(t)}finally{a.f()}}return i.getSolid(e[0],e[1],r.args.layer)?t:n.actorsAtPoint(e[0],e[1]).filter(function(t){return t.args!==r.args&&t.callCollideHandler(r)&&t.solid}).length>0?t:void 0}}},{key:"findUpSpace",value:function(t,e,r){if(r.viewport){var n=r.viewport,i=n.tileMap;if(r.args.groundAngle<=0){var o,a=O(r.viewport.regionsAtPoint(e[0],e[1]));try{for(a.s();!(o=a.n()).done;){var s=o.value;if(r.args.mode!==E||e[1]!==1+s.y+-s.args.height||Math.abs(r.args.gSpeed)<=s.skimSpeed)if(0===n.actorsAtPoint(e[0],e[1]).filter(function(t){return t.args!==r.args&&t.callCollideHandler(r)&&t.solid}).length&&!i.getSolid(e[0],e[1],r.args.layer))return t}}catch(t){a.e(t)}finally{a.f()}}return 0!==n.actorsAtPoint(e[0],e[1]).filter(function(t){return t.args!==r.args&&t.callCollideHandler(r)&&t.solid}).length||i.getSolid(e[0],e[1],r.args.layer)?void 0:t}}},{key:"findNextStep",value:function(t){if(this.viewport){if(void 0!==this.stepCache[t])return this.stepCache[t];this.viewport.tileMap;for(var e=this.maxStep*(this.args.falling&&!this.args.xSpeed?3:1),r=(Math.max(this.args.width/2,1),Math.sign(t)),n=!1,i=!1,o=0,a=0,s=0;s<Math.abs(t);s+=1){n=!1,i=!1;var c=void 0,u=(1+s)*r;switch(this.args.mode){case E:c=[u,1];break;case 3:c=[1,-u];break;case 2:c=[-u,-1];break;case 1:c=[-1,u]}if(!1===(n=this.castRay(e,this.downAngle,c,this.findDownSolid)))return[!1,!1,!0];var l=a-n;if(Math.abs(l)>=e)return[!1,!1,l<0,l>0];if(0===n){var f=void 0;switch(this.args.mode){case E:f=[u,0];break;case 3:f=[0,-u];break;case 2:f=[-u,0];break;case 1:f=[0,u]}var h=1+e;i=this.castRay(h,this.upAngle,f,this.findUpSpace);var p=Math.abs(o-i);if(!1===i)return[!1,!1,!1,!0];if(p>=e)return[!1,!1,!1,!0];o=i}else a=n;this.stepCache[s*r]=!1!==i?[s*r,i,!1]:[s*r,-n,!1]}return!1!==i?[s*r,i,!1]:[s*r,-n,!1]}}},{key:"castRay",value:function(){for(var t=1,e=function(){},r=Math.PI/2,n=[0,0],i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];switch(o.length){case 2:t=o[0],e=o[1];break;case 3:t=o[0],r=o[1],e=o[2];break;case 4:t=o[0],r=o[1],n=o[2],e=o[3]}for(var s=0;s<Math.floor(t);s++){var c=e(s,[this.args.x+n[0]+s*Math.cos(r),this.args.y+n[1]+s*Math.sin(r)],this);if(void 0!==c)return c}return!1}},{key:"doJump",value:function(t){if(!this.args.ignore&&!this.args.falling&&this.args.landed&&!this.args.float){this.args.standingOn&&this.args.standingOn.args.yForce?t+=Math.max(0,.25*this.args.standingOn.args.yForce):this.args.standingOn&&this.args.standingOn.yLast&&(t+=Math.max(0,this.args.standingOn.yLast-this.args.standingOn.args.y));var e=this.args.width/2,r=Math.min(e,4),n=this.findNextStep(-r),i=this.findNextStep(+r),o=2*r,a=Math.atan2(n[1]-i[1],Math.ceil(o));this.args.ignore=6,this.args.pushing=!1,this.args.landed=!1,this.args.falling=!0;this.args.mode;switch(this.args.mode){case E:this.args.y-=16;break;case 3:a+=-Math.PI/2,this.args.x+=-this.args.width/2;break;case 2:a+=Math.PI,this.args.y+=this.args.normalHeight||this.args.height;break;case 1:a+=Math.PI/2,this.args.x+=this.args.width/2}var s=this.args.gSpeed;this.args.standingOn&&this.args.standingOn.args.convey&&(s+=this.args.standingOn.args.convey),this.args.standingOn=null,this.args.xSpeed=s*Math.cos(a),this.args.ySpeed=s*Math.sin(a);var c=a-Math.PI/2,u=t*Math.cos(c),l=t*Math.sin(c);Math.abs(u)<.01&&(u=0),Math.abs(l)<.01&&(l=0),this.args.airAngle=c,this.args.xSpeed+=u,this.args.ySpeed+=l,this.args.jumpedAt=this.y,this.args.jumping=!0,this.viewport.tileMap.getSolid(this.x+this.args.width/2*Math.sign(this.args.xSpeed),this.y,this.args.layer)&&(this.args.xSpeed=0),this.args.rolling=!1,this.args.mode=E,this.args.groundAngle=0,this.args.gSpeed=0}}},{key:"impulse",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.impulseMag=t,this.impulseDir=e,this.impulseFal=r}},{key:"rad2deg",value:function(t){var e=180/Math.PI*t;return e>0?Math.floor(10*e)/10:Math.ceil(10*e)/10}},{key:"roundAngle",value:function(t,e){return e/=2,Math.round(t/(Math.PI/e))*Math.PI/e}},{key:"findNearestActor",value:function(t,e){var r=this,n=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],this.viewport);if(n){var i=n.getNearbyColCells(this),o=new Map;i.map(function(n){return n.forEach(function(n){if(n!==r&&!n.args.gone&&t(n)){var i=r.distanceFrom(n);Math.atan2(n.y-r.y,n.x-r.x);Math.abs(i)>e||o.set(i,n)}})});var a=w(o.keys()),s=Math.min.apply(Math,w(a));return o.get(s)}}},{key:"immune",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal";if(this.args.mercy)return!0;var r=this.args.currentSheild;return!!(r&&r.immune&&r.immune(this,t,e))}},{key:"damage",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal";if(!this.args.mercy){this.viewport.onFrameOut(180,function(){return e.args.mercy=!1});var n=new CustomEvent("damage",{cancelable:!0,detail:{other:t,type:r}});this.immune(t,r)||(this.dispatchEvent(n)?this.args.rings?(this.loseRings(),this.args.rings=0,this.startle(t),this.args.mercy=!0,this.viewport.settings.rumble&&(this.controller.rumble({duration:350,strongMagnitude:1,weakMagnitude:1}),this.onTimeout(350,function(){e.controller.rumble({duration:150,strongMagnitude:.5,weakMagnitude:1})}))):this.controllable&&(this.die(),this.viewport.settings.rumble&&this.controller.rumble({duration:450,strongMagnitude:1,weakMagnitude:1})):n.detail.immune||(this.args.y-=8,this.startle(t),this.args.mercy=!0,this.viewport.settings.rumble&&this.controller.rumble({duration:350,strongMagnitude:1,weakMagnitude:1})))}}},{key:"startle",value:function(t){if(!this.noClip){var e=Math.sign(this.args.xSpeed||this.args.gSpeed||this.args.direction);this.args.jumping=!1,this.args.falling=!0,this.args.startled=180,this.args.ignore=30,this.args.float=1,this.args.xSpeed=-2.25*e,this.args.ySpeed=-8,this.args.gSpeed=0,this.args.standingOn=!1,2===this.args.mode&&(this.args.xSpeed*=-1,this.args.ySpeed*=-1)}}},{key:"checkSolidActors",value:function(t){return t.args!==this.args&&(!!t.solid&&(!t.args.platform&&!t.isVehicle||this.y<=t.y+-t.args.height&&this.args.ySpeed>=0))}},{key:"findSolid",value:function(t,e,r){if(r.viewport){var n=r.viewport,i=n.tileMap;if(n.actorsAtPoint(e[0],e[1]).filter(r.checkSolidActors.bind(r)).length>0)return t;var o=i.getSolid(e[0],e[1],r.args.layer);return r.upScan&&(r.lastLayer=o),o?t:void 0}}},{key:"findSolidTile",value:function(t,e,r){var n=tileMap.getSolid(e[0],e[1],r.args.layer);if(this.upScan&&(r.lastLayer=n),n)return t}},{key:"scanForward",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Math.sign(t),i=this.args.width/2,o=Math.abs(t),a=this.viewport;if(a){a.tileMap;var s=this.args.falling?[i*-n,-this.args.height*e]:this.rotatePoint(i*-n,this.args.height*e);return this.castRay(o+this.args.width,this.args.falling?[Math.PI,0,0][n+1]:this.realAngle+[0,0,Math.PI][n+1],s,r?this.findSolid:this.findSolidTile)}}},{key:"scanBottomEdge",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=this.viewport.tileMap,n=this.args.width/2,i=r.getSolid(this.x-n,this.y-1,this.args.layer),o=r.getSolid(this.x+n,this.y-1,this.args.layer);if(!i||!o)return this.castRay(this.args.width,e<0?Math.PI:0,[-e*n,0],function(e,n){if(!t.viewport.actorsAtPoint(n[0],n[1]).filter(function(e){return e.args!==t.args}).length&&!r.getSolid(n[0],n[1]+1,t.args.layer))return e})}},{key:"scanVerticalEdge",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=this.viewport.tileMap;return this.castRay(this.args.height+1,Math.PI/2,[e*this.args.width/2,-this.args.height],function(e,n){if(t.viewport.actorsAtPoint(n[0],n[1]).filter(function(e){return e.args!==t.args}).length||r.getSolid(n[0],n[1],t.args.layer))return e})}},{key:"realAngle",get:function(){if(!this.args.falling&&this.args.standingOn)return this.args.standingOn.realAngle;var t,e=Number(this.args.groundAngle);if(this.args.falling)return-e-Math.PI;switch(this.args.mode){case 0:t=-e-Math.PI;break;case 1:t=-e-Math.PI/2;break;case 2:t=-e;break;case 3:t=-e+Math.PI/2}return t}},{key:"downAngle",get:function(){switch(this.args.mode){case E:return Math.PI/2;case 3:return 0;case 2:return-Math.PI/2;case 1:return Math.PI}}},{key:"upAngle",get:function(){switch(this.args.mode){case E:return-Math.PI/2;case 3:return Math.PI;case 2:return Math.PI/2;case 1:return 0}}},{key:"leftAngle",get:function(){switch(this.args.mode){case E:return Math.PI;case 3:return-Math.PI/2;case 2:return 0;case 1:return Math.PI/2}}},{key:"rightAngle",get:function(){switch(this.args.mode){case E:return 0;case 3:return Math.PI/2;case 2:return Math.PI;case 1:return-Math.PI/2}}},{key:"groundPoint",get:function(){switch(this.args.mode){case E:return[this.x+0,this.y+1];case 3:return[this.x+1,this.y+0];case 2:return[this.x+0,this.y-1];case 1:return[this.x-1,this.y+0]}}},{key:"rotatePoint",value:function(t,e){return[t*Math.cos(this.realAngle)-e*Math.sin(this.realAngle),e*Math.cos(this.realAngle)+t*Math.sin(this.realAngle)]}},{key:"standBelow",value:function(t){}},{key:"filterSolidActors",value:function(t){return t.args!==this.args&&(!!t.solid&&(!t.args.platform&&!t.isVehicle||this.y<=t.y+-t.args.height&&this.args.ySpeed>=0))}},{key:"getMapSolidAt",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.viewport){if(r){var n=this.viewport.actorsAtPoint(t,e).filter(this.filterSolidActors.bind(this));if(n.length>0)return n}return this.viewport.tileMap.getSolid(t,e,this.args.layer)}}},{key:"canRoll",get:function(){return!1}},{key:"canFly",get:function(){return!1}},{key:"canStick",get:function(){return!1}},{key:"canSpindash",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"isGhost",get:function(){return!1}},{key:"isPushable",get:function(){return!1}},{key:"isVehicle",get:function(){return!1}},{key:"solid",get:function(){return!1}},{key:"x",get:function(){return this.args.x}},{key:"y",get:function(){return this.args.y}},{key:"point",get:function(){return[this.args.x,this.args.y]}},{key:"rotateLock",get:function(){return!1}},{key:"controllable",get:function(){return!1}},{key:"skidding",get:function(){return Math.abs(this.args.gSpeed)&&!this.args.grinding&&Math.sign(this.args.gSpeed)!==this.args.direction}},{key:"effect",value:function(t){}},{key:"readInput",value:function(){if(this.controller){var t=this.controller;if(this.xAxis=0,this.yAxis=0,t.axes){t.axes[0]&&(this.xAxis=t.axes[0].magnitude),t.axes[1]&&(this.yAxis=t.axes[1].magnitude),t.axes[2]&&(this.aAxis=t.axes[2].magnitude),t.axes[3]&&(this.bAxis=t.axes[3].magnitude);var e=t.buttons;for(var r in this.buttons=e,e){var n=e[r],i="release_".concat(r),o="command_".concat(r),a="hold_".concat(r);if(0==r&&1===n.delta||!this.args.standingOn||!this.args.standingOn.isVehicle)1===n.delta?(this.args.currentSheild&&o in this.args.currentSheild&&this.args.currentSheild[o](this,n),this[o]&&this[o](n)):-1===n.delta?(this.args.currentSheild&&i in this.args.currentSheild&&this.args.currentSheild[i](this,n),this[i]&&this[i](n)):n.active&&(this.args.currentSheild&&a in this.args.currentSheild&&this.args.currentSheild[a](this,n),this[a]&&this[a](n));else if(this.args.standingOn&&this.args.standingOn.isVehicle){this.args.jumping=!1,this.args.flying=!1;var s=this.args.standingOn;1===n.delta?s[o]&&s[o](n):-1===n.delta?s[i]&&s[i](n):n.active&&s[a]&&s[a](n)}}}}}},{key:"command_0",value:function(){if(this.args.hangingFrom&&this.args.hangingFrom.unhook){var t=this.getLocalDrag();return this.args.ySpeed=-this.args.jumpForce*t*.75,void this.args.hangingFrom.unhook()}if((this.args.falling||this.willJump||this.args.dontJump)&&this.args.standingOn&&!this.args.standingOn.isVehicle){if(this.args.ignore&&-4!==this.args.ignore)return;return this.viewport.auras.delete(this.args.standingOn),void(this.willJump=!0)}this.willJump||(this.yAxis<0&&(this.ignores.set(this.args.standingOn,15),this.args.ignore=0),this.willJump=!0)}},{key:"command_1",value:function(){this.canRoll&&this.args.gSpeed&&(this.args.rolling=!0)}},{key:"release_0",value:function(){this.args.float||(this.args.jumping&&!this.lightDashed&&!this.dashed&&this.args.ySpeed<-8?this.args.ySpeed*=.5:this.args.jumping&&!this.lightDashed&&!this.dashed&&this.args.ySpeed<-4&&(this.args.ySpeed=-4))}},{key:"distanceFrom",value:function(t){var e=t.x,r=t.y,n=Math.pow(this.x-e,2)+Math.pow(this.y-r,2);return n?Math.sqrt(n):0}},{key:"twist",value:function(t){var e=this;if(!this.twister){var r=this.viewport.tags.bgFilters;this.twistFilter=new o.Tag('<div class = "point-actor-filter twist-filter">'),r.appendChild(this.twistFilter.node),this.twister=new a.Twist({id:"twist-"+this.args.id,scale:60}),this.twister.args.bindTo(["x","y","width","height","xOff","yOff"],function(t,r){var n;e.twistFilter.style((A(n={},"--".concat(r),t),A(n,"filter","url(#twist-".concat(e.args.id,")")),n))}),this.twister.render(this.twistFilter.node),this.onRemove(function(){return e.twistFilter.remove()})}this.twister.args.scale=t}},{key:"pinch",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.pincherBg){var r=this.viewport.tags.bgFilters;this.args.type.split(" ").shift();this.pinchFilterBg=new o.Tag('<div class = "point-actor-filter pinch-filter">'),r.appendChild(this.pinchFilterBg.node),this.pincherBg=new c.Pinch({id:"pinch-"+this.args.id,scale:60}),this.pincherBg.args.bindTo(["x","y","width","height","xOff","yOff"],function(e,r){var n;t.pinchFilterBg.style((A(n={},"--".concat(r),e),A(n,"filter","url(#pinch-".concat(t.args.id,")")),n))}),this.args.yOff=16,this.pincherBg.render(this.pinchFilterBg),this.onRemove(function(){return t.pinchFilterBg.remove()})}this.pincherBg.args.scale=e}},{key:"droop",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.args.width/2;if(!this.drooperFg)return this.drooperFg=new s.Droop({id:"droop-"+this.args.id,width:3*this.args.width,height:3*this.args.height,scale:64}),this.args.bindTo(["x","y"],function(e,r){t.drooperFg.args[r]=Number(e)}),this.onNextFrame(function(){t.drooperFg.args.scale=Number(2*e),t.sprite.style({transform:"translate(-50%, calc(".concat(e,"px + calc(-100% + 1px)))"),filter:"url(#droop-".concat(t.args.id,")")}),t.drooperFg.args.dx=-r}),void this.drooperFg.render(this.sprite);this.drooperFg.args.scale=Number(2*e),this.sprite.style({transform:"translate(-50%, calc(".concat(e,"px + calc(-100% + 1px)))"),filter:"url(#droop-".concat(this.args.id,")")});var i=1-r/n;this.args.width;this.drooperFg.args.droopWidthLeft="".concat(51*i+1,"%"),this.drooperFg.args.droopRightStart="".concat(51*i,"%"),this.drooperFg.args.droopWidthRight="".concat(102+-51*i,"%")}},{key:"crossRegionBoundary",value:function(t){if(t&&!this.args.static&&this.viewport){var e=this.viewport;if(!this.args.gone&&t.entryParticle){var r=new o.Tag(t.entryParticle);r.node&&(r.style({"--x":this.x+this.args.xSpeed,"--y":t.y+-t.args.height+-8,"z-index":5,opacity:Math.random,"--particleScale":this.args.particleScale,"--time":320}),e.particles.add(r),setTimeout(function(){return r.node&&e.particles.remove(r)},320))}}}},{key:"die",value:function(){var t=this;this.args.dead||(this.args.groundAngle=0,this.args.ySpeed=0,this.args.xSpeed=0,this.args.jumping=!1,this.args.falling=!0,this.args.ignore=-1,this.args.float=0,this.args.rings=0,this.args.standingLayer=null,this.args.standingOn=null,this.lastLayer=null,this.args.dead=!0,this.noClip=!0,this.args.ySpeed=-12,this.y>this.viewport.meta.deathLine&&(this.args.ySpeed=-14),this.args.xSpeed=0,this.viewport.onFrameOut(120,function(){t.args.dead&&t.respawn()}))}},{key:"respawn",value:function(){this.viewport&&(this.args.xSpeed=0,this.args.ySpeed=0,this.args.gSpeed=0,this.args.respawning=!0,this.args.display="none",this.args.x=-this.viewport.args.x,this.args.y=-this.viewport.args.y,this.args.standingLayer=null,this.args.standingOn=null,this.lastLayer=null)}},{key:"sleep",value:function(){}},{key:"wakeUp",value:function(){}},{key:"urlWrap",value:function(t){return"url(".concat(t,")")}},{key:"facePoint",get:function(){return this.rotatePoint(-5*this.args.direction,-14+this.args.height)}},{key:"registerDebug",value:function(t){window[t]=this}},{key:"loseRings",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.viewport.objectPalette.ring;this.spawnRings=this.spawnRings||0;for(var i=e||Math.min(this.args.rings,18),o=0,a=(this.spawnRings,Math.floor(i/8)),s=function(){var e=new n,s=Math.ceil(a*o/i),c=o%8*(4*Math.PI*s)/i,u=Math.cos(c),l=Math.sin(c);e.args.x=t.x-u*(8*s),e.args.y=t.y-l*(8*s)-t.args.height/4,e.args.xSpeed=0,e.args.ySpeed=-1,e.noClip=!0,e.args.static=!1,e.args.float=18,e.args.ignore=30,e.args.width=16,e.args.height=16,e.dropped=!0,t.viewport.onFrameOut(3+t.spawnRings%3,function(){t.viewport.spawn.add({object:e})}),t.spawnRings++,o++,t.viewport.onFrameOut(6*s,function(){e.args.xSpeed+=-u*s+3*(-.5+Math.random()),e.args.ySpeed+=-l*s+3*(-.5+Math.random())}),o%3==1?(e.args.decoration=!0,e.noClip=!0,t.viewport.onFrameOut(120,function(){t.viewport.actors.remove(e),t.spawnRings>0&&t.spawnRings--})):(e.args.decoration=!1,e.noClip=!1,t.viewport.onFrameOut(r||360-o%5*35,function(){t.viewport.actors.remove(e),t.spawnRings>0&&t.spawnRings--}))};this.spawnRings<i;)s()}},{key:"collect",value:function(t){t.dropped&&(this.spawnRings&&this.spawnRings--,t.dropped=!1)}},{key:"angleTo",value:function(t){return Math.atan2(this.y-t.y,this.x-t.x)}},{key:"distanceTo",value:function(t){return Math.sqrt(Math.pow(this.y-t.y,2)+Math.pow(this.x-t.x,2))}},{key:"setTile",value:function(){var t=this,e=this.viewport.tileMap;e.ready.then(function(r){var n=e.getTile(t.args.tileId-1);n&&(t.args.spriteX=n[0],t.args.spriteY=n[1],t.args.spriteSheet=n[2]||t.args.spriteSheet)})}},{key:"halt",value:function(t){var e=this,r=this.args.hSpeed=this.args.gSpeed;this.args.gSpeed=0,this.viewport.onFrameOut(t,function(){e.args.gSpeed=r,e.args.hSpeed=0})}},{key:"setAutoAttr",value:function(t,e){this.autoAttr.get(this.box)[e]=t}}])&&x(e.prototype,r),j&&x(e,j),Object.defineProperty(e,"prototype",{writable:!1}),T}();t.PointActor=B,A(B,"lastClick",0)}),require.register("actor/PowerupGlow.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PowerupGlow=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-powerup-glow",t.args.width=64,t.args.height=64,t}return e=h,(r=[{key:"onAttached",value:function(){this.autoAttr.get(this.box)["data-closed"]="closed",this.icon=new o.Tag('<div class = "powerup-icon">'),this.halo=new o.Tag('<div class = "powerup-halo">'),this.tags.sprite.appendChild(this.icon.node),this.box.appendChild(this.halo.node)}},{key:"collideA",value:function(t){var e=this;s(l(h.prototype),"collideA",this).call(this,t),t.controllable&&(this.onTimeout(125,function(){return e.args.closed="closed"}),this.onTimeout(4500,function(){return e.args.closed=""}))}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.PowerupGlow=f}),require.register("actor/Projectile.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Projectile=void 0;var i=e("./PointActor"),o=(e("../actor/Explosion"),e("curvature/base/Tag")),a=e("../region/Region"),s=e("./Spring");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(g,i.PointActor);var e,r,n,p=f(g);function g(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=p.call.apply(p,[this].concat(r))).args.type="actor-item actor-projectile",t.args.width=8,t.args.height=8,t.removeTimer=null,t}return e=g,(r=[{key:"update",value:function(){var t=this;this.removed||(this.args.falling||(this.args.gSpeed=0,this.args.xSpeed=0,this.args.ySpeed=0),u(h(g.prototype),"update",this).call(this),this.args.xSpeed||this.args.ySpeed||this.explode(),this.removeTimer||(this.removeTimer=this.onTimeout(2500,function(){return t.explode()})))}},{key:"collideA",value:function(t){if(t===this.args.owner||t instanceof a.Region||t instanceof s.Spring)return!1;if(t.args.gone)return!1;if(t.args.currentSheild){var e=Math.atan2(this.x-t.x,this.y-t.y);return this.impulse(this.args.airSpeed/2,e,!0),void(this.args.falling=!0)}return!(!t.solid&&!t.controllable)&&(this.args.xSpeed=0,this.args.ySpeed=0,this.args.float=-1,this.args.owner&&!this.args.owner.args.gone&&t.controllable&&t.damage(),this.explode(),!1)}},{key:"explode",value:function(){var t=this.viewport;if(t){var e=new o.Tag('<div class = "particle-explosion">');e.style({"--x":this.x,"--y":this.y}),t.particles.add(e),setTimeout(function(){return t.particles.remove(e)},350),this.viewport.actors.remove(this)}}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!1}}])&&c(e.prototype,r),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),g}();t.Projectile=p}),require.register("actor/Pulley.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Pulley=void 0;var i=e("./PointActor");e("./Ring");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.width=64,t.args.height=64,t.args.type="actor-item actor-pulley",t.args.convey=0,t.args.conveyed=0,t.args.float=-1,t.noClip=!0,t}return e=u,(r=[{key:"update",value:function(){this.match?this.args.convey=-this.match.args.convey:this.match=this.viewport.actorsById[this.args.match],this.box&&this.box.style({"--convey":Math.abs(this.args.convey)}),this.box&&this.box.style({"--conveyDir":Math.sign(this.args.convey)}),this.args.conveyed+=this.match.args.convey,this.box&&this.box.style({"--conveyed":this.args.conveyed})}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.Pulley=u}),require.register("actor/PulleySmall.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PulleySmall=void 0;var i=e("./Pulley");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Pulley);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.width=32,t.args.height=32,t.args.type="actor-item actor-pulley-small",t.args.convey=0,t.args.float=-1,t.noClip=!0,t}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.PulleySmall=u}),require.register("actor/QuestionBlock.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionBlock=void 0;var i=e("./PointActor"),o=(e("./monitor/RingMonitor"),e("./monitor/SheildWaterMonitor"));function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(g,i.PointActor);var e,r,n,p=c(g);function g(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return h(u(t=p.call.apply(p,[this].concat(r))),"maxBounce",4),h(u(t),"float",-1),h(u(t),"template",'<div\n\t\tclass = "point-actor [[type]] [[collType]]"\n\t\tstyle = "\n\t\t\tdisplay:[[display]];\n\t\t\t--angle:[[angle]];\n\t\t\t--airAngle:[[airAngle]];\n\t\t\t--display-angle:[[_angle]];\n\t\t\t--height:[[height]];\n\t\t\t--width:[[width]];\n\t\t\t--x:[[x]];\n\t\t\t--y:[[y]];\n\t\t"\n\t\tdata-colliding = "[[colliding]]"\n\t\tdata-falling   = "[[falling]]"\n\t\tdata-facing    = "[[facing]]"\n\t\tdata-angle     = "[[angle|rad2deg]]"\n\t\tdata-mode      = "[[mode]]"\n\t\tdata-empty     = "[[empty]]"\n\t\tcv-ref = "box"\n\t><div cv-ref = "sprite" class = "sprite"></div></div>'),t.args.type="actor-question-block actor-item",t.args.width=32,t.args.height=32,t.initY=null,t.empty=!1,t}return e=g,n=[{key:"fromDef",value:function(t){var e=l(f(g),"fromDef",this).call(this,t);return e.args.x=e.originalX=t.x+Math.floor(t.width/2),e.args.y=e.originalY=t.y,e}}],(r=[{key:"collideA",value:function(t,e){var r=this;if(l(f(g.prototype),"collideA",this).call(this,t),null===this.initY&&(this.initY=this.y),2===e){var n=Math.abs(t.args.ySpeed);if(t.args.falling=!0,t.args.ySpeed>0?t.args.ySpeed+=this.args.ySpeed:(this.args.y-=n,t.args.y+=n),this.args.ySpeed>0&&this.args.ySpeed>t.args.ySpeed&&(t.args.ySpeed=Math.abs(t.args.ySpeed),t.args.y+=this.args.ySpeed),this.args.ySpeed<0&&(this.args.ySpeed=-Math.abs(this.args.ySpeed)),this.args.ySpeed)return!0;var i=this.maxBounce,a=2===e?-Math.abs(t.args.ySpeed):t.args.ySpeed;Math.abs(a)>i&&(a=i*Math.sign(a)),this.args.ySpeed=a,t.args.ySpeed=-t.args.ySpeed}if(2===e&&!this.args.empty&&!this.args.empty){var s=new o.SheildWaterMonitor({x:this.x,y:this.y-96});this.viewport.spawn.add({object:s}),s.onRemove(function(){return r.args.empty=!1}),this.args.empty=!0}return!0}},{key:"update",value:function(){null!==this.initY&&(this.initY>this.y?this.args.ySpeed+=.75:this.initY<this.y&&(this.args.ySpeed-=.75),Math.abs(this.args.y-this.initY)<1&&Math.abs(this.args.ySpeed)<1&&(this.args.ySpeed=0,this.args.y=this.initY)),this.args.ySpeed*=.9,this.args.ySpeed=Math.floor(100*this.args.ySpeed)/100,this.args.y=Math.round(this.args.y);var t=this.maxBounce;Math.abs(this.args.ySpeed)>t&&(this.args.ySpeed=t*Math.sign(this.args.ySpeed)),l(f(g.prototype),"update",this).call(this)}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),g}();t.QuestionBlock=p}),require.register("actor/RailCar.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RailCar=void 0;var i=e("./Vehicle"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.Vehicle);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-rail-car",t.args.width=32,t.args.height=48,t.removeTimer=null,t.args.cartSpeed=t.args.cartSpeed||15,t.args.gSpeedMax=20,t.args.decel=0,t.args.accel=.75,t.args.gravity=1,t.args.seatHeight=44,t.args.skidTraction=.05,t.args.jumpForce=12,t.dustCount=0,t.args.particleScale=2,t.args.started=!1,t}return e=h,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.frontWheel=new o.Tag('<div class = "rail-car-wheel rail-car-wheel-front">'),this.backWheel=new o.Tag('<div class = "rail-car-wheel rail-car-wheel-back">'),this.frontFrag=new o.Tag('<div class = "rail-car-frag rail-car-frag-front">'),this.backFrag=new o.Tag('<div class = "rail-car-frag rail-car-frag-back">'),this.sprite.appendChild(this.frontWheel.node),this.sprite.appendChild(this.backWheel.node),this.sprite.appendChild(this.frontFrag.node),this.sprite.appendChild(this.backFrag.node)}},{key:"update",value:function(){this.originalSpeed=this.args.gSpeed||this.args.xSpeed;var t=this.x;if(s(l(h.prototype),"update",this).call(this),this.sprite){var e=this.x;if(0===this.args.gSpeed&&0===this.args.hSpeed&&0===this.args.xSpeed||(this.sprite.classList.add("moving"),this.args.started=!0),e===t&&!this.args.broken&&!this.args.hSpeed&&(this.sprite.classList.remove("moving"),this.args.started)){this.viewport;!this.args.falling||this.args.xSpeed||this.args.ySpeed?!this.args.falling&&this.args.pushing&&this.breakApart():this.breakApart()}if(this.occupant&&!this.args.falling){var r=this.args.hSpeed||this.args.gSpeed;(Math.abs(r)<Math.abs(this.args.cartSpeed)||Math.sign(r)!==Math.sign(this.args.cartSpeed))&&(this.args.hSpeed?this.args.hSpeed+=.125*Math.sign(this.args.cartSpeed):this.args.gSpeed+=.125*Math.sign(this.args.cartSpeed),Math.abs(this.args.gSpeed)<1&&(this.args.gSpeed=Math.sign(this.args.gSpeed))),this.args.direction=Math.sign(this.args.hSpeed||this.args.gSpeed)}else this.args.hSpeed?this.args.hSpeed=this.args.xSpeed:this.args.xSpeed&&(this.args.gSpeed=this.args.xSpeed)}}},{key:"breakApart",value:function(){if(!this.args.broken){this.viewport;this.occupant&&this.occupant.startle(),this.sprite.classList.add("breaking"),this.args.broken=!0,this.args.groundAngle=0,this.args.mode=0}}},{key:"sleep",value:function(){this.args.x=this.def.get("x"),this.args.y=this.def.get("y"),this.args.groundAngle=0,this.args.gSpeed=0,this.args.xSpeed=0,this.args.ySpeed=0,this.sprite.classList.remove("breaking"),this.sprite.classList.remove("broken"),this.args.broken=!1,this.args.started=!1,s(l(h.prototype),"sleep",this).call(this)}},{key:"processInputDirect",value:function(){}},{key:"solid",get:function(){return!this.args.broken&&!this.occupant}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.RailCar=f}),require.register("actor/RedEyeJet.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RedEyeJet=void 0;var i=e("curvature/base/Tag"),o=e("../audio/Bgm"),a=e("../audio/Sfx"),s=e("./PointActor"),c=e("./Projectile"),u=e("./MiniMace"),l=e("./MegaMace");function f(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function g(){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=b(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=b(t);if(e){var o=b(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(v,s.PointActor);var e,r,n,h=y(v);function v(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v),(r=h.call(this,t,e)).args.gravity=.4,r.args.width=96,r.args.height=32,r.args.type="actor-item actor-red-eye-jet",r.args.float=-1,r.args.phase="idle",r.args.hitPoints=r.args.hitPoints||8,r.args.maxSpeed=9,r.args.bindTo("phase",function(t){return r.args.phaseFrameId=0}),r}return e=v,(r=[{key:"collideA",value:function(t,e){var r,n=this;if(this.hanging.has(t))return!1;if(this.hanging.has(u.MiniMace)?r="MINI-MACE":this.hanging.has(l.MegaMace)&&(r="MEGA-MACE"),t.controllable||t instanceof c.Projectile){if(c.Projectile,this.args.hitPoints>0&&!(t.args.jumping||t.args.rolling||t.dashed||t instanceof c.Projectile))return t.damage(),!0;if(!this.args.falling&&"exploding"!==this.args.phase){if(!(t.args.jumping||t.args.rolling||t.dashed))return!0;this.box.setAttribute("data-phase","exploding"),this.args.phase="exploding",this.viewport.clearCheckpoints(t.args.id);var i=this.viewport;i.onFrameOut(80,function(){n.box.setAttribute("data-phase","exploded"),n.args.falling=!0,n.args.ySpeed=-12,n.noClip=!0,a.Sfx.play("OBJECT_DESTROYED")}),i.onFrameOut(100,function(){i.clearAct("".concat(t.args.name," BEAT THE ").concat(r))}),i.onFrameOut(100,function(){n.viewport.args.cutScene=!0}),i.onFrameOut(150,function(){n.viewport.controlActor.controller.replay({axes:[1,0,0,1]}),n.viewport.controlActor.readInput()}),i.onFrameOut(210,function(){n.viewport.controlActor.controller.replay({buttons:[1]}),n.viewport.controlActor.readInput()}),i.onFrameOut(211,function(){n.viewport.controlActor.dropDashCharge=30}),i.onFrameOut(285,function(){n.viewport.controlActor.controller.replay({buttons:[0,0,0,0,0,0]}),n.viewport.controlActor.readInput(),n.args.phase="done"}),i.onFrameOut(500,function(){n.args.xSpeed=0,n.args.ySpeed=0,n.args.y=-1024})}this.ignores.set(t,15),2===e&&(a.Sfx.play("BOSS_DUDHIT"),t.args.ySpeed=Math.max(7,Math.abs(t.args.ySpeed)));var s=Math.max(Math.abs(t.args.xSpeed),Math.abs(this.args.xSpeed));this.args.hitPoints>1&&this.args.falling?this.args.xSpeed=t.args.xSpeed:this.args.xSpeed=0;var f=!1;if(1===e&&(a.Sfx.play("BOSS_DAMAGED"),f=!0,this.args.hitPoints>0?(t.args.xSpeed=1.25*-s,t.args.xSpeed=Math.min(-7,-this.args.xSpeed),this.args.hitPoints--):(t.args.xSpeed=-2,t.args.ignore=-2)),3===e&&(a.Sfx.play("BOSS_DAMAGED"),f=!0,this.args.hitPoints>0?(t.args.xSpeed=1.25*s,t.args.xSpeed=Math.max(7,-this.args.xSpeed),this.args.hitPoints--):(t.args.xSpeed=2,t.args.ignore=-2)),f&&t&&t.controller&&t.controller.rumble&&this.viewport.settings.rumble&&(t.controller.rumble({duration:120,strongMagnitude:1,weakMagnitude:1}),this.onTimeout(100,function(){t.controller.rumble({duration:100,strongMagnitude:0,weakMagnitude:.5})})),t instanceof c.Projectile||1===e||3===e||0===e){if(["dead","exploding","damaged","done"].includes(this.args.phase)||(this.args.phase="damaged",this.args.animation="",this.args.animation="damaged",0===this.args.hitPoints&&"exploding"!==this.args.phase&&(this.box.setAttribute("data-phase","dead"),this.args.animation="",this.args.phase="dead","function"==typeof ga&&ga("send","event",{eventCategory:"boss",eventAction:"defeated",eventLabel:"".concat(this.viewport.args.actName,"::").concat(this.args.id)})),this.viewport.onFrameOut(20,function(){"intro"!==n.args.phase&&(n.args.hitPoints>0?(n.args.animation="attacking",n.args.phase="attacking"):["dead","exploding","done"].includes(n.args.phase)||(n.box.setAttribute("data-phase","dead"),n.args.animation="dead",n.args.phase="dead",n.args.xSpeed=0,t.args.score+=2e4))})),0===e){t.args.y=this.y-this.args.height;var h=t.args.animation,p=t.args.ySpeed;this.onNextFrame(function(){t.args.animation=h,t.args.falling=!0,t.args.xSpeed=-4*Math.sign(n.x-t.x),t.args.ySpeed=-Math.floor(Math.abs(p))||-4}),a.Sfx.play("BOSS_DAMAGED")}var g=t.args.gSpeed;t.args.gSpeed=-g,t.args.rolling&&this.onNextFrame(function(){t.args.gSpeed=-g,t.args.rolling=!0,t.args.direction,Math.sign(g)})}return t.args.ignore=1,this.args.hitPoints||(o.Bgm.stop("ZONE-BOSS"),o.Bgm.stop("ACT-BOSS"),t.args.ignore=-2),!0}}},{key:"update",value:function(){var t=this;if("idle"!==this.args.phase&&this.viewport){if(this.args.phaseFrameId++,this.args.frameId++,"intro"===this.args.phase){if(this.hanging.has(u.MiniMace)){var e,r=f(this.hanging.get(u.MiniMace));try{for(r.s();!(e=r.n()).done;){e.value.args.ropeLength=80}}catch(t){r.e(t)}finally{r.f()}o.Bgm.play("ACT-BOSS",!0)}if(this.hanging.has(l.MegaMace)){var n,s=f(this.hanging.get(l.MegaMace));try{for(s.s();!(n=s.n()).done;){n.value.args.ropeLength=96}}catch(t){s.e(t)}finally{s.f()}o.Bgm.play("ZONE-BOSS",!0)}this.args.maxSpeed=12,this.args.phaseFrameId>240&&(this.args.phase="attacking")}else this.hanging.has(u.MiniMace)?this.viewport.onFrameOut(45,function(){var e,r=f(t.hanging.get(u.MiniMace));try{for(r.s();!(e=r.n()).done;){e.value.args.ropeLength=144}}catch(t){r.e(t)}finally{r.f()}}):this.hanging.has(l.MegaMace)&&this.viewport.onFrameOut(45,function(){var e,r=f(t.hanging.get(l.MegaMace));try{for(r.s();!(e=r.n()).done;){e.value.args.ropeLength=192}}catch(t){r.e(t)}finally{r.f()}});if("attacking"===this.args.phase){if(this.args.maxSpeed=9,this.hanging.has(u.MiniMace)){var c,h=f(this.hanging.get(u.MiniMace));try{for(h.s();!(c=h.n()).done;){c.value.args.float=0}}catch(t){h.e(t)}finally{h.f()}}if(this.hanging.has(l.MegaMace)){var p,d=f(this.hanging.get(l.MegaMace));try{for(d.s();!(p=d.n()).done;){p.value.args.float=0}}catch(t){d.e(t)}finally{d.f()}}Math.abs(this.viewport.controlActor.x-this.x)>255&&(this.args.phase="chasing")}if("chasing"===this.args.phase&&Math.abs(this.viewport.controlActor.x-this.x)<8&&this.y<this.viewport.controlActor.y&&(this.args.phase="attacking"),"exploding"!==this.args.phase)"damaged"===this.args.phase&&(this.args.xSpeed*=.999),this.box&&(this.x-this.viewport.controlActor.x>0?Math.abs(this.x-this.viewport.controlActor.x)>128?this.box.setAttribute("data-looking","far-left"):-1===this.viewport.controlActor.args.direction?this.box.setAttribute("data-looking","far-left"):this.box.setAttribute("data-looking","left"):this.x-this.viewport.controlActor.x<0&&(this.box.setAttribute("data-looking","far-right"),Math.abs(this.x-this.viewport.controlActor.x)>128?this.box.setAttribute("data-looking","far-right"):1===this.viewport.controlActor.args.direction?this.box.setAttribute("data-looking","far-right"):this.box.setAttribute("data-looking","right")),32>this.y-this.viewport.controlActor.y?this.box.setAttribute("data-ducking","true"):this.box.setAttribute("data-ducking","false")),this.args.hitPoints&&["attacking","intro","chasing"].includes(this.args.phase)&&(Math.abs(this.x-this.viewport.controlActor.x)>384&&(this.args.x=this.viewport.controlActor.x+384*Math.sign(this.x-this.viewport.controlActor.x)),this.args.xSpeed+=.35*-Math.sign(this.x-this.viewport.controlActor.x)),this.args.hitPoints?(this.args.falling=!0,this.args.float=-1):this.args.float=0,"intro"!==this.args.phase&&"attacking"!==this.args.phase||(this.args.maxSpeed=11),"chasing"===this.args.phase?Math.abs(this.x-this.viewport.controlActor.x)<128&&(this.args.maxSpeed=Math.max(this.args.maxSpeed,this.viewport.controlActor.args.xSpeed)):Math.abs(this.args.xSpeed)>this.args.maxSpeed&&(this.args.xSpeed=Math.sign(this.args.xSpeed)*this.args.maxSpeed),g(b(v.prototype),"update",this).call(this);else{var y=this.viewport;if(y&&y.args.frameId%3==0){var m=new i.Tag('<div class = "particle-explosion">');a.Sfx.play("BOSS_DAMAGED");var w=this.args.width*Math.random()-this.args.width/2,S=this.args.height*Math.random()-this.args.height/2;m.style({"--x":this.x+w,"--y":this.y+S+-16}),y.particles.add(m),setTimeout(function(){return y.particles.remove(m)},512)}g(b(v.prototype),"update",this).call(this)}}}},{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.body=new i.Tag('<div class = "body-center">'),this.bodyL=new i.Tag('<div class = "body-left">'),this.bodyR=new i.Tag('<div class = "body-right">'),this.fireA=new i.Tag('<div class = "boost-fire boost-fire-left">'),this.fireB=new i.Tag('<div class = "boost-fire boost-fire-right">'),this.eye=new i.Tag('<div class = "orange-eye">'),this.box.appendChild(this.body.node),this.box.appendChild(this.bodyL.node),this.box.appendChild(this.bodyR.node),this.box.appendChild(this.fireA.node),this.box.appendChild(this.fireB.node),this.box.appendChild(this.eye.node)}},{key:"solid",get:function(){return!0}}])&&p(e.prototype,r),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),v}();t.RedEyeJet=v}),require.register("actor/Redz.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Redz=void 0;e("./Flickie");var i=e("curvature/base/Mixin"),o=(e("curvature/base/Tag"),e("./PointActor")),a=e("../behavior/SkidDust"),s=e("../mixin/CanPop");e("../actor/Explosion"),e("../actor/Projectile");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(g,i.Mixin.from(o.PointActor,s.CanPop));var e,r,n,p=f(g);function g(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=p.call.apply(p,[this].concat(r))).behaviors.add(new a.SkidDust),t.args.type="actor-item actor-redz",t.args.animation="standing",t.args.accel=.1,t.args.decel=.5,t.args.gSpeedMax=5,t.args.jumpForce=5,t.args.gravity=.5,t.args.width=18,t.args.height=32,t.willStick=!1,t.stayStuck=!1,t}return e=g,(r=[{key:"update",value:function(){var t=this.args.direction;this.box&&(Math.sign(this.args.gSpeed)!==t&&Math.abs(this.args.gSpeed-t)>5?this.box.setAttribute("data-animation","skidding"):this.args.moving&&this.args.gSpeed?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")),u(h(g.prototype),"update",this).call(this)}},{key:"effect",value:function(t){u(h(g.prototype),"effect",this).call(this,t)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}}])&&c(e.prototype,r),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),g}();t.Redz=p}),require.register("actor/Ring.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Ring=void 0;var i=e("./PointActor"),o=e("../audio/Sfx");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(g,i.PointActor);var e,r,n,p=u(g);function g(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return h(l(n=p.call.apply(p,[this].concat(o))),"template",'<div class  = "point-actor [[type]]">\n\t\t<div class = "sprite" cv-ref = "sprite"></div>\n\t</div>'),h(l(n),"float",-1),n.args.type="actor-item actor-ring",n.args.width=32,n.args.height=32,n.args.static=null===(t=n.args.static)||void 0===t||t,n.args.dropped=null===(e=n.args.dropped)||void 0===e||e,n.args.gone=!1,n.args.gravity=.4,n.args.delay=null!==(r=n.args.delay)&&void 0!==r?r:64,n}return e=g,(r=[{key:"update",value:function(){if(this.viewport){this.viewport.args.frameId,this.startFrame;this.args.decoration?this.noClip=!0:this.args.ySpeed<0?this.noClip=!0:this.attract||(this.noClip=!1),this.args.decoration&&(this.args.type="actor-item actor-ring decoration",this.args.gravity=.36),this.dropped&&(this.args.type="actor-item actor-ring dropped",this.args.height=14),this.dropped&&this.viewport&&!this.viewport.actorIsOnScreen(this,256)&&this.viewport.actors.remove(this),s(f(g.prototype),"update",this).call(this),!this.dropped&&!this.scattered||this.args.falling&&this.args.ySpeed||(this.args.xSpeed=this.args.xSpeed||this.xSpeedLast||Math.random()-.5,this.args.ySpeed=Math.min(.75*-Math.abs(this.args.ySpeed||this.ySpeedLast||0),-5),this.args.gSpeed=0,this.args.x+=this.args.xSpeed,this.args.y+=this.args.ySpeed,this.args.falling=!0,this.args.groundAngle=0)}}},{key:"callCollideHandler",value:function(t){return!(t instanceof g)&&s(f(g.prototype),"callCollideHandler",this).call(this,t)}},{key:"collideA",value:function(t){var e=this;if(!this.viewport||this.args.gone||this.args.ignore)return!1;var r=this.viewport.args.frameId-this.startFrame;if(this.dropped&&r<this.args.delay)return!1;if(s(f(g.prototype),"collideA",this).call(this,t),t.args.owner&&(t=t.args.owner),t.occupant&&(t=t.occupant),!t.controllable&&!t.occupant&&!t.args.owner)return!1;t.controllable&&(t.args.rings+=1),this.args.gone=!0,this.viewport.auras.delete(this),this.args.static=!0,this.args.float=-1,this.args.type="actor-item actor-ring collected",this.args.xSpeed=0,this.args.ySpeed=0,this.viewport.args.audio&&o.Sfx.play("RING_COLLECTED"),this.viewport.onFrameOut(5,function(){e.args.type="actor-item actor-ring collected gone"});this.x,this.y,this.viewport;this.viewport.onFrameOut(1200,function(){e.restore=!0}),t.collect&&("function"==typeof ga&&ga("send","event",{eventCategory:"ring",eventAction:"collected",eventLabel:"".concat(this.viewport.args.actName,"::").concat(this.args.id)}),this.onNextFrame(function(){t.collect(e)}))}},{key:"wakeUp",value:function(){this.def&&this.restore&&(this.args.x=this.def.get("x"),this.args.y=this.def.get("y"),this.args.gone=this.restore=!1,this.args.type="actor-item actor-ring")}},{key:"solid",get:function(){return!1}},{key:"rotateLock",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),g}();t.Ring=p}),require.register("actor/RoadBarrier.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RoadBarrier=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.width=t.args.width||64,t.args.height=t.args.height||32,t.args.type="actor-item actor-road-barrier",t.args.z=0,t}return e=u,(r=[{key:"solid",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.RoadBarrier=u}),require.register("actor/Rocket.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Rocket=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag"),a=e("../audio/Sfx");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(p,i.PointActor);var e,r,n,h=l(p);function p(){var t,e,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(r=h.call.apply(h,[this].concat(i))).args.width=64,r.args.height=16,r.args.xMax=null!==(t=r.args.xMax)&&void 0!==t?t:24,r.args.yMax=null!==(e=r.args.yMax)&&void 0!==e?e:24,r.args.type="actor-item actor-rocket",r.args.launched=!1,r.args.bindTo(["xSpeed","ySpeed"],function(t){!t&&r.args.launched&&r.explode()}),r}return e=p,(r=[{key:"update",value:function(){this.viewport&&(c(f(p.prototype),"update",this).call(this),this.args.launched&&Math.abs(this.args.xSpeed)<Math.abs(this.args.xMax)&&(this.args.xSpeed+=.5*Math.sign(this.args.xMax)),this.args.launched&&Math.abs(this.args.ySpeed)<Math.abs(this.args.yMax)&&(this.args.ySpeed-=.5*Math.sign(this.args.yMax)),this.args.launched&&0===this.args.xSpeed&&0===this.args.ySpeed&&this.explode())}},{key:"activate",value:function(){this.viewport.auras.add(this),this.args.launched=!0,this.args.xMax&&(this.args.xSpeed+=.5),this.args.yMax&&(this.args.ySpeed-=.5)}},{key:"sleep",value:function(){this.args.launched&&this.explode()}},{key:"wakeUp",value:function(){}},{key:"explode",value:function(){var t=this.viewport;if(t){var e=new o.Tag('<div class = "particle-explosion">');e.style({"--x":this.x,"--y":this.y-8}),t.particles.add(e),setTimeout(function(){return t.particles.remove(e)},512),a.Sfx.play("OBJECT_DESTROYED"),this.args.xSpeed=0,this.args.ySpeed=0,this.args.opacity=0,this.args.launched=!1,this.viewport.setColCell(this),this.viewport.onFrameOut(60,function(){});var r=new CustomEvent("exploded",{detail:{actor:this}});this.dispatchEvent(r),this.args.launched=!1,this.args.opacity=1,this.args.x=this.def.get("x"),this.args.y=this.def.get("y"),this.viewport.setColCell(this),this.viewport.auras.delete(this)}}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.Rocket=h}),require.register("actor/Rocks.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Rocks=void 0;var i=e("./PointActor"),o=e("../actor/Projectile"),a=e("curvature/base/Tag"),s=e("../audio/Sfx");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(g,i.PointActor);var e,r,n,p=f(g);function g(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),(r=p.call(this,t,e)).args.type="actor-item actor-rocks-tall",r.args.width=48,r.args.height=80,r.gone=!1,r.particleA=new a.Tag('<div class = "particle-rock">'),r.particleB=new a.Tag('<div class = "particle-rock">'),r.particleC=new a.Tag('<div class = "particle-rock">'),r.particleD=new a.Tag('<div class = "particle-rock">'),r.particleE=new a.Tag('<div class = "particle-rock">'),r.particleF=new a.Tag('<div class = "particle-rock">'),r.particleG=new a.Tag('<div class = "particle-rock">'),r.particleH=new a.Tag('<div class = "particle-rock">'),r}return e=g,(r=[{key:"onAttached",value:function(){var t=-1,e=this.particleA,r=this.particleB,n=this.particleC,i=this.particleD,o=this.particleE,a=this.particleF,s=this.particleG,c=this.particleH;e.style({"--x":this.x-8,"--y":this.y-8,"--fallSpeed":1550+20*Math.random(),"--xMomentum":60*t+20*Math.random(),"--yMomentum":40,"z-index":0}),t*=-1,r.style({"--x":this.x+8,"--y":this.y-0,"--fallSpeed":1550+20*Math.random(),"--xMomentum":60*t+20*Math.random(),"--yMomentum":40,"z-index":0}),t*=-1,n.style({"--x":this.x,"--y":this.y-18,"--fallSpeed":1550+20*Math.random(),"--xMomentum":60*t+20*Math.random(),"--yMomentum":44,"z-index":0}),t*=-1,i.style({"--x":this.x+8,"--y":this.y-10,"--fallSpeed":1550+20*Math.random(),"--xMomentum":60*t+20*Math.random(),"--yMomentum":44,"z-index":0}),t*=-1,o.style({"--x":this.x-8,"--y":this.y-28,"--fallSpeed":1550+20*Math.random(),"--xMomentum":60*t+20*Math.random(),"--yMomentum":48,"z-index":0}),t*=-1,a.style({"--x":this.x+8,"--y":this.y-20,"--fallSpeed":1550+20*Math.random(),"--xMomentum":60*t+20*Math.random(),"--yMomentum":48,"z-index":0}),t*=-1,s.style({"--x":this.x-8,"--y":this.y-30,"--fallSpeed":1550+20*Math.random(),"--xMomentum":60*t+20*Math.random(),"--yMomentum":48,"z-index":0}),t*=-1,c.style({"--x":this.x+8,"--y":this.y-30,"--fallSpeed":1550+20*Math.random(),"--xMomentum":60*t+20*Math.random(),"--yMomentum":65,"z-index":0})}},{key:"collideA",value:function(t,e){return!this.args.gone&&(u(h(g.prototype),"collideA",this).call(this,t,e),t.occupant||t.args.rolling||t.punching?(this.pop(t),!1):2!==e&&(!this.args.falling||-1===this.args.float)&&t.args.ySpeed>0&&t.y<this.y&&this.viewport&&!this.args.gone?(this.args.falling&&Math.abs(t.args.ySpeed)>0&&(t.args.xSpeed*=-1),this.pop(t),!1):!((1===e||3===e)&&t instanceof o.Projectile&&this.viewport&&!this.args.gone)||(this.pop(t),!1))}},{key:"pop",value:function(t){var e=this;this.args.gone=!0;var r=this.viewport;if(r){s.Sfx.play("ROCKS_DESTROYED");var n=this.particleA,i=this.particleB,o=this.particleC,a=this.particleD,c=this.particleE,u=this.particleF,l=this.particleG,f=this.particleH;r.particles.add(n),r.particles.add(i),r.particles.add(o),r.particles.add(a),r.particles.add(c),r.particles.add(u),r.particles.add(l),r.particles.add(f),setTimeout(function(){r.particles.remove(n),r.particles.remove(i),r.particles.remove(o),r.particles.remove(a),r.particles.remove(c),r.particles.remove(u),r.particles.remove(l),r.particles.remove(f)},2500),this.onNextFrame(function(){return r.actors.remove(e)})}}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!this.args.gone}}])&&c(e.prototype,r),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),g}();t.Rocks=p}),require.register("actor/RollingSign.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RollingSign=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.PointActor);var e,r,n,l=s(f);function f(){var t,e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=l.call.apply(l,[this].concat(n))).args.width=20,e.args.height=null!==(t=e.args.height)&&void 0!==t?t:80,e.args.type="actor-item actor-rolling-sign",e}return e=f,n=[{key:"fromDef",value:function(t){var e=c(u(f),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.height=t.height,e}}],(r=[{key:"solid",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.RollingSign=l}),require.register("actor/Sean.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Sean=void 0;var i=e("./PointActor"),o=(e("curvature/base/Tag"),e("../behavior/SkidDust"));function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).behaviors.add(new o.SkidDust),t.args.type="actor-item actor-sean",t.args.normalHeight=35,t.args.rollingHeight=28,t.args.accel=.25,t.args.decel=.4,t.args.gSpeedMax=18,t.args.jumpForce=11,t.args.gravity=.5,t.args.width=18,t.args.height=35,t}return e=h,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div")}},{key:"update",value:function(){var t=this.args.falling;if(this.box){if(t)this.args.jumping&&this.box.setAttribute("data-animation","jumping");else{this.yAxis>0?this.args.crouching=!0:this.args.crouching=!1;var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;this.args.rolling?this.box.setAttribute("data-animation","rolling"):Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?this.box.setAttribute("data-animation","standing"):n>.25*i?this.box.setAttribute("data-animation","running"):this.args.moving&&r?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}s(l(h.prototype),"update",this).call(this)}else s(l(h.prototype),"update",this).call(this)}},{key:"solid",get:function(){return!1}},{key:"canRoll",get:function(){return!0}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.Sean=f}),require.register("actor/SeeSaw.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SeeSaw=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag");function a(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw o}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Symbol("Side");var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(p,i.PointActor);var e,r,n,s=f(p);function p(t,e){var r,n,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(i=s.call(this,t,e)).args.width=96,i.args.height=32,i.noClip=!0,i.args.float=-1,i.args.power=null!==(r=i.args.power)&&void 0!==r?r:20,i.tiltTime=0,i.args.power=null!==(n=i.args.power)&&void 0!==n?n:12,i.args.type="actor-item actor-see-saw",i.args.bindTo("tilt",function(t){i.args.type="actor-item actor-see-saw ".concat(t),i.tiltTime=0}),i}return e=p,(r=[{key:"onAttached",value:function(t){this.hub||(this.hub=new o.Tag('<div class = "see-saw-hub">'),this.box.appendChild(this.hub.node))}},{key:"collideA",value:function(t,e){if(t.args.groundAngle=0,!t.args.falling||t.args.ySpeed<=0)return!1;if(Math.abs(t.x-this.x)>4){var r=Math.sign(t.x-this.x);this.reflectImpulse(t,r*t.args.weight*Math.abs(t.args.ySpeed)),t.x<this.x?(this.tiltClass="tilt-left",this.tilt=-1):t.x>this.x&&(this.tiltClass="tilt-right",this.tilt=1),this.args.tilt=this.tiltClass}}},{key:"reflectImpulse",value:function(t,e){this.reflectObject&&this.reflectObject.args.falling&&!t.args.falling||this.tilt!==Math.sign(e)&&(this.reflectObject=t,this.reflectForce=e)}},{key:"update",value:function(){this.tiltTime++,u(h(p.prototype),"update",this).call(this)}},{key:"updateEnd",value:function(){u(h(p.prototype),"updateEnd",this).call(this);var t=this.viewport.collisions.get(this);if(!t)return this.reflectObject=null,void(this.reflectForce=0);var e,r=a(t.keys());try{for(r.s();!(e=r.n()).done;){var n=e.value;n.args.groundAngle=0;var i=n.x-this.x,o=Math.abs(i/(this.args.width/2)),s=Math.sign(i);if(this.reflectForce&&s!==Math.sign(this.reflectForce)&&!(Math.abs(i)<4)){var c=Math.abs(this.reflectForce/n.args.weight),l=Math.min(1,Math.ceil(5*o)/5);n.args.gSpeed=0,n.args.xSpeed=0,n.args.ySpeed=Math.min(-5,-c*l*1.2),n.args.y-=16,n.args.falling=!0}}}catch(t){r.e(t)}finally{r.f()}this.reflectObject=null,this.reflectForce=0}}])&&c(e.prototype,r),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.SeeSaw=p}),require.register("actor/Seymour.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Seymour=void 0;var i=e("./PointActor"),o=(e("curvature/base/Tag"),e("../behavior/SkidDust"));function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).behaviors.add(new o.SkidDust),t.args.type="actor-item actor-seymour",t.args.spriteSheet=t.spriteSheet="/secret/seymour-color-corrected.png",t.superSpriteSheet="/secret/super-seymour.png",t.args.normalHeight=44,t.args.rollingHeight=23,t.args.accel=.25,t.args.decel=.4,t.args.gSpeedMax=18,t.args.jumpForce=11,t.args.gravity=.5,t.args.width=18,t.args.height=32,t}return e=h,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div")}},{key:"update",value:function(){var t=this.args.falling;if(this.box){if(t)this.args.jumping&&this.box.setAttribute("data-animation","jumping");else{this.yAxis>0?this.args.crouching=!0:this.args.crouching=!1;var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;this.args.rolling?this.box.setAttribute("data-animation","rolling"):Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?this.box.setAttribute("data-animation","standing"):n>.25*i?this.box.setAttribute("data-animation","running"):this.args.moving&&r?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}s(l(h.prototype),"update",this).call(this)}else s(l(h.prototype),"update",this).call(this)}},{key:"command_3",value:function(){var t=this;this.isSuper=!this.isSuper,this.onTimeout(150,function(){0===t.args.rings&&t.setProfile()}),this.setProfile()}},{key:"setProfile",value:function(){this.isSuper?this.args.spriteSheet=this.superSpriteSheet:this.args.spriteSheet=this.spriteSheet}},{key:"solid",get:function(){return!1}},{key:"canRoll",get:function(){return!0}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.Seymour=f}),require.register("actor/Signpost.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Signpost=void 0;var i=e("../ui/CharacterString"),o=e("./PointActor"),a=e("curvature/base/Tag");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(p,o.PointActor);var e,r,n,h=l(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=h.call.apply(h,[this].concat(r))).args.type="actor-item actor-signpost",t.args.width=48,t.args.height=256,t.args.active=!1,t.args.follow=!1,t}return e=p,(r=[{key:"collideA",value:function(t){var e=this;if(t.controllable&&!this.args.active){this.viewport.onFrameOut(120,function(){return e.box.setAttribute("data-cleared-by",t.args.name)}),this.viewport.onFrameOut(30,function(){return t.args.rolling=!1}),this.viewport.onFrameOut(180,function(){return e.viewport.clearAct("".concat(t.args.name," GOT THROUGH ").concat(e.viewport.args.actName))}),this.viewport.onFrameOut(540,function(){e.args.charStrings=[],t.args.ignore=0,e.args.follow=!1,e.args.boss}),this.viewport.onFrameOut(30,function(){t.args.ignore=-1}),this.viewport.onFrameOut(600,function(){var r=e.viewport.actorsById[e.args.boss];e.viewport.auras.add(r),r.args.x=e.x+(e.x<125e3?768:-768),r.args.y=e.y-160,e.viewport.controlActor&&e.viewport.controlActor.args.jumpForce<10.5&&(r.args.y+=48),r.args.phase="intro",t.args.clearSpeed=0});var r=(this.viewport.args.frameId-this.viewport.args.startFrameId)/60,n=String(Math.floor(Math.abs(r)/60)).padStart(2,"0");String(Math.trunc(Math.abs(r)%60)).padStart(2,"0");(r<0?"-":"")&&(n=Number(n));var o=60*((t.args.gSpeed||t.args.xSpeed)/32)*3;t.args.clearSpeed=Math.abs(o),this.args.charStrings=[new i.CharacterString({value:"Speed: ".concat(o.toFixed(2)," ft/sec")})],this.args.falling=!0,this.args.active=!0,this.args.follow=!0,this.args.xSpeed=1.1*(t.args.gSpeed||t.args.xSpeed),this.args.ySpeed=-7,this.args.y--}}},{key:"update",value:function(){var t=this;if(this.args.follow){var e=Math.max(this.x,this.viewport.controlActor.x+-160);if(e!==this.x){if(!this.args.falling){var r=new a.Tag('<div class = "particle-dust">'),n=this.rotatePoint(this.args.gSpeed,0);r.style({"--x":n[0]+this.x+-4,"--y":n[1]+this.y,"z-index":0,opacity:2*Math.random()}),this.viewport.particles.add(r),this.viewport.onFrameOut(30,function(){return t.viewport.particles.remove(r)})}this.args.x=e}}c(f(p.prototype),"update",this).call(this)}},{key:"rotateLock",get:function(){return!0}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.Signpost=h}),require.register("actor/SnowBoard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SnowBoard=void 0;var i=e("./Vehicle"),o=(e("curvature/base/Tag"),e("../behavior/SkidDust"));function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.Vehicle);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).behaviors.add(new o.SkidDust("particle-dust")),t.args.type="actor-item actor-snow-board",t.args.width=24,t.args.height=32,t.removeTimer=null,t.args.gSpeedMax=15,t.args.decel=.25,t.args.accel=.75,t.args.gravity=.75,t.args.seatHeight=1,t.args.skidTraction=.5,t.args.jumpForce=9.5,t.dustCount=0,t.args.particleScale=2,t.args.started=!1,t.ridingAnimation="grinding",t.dustDist=-16,t.dustFreq=1,t.broad=!0,t.slowSpin=!0,t}return e=h,(r=[{key:"update",value:function(){this.originalSpeed=this.args.gSpeed||this.args.xSpeed,s(l(h.prototype),"update",this).call(this),this.occupant&&(this.args.z=this.occupant.args.z-1),0===this.args.gSpeed&&0===this.args.xSpeed||(this.sprite.classList.add("moving"),this.args.started=!0)}},{key:"doJump",value:function(t){s(l(h.prototype),"doJump",this).call(this,t),this.args.groundAngle+=.125*Math.PI*Math.sign(this.args.gSpeed||this.args.direction)}},{key:"solid",get:function(){return!this.occupant}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.SnowBoard=f}),require.register("actor/Sonic.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Sonic=void 0;var i=e("./PointActor"),o=e("../audio/Sfx"),a=e("curvature/base/Tag"),s=e("curvature/base/View"),c=(e("../effects/Twist"),e("../effects/Pinch"),e("../sprite/Png")),u=e("./Ring"),l=e("./Spring"),f=(e("../powerups/FireSheild"),e("../powerups/BubbleSheild"),e("../powerups/ElectricSheild"),e("../region/GrindingRegion")),h=e("./Marker"),p=e("../behavior/SkidDust");function g(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=y(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function d(t){return function(t){if(Array.isArray(t))return b(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||y(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){if(t){if("string"==typeof t)return b(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(t,e):void 0}}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function v(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function m(){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=j(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function S(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=j(t);if(e){var o=j(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return O(t)}(this,r)}}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w(t,e)}(k,i.PointActor);var r,n,y,b=S(k);function k(){var t,r,n,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,k);for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return t=b.call.apply(b,[this].concat(a)),r=O(t),n="png",i=new c.Png("/Sonic/sonic.png"),n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,window.sonic=O(t),t.behaviors.add(new p.SkidDust),t.args.canonical="Sonic",t.args.type="actor-sonic actor-item",t.accelNormal=.15,t.accelSuper=.22,t.markers=new Set,t.springing=!1,t.args.boltCount=0,t.args.accel=t.accelNormal,t.args.decel=.4,t.gSpeedMaxNormal=18,t.gSpeedMaxSuper=23,t.jumpForceNormal=11.5,t.jumpForceSuper=16,t.args.gSpeedMax=t.gSpeedMaxNormal,t.args.jumpForce=t.jumpForceNormal,t.args.gravity=.5,t.args.width=16,t.args.height=40,t.args.lookTime=0,t.args.normalHeight=40,t.args.rollingHeight=28,t.sparks=new Set,t.spindashCharge=0,t.dropDashCharge=0,t.willStick=!1,t.stayStuck=!1,t.lightDashed=!0,t.dashed=!1,t.airControlCard=s.View.from(e("../cards/sonic-air-controls.html")),t.controlCard=s.View.from(e("../cards/sonic-controls.html")),t.moveCard=s.View.from(e("../cards/basic-moves.html")),t.args.spriteSheet=t.spriteSheet="/Sonic/sonic.png",t.hyperSheet=0,t.args.bindTo("falling",function(e){e||(!t.willStick||1!==t.args.mode&&3!==t.args.mode?t.onNextFrame(function(){t.args.wallSticking=!1}):(t.args.wallSticking=!0,t.onNextFrame(function(){t.dashed=!1})))}),t}return r=k,(n=[{key:"onAttached",value:function(t){var e=this,r={"8080e0":"e0e080","6060c0":"e0e000","4040a0":"e0e001",202080:"a0a000"},n={"8080e0":"fcfcfc","6060c0":"fcfcfc","4040a0":"fcd8d8",202080:"fcb4b4"},i={"8080e0":"fcfcfc","6060c0":"fcfcfc","4040a0":"fcd8fc",202080:"d8b4d8"},o={"8080e0":"d8fcfc","6060c0":"fcfcfc","4040a0":"b4d8fc",202080:"90b4fc"},a={"8080e0":"d8d8ff","6060c0":"b4b4d8","4040a0":"a4a4d8",202080:"6c6cb4"},s={"8080e0":"d8fcfc","6060c0":"d8fcd8","4040a0":"b4fcb4",202080:"00fc24"},c={"8080e0":"d8fcfc","6060c0":"d8fcb4","4040a0":"d8fc48",202080:"d8d800"},u={"8080e0":"ffffff","6060c0":"fcfcfc","4040a0":"d8d8d8",202080:"b4b4b4"};this.superSpriteSheet||this.png.ready.then(function(){var t=e.png.recolor(r);e.superSpriteSheet=t.toUrl()}),this.hyperSpriteSheets||this.png.ready.then(function(){return e.hyperSpriteSheets=[e.png.recolor(n).toUrl(),e.png.recolor(o).toUrl(),e.png.recolor(i).toUrl(),e.png.recolor(u).toUrl(),e.png.recolor(s).toUrl(),e.png.recolor(a).toUrl(),e.png.recolor(c).toUrl()]})}},{key:"onRendered",value:function(){m(j(k.prototype),"onRendered",this).call(this),this.arm||(this.arm=new a.Tag('<div class = "rear-arm">'),this.box.appendChild(this.arm.node))}},{key:"updateStart",value:function(){this.args.grinding&&this.args.falling&&this.args.ySpeed>0&&(this.args.animation="airdash",this.args.grinding=!1),m(j(k.prototype),"updateStart",this).call(this),this.args.dead&&(this.args.animation="dead")}},{key:"updateEnd",value:function(){m(j(k.prototype),"updateEnd",this).call(this)}},{key:"update",value:function(){var t=this;if(this.args.falling&&this.isHyper&&this.dashed&&this.yAxis<-.5&&(this.args.ySpeed-=.6),this.args.dead)return this.args.animation="dead",void m(j(k.prototype),"update",this).call(this);this.isSuper&&this.viewport.args.frameId%60==0&&(this.args.rings>0?this.args.rings--:(this.isSuper=!1,this.isHyper=!1,this.setProfile())),this.isHyper&&this.viewport.args.frameId%45==0&&(this.args.spriteSheet=this.hyperSpriteSheets[this.hyperSheet++],this.hyperSheet>=this.hyperSpriteSheets.length&&(this.hyperSheet=0)),this.args.falling?(this.args.wallSticking&&!this.dashed&&(1===this.args.mode?(this.args.direction=-1,this.args.facing="left"):3===this.args.mode&&(this.args.direction=1,this.args.facing="right"),this.args.animation="wall-dropping-start",this.onTimeout(150,function(){t.args.falling&&t.args.wallDropping&&(t.args.animation="wall-dropping")}),this.args.wallDropping=!0,this.args.groundAngle=0,this.args.ignore=30),this.args.wallDropping&&(this.args.groundAngle=0),this.args.wallSticking=!1):(this.springing&&(this.args.groundAngle=0),this.springing=!1,this.doubleSpin=this.dashed=!1,this.args.mode%2==0&&(this.args.wallSticking=!1),this.args.wallSticking||(this.willStick=!1)),this.lightDashingCoolDown>0&&this.lightDashingCoolDown--,this.dashTimer>0&&this.dashTimer--;var e=this.args.falling;if(e&&(this.args.cameraBias=0),this.args.wallSticking){this.args.animation="wall-stick";var r=3;this.yAxis<0?(this.args.animation="wall-stick-brake",this.stayStuck=!0,r=0):this.yAxis>0&&(r=6),this.args.modeTime<15&&(r=0),1===this.args.mode?(this.args.facing="left",this.args.direction=1,Math.abs(this.args.gSpeed)<r?this.args.gSpeed+=1:this.args.gSpeed=r):3===this.args.mode&&(this.args.facing="right",this.args.direction=-1,Math.abs(this.args.gSpeed)<r?this.args.gSpeed-=1:this.args.gSpeed=-r);var n=Math.ceil(this.args.width/2),i=Math.sign(this.args.gSpeed),o=this.rotatePoint(n*-i,this.args.height);this.getMapSolidAt(this.x+o[0],this.y+o[1])&&this.doJump(0)}else if(this.lightDashing){var s=Math.sign(this.args.xSpeed)||Math.sign(this.args.gSpeed);s<0?this.args.animation="lightdash-back":s>0&&(this.args.animation="lightdash"),e&&(this.args.direction=Math.sign(this.args.xSpeed)||this.args.direction,this.args.mode=0)}else if(e)this.dashed?e&&!this.args.jumping&&this.isSuper&&this.args.ySpeed>0&&(this.args.animation="dropping",this.onTimeout(150,function(){t.args.falling&&(t.args.animation="dropping")})):(this.args.height=this.args.rollingHeight,this.args.jumping?this.args.animation="jumping":!this.args.xSpeed&&this.args.ySpeed);else{var c=this.args.direction,u=this.args.gSpeed,l=Math.abs(u),f=this.args.gSpeedMax;this.dashed=!1,this.lightDashed=!1,this.args.height=this.args.normalHeight,this.spindashCharge?this.args.animation="spindash":this.args.rolling||(Math.sign(c)&&Math.sign(u)&&Math.sign(u)!==Math.sign(c)?this.args.animation="skidding":this.args.moving&&l>.75*f?this.isSuper&&this.args.moving&&l>1.85*f?this.args.animation="dash":this.args.moving&&l>2.25*f?this.args.animation="running-4":this.args.moving&&l>1.75*f?this.args.animation="running-3":this.args.moving&&l>1.25*f?this.args.animation="running-2":this.args.animation="running":this.args.moving&&this.args.gSpeed?this.args.animation="walking":this.args.moving&&this.args.gSpeed?this.args.pushing=Math.sign(this.args.gSpeed):this.yAxis>.5&&!this.args.ignore?(this.args.animation="crouching",this.args.lookTime--,this.args.lookTime<-45&&(this.args.cameraBias=-.5)):this.yAxis<-.5&&!this.args.ignore?(this.args.animation="looking-up",this.args.lookTime++,this.args.lookTime>45&&(this.args.cameraBias=.25)):(this.args.idleTime>18e3?this.args.animation="idle-3":this.args.idleTime>250?this.args.animation="idle-2":this.args.idleTime>200?this.args.animation="idle":this.args.animation="standing",this.args.cameraBias=0,this.args.lookTime=0)),!this.spindashCharge&&this.dashDust&&(this.dashDust.remove(),this.dashDust=null),this.dropDashCharge&&(this.args.animation="spindash",this.args.rolling=!0)}if(this.args.hangingFrom&&(this.args.animation="hanging"),this.args.rolling&&("spindash"!==this.args.animation?this.args.animation="rolling":(this.viewport.onFrameOut(14,function(){return t.args.animation="rolling"}),this.args.animation="spindash")),!this.skidding||this.args.rolling||this.args.falling||this.spindashCharge)this.spindashCharge||this.twister&&(this.twister.args.scale=0);else{this.args.xOff=8*-this.args.direction,this.args.yOff=32;var h=15*-this.args.gSpeed;Math.abs(h)>120&&(h=120*Math.sign(h)),this.twist(h)}if(this.args.standingOn&&this.args.standingOn.isVehicle&&(this.args.animation=this.args.standingOn.ridingAnimation||"standing"),this.args.grinding&&!this.args.falling){var p=document.createElement("div");p.classList.add("particle-sparks");var y=new a.Tag(p),b=document.createElement("div");b.classList.add("envelope-sparks");var v=new a.Tag(b);v.appendChild(y.node);var w=this.rotatePoint(1.75*-this.args.gSpeed*this.args.direction,8),S=Math.sign(this.args.gSpeed);v.style({"--x":w[0]+this.x,"--y":w[1]+this.y+-3*Math.random,"z-index":0,"animation-delay":.25*-Math.random()+"s","--xMomentum":Math.max(Math.abs(this.args.gSpeed),4)*S,"--flip":S,"--angle":this.realAngle,opacity:2*Math.random()}),v.particle=y,this.viewport.particles.add(v),this.sparks.add(v),this.viewport.onFrameOut(30,function(){t.viewport.particles.remove(v),t.sparks.delete(v)})}if(this.pincherBg&&(this.pincherBg.args.scale*=.85,Math.abs(this.pincherBg.args.scale)),this.twister||this.twist(0),this.args.grinding&&(this.args.rolling=!1,this.yAxis>.5?this.args.animation="grinding-crouching":this.args.animation="grinding"),m(j(k.prototype),"update",this).call(this),this.args.falling&&this.springing&&this.args.ySpeed>=0&&(this.args.groundAngle=0,this.args.animation="dropping-start",this.springing=!1,this.onTimeout(150,function(){t.args.falling&&"dropping-start"===t.args.animation&&(t.args.animation="dropping")})),this.args.boltDash){this.dimmer=this.dimmer||new a.Tag('<div class = "particle particle-dimmer">');var O=new a.Tag('<div class = "particle particle-bolt">'),x=this.args.falling?this.args.airSpeed:this.args.gSpeed,P=this.rotatePoint(x<0?8:-8,this.args.falling?this.dashed?x<0?28:32:14:28);this.dimmer.style({"--x":this.x+P[0],"--y":this.y+P[1]}),this.args.boltCount++;var _=Math.sign(this.args.gSpeed||this.args.xSpeed);O.attr({"data-direction":_}),O.style({"--x":this.x+P[0],"--y":this.y+P[1],"--index":this.args.boltCount,"--direction":_,"--mod":this.viewport.args.frameId%4,"--wipe":Math.abs(x),"--angle":this.args.falling?this.args.airAngle:this.realAngle,"--dashCharge":0}),this.viewport.particles.add(O),Math.abs(x)<20&&this.args.falling&&(this.args.boltDash=!1),this.viewport.particles.add(this.dimmer),this.viewport.onFrameOut(30,function(){t.viewport.particles.remove(O)})}if(d(this.regions).filter(function(t){return t.isWater}).length&&!this.checkBelow(this.x,this.y+16)&&this.args.falling&&this.dashed&&(this.yAxis<0&&(this.args.xSpeed=.95*this.args.xSpeed,this.args.ySpeed-=.05*Math.abs(this.args.xSpeed)),this.yAxis>0&&(this.args.xSpeed+=.05*Math.abs(this.args.ySpeed)*Math.sign(this.args.xSpeed),this.args.ySpeed=.95*this.args.ySpeed)),this.args.grinding&&!this.args.falling&&this.args.gSpeed){var M,R=g(this.sparks);try{for(R.s();!(M=R.n()).done;){var T=M.value,A=this.rotatePoint(1.75*this.args.direction,8);T.style({opacity:2*Math.random(),"--x":A[0]+this.x,"--y":A[1]+this.y})}}catch(t){R.e(t)}finally{R.f()}}}},{key:"readInput",value:function(){this.lightDashing||m(j(k.prototype),"readInput",this).call(this)}},{key:"airDash",value:function(t){var e=this;if(!(this.dashed||this.args.ignore&&-2!==this.args.ignore)){var r=t*(this.isSuper||this.isHyper?13:8);this.args.wallSticking&&(this.args.x+=r,r=t*(this.isSuper||this.isHyper?18:9)),this.args.mode=0,this.args.float=2,this.args.rolling=!1,this.args.height=this.args.normalHeight,this.args.xSpeed&&Math.sign(this.args.xSpeed)!==Math.sign(t)&&(r=t*Math.abs(r),this.args.float=4,this.args.xSpeed=0),this.args.falling=!0;var n=this.args.xSpeed+r;this.args.animation="rolling",this.viewport.onFrameOut(3,function(){return e.args.animation="airdash"}),this.args.xSpeed=n,this.args.ySpeed=0,this.args.gSpeed=0,this.dashTimer=0,this.dashed=!0,this.args.mode=0,this.args.groundAngle=0}}},{key:"command_0",value:function(){var t=this;if(this.dropDashCharge=0,this.args.jumping&&!this.dashed&&!this.doubleSpin){this.doubleSpin=!0,this.args.xOff=0,this.args.yOff=32,this.pinch(-600,50);var e=new h.Marker({x:this.x,y:this.y});e.owner=this,this.markers.add(e),this.viewport.spawn.add({object:e});var r=this.args.bindTo("x",function(t,r){return e.args[r]=t}),n=this.args.bindTo("y",function(t,r){return e.args[r]=t+18});this.viewport.onFrameOut(25,function(){t.viewport.actors.remove(e),r(),n()})}m(j(k.prototype),"command_0",this).call(this)}},{key:"command_4",value:function(){this.args.ignore||this.args.falling&&(this.airDash(-1),this.willStick=2,this.stayStuck=!0)}},{key:"hold_4",value:function(t){this.args.ignore||(this.args.jumping||this.dashed)&&(this.dropDashCharge=0,this.willStick=2,this.stayStuck=!0)}},{key:"release_4",value:function(){var t=this;if(this.onNextFrame(function(){t.willStick=!1,t.stayStuck=!1}),this.args.wallSticking&&!this.dashed){this.args.falling=!0,this.args.ySpeed>128||(this.args.ySpeed=0);var e=this.args.mode;this.airDash(1===e?1:-1),this.args.facing=1===e?"left":"right",this.args.mode=0,this.dashed=!0}}},{key:"command_5",value:function(){this.args.ignore||this.args.falling&&(this.airDash(1),this.willStick=2,this.stayStuck=!0)}},{key:"hold_5",value:function(t){this.args.ignore||(this.args.jumping||this.dashed&&2!==this.args.mode)&&(this.dropDashCharge=0,this.willStick=2,this.stayStuck=!0)}},{key:"release_5",value:function(){var t=this;if(this.onNextFrame(function(){t.willStick=!1,t.stayStuck=!1}),this.args.wallSticking&&!this.dashed){this.args.falling=!0,this.args.ySpeed=0;var e=this.args.mode;this.airDash(1===e?1:-1),this.args.facing=1===e?"left":"right",this.args.mode=0,this.dashed=!0}}},{key:"command_1",value:function(){var t=this;if(!this.args.ignore&&(this.args.wallSticking&&(this.args.x+=this.args.width/2*(1===this.args.mode?1:-1),this.doJump(0)),this.args.gSpeed&&!this.args.falling&&!this.args.rolling&&Math.sign(this.args.gSpeed)===this.args.direction)){this.args.rolling=!0;this.viewport.onFrameOut(20,function e(){var r=[t.args.width/2,t.args.height+4];if(t.getMapSolidAt(t.x-r[0],t.y-r[1]))return t.viewport.onFrameOut(40,e),t.args.gSpeed=4*t.args.direction,void(t.args.rolling=!0);t.args.rolling=!1})}}},{key:"release_1",value:function(){if(this.dropDashCharge=0,this.spindashCharge){this.spindashCharge<5&&(this.args.modeTime<45||this.args.skidding)&&(this.spindashCharge=15);var t=this.args.direction,e=this.spindashCharge/40;e>1&&(e=1),this.args.rolling=!0;var r=32*e;Math.sign(t)!==Math.sign(this.args.gSpeed)?this.args.gSpeed=r*Math.sign(t):this.args.gSpeed+=r*Math.sign(t),this.args.ignore=1,this.args.rolling=!0,this.spindashCharge=0,this.dashDust&&this.dashDust.remove()}}},{key:"hold_1",value:function(t){if(!this.args.ignore&&!this.args.rolling)if(this.args.jumping&&this.dropDashCharge<15)this.dropDashCharge++;else if(0!==this.args.modeTime&&!this.dropDashCharge)if(this.args.falling||this.willJump||this.args.gSpeed&&!this.skidding)this.skidding||(this.spindashCharge=0);else{this.args.ignore=1;var e=this.spindashCharge/20;if(e>1&&(e=1),0===this.spindashCharge){this.spindashCharge=1,this.yAxis>.5&&(this.spindashCharge=10);var r=this.viewport,n=new a.Tag('<div class = "particle-spindash-dust">'),i=this.rotatePoint(0,0);n.style({"--x":i[0]+this.x,"--y":i[1]+this.y,"--direction":this.args.direction,"--dashCharge":0}),this.args.direction<0?n.setAttribute("data-facing","left"):this.args.direction>0&&n.setAttribute("data-facing","right"),r.particles.add(n.node),this.dashDust=n}else this.dashDust&&this.dashDust.style({"--dashCharge":e});this.viewport.args.frameId%3==0&&this.spindashCharge++,this.args.xOff=5*-this.args.direction,this.args.yOff=32,this.twist(120*e*this.args.direction),this.args.animation="spindash",this.args.direction<0?this.args.facing="left":this.args.direction>0&&(this.args.facing="right")}}},{key:"hold_2",value:function(){if(this.args.falling&&!(this.lightDashing||this.lightDashingCoolDown>0)){var t=this.findDashableRing(48);return t?(this.lightDash(t),void(this.lightDashingCoolDown=9)):void 0}}},{key:"command_2",value:function(){var t=this;if(this.viewport.collisions.has(this)){var e,r=g(this.viewport.collisions.get(this).keys());try{for(r.s();!(e=r.n()).done;){var n=e.value;if("function"==typeof n.lift)return void n.lift(this)}}catch(t){r.e(t)}finally{r.f()}}this.onNextFrame(function(){var e=t.args.falling?t.args.airSpeed:t.args.gSpeed;if(t.isSuper&&!t.lightDashing&&!t.args.boltDash&&Math.abs(e)>6){var r=t.args.xSpeed,n=t.args.ySpeed,i=t.args.gSpeed;t.args.falling?(t.args.xSpeed=Math.max(-64,Math.min(t.args.xSpeed,64)),t.args.ySpeed=Math.max(-64,Math.min(t.args.ySpeed,64)),t.args.float=5,t.args.xSpeed*=5,t.args.ySpeed*=5):(t.args.gSpeed*=3,t.args.gSpeed=Math.max(-128,Math.min(t.args.gSpeed,128))),t.args.boltCount=0,t.args.boltDash=!0,o.Sfx.play("LIGTNING_STRIKE"),t.args.opacity=0,t.viewport.onFrameOut(35,function(){t.args.opacity=1,t.args.boltDash=!1,t.args.xSpeed=t.args.xSpeed?r:0,t.args.ySpeed=t.args.ySpeed?n:0,t.args.gSpeed=t.args.gSpeed?i:0,t.dimmer&&t.viewport.particles.remove(t.dimmer),t.dimmer=!1})}})}},{key:"release_2",value:function(){this.args.boltDash&&(this.args.opacity=1,this.args.boltDash=!1,this.args.xSpeed/=2,this.args.ySpeed/=2,this.args.gSpeed/=3,this.dimmer&&this.viewport.particles.remove(this.dimmer),this.dimmer=!1)}},{key:"command_3",value:function(){var t=this;this.args.ignore&&!this.isSuper||(this.isSuper=!this.isSuper,this.isHyper=!this.isHyper,this.onTimeout(150,function(){0===t.args.rings&&(t.isSuper=!1,t.isHyper=!1,t.setProfile())}),this.setProfile())}},{key:"setProfile",value:function(){this.isHyper?(this.args.spriteSheet=this.superSpriteSheet,this.args.gSpeedMax=this.gSpeedMaxSuper,this.args.jumpForce=this.jumpForceSuper,this.args.accel=this.accelSuper):this.isSuper?(this.args.spriteSheet=this.superSpriteSheet,this.args.gSpeedMax=this.gSpeedMaxSuper,this.args.jumpForce=this.jumpForceSuper,this.args.accel=this.accelSuper):(this.args.spriteSheet=this.spriteSheet,this.args.gSpeedMax=this.gSpeedMaxNormal,this.args.jumpForce=this.jumpForceNormal,this.args.accel=this.accelNormal)}},{key:"findNearestRing",value:function(){return this.findDashableRing(64)}},{key:"findDashableRing",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128,r=function(e){if(!(e instanceof u.Ring))return!1;var r=Math.sign(t.args.xSpeed);return!(r>0&&e.x<t.x)&&!(r<0&&e.x>t.x)},n=this.findNearestActor(r,e);if(n){var i=n.findNearestActor(r,e);if(i){var o=Math.atan2(this.y-n.y,this.x-n.x),a=Math.atan2(n.y-i.y,n.x-i.x);if(!(Math.abs(o-a)>Math.PI/2))return n}}}},{key:"lightDash",value:function(t){if(!this.args.falling)return this.lightDashing=!1,!1;var e;this.lightDashed=!0,this.spindashCharge=0;var r=Math.atan2(t.y-this.y,t.x-this.x);e=this.args.groundAngle;var n=Math.abs(e-r),i=4*this.distanceFrom(t)*(Math.PI/2/n);i>55&&(i=55);var o=this.scanForward(i,.5);o&&i>o&&(i=o);Math.sign(this.args.xSpeed)||Math.sign(this.args.gSpeed);this.args.direction<0?this.args.animation="lightdash-back":this.args.direction>0&&(this.args.animation="lightdash");Math.PI;this.args.airAngle=r,this.lightDashing=!0,this.args.xSpeed=i*Math.cos(r)*.5,this.args.ySpeed=i*Math.sin(r)*.5,this.lightDashTimeout()}},{key:"collect",value:function(t){if(m(j(k.prototype),"collect",this).call(this,t),t instanceof u.Ring&&this.lightDashing){var e=this.findNearestActor(function(t){return t instanceof u.Ring},128);e?this.lightDash(e):(this.lightDashing=!1,this.args.float=0)}}},{key:"lightDashTimeout",value:function(){var t=this;this.clearLightDash&&(this.clearLightDash(),this.clearLightDash=!1),this.clearLightDash=this.viewport.onFrameOut(9,function(){t.lightDashing=!1,t.args.float=0})}},{key:"setCameraMode",value:function(){this.args.boltDash?this.args.cameraMode="draggable":this.args.wallSticking?this.args.cameraMode="aerial":m(j(k.prototype),"setCameraMode",this).call(this)}},{key:"startle",value:function(){var t=this;m(j(k.prototype),"startle",this).call(this),this.onNextFrame(function(){return t.args.animation="startle"})}},{key:"die",value:function(){var t=this;m(j(k.prototype),"die",this).call(this),this.onNextFrame(function(){return t.args.animation="dead"})}},{key:"loseRings",value:function(t,e){m(j(k.prototype),"loseRings",this).call(this,t,e),o.Sfx.play("RINGS_SCATTERED")}},{key:"collideA",value:function(t){var e=this;t instanceof l.Spring&&this.onNextFrame(function(){e.args.falling&&(e.springing=!0,e.args.animation="springdash")})}},{key:"solid",get:function(){return!1}},{key:"canRoll",get:function(){return!this.args.wallSticking}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!this.args.npc}},{key:"facePoint",get:function(){return this.args.wallSticking?this.rotatePoint(0,-5):m(j(k.prototype),"facePoint",this)}},{key:"crossRegionBoundary",value:function(t,e){t instanceof f.GrindingRegion&&(e||(this.args.falling?this.args.animation="springdash":this.args.grinding=!1)),m(j(k.prototype),"crossRegionBoundary",this).call(this,t,e)}}])&&v(r.prototype,n),y&&v(r,y),Object.defineProperty(r,"prototype",{writable:!1}),k}();t.Sonic=k}),require.register("actor/Spawner.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Spawner=void 0;var i=e("./PointActor"),o=e("../ObjectPalette");function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||s(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){if(t){if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(h,i.PointActor);var e,r,n,c=f(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.width=16,t.args.height=32,t.args.type="actor-item actor-spawner",t}return e=h,(r=[{key:"activate",value:function(){if(this.args.spawn&&this.args.point){var t=this.viewport.objDefs.get(this.args.point),e=o.ObjectPalette[this.args.spawn];if(t&&e){var r,n=new e({x:t.x,y:t.y}),i=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=s(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw o}}}}(this.def);try{for(i.s();!(r=i.n()).done;){var c=a(r.value,2),u=c[0],l=c[1];"point"!==u&&"type"!==u&&(n.args[u]=l)}}catch(t){i.e(t)}finally{i.f()}n.args[name]=this.args.spawn,this.viewport.spawn.add({object:n})}}}},{key:"solid",get:function(){return!1}}])&&u(e.prototype,r),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.Spawner=p}),require.register("actor/Spikes.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Spikes=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.PointActor);var e,r,n,l=s(f);function f(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(r=l.call(this,t,e)).args.type="actor-item actor-spikes",r.args.width=t.width||32,r.args.height=t.height||32,r.args.pointing=r.args.pointing||0,r.hazard=!0,r}return e=f,n=[{key:"fromDef",value:function(t){var e=c(u(f),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.height=t.height,e.args.x=e.originalX=t.x+Math.floor(t.width/2),e}}],(r=[{key:"onRendered",value:function(t){c(u(f.prototype),"onRendered",this).call(this,t),this.autoAttr.get(this.box)["data-pointing"]="pointing"}},{key:"startle",value:function(){}},{key:"damage",value:function(){}},{key:"collideA",value:function(t,e){if(!t.isRegion){if(!this.args.falling||this.args.float){if(e===this.args.pointing)if(3===this.args.pointing)(t.args.xSpeed||t.args.gSpeed*(2===t.args.mode?-1:1))<=0&&t.damage(this);else if(1===this.args.pointing){(t.args.xSpeed||t.args.gSpeed*(2===t.args.mode?-1:1))>=0&&t.damage(this)}else if(2===this.args.pointing){(t.args.ySpeed||t.args.gSpeed*(1===t.args.mode?-1:1))<=0&&t.damage(this)}else if(0===this.args.pointing){(t.args.ySpeed||t.args.gSpeed*(3===t.args.mode?-1:1))>=0&&t.damage(this)}return!0}t.damage(!1)}}},{key:"solid",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.Spikes=l}),require.register("actor/SpikesSmall.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SpikesSmall=void 0;var i=e("curvature/base/Tag"),o=e("../audio/Sfx"),a=(e("./PointActor"),e("./Spikes"));function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(p,a.Spikes);var e,r,n,h=u(p);function p(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(r=h.call(this,t,e)).args.type="actor-item actor-spikes actor-spikes-small",r.args.width=t.width||32,r.args.height=10,r.args.pointing=r.args.pointing||0,r.hazard=!0,r.args.width<16&&(r.args.narrow=!0),r}return e=p,n=[{key:"fromDef",value:function(t){var e=l(f(p),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.height=10,e.args.x=e.originalX=t.x+Math.floor(t.width/2),e}}],(r=[{key:"update",value:function(){l(f(p.prototype),"update",this).call(this);this.sprite&&!this.graphic&&(this.graphic=new i.Tag('<svg style  = "--breakSplit: '.concat(4,';" data-narrow = "').concat(this.args.narrow,'">\n\t\t\t\t<defs>\n\t\t\t\t\t<pattern\n\t\t\t\t\t\tid     = "spikes-').concat(this._id,'"\n\t\t\t\t\t\twidth  = "').concat(16/this.args.width,'"\n\t\t\t\t\t\theight = "1"\n\t\t\t\t\t\tx      = "0"\n\t\t\t\t\t\ty      = "0"\n\t\t\t\t\t>\n\t\t\t\t\t\t<image href = "/Sonic/spikes-small-single.png">\n\t\t\t\t\t</pattern>\n\t\t\t\t</defs>\n\t\t\t\t<rect fill = "url(#spikes-').concat(this._id,')"></rect>\n\t\t\t\t<rect fill = "url(#spikes-').concat(this._id,')"></rect>\n\t\t\t</svg>')),this.sprite.appendChild(this.graphic.node))}},{key:"collideA",value:function(t,e){var r=this;if(this.args.broken||t instanceof a.Spikes||t.args.static)return!1;if(t.isVehicle){this.args.broken=!0,this.args.gravity=.4,t.halt(10);var n=8+(t.args.width+this.args.width)/2;return t.args.x=this.x+-n*Math.sign(this.x-t.x),this.args.type="actor-item actor-spikes actor-spikes-small actor-spikes-breaking",this.viewport.onFrameOut(7,function(){r.args.falling=!0,r.args.xSpeed=.25*t.args.hSpeed+1*Math.pow(Math.random(),2),r.args.ySpeed=-5*Math.pow(Math.random(),2)-5,r.args.type="actor-item actor-spikes actor-spikes-small actor-spikes-broken",o.Sfx.play("BLOCK_DESTROYED")}),this.args.float=8,this.noClip=!0,!1}return l(f(p.prototype),"collideA",this).call(this,t,e)}},{key:"activate",value:function(){this.args.float=0,this.noClip=!0}},{key:"solid",get:function(){return!this.args.broken&&!this.noClip}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.SpikesSmall=h}),require.register("actor/Spinner.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Spinner=void 0;var i=e("./PointActor"),o=e("../audio/Sfx");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=Symbol("Boosted"),f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.PointActor);var e,r,n,u=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=u.call.apply(u,[this].concat(r))).args.type="actor-item actor-spinner",t.args.width=64,t.args.height=24,t.args.direction=t.args.direction||1,t}return e=f,(r=[{key:"collideB",value:function(t){if(!(t instanceof f||(t.args.gSpeed,t.args.falling||t[l]))){this.viewport.onFrameOut(10,function(){return delete t[l]}),t[l]=this;var e=this.args.toSpeed||40;t.args.ignore=2,t.args.direction=this.args.direction,t.args.facing=this.args.direction>0?"right":"left",t.args.gSpeed=Math.abs(t.args.gSpeed)>e?Math.abs(t.args.gSpeed)*this.args.direction:e*this.args.direction,o.Sfx.play("SPEEDPAD_HIT")}}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.Spinner=f}),require.register("actor/Spring.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Spring=void 0;var i=e("./LayerSwitch"),o=e("./PointActor"),a=e("../region/Region"),s=e("../audio/Sfx");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return f(t)}(this,r)}}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var d=Symbol("WillSpring"),y=Symbol("WontSpring"),b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(v,o.PointActor);var e,r,n,b=l(v);function v(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return g(f(t=b.call.apply(b,[this].concat(r))),"float",-1),g(f(t),"template",'<div\n\t\tclass = "point-actor actor-item [[type]] [[collType]] [[active]]"\n\t\tstyle = "\n\t\t\tdisplay:[[display]];\n\t\t\t--angle:[[angle]];\n\t\t\t--airAngle:[[airAngle]];\n\t\t\t--ground-angle:[[groundAngle]];\n\t\t\t--height:[[height]];\n\t\t\t--width:[[width]];\n\t\t\t--x:[[x]];\n\t\t\t--y:[[y]];\n\t\t"\n\t\tdata-colliding = "[[colliding]]"\n\t\tdata-diagonal  = "[[diagonal]]"\n\t\tdata-falling   = "[[falling]]"\n\t\tdata-facing    = "[[facing]]"\n\t\tdata-angle     = "[[angle|rad2deg]]"\n\t\tdata-mode      = "[[mode]]"\n\t>\n\t\t<div\n\t\t\tdata-color = "[[color]]"\n\t\t\tdata-type  = "[[base]]"\n\t\t\tclass      = "spring-pad"\n\t\t\tstyle = "--color:[[color]]deg"\n\t\t></div>\n\t\t<div class = "sprite"></div>\n\t</div>'),t.args.type="actor-item actor-spring",t.args.width=t.args.width||32,t.args.height=t.args.height||32,t.args.color=t.args.color||0,t.args.static=!0,t.args.actingOn=new Set,t}return e=v,n=[{key:"fromDef",value:function(t){var e=h(p(v),"fromDef",this).call(this,t);return e.args.angle=Number(e.args.angle),e.args.width=t.width||32,e.args.height=t.height||32,e}}],(r=[{key:"collideA",value:function(t){var e=this;if(t.args.hangingFrom&&t.args.hangingFrom.unhook(),t[y])return!1;if(t.args.static)return!1;if(t instanceof this.constructor)return!1;if(t instanceof i.LayerSwitch)return!1;if(h(p(v.prototype),"collideA",this).call(this,t),!this.args.actingOn.has(t)&&!t.args.platform&&!(t instanceof a.Region||(s.Sfx.play("SPRING_HIT"),t[d]||(this.args.actingOn.add(t),this.viewport.onFrameOut(1,function(){e.args.active=!0}),this.viewport.onFrameOut(5,function(){delete t[d],e.args.active=!1,e.args.actingOn.delete(t)}),t.noClip)))){t[d]=!0,t.args.gSpeed=0,t.args.xSpeed=0,t.args.ySpeed=0;var r=this.roundAngle(this.args.angle,8,!0);this.viewport.settings.rumble&&t.controller&&t.controller.rumble&&(t.controller.rumble({duration:120,strongMagnitude:1,weakMagnitude:1}),this.onTimeout(100,function(){t.controller.rumble({duration:500,strongMagnitude:0,weakMagnitude:.25})})),t.args.x=this.x+16*Math.cos(r),t.args.y=this.y+16*Math.sin(r),t.args.jumping=!1,t.args.ignore=t.args.falling?4:12,t.args.float=2,this.viewport.onFrameOut(2,function(){t.args.float=2,t.args.direction=Math.sign(n),t.impulse(e.args.power,r,![0,Math.PI].includes(e.args.angle)&&Math.abs(Math.PI-e.args.angle)>.01)});var n=Number(Number(1*Math.cos(r)).toFixed(3)),o=Number(Number(1*Math.sin(r)).toFixed(3)),c=t.args.rolling;![0,Math.PI].includes(this.args.angle)&&Math.abs(Math.PI-this.args.angle)>.01||t.args.falling||0!==t.args.mode?(t.args.falling=!0,t.args.mode=0):(this.viewport.onFrameOut(3,function(){return t.args.rolling=c}),this.viewport.onFrameOut(2,function(){return t.args.rolling=c}),this.viewport.onFrameOut(1,function(){return t.args.rolling=c})),Math.abs(t.args.xSpeed)<3||Math.sign(t.args.xSpeed)!==Math.sign(n)?t.args.xSpeed=n:t.args.xSpeed+=n,Math.abs(t.args.ySpeed)<3||Math.sign(t.args.ySpeed)!==Math.sign(o)?t.args.ySpeed=o:t.args.ySpeed+=o,t.args.airAngle=this.args.angle,t.args.displayAngle=0,t.args.groundAngle=0,t.args.airAngle=-Math.PI/2}}},{key:"sleep",value:function(){this.args.actingOn.clear(),this.args.active=!1}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!1}}])&&c(e.prototype,r),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),v}();t.Spring=b,g(b,"WontSpring",y)}),require.register("actor/Springboard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Springboard=void 0;var i=e("./PointActor"),o=e("../audio/Sfx");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(l,i.PointActor);var e,r,n,u=c(l);function l(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=u.call.apply(u,[this].concat(r))).args.type="actor-item actor-springboard",t.args.width=56,t.args.height=16,t.args.animation="idle",t}return e=l,(r=[{key:"collideA",value:function(t,e){var r=this;if(t.controllable&&!this.args.ignore){var n=Math.min(1,Math.max(0,1+(-this.x-26+t.x)/56));if(n<.5&&(n*=.5),this.args.animation="depressed",t.args.jumping&&"idle"!==this.args.animation&&t.args.ySpeed<0){this.args.ignore=6,this.args.animation="idle";var i=Math.max(t.args.gSpeed/2,t.args.xSpeed);this.onNextFrame(function(){t.args.xSpeed=i,t.args.ySpeed+=-12*n}),o.Sfx.play("SPRING_HIT")}if(-this.x+t.x<=-26&&(this.args.animation="idle"),(-this.x+t.x>=26||Math.abs(t.args.gSpeed)>13)&&0===t.args.mode){this.args.ignore=6;var a=Math.max(t.args.gSpeed/2,t.args.xSpeed);this.onNextFrame(function(){t.args.falling=!0,t.args.xSpeed=a,t.args.ySpeed=-8}),this.viewport.onFrameOut(5,function(){return r.args.animation="idle"}),o.Sfx.play("SPRING_HIT")}t.args.ySpeed<0&&(this.args.animation="idle")}}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),l}();t.Springboard=l}),require.register("actor/StarBalloon.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.StarBalloon=void 0;var i=e("./Balloon"),o=e("./Spring");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.Balloon);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-balloon actor-star-balloon",t.args.target=t.args.target||0,t.args.gravity=.475,t[o.Spring.WontSpring]=!0,t}return e=h,(r=[{key:"update",value:function(){if(s(l(h.prototype),"update",this).call(this),!this.popped)if(this.launched){var t=this.args.target-this.y;this.args.ySpeed=Math.min(8,Math.abs(t))*Math.sign(t)}else this.args.ySpeed=0;this.args.groundAngle=0}},{key:"activate",value:function(){this.launched=!0}},{key:"collideA",value:function(t){return!(!t.controllable||t.args.hangingFrom)&&(!this.popped&&void((t.args.ySpeed>=0||t.args.spinning)&&(t.args.ySpeed=-14,this.pop())))}},{key:"sleep",value:function(){this.tags.sprite&&this.tags.sprite.classList.remove("popped"),this.args.x=this.def.get("x"),this.args.y=this.def.get("y"),this.args.xSpeed=0,this.args.ySpeed=0,this.args.float=-1,this.popped=this.launched=!1,this.args.falling=!0,this.viewport.setColCell(this),this.noClip=!1}},{key:"damage",value:function(){this.pop()}},{key:"pop",value:function(){var t=new CustomEvent("exploded",{detail:{actor:this}});this.dispatchEvent(t),this.tags.sprite.classList.add("popped"),this.popped=!0,this.args.float=0,this.noClip=!0}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.StarBalloon=f}),require.register("actor/StarPost.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.StarPost=void 0;e("../ui/CharacterString");var i=e("./PointActor"),o=e("curvature/base/Tag"),a=e("../audio/Sfx"),s=(e("./Monitor"),e("./monitor/RingMonitor")),c=e("./monitor/SheildElectricMonitor"),u=e("./monitor/SheildWaterMonitor"),l=e("./monitor/SheildFireMonitor");function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=d(t);if(e){var o=d(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}(b,i.PointActor);var e,r,n,y=g(b);function b(){var t,e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=y.call.apply(y,[this].concat(n))).args.type="actor-item actor-star-post",e.args.width=16,e.args.height=48,e.args.active=null!==(t=e.args.active)&&void 0!==t&&t,e.args.static=!0,e.spinning=!1,e}return e=b,(r=[{key:"update",value:function(){var t=this;if(h(d(b.prototype),"update",this).call(this),this.args.wasActive){var e=new s.RingMonitor({direction:0,ySpeed:-4,x:this.x-10,y:this.y-48});this.viewport.onFrameOut(12,function(){t.viewport.spawn.add({object:e})}),this.args.wasActive=!1}}},{key:"onRendered",value:function(){h(d(b.prototype),"onRendered",this).call(this),this.sprite=this.findTag("div.sprite"),this.box=this.findTag("div"),this.headBox=new o.Tag('<div class = "star-post-head-box">'),this.head=new o.Tag('<div class = "star-post-head">'),this.headBox.appendChild(this.head.node),this.box.appendChild(this.headBox.node)}},{key:"collideA",value:function(t){var e=this;if(h(d(b.prototype),"collideA",this).call(this,t),t.args.owner&&(t=t.args.owner),(t.controllable||t.occupant)&&this.box&&!this.args.active){this.args.active=!0,this.box.setAttribute("data-direction",t.args.direction),this.box.setAttribute("data-active","true"),this.box.setAttribute("data-spin","true"),a.Sfx.play("STARPOST_HIT");var r=t.args.gSpeed||t.args.xSpeed;Math.abs(r)>8&&(r=8*Math.sign(r));var n=t.args.rings>50?[s.RingMonitor,l.SheildFireMonitor,u.SheildWaterMonitor,c.SheildElectricMonitor]:[s.RingMonitor],i=new(0,n[Math.floor(Math.random()*n.length)])({direction:t.args.direction,xSpeed:r,ySpeed:-5,x:this.x-10,y:this.y-48});this.viewport.storeCheckpoint(t.args.canonical,this.args.id),this.viewport.spawn.add({object:i}),this.spinning=!0,this.viewport.onFrameOut(36,function(){e.spinning=!1}),"function"==typeof ga&&ga("send","event",{eventCategory:"starpost",eventAction:"activated",eventLabel:"".concat(this.viewport.args.actName,"::").concat(this.args.id)})}}},{key:"solid",get:function(){return!1}}])&&f(e.prototype,r),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),b}();t.StarPost=y}),require.register("actor/SteelCrate.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SteelCrate=void 0;var i=e("./Block"),o=e("./BreakableBlock"),a=e("./Projectile");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(p,o.BreakableBlock);var e,r,n,h=l(p);function p(){var t,e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=h.call.apply(h,[this].concat(n))).args.type="actor-item actor-breakable-block actor-steel-crate",e.args.width=64,e.args.height=64,e.args.static=null!==(t=e.args.static)&&void 0!==t&&t,e}return e=p,(r=[{key:"collideA",value:function(t,e){return t instanceof i.Block||(t instanceof a.Projectile&&!this.broken?(this.break(),!0):t.args.bouncing&&!this.broken?(this.break(),!0):t.punching&&!this.broken?(this.break(),!1):!(!t.args.rolling||this.broken)||(!(0!==e||!t.controllable)||(1!==e&&3!==e||t.y<=this.y-this.args.height||!!this.viewport&&(-1!==e&&!t.args.rolling||c(f(p.prototype),"collideA",this).call(this,t,e)))))}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.SteelCrate=h}),require.register("actor/Stopper.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Stopper=void 0;var i=e("./BreakableBlock");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.BreakableBlock);var e,r,n,l=c(f);function f(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(t=l.call(this,e,r)).args.type="actor-item actor-breakable-block actor-stopper",t.args.height=16,t.args.float=-1,t}return e=f,(r=[{key:"collideA",value:function(t,e){var r=this;return!this.broken&&(!this.broken&&2===e||Math.abs(t.args.ySpeed)>20&&0===e?!(t.args.ySpeed>0||t.ySpeedLast>0)||(t.args.groundAngle=0,t.args.x=this.args.x,t.args.xSpeed=0,t.args.ySpeed=Math.abs(t.args.gSpeed),t.args.falling=!0,t.args.mode=0,this.break(),!1):!(t.args.jumping&&t.args.ySpeed>0||t.args.rolling)||(t.args.x=this.args.x,t.args.y=this.args.y,this.viewport.onFrameOut(1,function(){t.args.groundAngle=0,t.args.falling=!0,t.args.animation="rolling",t.args.x=r.args.x,t.args.gSpeed=0,t.args.xSpeed=0,t.args.ySpeed=Math.abs(t.args.gSpeed)}),t.args.jumping&&(t.args.gSpeed=0,t.args.xSpeed=0,t.args.ySpeed=0,t.args.ignore=30,t.args.float=30,this.viewport.onFrameOut(30,function(){t.args.xSpeed=0,t.args.ySpeed=10})),a(u(f.prototype),"collideA",this).call(this,t,e)))}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.Stopper=l}),require.register("actor/SuperRing.js",function(t,e,r){"use strict"}),require.register("actor/Switch.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Switch=void 0;var i=e("./PointActor"),o=e("../audio/Sfx");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t,e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=f.call.apply(f,[this].concat(n))).args.type="actor-item actor-switch",e.args.width=32,e.args.height=e.height=16,e.removeTimer=null,e.args.active=!1,e.args.latch=e.args.latch||!1,e.activator=null,e.args.bindTo("active",function(t){e.box&&e.box.setAttribute("data-active",t?"true":"false")}),e.args.threshold=null!==(t=e.args.threshold)&&void 0!==t?t:100,e.ignore=0,e}return e=h,(r=[{key:"update",value:function(){s(l(h.prototype),"update",this).call(this),this.args.active?this.args.height=this.height+-6:this.args.height=this.height,this.ignore>0?this.ignore--:this.args.latch||this.activator&&this.activator.args.standingOn===this&&this.activator.y!==this.args.y||(this.args.active=!1,this.activator=null)}},{key:"onAttached",value:function(){this.box=this.findTag("div")}},{key:"collideA",value:function(t,e){var r=this;return this.activator===t&&t.y>this.y?(this.ignore=8,!0):t.args.ySpeed<0?0===t.args.ySpeed&&t.y>this.y:!!(this.args.active&&t.y<this.y)||(t.isEffect||t.isRegion?void 0:!(t.y>this.y-this.args.height+0)&&(!!(this.args.threshold&&t.args.weight<this.args.threshold)||(t.onRemove(function(){return r.activator=null}),t.y<=this.y-this.args.height&&(this.args.active||this.activate(t),this.ignore=8,this.args.active=!0,this.activator=t,!0))))}},{key:"activate",value:function(t){(this.beep(),this.args.target&&this.viewport.actorsById[this.args.target])&&this.viewport.actorsById[this.args.target].activate(t,this);if(this.args.destroyLayer){var e=this.args.destroyLayer,r=this.viewport.args.layers[e];r&&(r.args.destroyed=!0)}if(this.args.water){var n,i,o=this.viewport.actorsById[this.args.water],a=this.viewport.objDefs.get(this.args.setPoint);o.target=Number(o.y||0)-Number(a.y||0),o.args.fillSpeed=null!==(n=this.args.fillSpeed)&&void 0!==n?n:o.args.fillSpeed,o.args.drainSpeed=null!==(i=this.args.drainSpeed)&&void 0!==i?i:o.args.drainSpeed}var s=this.viewport.objDefs.get(this.args.point),c=this.viewport.objectPalette[this.args.spawn];c&&s&&this.viewport.spawn.add({object:new c({x:s.x,y:s.y})}),this.args.active=!0}},{key:"beep",value:function(){this.viewport&&(this.args.silent||o.Sfx.play("SWITCH_HIT"))}},{key:"sleep",value:function(){var t=this;this.viewport&&(this.args.x=this.def.get("x"),this.args.y=this.def.get("y"),this.onNextFrame(function(){t.args.x=t.def.get("x"),t.args.y=t.def.get("y"),t.viewport.setColCell(t),t.args.xSpeed=0,t.args.ySpeed=0,t.args.pushed=0,t.args.float=0}))}},{key:"solid",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.Switch=f}),require.register("actor/Tails.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Tails=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag"),a=(e("./Spring"),e("../behavior/SkidDust"));function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(p,i.PointActor);var e,r,n,h=l(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=h.call.apply(h,[this].concat(r))).args.canonical="Tails",t.behaviors.add(new a.SkidDust),t.args.type="actor-item actor-tails",t.jumpForceNormal=11.5,t.jumpForceSuper=16,t.accelNormal=.15,t.accelSuper=.22,t.args.accel=t.accelNormal,t.args.decel=.4,t.args.flySpeedMax=25,t.args.gSpeedMax=18,t.args.jumpForce=t.jumpForceNormal,t.args.weight=80,t.args.gravity=.5,t.args.width=16,t.args.height=34,t.args.normalHeight=32,t.args.rollingHeight=28,t.willStick=!1,t.stayStuck=!1,t}return e=p,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.tails=new o.Tag('<div class = "tails-tails">'),this.sprite.appendChild(this.tails.node),this.flyingSound=new Audio("/Sonic/tails-flying.wav"),this.flyingSound.volume=.35+-.3*Math.random(),this.flyingSound.loop=!0}},{key:"startle",value:function(){var t=this;c(f(p.prototype),"startle",this).call(this),this.args.animation="startle",this.onNextFrame(function(){return t.args.animation="startle"})}},{key:"updateStart",value:function(){c(f(p.prototype),"updateStart",this).call(this),this.args.dead&&(this.args.animation="dead")}},{key:"update",value:function(){var t=this.args.falling;if(this.viewport)if(this.viewport.args.audio&&this.flyingSound&&(this.flyingSound.paused||(this.flyingSound.volume=.35+-.3*Math.random()),this.flyingSound.currentTime>.2&&(this.flyingSound.currentTime=0)),this.box){if(this.args.tailFlyCoolDown>0&&this.args.tailFlyCoolDown--,this.args.tailFlyCoolDown<0&&this.args.tailFlyCoolDown++,0===this.args.tailFlyCoolDown&&(this.flyingSound.pause(),this.args.flying=!1),t)this.args.flying&&!this.args.startled?this.yAxis>0?(this.box.setAttribute("data-animation","jumping"),this.args.ySpeed=this.args.ySpeed>this.args.jumpForce?this.args.ySpeed:this.args.jumpForce):this.box.setAttribute("data-animation","flying"):this.args.jumping&&(this.flyingSound.pause(),this.box.setAttribute("data-animation","jumping"));else{this.args.tailFlyCoolDown=0,this.flyingSound.pause();var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;this.args.rolling?this.box.setAttribute("data-animation","rolling"):Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?this.box.setAttribute("data-animation","skidding"):n>i/2?this.box.setAttribute("data-animation","running"):this.args.moving&&this.args.gSpeed?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}this.args.hangingFrom&&(this.args.animation="hanging"),this.args.startled&&(this.flyingSound.pause(),this.args.flying=!1),c(f(p.prototype),"update",this).call(this)}else c(f(p.prototype),"update",this).call(this)}},{key:"command_0",value:function(t){this.args.hangingFrom?c(f(p.prototype),"command_0",this).call(this):(c(f(p.prototype),"command_0",this).call(this,t),this.args.jumping&&(this.args.falling?0!==this.args.tailFlyCoolDown?(this.args.ySpeed>0&&(this.args.ySpeed=0),this.args.tailFlyCoolDown=80,this.args.flying=!0,this.flyingSound.volume=.35+-.3*Math.random(),this.viewport.args.audio&&this.flyingSound.paused&&this.flyingSound.play()):this.args.tailFlyCoolDown=80:this.args.tailFlyCoolDown=-80))}},{key:"hold_0",value:function(t){this.args.flying?(this.args.ySpeed>0&&(this.args.ySpeed=0),Math.random()>.8&&(this.flyingSound.volume=.35+-.3*Math.random()),this.args.tailFlyCoolDown=80,this.args.ySpeed-=Math.min(3,t.time/9),this.args.ySpeed=Math.max(-5,this.args.ySpeed)):this.args.flying=!0}},{key:"sleep",value:function(){this.flyingSound&&this.flyingSound.pause()}},{key:"solid",get:function(){return!1}},{key:"canRoll",get:function(){return!0}},{key:"canFly",get:function(){return!0}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!this.args.npc}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.Tails=h}),require.register("actor/Tester.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Tester=void 0;var i=e("./PointActor"),o=(e("./Cursor"),e("../ObjectPalette"));function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}window.testRuns=[];var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(h,i.PointActor);var e,r,n,l=c(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return f(u(t=l.call.apply(l,[this].concat(r))),"count",0),f(u(t),"char",null),t}return e=h,(r=[{key:"update",value:function(){var t=this;if(this.char){var e=this.char.controller;5===this.char.age&&e.press(4,1),6===this.char.age&&e.press(4,0),this.char.readInput()}else{var r=o.ObjectPalette.sonic,n=this.count;this.char=new r({name:"Test #".concat(n),x:this.x+-n%160+80,y:this.y});var i=this.char.args.bindTo("falling",function(){var e=t.char.x;t.viewport.onFrameOut(5,function(){console.log({count:n,landed:e,groundAngle:t.char.args.groundAngle,gSpeed:t.char.args.gSpeed})}),i()},{now:!1,frame:1});window.testRuns[n]=this.char,this.count++,this.viewport.spawn.add({object:this.char})}if(this.char.args.dead){var a=this.char;this.char=null,this.viewport.onFrameOut(100,function(){return t.viewport.actors.remove(a)})}else this.char.age>30&&(this.char.xAxis=1)}},{key:"updateEnd",value:function(){this.char}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.Tester=h}),require.register("actor/TextActor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TextActor=void 0;var i=e("./PointActor"),o=e("../ui/CharacterString");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(t,e){var r,n,i,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),r=l.call(this,t,e),n=u(r),a=-1,(i="float")in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,r.args.type="actor-item actor-text-actor",r.args.float=-1,r.text=new o.CharacterString({value:""}),r.args.bindTo("content",function(e){r.text.args.value=e,r.text.args.color=t.color,r.args.width=18*e.length,r.args.height=18}),r}return e=f,(r=[{key:"onAttached",value:function(){this.sprite=this.findTag("div.sprite"),this.text.render(this.sprite)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.TextActor=f}),require.register("actor/TilesetSwapper.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TilesetSwapper=void 0;var i=e("./PointActor"),o=e("../effects/ScreenFire"),a=e("../BackdropPalette");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(f,i.PointActor);var e,r,n,l=u(f);function f(t,e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(r=l.call(this,t,e)).args.hidden=!0;new Image("../Sonic/tiles/azure-lake/azure-lake-burnt.png");var n=a.BackdropPalette[r.args.backdrop];return r.args.backdrop=new n,r}return e=f,(r=[{key:"activate",value:function(t,e){var r=this;this.activated||(this.activated=!0,this.viewport.onFrameOut(15,function(){r.viewport.args.screenEffects.push(new o.ScreenFire),r.viewport.onFrameOut(45,function(){r.viewport.tileMap.replacements.set("/map/../Sonic/tiles/azure-lake/azure-lake.png","/map/../Sonic/tiles/azure-lake/azure-lake-burnt.png"),r.viewport.args.backdrop=r.args.backdrop,r.viewport.tileMap.replacements.set("/map/../Sonic/tiles/azure-lake/azure-lake-shapes.png","/map/../Sonic/tiles/azure-lake/azure-lake-burnt-shapes.png"),r.viewport.tileMap.replacements.set("/map/../Sonic/tiles/azure-lake/rolling.png","/map/../Sonic/tiles/azure-lake/rolling-burnt.png"),r.viewport.tileMap.replacements.set("/map/../Sonic/tiles/azure-lake/giant-loop.png","/map/../Sonic/tiles/azure-lake/giant-loop-burnt.png")})}))}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.TilesetSwapper=f}),require.register("actor/Torch.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Torch=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.width=16,t.args.height=32,t.args.type="actor-item actor-torch",t.args.float=-1,t}return e=u,(r=[{key:"solid",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.Torch=u}),require.register("actor/Tornado.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Tornado=void 0;var i=e("./Vehicle"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.Vehicle);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-tornado",t.args.width=96,t.args.height=48,t.removeTimer=null,t.args.xSpeedMaxThrusting=64,t.args.xSpeedMaxOriginal=32,t.args.xSpeedMax=t.args.xSpeedMaxOriginal,t.args.gSpeedMax=5,t.args.decel=.15,t.args.accel=.5,t.args.seatHeight=14,t.args.seatForward=-32,t.args.skidTraction=.95,t.dustCount=0,t.args.flyAngle=-.25,t.args.particleScale=2,t.args.float=-1,t.args.thrusting=!1,t.args.landingGear=!0,t.args.jumpForce=8,t.args.fuelLevel=100,t.args.thrusterFill=0,t.args.noThrust=0,t.plane=new o.Tag('<div class = "plane">'),t.fuselage=new o.Tag('<div class = "fuselage">'),t.propeller=new o.Tag('<div class = "propeller">'),t.thruster=new o.Tag('<div class = "thruster">'),t.fuelMeter=new o.Tag('<div class = "fuel-meter">'),t.frontGear=new o.Tag('<div class = "front-landing-gear">'),t.rearGear=new o.Tag('<div class = "rear-landing-gear">'),t}return e=h,(r=[{key:"onAttached",value:function(){var t=this;this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.sprite.appendChild(this.plane.node),this.thruster.appendChild(this.fuelMeter.node),this.plane.appendChild(this.thruster.node),this.plane.appendChild(this.propeller.node),this.plane.appendChild(this.frontGear.node),this.plane.appendChild(this.rearGear.node),this.plane.appendChild(this.fuselage.node),this.args.bindTo("landingGear",function(e){t.plane&&t.plane.setAttribute("data-landing-gear",e)}),this.args.bindTo("thrusting",function(e){t.plane&&t.plane.setAttribute("data-thrusting",e)})}},{key:"update",value:function(){if(this.occupant&&this.args.falling||(this.args.flyAngle=this.args.falling?.26:-.26,this.args.flying=!1,this.args.float=0),!this.args.thrusting&&Math.abs(this.args.xSpeed)<8?(this.args.float=0,this.args.flying=!1):this.args.falling&&(this.args.float=-1,this.args.flying=!0),!this.args.jumping&&0===this.args.xSpeed&&this.args.falling)return this.args.flying=!1,this.args.float=0,this.args.thrusting&&(this.args.crashed=!0,this.args.thrusting=!1,this.args.noThrust=Date.now()+500),void s(l(h.prototype),"update",this).call(this);var t=this.args.xSpeedMaxThrusting;if(this.args.thrusting&&this.args.fuelLevel<=0&&(this.args.thrusting=!1,this.args.noThrust=Date.now()+500,this.args.thrusterFill=Date.now()+500),this.args.thrusting?(this.args.xSpeedMax=this.args.xSpeedMaxThrusting,this.args.fuelLevel>0&&(this.args.fuelLevel-=.1)):(this.args.xSpeedMax=this.args.xSpeedMaxOriginal,this.args.thrusterFill<Date.now()&&this.args.fuelLevel<100&&(this.args.fuelLevel+=.25)),this.fuelMeter.style({"--fuelLevel":this.args.fuelLevel/100}),!this.args.thrusting&&Math.abs(this.args.xSpeed)>t&&(this.args.xSpeed-=.2*Math.sign(this.args.xSpeed)),this.args.thrusting&&(Math.sign(this.args.xSpeed)!==this.args.direction||Math.abs(this.args.xSpeed)<t)&&(this.args.falling||0!==this.args.xSpeed||(this.args.flyAngle=-.26,this.args.falling=!0,this.args.flying=!0,this.args.ySpeed=-5),this.args.xSpeed+=4*Math.sign(this.args.direction)),Math.abs(this.args.xSpeed)>this.args.xSpeedMax/2&&!this.args.thrusting&&!this.xAxis&&(this.args.xSpeed*=.95),Math.abs(this.args.xSpeed)>t&&(this.args.xSpeed=t*Math.sign(this.args.direction)),this.args.flying){if(0===this.args.ySpeed&&(this.args.flyAngle=0),this.args.landingGear?!this.args.thrusting&&this.args.flyAngle<Math.PI/4?this.args.flyAngle+=.005:this.args.thrusting&&this.args.flyAngle>-Math.PI/4&&(this.args.flyAngle-=.005):Math.abs(this.args.flyAngle)>.00125?this.args.flyAngle-=.00125*Math.sign(this.args.flyAngle):this.args.flyAngle=0,!this.args.xSpeed)return void(this.args.flying=!1);var e=this.args.flyAngle+.035*Math.sign(this.yAxis);if(this.args.flyAngle>0?this.args.xSpeed*=1.025:this.args.flyAngle>0&&(this.args.xSpeed/=1.025),this.yAxis&&Math.abs(e)<Math.PI/2&&(this.args.flyAngle=e),Math.sign(this.args.xSpeed)===this.args.direction){var r=this.args.xSpeed||this.args.gSpeed;this.args.ySpeed=Math.sin(this.args.flyAngle)*r*(this.args.direction||Math.sign(r))*2}}else!this.args.thrusting&&this.args.flyAngle<Math.PI/2&&this.args.ySpeed>0&&(this.args.flyAngle+=.025);this.args.flying&&(this.args.airAngle=this.args.flyAngle,this.args.jumping=!1),this.args.falling||(this.args.landingGear=!0,this.args.flyAngle=-.26),s(l(h.prototype),"update",this).call(this),this.args.flying&&(this.args.cameraMode="airplane")}},{key:"command_1",value:function(){this.args.falling&&(this.args.landingGear=!this.args.landingGear)}},{key:"hold_2",value:function(){!this.args.thrusting&&this.args.fuelLevel<=1||this.args.fuelLevel<=0||(this.args.crashed||this.args.noThrust>Date.now()?this.args.false=!0:this.args.thrusting=!0)}},{key:"release_2",value:function(){this.args.thrusting=!1,this.args.crashed=!1}},{key:"solid",get:function(){return!this.occupant}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.Tornado=f}),require.register("actor/UnbreakableCrate.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.UnbreakableCrate=void 0;e("./PointActor");var i=e("./Block");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.Block);var e,r,n,l=c(f);function f(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(r=l.call(this,t,e)).args.type="actor-item actor-unbreakable-crate",r.args.width=64,r.args.height=64,r.args.static=!1,r}return e=f,(r=[{key:"update",value:function(){this.viewport&&this.args.gate&&(this.viewport.actorsById[this.args.gate].args.hitPoints||this.viewport.actors.remove(this));a(u(f.prototype),"update",this).call(this)}},{key:"collideA",value:function(t,e){return!0}},{key:"damage",value:function(t,e){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.UnbreakableCrate=l}),require.register("actor/Vehicle.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Vehicle=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),l.apply(this,arguments)}return e=f,(r=[{key:"update",value:function(){this.occupant&&(this.running=this.occupant.running,this.crawling=this.occupant.crawling),a(u(f.prototype),"update",this).call(this)}},{key:"collideA",value:function(t,e){if(t.noClip)return!1;if(t.controllable){if(t.args.falling&&this.y+-t.y+24<=this.args.seatHeight)return!1;if(t.args.ySpeed>0&&!this.occupant){var r=this.args.seatHeight||0;return t.args.ySpeed=0,t.args.y=this.y+-r+1,t.args.x=this.x,t.args.standingOn=this,!0}return!1}return!(t.y>=this.y)&&(t.args.float||(t.args.ySpeed=-t.args.ySpeed,t.args.xSpeed=t.args.xSpeed||5*t.args.direction,t.args.ySpeed>-5&&(t.args.ySpeed=-5)),!1)}},{key:"standBelow",value:function(t){t.controllable||(t.args.ySpeed=-t.args.ySpeed,t.args.xSpeed=t.args.xSpeed||5*t.args.direction,t.args.ySpeed>-5&&(t.args.ySpeed=-5))}},{key:"isVehicle",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.Vehicle=l}),require.register("actor/Voltorb.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Voltorb=void 0;var i=e("../actor/GohlaBall");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.GohlaBall);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-gohla-ball actor-voltorb",t}return e=f,(r=[{key:"update",value:function(){if(a(u(f.prototype),"update",this).call(this),this.viewport&&this.viewport.controlActor){var t=this.viewport.controlActor;this.direction=Math.sign(this.x-t.x),this.args.facing=this.direction<0?"left":"right",Math.abs(t.y-this.y)<=16&&Math.abs(t.x-this.x)<34?(this.args.animation="sparking",t.damage(this,"electric")):t.args.dead||t.args.mercy||(this.args.animation="standing")}}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.Voltorb=l}),require.register("actor/WaterController.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WaterController=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(r=l.call(this,t,e)).args.activated=!1,r.args.levelLimit=r.args.levelLimit||0,r.args.levelSpeed=r.args.levelSpeed||1,r.args.level=r.args.level||0,r.args.static=!0,r.args.hidden=!0,r}return e=f,(r=[{key:"updateStart",value:function(){a(u(f.prototype),"updateStart",this).call(this),this.args.switch&&!this.switch&&(this.switch=this.viewport.actorsById[this.args.switch]),this.switch&&this.switch.args.active>0&&this.activate(this.switch.activator,this.switch)}},{key:"update",value:function(){if(this.args.level<this.args._levelLimit&&(this.args.level+=this.args.levelSpeed||0),this.args.level>this.args._levelLimit){this.args.levelSpeed=0,this.args.level=this.args._levelLimit;var t=this.viewport.actorsById[this.args.target];this.viewport.auras.delete(t),this.viewport.auras.delete(this)}}},{key:"activate",value:function(t,e){if(!this.args.activated&&(this.args._levelLimit=this.args.levelLimit||4096,this.viewport.auras.add(this),this.args.activated=!0,this.args.target&&this.viewport.actorsById[this.args.target])){var r=this.viewport.actorsById[this.args.target];this.viewport.auras.add(r),r.activate(t,this)}}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.WaterController=l}),require.register("actor/WaterFall.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WaterFall=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(h,i.PointActor);var e,r,n,f=s(h);function h(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=f.call.apply(f,[this].concat(o)),e=c(t),n=-1,(r="float")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.width=t.args.width||32,t.args.height=t.args.height||64,t.args.type="actor-item actor-water-fall",t.args.active=!1,t.args.static=!0,t}return e=h,n=[{key:"fromDef",value:function(t){var e=u(l(h),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.height=t.height,e.args.toHeight=t.toHeight||0,e.args.x=t.x+32,e.args.yOriginal=t.y,e}}],(r=[{key:"onRendered",value:function(){var t=this;u(l(h.prototype),"onRendered",this).call(this),this.autoAttr.get(this.box)["data-upward"]="upward",this.viewport&&this.args.switch&&(this.switch=this.viewport.actorsById[this.args.switch],this.switch&&this.switch.args.bindTo("active",function(e){e&&e>0&&!t.args.active&&(t.args.active=!0,t.onNextFrame(function(){t.args.toHeight=t.args.openHeight,t.args.y-=t.args.openOffset}))}))}},{key:"update",value:function(){if(u(l(h.prototype),"update",this).call(this),this.args.toHeight!==this.args.height){var t=this.args.toHeight-this.args.height,e=32*Math.sign(t);t<=e?(this.args.height=this.args.toHeight,this.args.y=this.args.yOriginal+this.args.toHeight):(this.args.height+=e,this.args.y+=e)}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.WaterFall=f}),require.register("actor/WaterJet.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WaterJet=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(h,i.PointActor);var e,r,n,f=s(h);function h(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=f.call.apply(f,[this].concat(o)),e=c(t),n=-1,(r="float")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.width=t.args.width||32,t.args.height=t.args.height||64,t.args.type="actor-item actor-water-jet",t}return e=h,n=[{key:"fromDef",value:function(t){var e=u(l(h),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.height=t.height,e.args.x=t.x+t.width/2,e}}],(r=[{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}},{key:"isGhost",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.WaterJet=f}),require.register("actor/WindStone.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WindStone=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(l,i.PointActor);var e,r,n,u=s(l);function l(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=u.call.apply(u,[this].concat(r))).args.width=8,t.args.height=24,t.args.type="actor-item actor-wind-stone",t.bindTo("carriedBy",function(e){if(t.cX&&(t.cX(),t.cX=null),t.cY&&(t.cY(),t.cY=null),e)t.cX=e.args.bindTo("x",function(r){return t.args.x=r+8*e.args.direction}),t.cY=e.args.bindTo("y",function(e){return t.args.y=e+-16}),e.carrying.add(c(t)),t.args.float=-1;else if(t.carriedBy){var r=t.carriedBy;t.carriedBy=null,t.args.xSpeed=r.args.xSpeed,t.args.ySpeed=r.args.ySpeed,t.args.xSpeed+=4*Math.sign(r.args.gSpeed||r.args.xSpeed),t.args.ySpeed-=4,r.carrying.delete(c(t)),t.args.falling=!0,t.args.float=0}}),t}return e=l,(r=[{key:"lift",value:function(t){this.carriedBy!==t?this.carriedBy=t:this.carriedBy=null}},{key:"solid",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),l}();t.WindStone=l}),require.register("actor/Window.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Window=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(l,i.PointActor);var e,r,n,u=s(l);function l(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=u.call.apply(u,[this].concat(o)),e=c(t),n=-1,(r="float")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="actor-item actor-window",t.args.width=64,t.args.height=160,t}return e=l,(r=[{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),l}();t.Window=l}),require.register("actor/WoodenCrate.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WoodenCrate=void 0;var i=e("./BreakableBlock"),o=e("./Projectile");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.BreakableBlock);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-breakable-block actor-wooden-crate",t.args.width=60,t.args.height=60,t.args.static=!1,t}return e=h,(r=[{key:"collideA",value:function(t,e){return!(0!==e||!t.controllable)||(t instanceof o.Projectile&&!this.broken?(this.break(t),!0):t.spindashCharge?(this.break(t),!0):-1!==e||t.args.gSpeed||t.args.falling||!t.controllable?1!==e&&3!==e||t.y<=this.y-this.args.height||(t.args.rolling||2===e?(this.break(t),!1):t.punching&&!this.broken?(this.break(t),!1):!!this.viewport&&(-1!==e&&!t.args.rolling||s(l(h.prototype),"collideA",this).call(this,t,e))):(this.break(t),!1))}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.WoodenCrate=f}),require.register("actor/Zipline.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Zipline=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.width=1,t.args.height=1,t.args.type="actor-item actor-zipline",t.args.z=128,t.args.static=!1,t.breakable=!1,t.args.decel=0,t.args.accel=0,t}return e=f,(r=[{key:"activate",value:function(){this.viewport.auras.add(this),this.args.launched=!0}},{key:"update",value:function(){if(this.args.launched){this.args.gSpeed<1&&(this.args.gSpeed=1),this.args.gSpeed+=.1;this.args.gSpeed>1/0&&(this.args.gSpeed=1/0)}a(u(f.prototype),"update",this).call(this)}},{key:"collideA",value:function(t,e){return!this.breakable||a(u(f.prototype),"collideA",this).call(this,t,e)}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.Zipline=l}),require.register("actor/monitor/RingMonitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RingMonitor=void 0;var i=e("../Monitor"),o=e("../../audio/Sfx");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.Monitor);var e,r,n,f=u(h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),f.apply(this,arguments)}return e=h,(r=[{key:"onRendered",value:function(t){s(l(h.prototype),"onRendered",this).call(this,t),this.box.attr({"data-monitor":"ring"})}},{key:"effect",value:function(t){t.args.rings+=10,o.Sfx.play("RING_COLLECTED")}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.RingMonitor=f}),require.register("actor/monitor/SheildElectricMonitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SheildElectricMonitor=void 0;var i=e("../Monitor"),o=e("../../powerups/ElectricSheild");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.Monitor);var e,r,n,f=u(h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),f.apply(this,arguments)}return e=h,(r=[{key:"onRendered",value:function(t){s(l(h.prototype),"onRendered",this).call(this,t),this.box&&this.box.attr({"data-monitor":"sheild-electric"})}},{key:"effect",value:function(t){if(t.controllable){var e=new o.ElectricSheild;t.inventory.add(e)}}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.SheildElectricMonitor=f}),require.register("actor/monitor/SheildFireMonitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SheildFireMonitor=void 0;var i=e("../Monitor"),o=e("../../powerups/FireSheild");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.Monitor);var e,r,n,f=u(h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),f.apply(this,arguments)}return e=h,(r=[{key:"onRendered",value:function(t){s(l(h.prototype),"onRendered",this).call(this,t),this.box.attr({"data-monitor":"sheild-fire"})}},{key:"effect",value:function(t){if(t.controllable){var e=new o.FireSheild;t.inventory.add(e)}}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.SheildFireMonitor=f}),require.register("actor/monitor/SheildNormalMonitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SheildNormalMonitor=void 0;var i=e("../Monitor"),o=e("../../powerups/NormalSheild");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.Monitor);var e,r,n,f=u(h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),f.apply(this,arguments)}return e=h,(r=[{key:"onRendered",value:function(t){s(l(h.prototype),"onRendered",this).call(this,t),this.box&&this.box.attr({"data-monitor":"sheild-normal"})}},{key:"effect",value:function(t){if(t.controllable){var e=new o.NormalSheild;t.inventory.add(e)}}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.SheildNormalMonitor=f}),require.register("actor/monitor/SheildStarMonitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SheildStarMonitor=void 0;var i=e("../Monitor"),o=e("../../powerups/StarSheild");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.Monitor);var e,r,n,f=u(h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),f.apply(this,arguments)}return e=h,(r=[{key:"onRendered",value:function(t){s(l(h.prototype),"onRendered",this).call(this,t),this.box.attr({"data-monitor":"sheild-star"})}},{key:"effect",value:function(t){if(t.controllable){var e=new o.StarSheild;t.inventory.add(e)}}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.SheildStarMonitor=f}),require.register("actor/monitor/SheildWaterMonitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SheildWaterMonitor=void 0;var i=e("../Monitor"),o=e("../../powerups/BubbleSheild");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.Monitor);var e,r,n,f=u(h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),f.apply(this,arguments)}return e=h,(r=[{key:"onRendered",value:function(t){s(l(h.prototype),"onRendered",this).call(this,t),this.box.attr({"data-monitor":"sheild-water"})}},{key:"effect",value:function(t){if(t.controllable){var e=new o.BubbleSheild;t.inventory.add(e)}}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.SheildWaterMonitor=f}),require.register("actor/monitor/WebMonitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WebMonitor=void 0;var i=e("../HtmlFrame"),o=e("../Monitor");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,o.Monitor);var e,r,n,f=u(h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),f.apply(this,arguments)}return e=h,(r=[{key:"onRendered",value:function(t){s(l(h.prototype),"onRendered",this).call(this,t),this.box.attr({"data-monitor":"web-monitor"})}},{key:"effect",value:function(t){var e=new i.HtmlFrame({x:this.x,y:this.y,width:240,height:180});this.viewport.spawn.add({object:e})}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.WebMonitor=f}),require.register("audio/AudioManager.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.AudioManager=void 0;var i=e("curvature/net/Elicit"),o=e("curvature/base/Mixin"),a=e("curvature/mixin/EventTargetMixin");function s(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||u(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=u(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function u(t,e){if(t){if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=d(t);if(e){var o=d(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return g(t)}(this,r)}}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(l,o.Mixin["with"](a.EventTargetMixin));var e,r,n,u=p(l);function l(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return y(g(t=u.call.apply(u,[this].concat(r))),"volume",1),y(g(t),"theme","/Sonic/carnival-night-zone-act-2-beta.mp3"),y(g(t),"overlay","/audio/leslie-wai/feel-the-sunshine.mp3"),y(g(t),"tracks",new Map),y(g(t),"plays",new Map),y(g(t),"tags",new Map),y(g(t),"factors",new Map),y(g(t),"stack",[]),y(g(t),"playing",null),y(g(t),"id3",new Map),y(g(t),"request",[]),t}return e=l,(r=[{key:"setVolume",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.volume=t,this.playing&&(this.playing.volume=t)}},{key:"register",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.maxConcurrent,a=void 0===o?1:o,u=n.volume,l=void 0===u?1:u,f=n.fudgeFactor,h=void 0===f?0:f,p=n.startTime,g=void 0===p?0:p,d=Array(a).fill().map(function(t){return new Audio(e)});this.tracks.set(t,d);var y,b=c(d);try{for(b.s();!(y=b.n()).done;){var v=y.value;this.factors.set(v,{volume:l,fudgeFactor:h,startTime:g})}}catch(t){b.e(t)}finally{b.f()}var m=new i.Elicit(e);"mp3"===e.substr(-3)&&this.request.push(m.buffer().then(function(t){var e=new Uint8Array(t);if("ID3"===String.fromCharCode.apply(String,s(e.slice(0,3)))){e[3],e[4],e[5];for(var n=e[6]<<21|e[7]<<14|e[8]<<7|e[9],i=10,o={};i<n;){var a=String.fromCharCode.apply(String,s(e.slice(i,i+4))),u=10+(e[i+4]<<21|e[i+5]<<14|e[i+6]<<7|e[i+7]);if(10===u)break;if(i+u>n)break;var l=String.fromCharCode.apply(String,s(e.slice(i+11,i+u)));if(!a)break;if(i+=u,!a)break;o[a]=l}var f,h=c(d);try{for(h.s();!(f=h.n()).done;){var p=f.value;r.id3.set(p,o)}}catch(t){h.e(t)}finally{h.f()}}}))}},{key:"play",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.playing||(this.playing=this.stack[this.stack.length-1]),this.tracks.has(t)){var n,i=new Map,o=null,a=c(this.tracks.get(t));try{for(a.s();!(n=a.n()).done;){var u=n.value;if(!this.plays.has(u)){o=u;break}i.set(u,this.plays.get(u))}}catch(t){a.e(t)}finally{a.f()}if(!o)o=s(i).sort(function(t,e){return Math.sign(t[1]-e[1])})[0][0];if(o){var l=this.factors.get(o),f=l.volume,h=l.fudgeFactor,p=l.startTime;o.playbackRate=1,o.currentTime=p,o.volume=Math.max(0,Math.min(1,this.volume*(f+h*(Math.random()+-.5)))),o.loop=r,this.plays.set(o,Date.now()),this.playing=o,this.stack.push(this.playing);r||this.playing.addEventListener("ended",function(t){e.stack.pop(),e.playing=e.stack[e.stack.length-1],e.play()},{once:!0}),this.tags.set(o,t);var g=new CustomEvent("play",{cancelable:!0});if(this.dispatchEvent(g))try{o.play()}catch(t){console.warn(t)}Promise.all(this.request).then(function(){})}}}},{key:"stop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===t&&this.playing&&(this.playing.pause(),this.playing=null);for(var e=0,r=Object.keys(this.stack);e<r.length;e++){var n=r[e],i=this.stack[n];if(this.tags.has(i)){if(null===t||this.tags.get(i)===t){var o=this.id3.get(this.playing),a=new CustomEvent("stop",{detail:o,cancelable:!0});this.dispatchEvent(a)&&(i.paused||i.pause(),this.stack.splice(n,1))}}else this.stack.splice(n,1)}this.playing=this.stack[this.stack.length-1],this.playing&&this.play(this.tags.get(this.playing))}},{key:"pause",value:function(){if(this.playing&&!this.playing.paused){var t=this.id3.get(this.playing),e=new CustomEvent("pause",{detail:t,cancelable:!0});this.dispatchEvent(e)&&this.playing.pause()}}},{key:"unpause",value:function(){if(this.playing&&this.playing.paused){var t=this.id3.get(this.playing),e=new CustomEvent("unpause",{detail:t,cancelable:!0});this.dispatchEvent(e)&&this.playing&&this.playing.play()}}},{key:"fadeOut",value:function(t){var e=this;return new Promise(function(r){var n,i,o,a;a=setInterval(function(){if(n=e.playing){i||(o=n.volume,i=Date.now());var s=Date.now(),c=1-Math.min(1,(s-i)/t);n.volume=c*o,c||(e.stop(e.tags.get(n)),clearInterval(a),r())}},16)})}}])&&f(e.prototype,r),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),l}();t.AudioManager=b}),require.register("audio/Bgm.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BgmHandler=t.Bgm=void 0;var i=e("curvature/net/Elicit"),o=e("curvature/base/Mixin"),a=e("curvature/mixin/EventTargetMixin");function s(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=u(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function c(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||u(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){if(t){if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=d(t);if(e){var o=d(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return g(t)}(this,r)}}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(l,o.Mixin["with"](a.EventTargetMixin));var e,r,n,u=p(l);function l(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return y(g(t=u.call.apply(u,[this].concat(r))),"volume",1),y(g(t),"theme","/Sonic/carnival-night-zone-act-2-beta.mp3"),y(g(t),"overlay","/audio/leslie-wai/feel-the-sunshine.mp3"),y(g(t),"tracks",new Map),y(g(t),"plays",new Map),y(g(t),"tags",new Map),y(g(t),"stack",[]),y(g(t),"playing",null),y(g(t),"id3",new Map),y(g(t),"request",[]),t}return e=l,(r=[{key:"setVolume",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.volume=t,this.playing&&(this.playing.volume=t)}},{key:"register",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=Array(n).fill().map(function(t){return new Audio(e)});this.tracks.set(t,o);var a=new i.Elicit(e);this.request.push(a.buffer().then(function(t){var e=new Uint8Array(t);if("ID3"===String.fromCharCode.apply(String,c(e.slice(0,3)))){e[3],e[4],e[5];for(var n=e[6]<<21|e[7]<<14|e[8]<<7|e[9],i=10,a={};i<n;){var u=String.fromCharCode.apply(String,c(e.slice(i,i+4))),l=10+(e[i+4]<<21|e[i+5]<<14|e[i+6]<<7|e[i+7]);if(10===l)break;if(i+l>n)break;var f=String.fromCharCode.apply(String,c(e.slice(i+11,i+l)));if(!u)break;if(i+=l,!u)break;a[u]=f}var h,p=s(o);try{for(p.s();!(h=p.n()).done;){var g=h.value;r.id3.set(g,a)}}catch(t){p.e(t)}finally{p.f()}}}))}},{key:"play",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.playing||(this.playing=this.stack[this.stack.length-1]),this.playing&&this.tags.get(this.playing)===t){if(this.playing.paused){var n=this.id3.get(this.playing),i=new CustomEvent("play",{detail:n,cancelable:!0});if(!this.dispatchEvent(i))return;return this.unpause()}}else this.playing&&this.playing.pause();if(this.tracks.has(t)){var o,a=new Map,u=null,l=s(this.tracks.get(t));try{for(l.s();!(o=l.n()).done;){var f=o.value;if(!this.plays.has(f)){u=f;break}a.set(this.plays.get(f),f)}}catch(t){l.e(t)}finally{l.f()}if(!u){var h=c(a).sort(function(t,e){return Math.sign(t[0]-e[0])});u=h[0][1]}if(u&&u!==this.playing){u.playbackRate=1,u.currentTime=0,u.volume=this.volume,u.loop=r,this.plays.set(u,Date.now()),this.playing=u,this.stack.push(this.playing);r||this.playing.addEventListener("ended",function(t){e.stack.pop(),e.playing=e.stack[e.stack.length-1],e.play()},{once:!0}),this.tags.set(u,t),Promise.all(this.request).then(function(){var t=e.id3.get(u),r=new CustomEvent("play",{detail:t,cancelable:!0});if(e.dispatchEvent(r))try{u.play()}catch(t){console.warn(t)}})}}}},{key:"stop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===t&&this.playing&&(this.playing.pause(),this.playing=null);for(var e=0,r=Object.keys(this.stack);e<r.length;e++){var n=r[e],i=this.stack[n];if(this.tags.has(i)){if(null===t||this.tags.get(i)===t){var o=this.id3.get(this.playing),a=new CustomEvent("stop",{detail:o,cancelable:!0});this.dispatchEvent(a)&&(i.paused||i.pause(),this.stack.splice(n,1))}}else this.stack.splice(n,1)}this.playing=this.stack[this.stack.length-1],this.playing&&this.play(this.tags.get(this.playing))}},{key:"pause",value:function(){if(this.playing&&!this.playing.paused){var t=this.id3.get(this.playing),e=new CustomEvent("pause",{detail:t,cancelable:!0});this.dispatchEvent(e)&&this.playing.pause()}}},{key:"unpause",value:function(){if(this.playing&&this.playing.paused){var t=this.id3.get(this.playing),e=new CustomEvent("unpause",{detail:t,cancelable:!0});this.dispatchEvent(e)&&this.playing&&this.playing.play()}}},{key:"fadeOut",value:function(t){var e=this;return new Promise(function(r){var n,i,o,a;n=e.playing;a=setInterval(function(){if(n){i||(o=n.volume,i=Date.now());var s=Date.now(),c=1-Math.min(1,(s-i)/t);n.volume=c*o,c||(e.stop(e.tags.get(n)),clearInterval(a),r())}},16)})}}])&&f(e.prototype,r),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),l}();t.BgmHandler=b;var v=new b;t.Bgm=v}),require.register("audio/Sfx.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sfx=void 0;var n=new(e("./AudioManager").AudioManager);t.Sfx=n}),require.register("backdrop/Backdrop.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Backdrop=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.View);var e,r,n,u=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return l(c(t=u.call.apply(u,[this].concat(r))),"template",'<div class = "backdrop [[name]]">\n\t\t<div cv-ref = "backdrop" class = "parallax"></div>\n\t</div>'),l(c(t),"layers",[]),l(c(t),"urls",[]),l(c(t),"stacked",0),t}return e=f,(r=[{key:"onAttached",value:function(t){var e=this;if(!this.alreadyAttached){this.alreadyAttached=!0;var r=this.tags.backdrop,n=this.args.strips.reverse(),i=[],o=[],a=[],s=0;for(var c in n){var u=n[c];i.push("calc(100% - calc(1px * ".concat(s,"))"));var f="0px";u.parallax&&(f="calc(".concat(f," + calc(1px * calc(").concat(u.parallax," * var(--xPan))))")),u.autoscroll&&(f="calc(".concat(f," + calc(1px * calc(").concat(u.autoscroll," * var(--frame) )) )")),o.push(f),a.push(n[c].url),s+=n[c].height-1}this.urls=a,this.stacked=s;var h=o.join(", "),p=i.join(", "),g=this.urls.map(function(t){return"url(".concat(t,")")}).join(", ");r.style({"background-position-y":p,"background-position-x":h,"background-repeat":"repeat-x","background-image":g}),this.args.bindTo(["x","y","xPan","yPan","bX","bY","width","height","right","xMax","yMax","frame","stacked","top","bottom"],function(t,e){return r.style(l({},"--".concat(e),t))}),this.args.bindTo("frame",function(t,r){for(var n in e.args.strips){var i=e.args.strips[n];i.frames&&0==i.timeout--&&(i.timeout=i.interval,i.frame++,i.frame>=i.frames.length&&(i.frame=0),e.urls[n]=i.frames[i.frame],e.refreshLayers())}})}}},{key:"refreshLayers",value:function(){this.tags.backdrop.style({"background-image":this.urls.map(function(t){return"url(".concat(t,")")}).join(", ")})}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.Backdrop=f}),require.register("backdrop/Industrial.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Industrial=void 0;var i=e("./Backdrop");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Backdrop);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.name="industrial",r.args.sunrise=0,r.args.bindTo("sunrise",function(t){r.nodes[1]&&r.nodes[1].style.setProperty("--sunrise",t)}),r.args.strips=[{autoscroll:.4,parallax:.035,url:"/Sonic/backdrop/labrynth-industrial/0.png",height:24},{autoscroll:.35,parallax:.025,url:"/Sonic/backdrop/labrynth-industrial/1.png",height:24},{autoscroll:.25,parallax:.015,url:"/Sonic/backdrop/labrynth-industrial/0.png",height:24},{autoscroll:.125,parallax:.0125,url:"/Sonic/backdrop/labrynth-industrial/1.png",height:24},{autoscroll:.025,parallax:.012,url:"/Sonic/backdrop/labrynth-industrial/2.png",height:24},{autoscroll:.015,parallax:.011,url:"/Sonic/backdrop/labrynth-industrial/3.png",height:24},{autoscroll:0,parallax:.02,url:"/Sonic/backdrop/labrynth-industrial/4-dist.png",height:70},{autoscroll:0,parallax:.05,url:"/Sonic/backdrop/labrynth-industrial/4.png",height:0},{autoscroll:0,parallax:.05,url:"/Sonic/backdrop/labrynth-industrial/flame-0.png",height:1,interval:1,timeout:0,frame:0,frames:["/Sonic/backdrop/labrynth-industrial/flame-0a.png","/Sonic/backdrop/labrynth-industrial/flame-1.png","/Sonic/backdrop/labrynth-industrial/flame-1.png","/Sonic/backdrop/labrynth-industrial/flame-2.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-2.png","/Sonic/backdrop/labrynth-industrial/flame-2.png","/Sonic/backdrop/labrynth-industrial/flame-2.png","/Sonic/backdrop/labrynth-industrial/flame-3.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-3.png","/Sonic/backdrop/labrynth-industrial/flame-3.png","/Sonic/backdrop/labrynth-industrial/flame-4.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-4.png","/Sonic/backdrop/labrynth-industrial/flame-5.png","/Sonic/backdrop/labrynth-industrial/flame-6.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-6.png","/Sonic/backdrop/labrynth-industrial/flame-6.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png"]},{autoscroll:0,parallax:.125,url:"/Sonic/backdrop/labrynth-industrial/5-bw-small.png",height:10},{autoscroll:0,parallax:.15,url:"/Sonic/backdrop/labrynth-industrial/5-bw-small.png",height:10},{autoscroll:0,parallax:.275,url:"/Sonic/backdrop/labrynth-industrial/5-dim.png",height:50},{autoscroll:0,parallax:.275,url:"/Sonic/backdrop/labrynth-industrial/5-pink-lights.png",height:1,interval:20,timeout:0,frame:0,frames:["/Sonic/backdrop/labrynth-industrial/5-lights-0.png","/Sonic/backdrop/labrynth-industrial/5-lights-0.png","/Sonic/backdrop/labrynth-industrial/5-lights-1.png","/Sonic/backdrop/labrynth-industrial/5-lights-1.png","/Sonic/backdrop/labrynth-industrial/5-lights-2.png","/Sonic/backdrop/labrynth-industrial/5-lights-2.png"]},{autoscroll:0,parallax:.275,url:"/Sonic/backdrop/labrynth-industrial/5-signals-0.png",height:1,interval:10,timeout:0,frame:0,frames:["/Sonic/backdrop/labrynth-industrial/5-signals-0.png","/Sonic/backdrop/labrynth-industrial/5-signals-1.png","/Sonic/backdrop/labrynth-industrial/5-signals-1.png","/Sonic/backdrop/labrynth-industrial/5-signals-1.png","/Sonic/backdrop/labrynth-industrial/5-signals-1.png","/Sonic/backdrop/labrynth-industrial/5-signals-0.png","/Sonic/backdrop/labrynth-industrial/5-signals-2.png","/Sonic/backdrop/labrynth-industrial/5-signals-2.png","/Sonic/backdrop/labrynth-industrial/5-signals-2.png","/Sonic/backdrop/labrynth-industrial/5-signals-2.png"]},{autoscroll:0,parallax:.35,url:"/Sonic/backdrop/labrynth-industrial/5.png",height:40},{autoscroll:0,parallax:.35,url:"/Sonic/backdrop/labrynth-industrial/5-pink-lights.png",height:1},{autoscroll:0,parallax:.35,url:"/Sonic/backdrop/labrynth-industrial/5-signals-0.png",height:1,interval:20,timeout:0,frame:0,frames:["/Sonic/backdrop/labrynth-industrial/5-signals-0.png","/Sonic/backdrop/labrynth-industrial/5-signals-2.png","/Sonic/backdrop/labrynth-industrial/5-signals-2.png","/Sonic/backdrop/labrynth-industrial/5-signals-2.png","/Sonic/backdrop/labrynth-industrial/5-signals-2.png","/Sonic/backdrop/labrynth-industrial/5-signals-0.png","/Sonic/backdrop/labrynth-industrial/5-signals-1.png","/Sonic/backdrop/labrynth-industrial/5-signals-1.png","/Sonic/backdrop/labrynth-industrial/5-signals-1.png","/Sonic/backdrop/labrynth-industrial/5-signals-1.png"]},{autoscroll:0,parallax:.4,url:"/Sonic/backdrop/labrynth-industrial/6-half.png",height:88}],r}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.Industrial=u}),require.register("backdrop/MarbleGarden.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MarbleGarden=void 0;var i=e("./Backdrop");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Backdrop);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.name="marble-garden",r.args.strips=[{autoscroll:-1.25,parallax:.015,url:"/Sonic/backdrop/marble-garden/0.png",height:32},{autoscroll:-1,parallax:.015,url:"/Sonic/backdrop/marble-garden/1.png",height:24},{autoscroll:-.9,parallax:.015,url:"/Sonic/backdrop/marble-garden/2.png",height:8},{autoscroll:-.8,parallax:.015,url:"/Sonic/backdrop/marble-garden/3.png",height:24},{autoscroll:-.7,parallax:.015,url:"/Sonic/backdrop/marble-garden/4.png",height:8},{autoscroll:-.6,parallax:.0125,url:"/Sonic/backdrop/marble-garden/5.png",height:24},{autoscroll:-.5,parallax:.0125,url:"/Sonic/backdrop/marble-garden/6.png",height:16},{autoscroll:-.45,parallax:.0125,url:"/Sonic/backdrop/marble-garden/7.png",height:8},{autoscroll:-.45,parallax:.0125,url:"/Sonic/backdrop/marble-garden/8.png",height:16},{autoscroll:-.4,parallax:.0125,url:"/Sonic/backdrop/marble-garden/9.png",height:8},{autoscroll:-.35,parallax:.0125,url:"/Sonic/backdrop/marble-garden/10.png",height:16},{autoscroll:-.3,parallax:.01,url:"/Sonic/backdrop/marble-garden/11.png",height:8},{autoscroll:-.25,parallax:.0075,url:"/Sonic/backdrop/marble-garden/12.png",height:8},{autoscroll:-.2,parallax:.0075,url:"/Sonic/backdrop/marble-garden/13.png",height:8},{autoscroll:-.15,parallax:.01,url:"/Sonic/backdrop/marble-garden/14.png",height:8},{autoscroll:-.1,parallax:.01,url:"/Sonic/backdrop/marble-garden/15.png",height:5},{autoscroll:0,parallax:.1,url:"/Sonic/backdrop/marble-garden/16.png",height:30},{autoscroll:0,parallax:.125,url:"/Sonic/backdrop/marble-garden/17.png",height:12},{autoscroll:0,parallax:.125,url:"/Sonic/backdrop/marble-garden/18.png",height:6},{autoscroll:0,parallax:.15,url:"/Sonic/backdrop/marble-garden/19.png",height:6},{autoscroll:0,parallax:.175,url:"/Sonic/backdrop/marble-garden/20.png",height:8},{autoscroll:0,parallax:.2,url:"/Sonic/backdrop/marble-garden/21.png",height:8},{autoscroll:0,parallax:.225,url:"/Sonic/backdrop/marble-garden/22.png",height:24},{autoscroll:0,parallax:.25,url:"/Sonic/backdrop/marble-garden/23.png",height:344}],r}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.MarbleGarden=u}),require.register("backdrop/Moon.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Moon=void 0;var i=e("./Backdrop");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Backdrop);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.name="moon",r.args.strips=[{autoscroll:0,parallax:.0019,url:"/Sonic/backdrop/doomsday/backdrop-inverted-0-0a.png",height:13},{autoscroll:0,parallax:.0016,url:"/Sonic/backdrop/doomsday/backdrop-inverted-0-0b.png",height:13},{autoscroll:0,parallax:.0015,url:"/Sonic/backdrop/doomsday/backdrop-inverted-0-1.png",height:12},{autoscroll:0,parallax:.0013,url:"/Sonic/backdrop/doomsday/backdrop-inverted-0-2.png",height:12},{autoscroll:0,parallax:.001,url:"/Sonic/backdrop/doomsday/backdrop-inverted-0-3.png",height:8},{autoscroll:0,parallax:9e-4,url:"/Sonic/backdrop/doomsday/backdrop-inverted-0-4.png",height:5},{autoscroll:0,parallax:7e-4,url:"/Sonic/backdrop/doomsday/backdrop-inverted-0-5.png",height:14},{autoscroll:0,parallax:5e-4,url:"/Sonic/backdrop/doomsday/backdrop-inverted-0-6.png",height:140},{autoscroll:0,parallax:.015,url:"/mmpr/moon/terrain-00-00.png",height:0},{autoscroll:0,parallax:.035,url:"/mmpr/moon/terrain-00-01.png",height:2},{autoscroll:0,parallax:.045,url:"/mmpr/moon/terrain-00-02.png",height:3},{autoscroll:0,parallax:.055,url:"/mmpr/moon/terrain-00-03.png",height:4},{autoscroll:0,parallax:.065,url:"/mmpr/moon/terrain-00-04.png",height:4},{autoscroll:0,parallax:.075,url:"/mmpr/moon/terrain-00-05.png",height:10},{autoscroll:0,parallax:.085,url:"/mmpr/moon/terrain-00-06.png",height:5},{autoscroll:0,parallax:.095,url:"/mmpr/moon/terrain-00-07-b.png",height:10},{autoscroll:0,parallax:.1,url:"/mmpr/moon/terrain-00-08.png",height:10},{autoscroll:0,parallax:.105,url:"/mmpr/moon/terrain-00-09.png",height:12},{autoscroll:0,parallax:.115,url:"/mmpr/moon/terrain-00-10-b.png",height:12},{autoscroll:0,parallax:.125,url:"/mmpr/moon/terrain-00-11.png",height:5},{autoscroll:0,parallax:.1325,url:"/mmpr/moon/terrain-00-09-b.png",height:12},{autoscroll:0,parallax:.1435,url:"/mmpr/moon/terrain-00-12.png",height:22}],r}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.Moon=u}),require.register("backdrop/MysticCave.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MysticCave=void 0;var i=e("./Backdrop");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Backdrop);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.name="mystic-cave",r.args.strips=[{autoscroll:0,parallax:.11,url:"/Sonic/backdrop/mystic-cave/1.png",height:37},{autoscroll:0,parallax:.12,url:"/Sonic/backdrop/mystic-cave/2.png",height:23},{autoscroll:0,parallax:.13,url:"/Sonic/backdrop/mystic-cave/3.png",height:18},{autoscroll:0,parallax:.14,url:"/Sonic/backdrop/mystic-cave/4.png",height:7},{autoscroll:0,parallax:.15,url:"/Sonic/backdrop/mystic-cave/5.png",height:6},{autoscroll:0,parallax:.16,url:"/Sonic/backdrop/mystic-cave/6.png",height:1},{autoscroll:0,parallax:.18,url:"/Sonic/backdrop/mystic-cave/7.png",height:1},{autoscroll:0,parallax:.2,url:"/Sonic/backdrop/mystic-cave/8.png",height:1},{autoscroll:0,parallax:.22,url:"/Sonic/backdrop/mystic-cave/9.png",height:1},{autoscroll:0,parallax:.21,url:"/Sonic/backdrop/mystic-cave/10.png",height:1},{autoscroll:0,parallax:.2,url:"/Sonic/backdrop/mystic-cave/11.png",height:48},{autoscroll:0,parallax:.19,url:"/Sonic/backdrop/mystic-cave/12.png",height:13},{autoscroll:0,parallax:.18,url:"/Sonic/backdrop/mystic-cave/13.png",height:19},{autoscroll:0,parallax:.17,url:"/Sonic/backdrop/mystic-cave/14.png",height:34},{autoscroll:0,parallax:.16,url:"/Sonic/backdrop/mystic-cave/15.png",height:62},{autoscroll:0,parallax:.15,url:"/Sonic/backdrop/mystic-cave/16.png",height:32},{autoscroll:0,parallax:.14,url:"/Sonic/backdrop/mystic-cave/16.5.png",height:19},{autoscroll:0,parallax:.13,url:"/Sonic/backdrop/mystic-cave/17.png",height:13},{autoscroll:0,parallax:.12,url:"/Sonic/backdrop/mystic-cave/18.png",height:48},{autoscroll:0,parallax:.15,url:"/Sonic/backdrop/mystic-cave/19.png",height:1},{autoscroll:0,parallax:.175,url:"/Sonic/backdrop/mystic-cave/20.png",height:1},{autoscroll:0,parallax:.2,url:"/Sonic/backdrop/mystic-cave/21.png",height:1},{autoscroll:0,parallax:.25,url:"/Sonic/backdrop/mystic-cave/22.png",height:1},{autoscroll:0,parallax:.275,url:"/Sonic/backdrop/mystic-cave/23.png",height:1},{autoscroll:0,parallax:.325,url:"/Sonic/backdrop/mystic-cave/24.png",height:6},{autoscroll:0,parallax:.375,url:"/Sonic/backdrop/mystic-cave/25.png",height:7},{autoscroll:0,parallax:.4,url:"/Sonic/backdrop/mystic-cave/26.png",height:32},{autoscroll:0,parallax:.425,url:"/Sonic/backdrop/mystic-cave/27.png",height:18},{autoscroll:0,parallax:.45,url:"/Sonic/backdrop/mystic-cave/28.png",height:23},{autoscroll:0,parallax:.5,url:"/Sonic/backdrop/mystic-cave/29.png",height:37}],r}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.MysticCave=u}),require.register("backdrop/ProtoLabrynth.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ProtoLabrynth=void 0;var i=e("./Backdrop");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Backdrop);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.name="proto-labrynth",r.args.strips=[{autoscroll:0,parallax:.15,url:"/Sonic/backdrop/protolabrynth/0.png",height:48},{autoscroll:0,parallax:.125,url:"/Sonic/backdrop/protolabrynth/1.png",height:24},{autoscroll:0,parallax:.1,url:"/Sonic/backdrop/protolabrynth/2.png",height:8},{autoscroll:0,parallax:.075,url:"/Sonic/backdrop/protolabrynth/3.png",height:68},{autoscroll:0,parallax:.1,url:"/Sonic/backdrop/protolabrynth/4.png",height:18},{autoscroll:0,parallax:.125,url:"/Sonic/backdrop/protolabrynth/5.png",height:27},{autoscroll:0,parallax:.15,url:"/Sonic/backdrop/protolabrynth/5.png",height:27},{autoscroll:0,parallax:.175,url:"/Sonic/backdrop/protolabrynth/6.png",height:76}],r}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.ProtoLabrynth=u}),require.register("backdrop/SouthRidge.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SouthRidge=void 0;var i=e("./Backdrop");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Backdrop);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.name="south-ridge",r.args.strips=[{autoscroll:-.03,parallax:.11,url:"/Sonic/backdrop/south-ridge/clouds-10.png",height:10},{autoscroll:0,parallax:.1,url:"/Sonic/backdrop/south-ridge/ridge.png",height:10},{autoscroll:-.06,parallax:.12,url:"/Sonic/backdrop/south-ridge/clouds-9.png",height:0},{autoscroll:-.06,parallax:.12,url:"/Sonic/backdrop/south-ridge/clouds-9b.png",height:8},{autoscroll:-.065,parallax:.13,url:"/Sonic/backdrop/south-ridge/clouds-8.png",height:11},{autoscroll:0,parallax:.11,url:"/Sonic/backdrop/south-ridge/ridge-b.png",height:20},{autoscroll:-.07,parallax:.14,url:"/Sonic/backdrop/south-ridge/clouds-7.png",height:-9},{autoscroll:-.075,parallax:.15,url:"/Sonic/backdrop/south-ridge/clouds-6.png",height:9},{autoscroll:-.08,parallax:.16,url:"/Sonic/backdrop/south-ridge/clouds-5.png",height:8},{autoscroll:-.09,parallax:.18,url:"/Sonic/backdrop/south-ridge/clouds-4.png",height:16},{autoscroll:-.1,parallax:.2,url:"/Sonic/backdrop/south-ridge/clouds-3.png",height:13},{autoscroll:-.1125,parallax:.22,url:"/Sonic/backdrop/south-ridge/clouds-2.png",height:17},{autoscroll:-.15,parallax:.21,url:"/Sonic/backdrop/south-ridge/clouds-1.png",height:15},{autoscroll:-.175,parallax:.21,url:"/Sonic/backdrop/south-ridge/clouds-0.png",height:16},{autoscroll:-.15,parallax:.22,url:"/Sonic/backdrop/south-ridge/clouds-1.png",height:15},{autoscroll:-.175,parallax:.23,url:"/Sonic/backdrop/south-ridge/clouds-0.png",height:16}],r}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.SouthRidge=u}),require.register("backdrop/Underground.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Underground=void 0;var i=e("./Backdrop");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Backdrop);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.name="underground",r.args.strips=[{autoscroll:.045,parallax:.075,url:"/Sonic/backdrop/wing-fortress/sky-1b-recolor.png",height:32},{autoscroll:.043,parallax:.07,url:"/Sonic/backdrop/wing-fortress/sky-0-recolor.png",height:48},{autoscroll:.041,parallax:.065,url:"/Sonic/backdrop/wing-fortress/sky-1-recolor.png",height:32},{autoscroll:.039,parallax:.06,url:"/Sonic/backdrop/wing-fortress/sky-2-recolor.png",height:48},{autoscroll:0,parallax:.075,url:"/Sonic/backdrop/aquatic-ruin/mountains-0-recolor.png",height:0},{autoscroll:0,parallax:0,url:"/Sonic/backdrop/aquatic-ruin/mountains-1-recolor.png",height:48},{autoscroll:0,parallax:0,url:"/Sonic/backdrop/aquatic-ruin/mountains-1-recolor.png",height:48},{autoscroll:0,parallax:0,url:"/Sonic/backdrop/aquatic-ruin/mountains-1-recolor.png",height:24}],r}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.Underground=u}),require.register("backdrop/WestSide.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WestSide=void 0;var i=e("./Backdrop");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Backdrop);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.name="west-side",r.args.strips=[{autoscroll:.001,parallax:.001,url:"/Sonic/backdrop/west-side/stars.png",height:0},{autoscroll:0,parallax:5e-4,url:"/Sonic/backdrop/west-side/island-dark.png",height:0},{autoscroll:0,parallax:5e-4,url:"/Sonic/backdrop/west-side/water-shine-0.png",height:3},{autoscroll:0,parallax:5e-4,url:"/Sonic/backdrop/west-side/water-shine-1.png",height:3},{autoscroll:0,parallax:4e-4,url:"/Sonic/backdrop/west-side/water-shine-2.png",height:3},{autoscroll:0,parallax:.004,url:"/Sonic/backdrop/west-side/water.png",height:142},{autoscroll:.001,parallax:.001,url:"/Sonic/backdrop/west-side/stars-reflected.png",height:0},{autoscroll:0,parallax:5e-4,url:"/Sonic/backdrop/west-side/island-dark-reflected.png",height:0},{autoscroll:0,parallax:.03,url:"/Sonic/backdrop/launch-base/bushes-0-night.png",height:0},{autoscroll:0,parallax:.05,url:"/Sonic/backdrop/launch-base/bushes-1-night.png",height:0},{autoscroll:0,parallax:.05,url:"/Sonic/backdrop/launch-base/bushes-2-night.png",height:48}],r}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.WestSide=u}),require.register("backdrop/WestSideCloudy.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WestSideCloudy=void 0;var i=e("./Backdrop");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Backdrop);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.name="west-side-cloudy",r.args.strips=[{autoscroll:.14,parallax:.02,url:"/Sonic/backdrop/west-side/clouds-0.png",height:33},{autoscroll:.13,parallax:.014,url:"/Sonic/backdrop/west-side/clouds-1.png",height:32},{autoscroll:.12,parallax:.013,url:"/Sonic/backdrop/west-side/clouds-2.png",height:24},{autoscroll:.11,parallax:.012,url:"/Sonic/backdrop/west-side/clouds-3.png",height:16},{autoscroll:.1,parallax:.011,url:"/Sonic/backdrop/west-side/clouds-4.png",height:5},{autoscroll:.09,parallax:.01,url:"/Sonic/backdrop/west-side/clouds-5.png",height:3},{autoscroll:.08,parallax:.009,url:"/Sonic/backdrop/west-side/clouds-6.png",height:8},{autoscroll:.07,parallax:.008,url:"/Sonic/backdrop/west-side/clouds-7.png",height:5},{autoscroll:.06,parallax:.007,url:"/Sonic/backdrop/west-side/clouds-8.png",height:3},{autoscroll:.05,parallax:.006,url:"/Sonic/backdrop/west-side/clouds-9.png",height:8},{autoscroll:.04,parallax:.005,url:"/Sonic/backdrop/west-side/clouds-10.png",height:8},{autoscroll:.03,parallax:.004,url:"/Sonic/backdrop/west-side/clouds-11.png",height:32},{autoscroll:.02,parallax:.003,url:"/Sonic/backdrop/west-side/clouds-12.png",height:8},{autoscroll:.015,parallax:.002,url:"/Sonic/backdrop/west-side/clouds-13.png",height:32},{autoscroll:0,parallax:5e-4,url:"/Sonic/backdrop/west-side/water-shine-cloudy.png",height:2},{autoscroll:0,parallax:5e-4,url:"/Sonic/backdrop/west-side/island-dark-cloudy.png",height:0},{autoscroll:.015,parallax:.002,url:"/Sonic/backdrop/west-side/reflected-clouds-0.png",height:32},{autoscroll:.02,parallax:.003,url:"/Sonic/backdrop/west-side/reflected-clouds-1.png",height:8},{autoscroll:.03,parallax:.004,url:"/Sonic/backdrop/west-side/reflected-clouds-2.png",height:32},{autoscroll:.04,parallax:.005,url:"/Sonic/backdrop/west-side/reflected-clouds-3.png",height:8},{autoscroll:.05,parallax:.006,url:"/Sonic/backdrop/west-side/reflected-clouds-4.png",height:8},{autoscroll:.06,parallax:.007,url:"/Sonic/backdrop/west-side/reflected-clouds-5.png",height:3},{autoscroll:.07,parallax:.008,url:"/Sonic/backdrop/west-side/reflected-clouds-6.png",height:5},{autoscroll:.08,parallax:.009,url:"/Sonic/backdrop/west-side/reflected-clouds-7.png",height:16},{autoscroll:.09,parallax:.01,url:"/Sonic/backdrop/west-side/reflected-clouds-8.png",height:24},{autoscroll:.1,parallax:.011,url:"/Sonic/backdrop/west-side/reflected-clouds-9.png",height:20},{autoscroll:0,parallax:5e-4,url:"/Sonic/backdrop/west-side/island-dark-cloudy-reflected.png",height:0},{autoscroll:0,parallax:.004,url:"/Sonic/backdrop/west-side/water-cloudy.png",height:48}],r.args.bindTo("frame",function(t){r.args.ligtening||Math.random()>.995&&(r.args.name="west-side-cloudy lightning",r.args.lightning=!0,r.onTimeout(1e3,function(){r.args.name="west-side-cloudy",r.args.lightning=!1}))}),r}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.WestSideCloudy=u}),require.register("backdrop/WestSideNight.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WestSideNight=void 0;var i=e("./Backdrop");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Backdrop);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.name="west-side",r.args.strips=[{autoscroll:0,parallax:.001,url:"/Sonic/backdrop/west-side/stars.png",height:0},{autoscroll:0,parallax:5e-4,url:"/Sonic/backdrop/west-side/island-dark.png",height:0},{autoscroll:0,parallax:5e-4,url:"/Sonic/backdrop/west-side/water-shine-0.png",height:3},{autoscroll:0,parallax:5e-4,url:"/Sonic/backdrop/west-side/water-shine-1.png",height:3},{autoscroll:0,parallax:4e-4,url:"/Sonic/backdrop/west-side/water-shine-2.png",height:3},{autoscroll:0,parallax:.004,url:"/Sonic/backdrop/west-side/water.png",height:142},{autoscroll:0,parallax:.001,url:"/Sonic/backdrop/west-side/stars-reflected.png",height:0},{autoscroll:0,parallax:5e-4,url:"/Sonic/backdrop/west-side/island-dark-reflected.png",height:0}],r}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.WestSideNight=u}),require.register("backdrop/Wood.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Wood=void 0;var i=e("./Backdrop");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Backdrop);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.name="wood",r.args.strips=[{autoscroll:0,parallax:.1,url:"/Sonic/backdrop/wood/forest.png",height:1600}],r}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.Wood=u}),require.register("behavior/Behavior.js",function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Behavior=void 0;var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,i;return e=t,(r=[{key:"update",value:function(t){}}])&&n(e.prototype,r),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.Behavior=i}),require.register("behavior/SkidDust.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SkidDust=void 0;var i=e("curvature/base/Tag"),o=e("./Behavior");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(l,o.Behavior);var e,r,n,u=c(l);function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=u.call(this)).dustType=t||"particle-dust",e}return e=l,(r=[{key:"update",value:function(t){if(!(t.args.falling||t.args.rolling||t.spindashCharge||t.args.wallSticking||t.args.climbing)){var e=t.args.direction;if(Math.sign(t.args.gSpeed)&&Math.sign(e)&&!(Math.abs(t.args.gSpeed-e)<5)){if(!t.alwaysSkidding){if(Math.sign(t.args.gSpeed)===Math.sign(e))return;if(!t.skidding)return}var r=t.viewport,n=t.distFreq||2;if(r.args.frameId%n==0){var o=new i.Tag(document.createElement("div"));o.classList.add(this.dustType);var a=Math.sign(t.args.gSpeed)*t.dustDist||0,s=t.groundPoint;o.style({"--x":s[0]+a,"--y":s[1],"z-index":0,opacity:.25*Math.random()+.5}),r.particles.add(o),r.onFrameOut(20,function(){r.particles.remove(o)})}}}}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),l}();t.SkidDust=l}),require.register("cards/basic-controls.html",function(t,e,r){r.exports='<div class = "control-card">\n\t<span class = "button-index">\n\t\t<span class = "arrow button arrow-west"></span>\n\t\t/ <span class = "arrow button arrow-east"></span>\n\t\t/ <b>wasd</b>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-x"></span>\n\t\t<span class = "button xb xb-a"></span>\n\t\t<b>space</b>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-o"></span>\n\t\t<span class = "button xb xb-b"></span>\n\t\t<b>ctrl</b>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-s"></span>\n\t\t<span class = "button xb xb-x"></span>\n\t\t<b>shift</b>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-t"></span>\n\t\t<span class = "button xb xb-y"></span>\n\t\t<b>z</b>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-l1"></span>\n\t\t<span class = "button xb xb-lb"></span>\n\t\t<b>q</b>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-r1"></span>\n\t\t<span class = "button xb xb-rb"></span>\n\t\t<b>e</b>\n\t</span>\n</div>\n'}),require.register("cards/basic-moves.html",function(t,e,r){r.exports='<p><b>jump</b> + <b>jump</b> - fly / double jump action</p>\n\n<p><span class = "arrow-button arrow-north"></span> + <b>jump</b> - disengage vehicle</p>\n\n\x3c!-- <p><span class = "arrow-button arrow-south"></span> + <b>jump</b> - spindash</p> --\x3e\n'}),require.register("cards/plane-air-controls.html",function(t,e,r){r.exports='<div class = "control-card">\n\t<span class = "button-index">\n\t\t<span class = "arrow button arrow-west"></span>\n\t\t/ <span class = "arrow button arrow-east"></span>\n\t\t/ <b>wasd</b>\n\t\t- move\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-x"></span>\n\t\t<span class = "button xb xb-a"></span>\n\t\t<b>space</b>\n\t\t- double barrier\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-o"></span>\n\t\t<span class = "button xb xb-b"></span>\n\t\t<b>ctrl</b>\n\t\t- <span>no action</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-s"></span>\n\t\t<span class = "button xb xb-x"></span>\n\t\t<b>shift</b>\n\t\t- <span>light dash</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-t"></span>\n\t\t<span class = "button xb xb-y"></span>\n\t\t<b>z</b>\n\t\t- <span>no action</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-l1"></span>\n\t\t<span class = "button xb xb-lb"></span>\n\t\t<b>q</b>\n\t\t- <span>air dash left</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-r1"></span>\n\t\t<span class = "button xb xb-rb"></span>\n\t\t<b>e</b>\n\t\t- <span>air dash right</span>\n\t</span>\n\n</div>\n'}),require.register("cards/sonic-air-controls.html",function(t,e,r){r.exports='<div class = "control-card">\n\t<span class = "button-index">\n\t\t<span class = "arrow button arrow-west"></span>\n\t\t/ <span class = "arrow button arrow-east"></span>\n\t\t/ <b>wasd</b>\n\t\t- move\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-x"></span>\n\t\t<span class = "button xb xb-a"></span>\n\t\t<b>space</b>\n\t\t- double barrier\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-o"></span>\n\t\t<span class = "button xb xb-b"></span>\n\t\t<b>ctrl</b>\n\t\t- <span>no action</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-s"></span>\n\t\t<span class = "button xb xb-x"></span>\n\t\t<b>shift</b>\n\t\t- <span>light dash</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-t"></span>\n\t\t<span class = "button xb xb-y"></span>\n\t\t<b>z</b>\n\t\t- <span>no action</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-l1"></span>\n\t\t<span class = "button xb xb-lb"></span>\n\t\t<b>q</b>\n\t\t- <span>air dash left</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-r1"></span>\n\t\t<span class = "button xb xb-rb"></span>\n\t\t<b>e</b>\n\t\t- <span>air dash right</span>\n\t</span>\n\n</div>\n'}),require.register("cards/sonic-controls.html",function(t,e,r){r.exports='<div class = "control-card">\n\n\t<span class = "button-index">\n\t\t<span class = "arrow button arrow-west"></span>\n\t\t/ <span class = "arrow button arrow-east"></span>\n\t\t/ <b>wasd</b>\n\t\t- move\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-x"></span>\n\t\t<span class = "button xb xb-a"></span>\n\t\t<b>space</b>\n\t\t- jump\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-o"></span>\n\t\t<span class = "button xb xb-b"></span>\n\t\t<b>ctrl</b>\n\t\t- <span>spindash</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-s"></span>\n\t\t<span class = "button xb xb-x"></span>\n\t\t<b>z</b>\n\t\t- <span>no action</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-t"></span>\n\t\t<span class = "button xb xb-y"></span>\n\t\t<b>x</b>\n\t\t- <span>super</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-l1"></span>\n\t\t<span class = "button xb xb-lb"></span>\n\t\t<b>q</b>\n\t\t- <span>no action</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-r1"></span>\n\t\t<span class = "button xb xb-rb"></span>\n\t\t<b>e</b>\n\t\t- <span>no action</span>\n\t</span>\n\n</div>\n'}),require.register("console/task/Impulse.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Impulse=void 0;var i=e("subspace-console/Task");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.Task);var e,r,n,u=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return l(c(t=u.call.apply(u,[this].concat(r))),"title","Impulse task"),l(c(t),"prompt",".."),t}return e=f,(r=[{key:"init",value:function(t,e){f.viewport.controlActor&&f.viewport.controlActor.impulse(t,e,!0)}},{key:"write",value:function(t){this.print(t)}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.Impulse=f,l(f,"viewport",null),l(f,"helpText","Apply an impulse to the player object."),l(f,"useText","input magnitude angle")}),require.register("console/task/Input.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Input=void 0;var i=e("subspace-console/Task");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.Task);var e,r,n,u=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return l(c(t=u.call.apply(u,[this].concat(r))),"title","Input task"),l(c(t),"prompt",".."),t}return e=f,(r=[{key:"init",value:function(t){var e,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=function(){};if(f.viewport.controlActor){var a=f.viewport.controlActor,s=a.controller;if("a"===t[0]){var c=t.substring(1);this.print("Setting axis ".concat(c," to ").concat(i," for ").concat(n," milliseconds...")),e={axes:l({},c,i)},r=setInterval(function(){s.replay(e),a.readInput()},16),o=function(){e.axes[c]=0,s.replay(e),a.readInput(),clearInterval(r)}}if("b"===t[0]){var u=t.substring(1);this.print("Pressing button ".concat(u," for ").concat(n," milliseconds...")),e={buttons:l({},u,1)},r=setInterval(function(){e.buttons[u]=1,s.replay(e),a.readInput()},16),o=function(){e.buttons[u]=0,s.replay(e),a.readInput(),clearInterval(r)}}if(e)return s.replay(e),a.readInput(),new Promise(function(t){setTimeout(function(){o(),t()},n)})}}},{key:"write",value:function(t){this.print(t)}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.Input=f,l(f,"viewport",null),l(f,"helpText","Press a button x for y milliseconds."),l(f,"useText","input x y")}),require.register("console/task/Move.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Move=void 0;var i=e("subspace-console/Task");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.Task);var e,r,n,u=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return l(c(t=u.call.apply(u,[this].concat(r))),"prompt",".."),t}return e=f,(r=[{key:"init",value:function(t,e){if(f.viewport.controlActor){this.print("Moving character to x, y...");var r=f.viewport.controlActor;r.args.x=Number(t),r.args.y=Number(e),r.viewport&&r.viewport.setColCell(r)}}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.Move=f,l(f,"viewport",null),l(f,"helpText","Move the current actor to a position in space."),l(f,"useText","move x y")}),require.register("console/task/Pos.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Pos=void 0;var i=e("subspace-console/Task");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Task);var e,r,n,c=s(u);function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),c.apply(this,arguments)}return e=u,(r=[{key:"init",value:function(t,e){if(u.viewport.controlActor){var r=u.viewport.controlActor;this.print("Character is at ".concat(r.x,", ").concat(r.y,"."))}}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.Pos=l,u(l,"viewport",null),u(l,"helpText","Check the current actor's position in space.")}),require.register("console/task/Settings.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Settings=void 0;var i=e("subspace-console/Task");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.Task);var e,r,n,u=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return l(c(t=u.call.apply(u,[this].concat(r))),"prompt",".."),t}return e=f,(r=[{key:"init",value:function(t,e){var r=f.viewport;void 0!==e&&(r.settings[t]=JSON.parse(e)),this.print(JSON.stringify(r.settings[t]))}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.Settings=f,l(f,"viewport",null),l(f,"helpText","Get/set the values of settings variables."),l(f,"useText","set key val")}),require.register("console/task/Spawn.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Spawn=void 0;var i=e("subspace-console/Task");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Task);var e,r,n,c=s(u);function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),c.apply(this,arguments)}return e=u,(r=[{key:"init",value:function(t){if(u.viewport&&u.viewport.controlActor){var e=u.viewport.objectPalette,r=u.viewport.controlActor;if(t)if(t in e){var n=e[t];u.viewport.spawn.add({object:new n({x:r.x+128,y:r.y-128})})}else this.print('Type not found: "'.concat(t,'".'));else this.print(Object.keys(e).join(", "))}}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.Spawn=l,u(l,"viewport",null),u(l,"helpText","Spawn an object.")}),require.register("controller/Axis.js",function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Object.defineProperty(t,"__esModule",{value:!0}),t.Axis=void 0;var o=function(){function t(e){var r=e.deadZone,n=void 0===r?0:r,o=e.proportional,a=void 0===o||o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,"magnitude",0),i(this,"delta",0),n&&(this.proportional=a,this.deadZone=n)}var e,r,o;return e=t,(r=[{key:"tilt",value:function(t){t=this.deadZone&&Math.abs(t)>=this.deadZone?(Math.abs(t)-this.deadZone)/(1-this.deadZone)*Math.sign(t):0,this.delta=Number(t-this.magnitude).toFixed(3)-0,this.magnitude=Number(t).toFixed(3)-0}},{key:"zero",value:function(){this.magnitude=this.delta=0}}])&&n(e.prototype,r),o&&n(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.Axis=o}),require.register("controller/Button.js",function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Object.defineProperty(t,"__esModule",{value:!0}),t.Button=void 0;var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,"active",!1),i(this,"pressure",0),i(this,"delta",0),i(this,"time",0)}var e,r,o;return e=t,(r=[{key:"update",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.pressure?this.time++:!this.pressure&&this.time>0?this.time=-1:!this.pressure&&this.time<0&&this.time--,this.time<-1&&-1===this.delta&&(this.delta=0)}},{key:"press",value:function(t){this.delta=Number(t-this.pressure).toFixed(3)-0,this.pressure=Number(t).toFixed(3)-0,this.active=!0,this.time=this.time>0?this.time:0}},{key:"release",value:function(){this.active&&(this.delta=Number(-this.pressure).toFixed(3)-0,this.pressure=0,this.active=!1)}},{key:"zero",value:function(){this.pressure=this.delta=0,this.active=!1}}])&&n(e.prototype,r),o&&n(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.Button=o}),require.register("controller/Controller.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;var n=e("./Axis"),i=e("./Button");function o(t){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var u={Space:0,Enter:0,NumpadEnter:0,ControlLeft:1,ControlRight:1,ShiftLeft:2,ShiftRight:2,KeyZ:3,KeyQ:4,KeyE:5,Digit1:6,Digit3:7,KeyW:12,KeyA:14,KeyS:13,KeyD:15,KeyH:112,KeyJ:113,KeyK:114,KeyL:115,KeyP:9,Pause:9,Tab:11,ArrowUp:12,ArrowDown:13,ArrowLeft:14,ArrowRight:15,Numpad4:112,Numpad2:113,Numpad8:114,Numpad6:115,Backquote:1010,NumpadAdd:1011,NumpadSubtract:1012,NumpadMultiply:1013,NumpadDivide:1014,Escape:1020};s(Array(12)).map(function(t,e){return u["F".concat(e)]=2e3+e});var l={12:-1,13:1,14:-0,15:0,112:-2,113:3,114:-3,115:2},f=function(){function t(e){e.keys;var r=e.deadZone,n=void 0===r?0:r;e.gamepad,e.keyboard;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.deadZone=n,Object.defineProperties(this,{buttons:{value:{}},pressure:{value:{}},axes:{value:{}},keys:{value:{}}})}var e,r,c;return e=t,(r=[{key:"update",value:function(t){var e=t.gamepad;for(var r in this.buttons){this.buttons[r].update()}e&&this.willRumble&&("object"!==o(this.willRumble)&&(this.willRumble={duration:1e3,strongMagnitude:1,weakMagnitude:1}),e.vibrationActuator&&e.vibrationActuator.playEffect("dual-rumble",this.willRumble),this.willRumble=!1)}},{key:"rumble",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.willRumble=t}},{key:"readInput",value:function(t){var e=t.keyboard,r=t.gamepad,n={},o={};if(r)for(var a in r.buttons){var c=r.buttons[a];c.pressed&&(this.press(a,c.value),n[a]=!0)}if(e){for(var f in s(Array(10)))n[f]||e.getKeyCode(f)>0&&(this.press(f,1),n[f]=!0);for(var h in u)if(!n[h]){var p=u[h];e.getKeyCode(h)>0&&(this.press(p,1),n[p]=!0)}}if(r)for(var g in r.buttons){if(!n[g])r.buttons[g].pressed||(this.release(g),o[g]=!0)}if(e){for(var d in s(Array(10)))o[d]||n[d]||e.getKeyCode(d)<0&&(this.release(d),o[d]=!0);for(var y in u){var b=u[y];o[b]||(n[b]||e.getKeyCode(y)<0&&(this.release(b),o[y]=!0))}}var v={};if(r)for(var m in r.axes){var w=r.axes[m];v[m]=!0,this.tilt(m,w)}for(var S in l){this.buttons[S]||(this.buttons[S]=new i.Button);var O=l[S],j=Math.sign(1/O),k=Math.abs(O);this.buttons[S].active?(v[k]=!0,this.tilt(k,j)):v[k]||this.tilt(k,0)}}},{key:"tilt",value:function(t,e){this.axes[t]||(this.axes[t]=new n.Axis({deadZone:this.deadZone})),this.axes[t].tilt(e)}},{key:"press",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.buttons[t]||(this.buttons[t]=new i.Button),this.buttons[t].press(e)}},{key:"release",value:function(t){this.buttons[t]||(this.buttons[t]=new i.Button),this.buttons[t].release()}},{key:"serialize",value:function(){var t={};for(var e in this.buttons)t[e]=this.buttons[e].pressure;var r={};for(var n in this.axes)r[n]=this.axes[n].magnitude;return{axes:r,buttons:t}}},{key:"replay",value:function(t){if(t.buttons)for(var e in t.buttons)t.buttons[e]>0?this.press(e,t.buttons[e]):this.release(e);if(t.axes)for(var r in t.axes)t.axes[r].magnitude!==t.axes[r]&&this.tilt(r,t.axes[r])}},{key:"zero",value:function(){for(var t in this.axes)this.axes[t].zero();for(var e in this.buttons)this.buttons[e].zero()}}])&&a(e.prototype,r),c&&a(e,c),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.Controller=f}),require.register("debug/LineDump.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.LineDump=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(l,i.View);var e,r,n,u=s(l);function l(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=u.call.apply(u,[this].concat(o)),e=c(t),n='<div class = "line-dump" style = "--x:[[x]];--y:[[y]];--length:[[len]];--angle:[[angle]]">\n\t\t<div class = "line" style = "border-color:[[color]]"></div>\n\t</div>',(r="template")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.x=t.args.x||0,t.args.y=t.args.y||0,t}return e=l,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.LineDump=l}),require.register("debug/PointDump.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PointDump=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(l,i.View);var e,r,n,u=s(l);function l(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=u.call.apply(u,[this].concat(o)),e=c(t),n='<div class = "point-dump">\n\t\t<div class = "point" style = "--color:[[color]]">[[x]], [[y]]</div>\n\t</div>',(r="template")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.x=t.args.x||0,t.args.y=t.args.y||0,t}return e=l,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.PointDump=l}),require.register("debug/arrow-east.svg",function(t,e,r){r.exports='<svg width="497.81px" height="497.81px" enable-background="new 0 0 497.812 497.812" version="1.1" viewBox="0 0 497.81 497.81" xmlns="http://www.w3.org/2000/svg">\n\t<g transform="matrix(-1 0 0 1 497.81 0)">\n\t\t<path d="m203.66 312.91 117.03 117.03-67.906 67.875-248.91-248.91 248.91-248.91 67.906 67.875-117.06 117.06 290.28-0.031 0.031 127.97z"/>\n\t</g>\n</svg>\n'}),require.register("effects/Cylinder.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Cylinder=void 0;var i=e("curvature/base/View"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(h,i.View);var r,n,l,f=c(h);function h(t,r){var n,i,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),n=f.call(this,t,r),i=u(n),o="template",a=e("./twist.svg"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n.args.scale=n.args.scale||0,n.args.id=n.args.id||"cylinder",n.args.width=n.args.width||64,n.args.height=n.args.height||64,n}return r=h,(n=[{key:"onRendered",value:function(){var t=this,e=new o.Tag('<canvas width = "'.concat(this.args.width,'" height = "').concat(this.args.height,'">')),r=e.getContext("2d");r.imageSmoothingEnabled=!1;for(var n=r.getImageData(0,0,this.args.width,this.args.height),i=n.data,a=0;a<i.length;a+=4){var s,c,u=a/4,l=Math.floor(u/this.args.width),f=u%this.args.width-this.args.width/2,h=l-this.args.height/2;Math.sqrt(Math.pow(f,2)+Math.pow(h,2)),Math.min(this.args.width,this.args.height);c=128+4*f*(Math.abs(f/this.args.width)/2),128,0,i[a+0]=null!==(s=c)&&void 0!==s?s:128,i[a+1]=(128,128),i[a+2]=null!==0?0:128,i[a+3]=255}r.putImageData(n,0,0),e.toBlob(function(e){return t.args.blob=URL.createObjectURL(e)},"image/png")}},{key:"name",get:function(){return"".concat(this.args.id)}}])&&a(r.prototype,n),l&&a(r,l),Object.defineProperty(r,"prototype",{writable:!1}),h}();t.Cylinder=f}),require.register("effects/Droop.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Droop=void 0;var i=e("curvature/base/View"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(p,i.View);var r,n,l,h=c(p);function p(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),f(u(n=h.call(this,t,r)),"template",e("./droop.svg")),n.args.scale=n.args.scale||0,n.args.id=n.args.id||"droop",n.args.width=2*(t.width||64),n.args.height=t.height||64,n.args.intensity=1,n.args.droopWidth="102%",n}return r=p,l=[{key:"generateMap",value:function(t,e){var r="".concat(t,"::").concat(e),n=this.memoMaps;if(n.has(r))return Promise.resolve(n.get(r));var i=new o.Tag('<canvas width = "'.concat(t,'" height = "').concat(e,'">')),a=i.getContext("2d");a.imageSmoothingEnabled=!1;for(var s=a.getImageData(0,0,t,e),c=s.data,u=0;u<c.length;u+=4){var l,f,h=u/4,p=h%t/t,g=(Math.floor(h/t),-Math.PI+p*Math.PI);128,f=128+Math.round(128*(.5*Math.cos(g)+.5)),0,255,c[u+0]=(128,128),c[u+1]=null!==(l=f)&&void 0!==l?l:128,c[u+2]=null!==0?0:128,c[u+3]=(255,255)}return a.putImageData(s,0,0),new Promise(function(t){i.toBlob(function(e){var i=URL.createObjectURL(e,"image/png");n.set(r,i),t(i)})})}}],(n=[{key:"onRendered",value:function(){var t=this;this.constructor.generateMap(this.args.width,this.args.height).then(function(e){t.args.blob=e})}},{key:"name",get:function(){return"".concat(this.args.id)}}])&&a(r.prototype,n),l&&a(r,l),Object.defineProperty(r,"prototype",{writable:!1}),p}();t.Droop=h,f(h,"memoMaps",new Map)}),require.register("effects/Pinch.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Pinch=void 0;var i=e("curvature/base/View"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(h,i.View);var r,n,l,f=c(h);function h(t,r){var n,i,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),n=f.call(this,t,r),i=u(n),o="template",a=e("./twist.svg"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n.args.scale=n.args.scale||0,n.args.id=n.args.id||"pinch",n.args.width=n.args.width||64,n.args.height=n.args.height||64,n}return r=h,(n=[{key:"onRendered",value:function(){var t=this,e=new o.Tag('<canvas width = "'.concat(this.args.width,'" height = "').concat(this.args.height,'">')),r=e.getContext("2d");r.imageSmoothingEnabled=!1;for(var n=r.getImageData(0,0,this.args.width,this.args.height),i=n.data,a=0;a<i.length;a+=4){var s,c,u,l,f=void 0,h=0,p=a/4,g=Math.floor(p/this.args.width),d=p%this.args.width-this.args.width/2,y=g-this.args.height/2,b=Math.sqrt(Math.pow(d,2)+Math.pow(y,2)),v=Math.min(this.args.width,this.args.height)/2;b<v?(f=Math.pow(1-b/v,2),h=Math.pow(1-b/v,2)):(f=0,h=0),u=128+4*d*f,l=128+4*y*h,0,i[a+0]=null!==(s=u)&&void 0!==s?s:128,i[a+1]=null!==(c=l)&&void 0!==c?c:128,i[a+2]=null!==0?0:128,i[a+3]=255}r.putImageData(n,0,0),e.toBlob(function(e){return t.args.blob=URL.createObjectURL(e)},"image/png")}},{key:"name",get:function(){return"".concat(this.args.id)}}])&&a(r.prototype,n),l&&a(r,l),Object.defineProperty(r,"prototype",{writable:!1}),h}();t.Pinch=f}),require.register("effects/ScreenFire.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenFire=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.View);var r,n,u,l=s(f);function f(){var t,r,n,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return t=l.call.apply(l,[this].concat(a)),r=c(t),n="template",i=e("./screen-fire"),n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,t}return r=f,(n=[{key:"onAttach",value:function(t){var e=this;this.args.animation="playing",this.onTimeout(5e3,function(){return e.remove()})}}])&&o(r.prototype,n),u&&o(r,u),Object.defineProperty(r,"prototype",{writable:!1}),f}();t.ScreenFire=l}),require.register("effects/ScreenWarp.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenWarp=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.View);var r,n,u,l=s(f);function f(){var t,r,n,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return t=l.call.apply(l,[this].concat(a)),r=c(t),n="template",i=e("./screen-fire"),n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,t}return r=f,(n=[{key:"onAttach",value:function(t){var e=this;this.args.animation="playing",this.onTimeout(5e3,function(){return e.remove()})}}])&&o(r.prototype,n),u&&o(r,u),Object.defineProperty(r,"prototype",{writable:!1}),f}();t.ScreenWarp=l}),require.register("effects/Twist.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Twist=void 0;var i=e("curvature/base/View"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(h,i.View);var r,n,l,f=c(h);function h(t,r){var n,i,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),n=f.call(this,t,r),i=u(n),o="template",a=e("./twist.svg"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n.args.scale=n.args.scale||0,n.args.id=n.args.id||"twist",n.args.width=n.args.width||64,n.args.height=n.args.height||64,n.args.dx=0,n.args.dy=0,n}return r=h,(n=[{key:"onRendered",value:function(){var t=this,e=new o.Tag('<canvas width = "64" height = "64">'),r=e.getContext("2d");r.imageSmoothingEnabled=!1;for(var n=r.getImageData(0,0,64,64),i=n.data,a=0;a<i.length;a+=4){var s,c,u,l,f=1,h=a/4,p=h%64-31.5,g=Math.floor(h/64)-31.5-15.5,d=Math.sqrt(Math.pow(p,2)+Math.pow(g,2));u=128+4*g*(f=d>32?0:Math.pow(1-d/32,3)),l=128-4*p*f,i[a+0]=null!==(s=u)&&void 0!==s?s:0,i[a+1]=null!==(c=l)&&void 0!==c?c:0,i[a+2]=0,i[a+3]=255}r.putImageData(n,0,0),e.toBlob(function(e){return t.args.blob=URL.createObjectURL(e)},"image/png")}},{key:"name",get:function(){return"".concat(this.args.id)}}])&&a(r.prototype,n),l&&a(r,l),Object.defineProperty(r,"prototype",{writable:!1}),h}();t.Twist=f}),require.register("effects/droop.svg",function(t,e,r){r.exports='<svg\n\twidth  ="100%"\n\theight ="100%"\n>\n\t<defs>\n\n\t\t<filter\n\t\t\tcv-ref = "filter"\n\t\t\tcolor-interpolation-filters="sRGB"\n\t\t\tid = "[[id]]"\n\t\t\twidth  ="102%"\n\t\t\theight ="1204%"\n\t\t\tx  = "-1%"\n\t\t\ty  = "-2%"\n\n\t\t>\n\t\t\t<feImage\n\t\t\t\tpreserveAspectRatio = "none"\n\t\t\t\tresult  = "DisplacementSourceLeft"\n\t\t\t\tcv-attr = "width:droopWidthLeft,href:blob"\n\t\t\t/>\n\n\t\t\t<feImage\n\t\t\t\tpreserveAspectRatio = "none"\n\t\t\t\tresult  = "DisplacementSourceRightInvert"\n\t\t\t\tcv-attr = "x:droopRightStart,width:droopWidthRight,href:blob"\n\t\t\t/>\n\n\t\t\t<feColorMatrix\n\t\t\t\tin     = "DisplacementSourceRightInvert"\n\t\t\t\tresult = "DisplacementSourceRight"\n\t\t\t\ttype   = "matrix"\n\t\t\t\tvalues="\n\t\t\t\t\t1 0 0 0 0\n\t\t\t\t\t0 -1 0 0 1.5\n\t\t\t\t\t0 0 1 0 0\n\t\t\t\t\t0 0 0 1 0"\n\t\t\t/>\n\n\t\t\t<feComposite\n\t\t\t\toperator="over"\n\t\t\t\tin     = "DisplacementSourceLeft"\n\t\t\t\tin2    = "DisplacementSourceRight"\n\t\t\t\tresult = "DisplacementSource"\n\t\t\t\twidth  ="102%"\n\t\t\t/>\n\n\t\t\t<feFlood flood-color="#808000" result = "OffsetNeutral" />\n\n\t\t\t<feComposite\n\t\t\t\toperator="over"\n\t\t\t\tin     = "DisplacementSource"\n\t\t\t\tin2    = "OffsetNeutral"\n\t\t\t\tresult = "DisplacementResult"\n\t\t\t\twidth  ="102%"\n\t\t\t/>\n\n\t\t\t<feComposite\n\t\t\t\toperator="over"\n\t\t\t\tin     = "DisplacementSource"\n\t\t\t\tin2    = "OffsetNeutral"\n\t\t\t\tresult = "DisplacementResult"\n\t\t\t\twidth  ="102%"\n\t\t\t/>\n\n\t\t\t<feDisplacementMap\n\t\t\t\txChannelSelector = "R"\n\t\t\t\tyChannelSelector = "G"\n\t\t\t\tin      = "SourceGraphic"\n\t\t\t\tin2     = "DisplacementResult"\n\t\t\t\tcv-ref  = "displace"\n\t\t\t\tcv-attr = "scale:scale"\n\t\t\t\twidth  ="102%"\n\t\t\t/>\n\n\t\t</filter>\n\n\t</defs>\n</svg>\n'}),require.register("effects/screen-fire.html",function(t,e,r){r.exports='<div class = "screen-fire [[animation]]">\n\t<div class = "fire-strip" style = "--index:0"><div></div></div>\n\t<div class = "fire-strip" style = "--index:1"><div></div></div>\n\t<div class = "fire-strip" style = "--index:2"><div></div></div>\n\t<div class = "fire-strip" style = "--index:3"><div></div></div>\n\t<div class = "fire-strip" style = "--index:4"><div></div></div>\n\t<div class = "fire-strip" style = "--index:5"><div></div></div>\n\t<div class = "fire-strip" style = "--index:6"><div></div></div>\n\t<div class = "fire-strip" style = "--index:7"><div></div></div>\n\t<div class = "fire-strip" style = "--index:8"><div></div></div>\n\t<div class = "fire-strip" style = "--index:9"><div></div></div>\n\t<div class = "fire-strip" style = "--index:10"><div></div></div>\n\t<div class = "fire-strip" style = "--index:11"><div></div></div>\n\t<div class = "fire-strip" style = "--index:12"><div></div></div>\n\t<div class = "fire-strip" style = "--index:13"><div></div></div>\n\t<div class = "fire-strip" style = "--index:14"><div></div></div>\n\t<div class = "fire-strip" style = "--index:15"><div></div></div>\n\t<div class = "fire-strip" style = "--index:16"><div></div></div>\n</div>\n'}),require.register("effects/twist.svg",function(t,e,r){r.exports='<svg\n\theight ="100%"\n\twidth  ="100%"\n>\n\t<defs>\n\n\t\t<filter\n\t\t\tcv-ref = "filter"\n\t\t\tcolor-interpolation-filters="sRGB"\n\t\t\theight = "100%"\n\t\t\twidth  = "100%"\n\t\t\tid     = "[[id]]"\n\t\t\tx      = "0%"\n\t\t\ty      = "0%"\n\n\t\t>\n\t\t\t<feFlood\n\t\t\t\tflood-color="#808000"\n\t\t\t\theight = "100%"\n\t\t\t\twidth  = "100%"\n\t\t\t\tresult = "OffsetNeutral"\n\t\t\t\tx="0"\n\t\t\t\ty="0"\n\t\t\t/>\n\n\t\t\t<feImage\n\t\t\t\txlink:href="[[blob]]"\n\t\t\t\tresult = "DisplacementSource"\n\t\t\t\theight = "100%"\n\t\t\t\twidth  = "100%"\n\t\t\t/>\n\n\t\t\t<feOffset\n\t\t\t\tin      = "DisplacementSource"\n\t\t\t\tresult  = "OffsetSource"\n\t\t\t\tcv-attr =  "dx:dx,dy:dy"\n\t\t\t/>\n\n\t\t\t<feComposite\n\t\t\t\toperator="over"\n\t\t\t\tin2    = "OffsetNeutral"\n\t\t\t\tin     = "OffsetSource"\n\t\t\t\tresult = "DisplacementResult"\n\t\t\t/>\n\n\t\t\t<feDisplacementMap\n\t\t\t\txChannelSelector = "R"\n\t\t\t\tyChannelSelector = "G"\n\t\t\t\tin      = "SourceGraphic"\n\t\t\t\tin2     = "DisplacementResult"\n\t\t\t\tcv-ref  = "displace"\n\t\t\t\tcv-attr = "scale:scale"\n\t\t\t/>\n\n\t\t</filter>\n\n\t</defs>\n</svg>\n'}),require.register("initialize.js",function(t,e,r){"use strict";var n=e("./audio/Bgm"),i=e("./audio/Sfx"),o=e("./viewport/Viewport"),a=e("curvature/base/Tag"),s=(e("./tileMap/TileMap"),new o.Viewport);document.addEventListener("DOMContentLoaded",function(){console.log("Starting..."),navigator.serviceWorker&&navigator.serviceWorker.register("/worker-cache.js");var t=0;s.render(document.body),s.args.fps="...";new a.Tag(document.body);var e=[];!function r(){var n=performance.now(),i=n-t,o=1e3/(s.args.maxFps||60);if(requestAnimationFrame(r),!(s.args.maxFps<60&&o>i)&&(s.update(),t=n,e.push(i),e.length>1)){var a=e.reduce(function(t,e){return t+e})/e.length;s.args.fps=1e3/a,e.splice(0)}}()}),n.Bgm.register("STAR_SHIELD","/audio/leslie-wai/feel-the-sunshine.mp3"),n.Bgm.register("RADICAL_CITY","/audio/colbreakz/848482_ColBreakz---My-Universe.mp3"),n.Bgm.register("WEST_SIDE","/audio/akselmcbossmcgee123/1066486_Blammed-By-Pico.mp3"),n.Bgm.register("UNDERGROUND_ZONE","/audio/tee-lopes/under-ground-zone-remix.mp3"),n.Bgm.register("MISTY_RUINS","audio/neil-voss/extol.mp3"),n.Bgm.register("TITLE_THEME","/Sonic/carnival-night-zone-act-2-beta.mp3"),n.Bgm.register("MENU_THEME","/Sonic/s3k-competition.mp3"),n.Bgm.register("TUTORIAL_THEME","/audio/teravex/1083419_Lowbeat.mp3"),n.Bgm.register("ACT-BOSS","/audio/F-777/Double-Cross.mp3"),n.Bgm.register("ZONE-BOSS","/audio/dex-arson/rampage.mp3"),n.Bgm.register("NO_WAY","/audio/sonic/no-way.mp3"),i.Sfx.register("PLAYER_DAMAGED","/Sonic/S3K_35.wav"),i.Sfx.register("RINGS_SCATTERED","/Sonic/ring-loss.wav",{maxConcurrent:3,volume:.75,fudgeFactor:0}),i.Sfx.register("BUMPER_BOUNCE","/Sonic/S3K_AA.wav"),i.Sfx.register("RING_COLLECTED","/Sonic/ring-collect.wav",{maxConcurrent:3,volume:.25,fudgeFactor:.1}),i.Sfx.register("EMERALD_COLLECTED","/Sonic/S3K_9C.wav"),i.Sfx.register("OBJECT_DESTROYED","/Sonic/object-destroyed.wav",{maxConcurrent:3,volume:.75,fudgeFactor:.1}),i.Sfx.register("BLOCK_DESTROYED","/Sonic/0A3H.wav",{maxConcurrent:8,volume:1,fudgeFactor:0,startTime:.4}),i.Sfx.register("ROCKS_DESTROYED","/Sonic/rock-smash.wav"),i.Sfx.register("SPEEDPAD_HIT","/Sonic/S2_2B.wav",{maxConcurrent:3,volume:.75,fudgeFactor:.1}),i.Sfx.register("SPRING_HIT","/Sonic/spring-activated.wav",{maxConcurrent:2,volume:.5,fudgeFactor:.1}),i.Sfx.register("SWITCH_HIT","/Sonic/switch-activated.wav",{maxConcurrent:3,volume:.3,fudgeFactor:.2}),i.Sfx.register("STARPOST_HIT","/Sonic/starpost-active.wav",{volume:.5}),i.Sfx.register("SHOT_FIRED","/Sonic/shot-fired.wav",{volume:.5}),i.Sfx.register("THRUSTER_FIRED","/Sonic/mecha-sonic-thruster.wav"),i.Sfx.register("BOSS_DAMAGED","/Sonic/S3K_6E.wav"),i.Sfx.register("BOSS_DUDHIT","/Sonic/S2_59.wav"),i.Sfx.register("WATER_ACQUIRE","/Sonic/S3K_3F.wav",{volume:.75,fudgeFactor:.1}),i.Sfx.register("WATER_BOUNCE","/Sonic/S3K_44.wav",{volume:.5,fudgeFactor:.1}),i.Sfx.register("ELECTRIC_ACQUIRE","/Sonic/S3K_41.wav",{volume:.75,fudgeFactor:.1}),i.Sfx.register("ELECTRIC_JUMP","/Sonic/S3K_45.wav",{maxConcurrent:3,volume:.5,fudgeFactor:.1}),i.Sfx.register("FIRE_ACQUIRE","/Sonic/S3K_3E.wav",{volume:.75,fudgeFactor:.1}),i.Sfx.register("FIRE_DASH","/Sonic/S3K_43.wav",{volume:.5,fudgeFactor:.1}),i.Sfx.register("CHOPPER_DRONE","/Sonic/drill-car-copter.wav"),i.Sfx.register("CHOPPER_DRONE","/Sonic/drill-car-copter.wav"),i.Sfx.register("MECHASONIC_TAKEOFF","/Sonic/mecha-sonic-takeoff.wav"),i.Sfx.register("MECHASONIC_SCRAPE","/Sonic/mecha-sonic-scrape.wav"),i.Sfx.register("MECHASONIC_SLAP","/Sonic/mecha-sonic-thruster-close.wav"),i.Sfx.register("TAILS_FLY","/Sonic/tails-flying.wav"),i.Sfx.register("LIGTNING_STRIKE","/Sonic/S3K_4E.wav",{maxConcurrent:1,volume:1,fudgeFactor:0}),i.Sfx.register("SECRET_FOUND","/doom/dssecret.wav")}),require.register("intro/BootCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BootCard=void 0;var i=e("./Card");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Card);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.cardName="boot-card",r.args.text="PRODUCED BY\nSEAN MORRIS UNDER\nTHE APACHE 2.0 LICENSE",r}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.BootCard=u}),require.register("intro/Card.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Card=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.View);var r,n,u,l=s(f);function f(){var t,r,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),t=l.call(this,o,a),r=c(t),n="template",i=e("./card.html"),n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,o.text=o.text||"this is an intro card.",t.args.timeout=t.args.timeout||1e3,t.args.animation="opening",t.done=new Promise(function(e){return t.accept=e}),t}return r=f,(n=[{key:"play",value:function(t){var e=this;this.onTimeout(50,function(){return e.args.animation="opened"});var r=this.args.waitFor||Promise.resolve();return new Promise(function(t){r.then(function(){var r=e.args.timeout;r>0&&(e.onTimeout(r-500,function(){return e.args.animation="closing"}),e.onTimeout(r,function(){e.args.animation="closed";var n=new Promise(function(t){return e.onTimeout(r,t)});t(e.accept([n]))}))})})}}])&&o(r.prototype,n),u&&o(r,u),Object.defineProperty(r,"prototype",{writable:!1}),f}();t.Card=l}),require.register("intro/DebianCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.DebianCard=void 0;var i=e("./SkippableCard");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.SkippableCard);var r,n,u,l=s(f);function f(t,r){var n,i,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),n=l.call(this,t,r),i=c(n),o="template",a=e("./debian-card.html"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n.args.cardName="debian-card",n.args.text="",n}return r=f,n&&o(r.prototype,n),u&&o(r,u),Object.defineProperty(r,"prototype",{writable:!1}),r}();t.DebianCard=l}),require.register("intro/GamepadCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.GamepadCard=void 0;var i=e("./SkippableCard");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.SkippableCard);var r,n,u,l=s(f);function f(t,r){var n,i,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),n=l.call(this,t,r),i=c(n),o="template",a=e("./gamepad-card.html"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n.args.cardName="gamepad-card",n.args.text="",n}return r=f,n&&o(r.prototype,n),u&&o(r,u),Object.defineProperty(r,"prototype",{writable:!1}),r}();t.GamepadCard=l}),require.register("intro/LoadingCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingCard=void 0;var i=e("./Card");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Card);var e,r,n,c=s(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=c.call(this,t,e)).args.cardName="loading-card",r}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.LoadingCard=u}),require.register("intro/LogoSplash.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.LogoSplash=void 0;var i=e("curvature/base/View"),o=e("../audio/Sfx");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(l,i.View);var e,r,n,u=c(l);function l(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(t=u.call(this,e,r)).template='\n\t\t<div class = "player-waving"></div>\n\t\t<div class = "splash [[animation]]" style = "\n\t\t\tpointer-events: [[pointerEvents]]\n\t\t">\n\t\t\t<div class = "center">SEAN<span class = "min">MORRIS</span><div class = "sm">SM</div></div>\n\t\t\t<div class = "center">SEAN<span class = "min">MORRIS</span><div class = "sm">SM</div></div>\n\t\t\t<div class = "center">SEAN<span class = "min">MORRIS</span><div class = "sm">SM</div></div>\n\t\t</div>',t}return e=l,(r=[{key:"onAttached",value:function(){var t=this;this.alreadyAttached||(this.alreadyAttached=!0,this.args.left=0,this.args.right=0,this.args.fade=1,this.args.frame=0,this.args.fullFade=1,this.args.pointerEvents="all",this.args.animation="hide",this.onTimeout(500,function(){return t.args.animation="slide"}),this.onTimeout(1250,function(){return t.args.animation="show"}),this.onTimeout(5e3,function(){return t.args.animation="done"}),this.onTimeout(1250,function(){return o.Sfx.play("RING_COLLECTED")}))}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),l}();t.LogoSplash=l}),require.register("intro/NoWayCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.NoWayCard=void 0;var i=e("./Card"),o=e("../audio/Bgm"),a=e("../ui/CharacterString");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(p,i.Card);var r,n,f,h=u(p);function p(t,r){var n,i,o,s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),n=h.call(this,t,r),i=l(n),o="template",s=e("./no-way.html"),o in i?Object.defineProperty(i,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[o]=s,n.args.cardName="no-way-card",n.args.text=new a.CharacterString({value:"Error: "+n.args.errorString}),n.args.backdrop="...",n}return r=p,(n=[{key:"onAttached",value:function(){o.Bgm.play("NO_WAY",!0)}}])&&s(r.prototype,n),f&&s(r,f),Object.defineProperty(r,"prototype",{writable:!1}),p}();t.NoWayCard=h}),require.register("intro/SeanCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SeanCard=void 0;var i=e("./Card"),o=e("./LogoSplash");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(l,i.Card);var e,r,n,u=c(l);function l(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(r=u.call(this,t,e)).args.cardName="sean-card",r.args.text=new o.LogoSplash({},e),r}return e=l,r&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.SeanCard=l}),require.register("intro/Series.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Series=void 0;var i=e("curvature/base/View");e("./Card");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(l,i.View);var e,r,n,u=s(l);function l(){var t,e,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),t=u.call(this,i,o),e=c(t),n='<div class = "intro-cards" cv-each = "cards:card:c">[[card]]</div>',(r="template")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.cards=t.args.cards,t.args.cards=[],t.args.card=null,t.startTime=!1,t}return e=l,(r=[{key:"play",value:function(){var t=this,e=this.cards.shift(),r=new Promise(function(t){return e.onRemove(t)}),n=e.play();this.args.cards.push(e),this.startTime=Date.now();var i=[r,e.done];return n&&i.push(n),Promise.race(i).then(function(r){return r&&t.parent.onFrameOut(10,function(){Promise.all(r).then(function(){return e.remove()})}),t.cards.length?t.play():n})}},{key:"input",value:function(t){var e=this.args.cards[this.args.cards.length-1];e&&e.input&&e.input(t)}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),l}();t.Series=l}),require.register("intro/SkippableCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SkippableCard=void 0;var i=e("./Card");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.Card);var e,r,n,l=c(f);function f(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(r=l.call(this,t,e)).args.cardName="skippable-card",r.args.text="",r}return e=f,(r=[{key:"input",value:function(t){var e=this;!this.started||Date.now()+-this.started<500||(t.buttons[9]&&1===t.buttons[9].time||t.buttons[0]&&1===t.buttons[0].time)&&(this.onTimeout(200,function(){return e.startPressed=!0}),this.args.animation="closing")}},{key:"play",value:function(){var t=this;return this.started=Date.now(),Promise.race([a(u(f.prototype),"play",this).call(this),new Promise(function(e){return t.onFrame(function(){t.startPressed&&e()})})])}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.SkippableCard=l}),require.register("intro/ThankYouCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ThankYouCard=void 0;var i=e("./Card"),o=e("../ui/CharacterString");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(h,i.Card);var r,n,l,f=c(h);function h(t,r){var n,i,a,s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),n=f.call(this,t,r),i=u(n),a="template",s=e("./thank-you.html"),a in i?Object.defineProperty(i,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[a]=s,n.args.cardName="thank-you-card",n.args.text=new o.CharacterString({value:"Thank you for playing!"}),n.args.backdrop="...",n}return r=h,n&&a(r.prototype,n),l&&a(r,l),Object.defineProperty(r,"prototype",{writable:!1}),r}();t.ThankYouCard=f}),require.register("intro/TitleScreenCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TitleScreenCard=void 0;var i=e("./Card"),o=e("../ui/CharacterString"),a=e("../audio/Bgm"),s=e("../backdrop/MarbleGarden"),c=e("curvature/input/Keyboard");function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return p(t)}(this,r)}}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(b,i.Card);var r,n,d,y=h(b);function b(t,r){var n,i,a,u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b),n=y.call(this,t,r),i=p(n),a="template",u=e("./titlescreen.html"),a in i?Object.defineProperty(i,a,{value:u,enumerable:!0,configurable:!0,writable:!0}):i[a]=u,n.args.cardName="title-screen-card",n.args.text="",n.args.backdrop="...",n.startPressed=!1;var l=new s.MarbleGarden;l.args.frame=0,l.args.x=0,l.args.y=140,l.args.xMax=1e4,l.args.yMax=800,n.started=0,c.Keyboard.get().reset();var f=c.Keyboard.get().codes.bindTo("Enter",function(t){!n.started||Date.now()-n.started<2e3||t<=0||void 0===t||(n.onTimeout(200,function(){return n.startPressed=!0}),n.args.animation="closing")});return n.onRemove(f),l.args.xPan=0,n.start=new Promise(function(t){return n.onFrame(function(){if(n.started&&!(Date.now()-n.started<0)&&(l.args.xPan-=24,l.args.frame++,n.startPressed)){var e=new Promise(function(t){return n.onTimeout(200,t)});t([e])}})}),n.args.backdrop=l,n.args.pressStart=new o.CharacterString({value:"press start/enter"}),n}return r=b,(n=[{key:"input",value:function(t){var e=this;!this.started||Date.now()-this.started<2e3?t.zero():t.buttons[9]&&1===t.buttons[9].time&&(this.onTimeout(200,function(){return e.startPressed=!0}),this.args.animation="closing")}},{key:"play",value:function(){var t=this;this.onTimeout(1e3,function(){t.onRemove(function(){return a.Bgm.stop("TITLE_THEME")}),a.Bgm.play("TITLE_THEME")}),this.onTimeout(2e3,function(){return t.args.aurora="aurora"}),this.started=Date.now();var e=l(g(b.prototype),"play",this).call(this);return Promise.race([this.start,e])}}])&&u(r.prototype,n),d&&u(r,d),Object.defineProperty(r,"prototype",{writable:!1}),b}();t.TitleScreenCard=d}),require.register("intro/WarningCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WarningCard=void 0;var i=e("./SkippableCard");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.SkippableCard);var r,n,u,l=s(f);function f(t,r){var n,i,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),n=l.call(this,t,r),i=c(n),o="template",a=e("./warning-card.html"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n.args.cardName="warning-card",n.args.text="",n}return r=f,n&&o(r.prototype,n),u&&o(r,u),Object.defineProperty(r,"prototype",{writable:!1}),r}();t.WarningCard=l}),require.register("intro/WebkitCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WebkitCard=void 0;var i=e("./SkippableCard");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(p,i.SkippableCard);var r,n,f,h=c(p);function p(t,r){var n,i,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),n=h.call(this,t,r),i=u(n),o="template",a=e("./webkit-card.html"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n.args.cardName="webkit-card",n.args.text="",n}return r=p,(n=[{key:"play",value:function(t){var e=this;return this.onTimeout(1500,function(){return e.args.animation="spindash-charge"}),this.onTimeout(3e3,function(){return e.args.animation="spindash"}),a(l(p.prototype),"play",this).call(this,t)}}])&&o(r.prototype,n),f&&o(r,f),Object.defineProperty(r,"prototype",{writable:!1}),p}();t.WebkitCard=f}),require.register("intro/card.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]]">\n\t<span>[[text]]</span>\n</div>\n'}),require.register("intro/debian-card.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]] [[aurora]]">\n\t<div class = "main-elements-container">\n\t\t<div class = "debian-logo"></div>\n\t\t<div class = "caption">Built on Debian</div>\n\t</div>\n</div>\n'}),require.register("intro/gamepad-card.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]] [[aurora]]">\n\t<div class = "main-elements-container">\n\t\t<div class = "gamepad-svg"></div>\n\t\t<div class = "caption">Supports HTML5 Gamepad API.</div>\n\t</div>\n</div>\n\n'}),require.register("intro/no-way.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]] [[aurora]]">\n\t<div class = "player-waving"></div>\n\t<div class = "no-way"></div>\n\t<div class = "main-elements-container">\n\t\t[[text]]\n\t</div>\n</div>\n'}),require.register("intro/thank-you.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]] [[aurora]]">\n\t<div class = "player-waving"></div>\n\t<div class = "main-elements-container">\n\t\t<div class = "title-emblem"></div>\n\t\t[[text]]\n\t</div>\n</div>\n'}),require.register("intro/titlescreen.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]] [[aurora]]">\n\t[[backdrop]]\n\n\t<div class = "main-elements-container">\n\n\t\t<div class = "title-emblem"></div>\n\t\t<div class = "press-start">[[pressStart]]</div>\n\n\t</div>\n\n</div>\n'}),require.register("intro/warning-card.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]] [[aurora]]">\n\t<div class = "main-elements-container">\n\t\t<div class = "warning-svg"></div>\n\t</div>\n</div>\n\n'}),require.register("intro/webkit-card.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]] [[aurora]]">\n\t<div class = "main-elements-container">\n\t\t<div class = "chromium-logo"></div>\n\t\t<div class = "caption">WebKit recommended for best experience.</div>\n\t</div>\n</div>\n'}),require.register("legacy/Actor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Actor=void 0;var i=e("curvature/base/View"),o=e("../debug/PointDump");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(p,i.View);var r,n,l,h=c(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return f(u(t=h.call.apply(h,[this].concat(n))),"speed",15),f(u(t),"template",e("./actor.html")),t.world=null,t.x=92,t.y=1024,t.width=64,t.height=64,t.boxWidth=64,t.boxHeight=64,t.directions=16,t.state="standing",t.gSpeed=0,t.gSpeedMax=40,t.xSpeed=0,t.ySpeed=0,t.angle=0,t.maxGravity=48,t.gravity=0,t.slopeFactor=.01,t.falling=!0,t.sensors={top:!1,bottom:!1,left:!1,right:!1},t.mode=t.args.mode=0,t.modes={floor:0,leftWall:1,ceiling:2,rightWall:3},t.animationClasses={},t.currentClasses=null,t.pdL=new o.PointDump({color:"red"}),t.pdR=new o.PointDump({color:"green"}),t.args.debugs=[t.pdL,t.pdR],t}return r=p,(n=[{key:"destroy",value:function(){}},{key:"update",value:function(){if(this.tags.actor){var t=this.gSpeed;this.args.animspeed=Math.floor((this.gSpeedMax-Math.abs(t))/12),this.args.animspeed<1&&(this.args.animspeed=1);var e=Math.round(1e3*this.angle)/1e3;if(this.falling?(this.falling||this.jumped)&&(this.args.state="jumping"):(e>Math.PI/4&&e<2*Math.PI/4&&(this.mode===this.modes.floor?this.args.mode=this.mode=this.modes.leftWall:this.mode===this.modes.leftWall?this.args.mode=this.mode=this.modes.ceiling:this.mode===this.modes.ceiling?this.args.mode=this.mode=this.modes.rightWall:this.mode===this.modes.rightWall&&(this.args.mode=this.mode=this.modes.floor)),e<-Math.PI/4&&e>-2*Math.PI/4&&(this.mode===this.modes.floor?this.args.mode=this.mode=this.modes.rightWall:this.mode===this.modes.rightWall?this.args.mode=this.mode=this.modes.ceiling:this.mode===this.modes.ceiling?this.args.mode=this.mode=this.modes.leftWall:this.mode===this.modes.leftWall&&(this.args.mode=this.mode=this.modes.floor)),Math.abs(t)>this.gSpeedMax/2?this.args.state="running":Math.abs(t)>0?this.args.state="walking":this.args.state="standing",this.args.facing=t>0?"facing-right":"facing-left"),this.falling?this.mode==this.modes.floor?this.ySpeed++:this.mode==this.modes.ceiling?this.ySpeed--:this.mode==this.modes.leftWall?this.xSpeed--:this.mode==this.modes.rightWall&&this.xSpeed++:this.jumped||(this.xSpeed=0,this.ySpeed=0),this.x+=this.xSpeed,this.ySpeed&&(this.y+=this.ySpeed>0?1:-1),t)for(var r=Math.abs(t),n=r>8?8:r,i=0;i<n;i++)this.iteratePosition(Math.floor(t/n));else this.iteratePosition(0);this.ySpeed>32&&(this.ySpeed=32),this.ySpeed<-32&&(this.ySpeed=-32),this.xSpeed>32&&(this.xSpeed=32),this.xSpeed<-32&&(this.xSpeed=-32),this.tags.actor.style({"--x":Math.floor(this.x),"--y":Math.floor(this.y)}),this.mode===this.modes.floor?this.tags.actor.style({"--angle":this.angle}):this.mode===this.modes.leftWall?this.tags.actor.style({"--angle":this.angle+Math.PI/2*1}):this.mode===this.modes.ceiling?this.tags.actor.style({"--angle":this.angle+Math.PI/2*2}):this.mode===this.modes.rightWall&&this.tags.actor.style({"--angle":this.angle+Math.PI/2*3}),this.jumped&&(this.jumped=!1)}}},{key:"iteratePosition",value:function(t){var e,r,n,i,o=Math.sin(this.angle),a=Math.cos(this.angle),s=this.center,c=(this.top,this.bottom),u=(this.left,this.right);this.mode==this.modes.floor||this.mode==this.modes.ceiling?(e=u-s[0],s[1]):this.mode!=this.modes.leftWall&&this.mode!=this.modes.rightWall||(e=u-s[1],s[0]),r=this.left-e*o+.5*e,n=this.right-e*o-.5*e,i=Math.abs(n-r);var l,f,h,p,g=this.viewport.tileMap,d=0,y=0,b=!1,v=!1,m=(this.falling,this.height),w=[[-m,0],[-m,m]];t:for(var S in w)for(d=w[S][0];d<w[S][1];){if(this.mode==this.modes.floor?(l=r,f=c+d):this.mode==this.modes.ceiling?(l=r,f=c-d):this.mode==this.modes.leftWall?(l=c-d,f=r):this.mode==this.modes.rightWall&&(l=c+d,f=r),b=g.getSolid(l,f)){if(0!==d)break t;break}d++}for(var O in w)for(y=w[O][0];y<w[O][1]&&(this.mode==this.modes.floor?(h=n,p=c+y):this.mode==this.modes.ceiling?(h=n,p=c-y):this.mode==this.modes.leftWall?(h=c-y,p=n):this.mode==this.modes.rightWall&&(h=c+y,p=n),!(v=g.getSolid(h,p)));)y++;if(this.pdL.args.x=l,this.pdL.args.y=f,this.pdR.args.x=h,this.pdR.args.y=p,this.angle=Math.atan((y-d)/i),!this.falling){var j=(d+y)/2;this.mode===this.modes.floor?(this.x+=t*a,this.y+=t*o):this.mode===this.modes.rightWall?(this.x+=t*o,this.y-=t*a):this.mode===this.modes.ceiling?(this.x-=t*a,this.y-=t*o):this.mode===this.modes.leftWall&&(this.x-=t*o,this.y+=t*a),b&&v&&d<=0&&y<=0&&(this.mode==this.modes.floor?this.y+=Math.ceil(j):this.mode==this.modes.ceiling?this.y-=Math.ceil(j):this.mode==this.modes.leftWall?this.x-=j:this.mode==this.modes.rightWall&&(this.x+=j))}this.falling=d>0&&y>0}},{key:"isColliding",value:function(t){}},{key:"animate",value:function(){this.animationClasses[animation]&&this.currentClasses!=this.animationClasses[animation]&&(this.currentClasses.map(function(t){this.tags.sprite.removeClass(t)}),this.animationClasses[animation].map(function(t){this.tags.sprite.addClass(t)}),this.currentClasses=this.animationClasses[animation])}},{key:"roundAngle",value:function(t,e){return 360*"Math.round"((t=Math.round(t*(180/Math.PI)))/(360/e))/e*(Math.PI/180)}},{key:"goLeft",value:function(){this.gSpeed>0&&(this.gSpeed=0),this.gSpeed>-this.gSpeedMax&&this.gSpeed--}},{key:"goRight",value:function(){this.gSpeed<0&&(this.gSpeed=0),this.gSpeed<this.gSpeedMax&&this.gSpeed++}},{key:"slowDown",value:function(){Math.abs(this.gSpeed)>32?this.gSpeed=.95*this.gSpeed:this.gSpeed=.75*this.gSpeed,Math.abs(this.gSpeed)<=.1&&(this.gSpeed=0)}},{key:"jump",value:function(){var t;this.falling||(this.falling=!0,this.jumped=!0,this.mode=this.args.mode=this.modes.floor,this.mode===this.modes.floor?t=this.angle:this.mode===this.modes.leftWall?t=this.angle+Math.PI/2*1:this.mode===this.modes.ceiling?t=this.angle+Math.PI/2*2:this.mode===this.modes.rightWall&&(t=this.angle+Math.PI/2*3),this.angle=0,this.ySpeed=20*-Math.cos(t),this.xSpeed=20*Math.sin(t),this.mode!==this.modes.leftWall&&this.mode!==this.modes.rightWall||(this.gSpeed=0))}},{key:"center",get:function(){return[this.x+this.boxWidth/2,this.y+this.boxHeight/2]}},{key:"left",get:function(){return this.mode==this.modes.floor?this.center[0]-this.width/2:this.mode==this.modes.ceiling?this.center[0]+this.width/2:this.mode==this.modes.leftWall?this.center[1]-this.width/2:this.mode==this.modes.rightWall?this.center[1]+this.width/2:void 0}},{key:"right",get:function(){return this.mode==this.modes.floor?this.center[0]+this.width/2:this.mode==this.modes.ceiling?this.center[0]-this.width/2:this.mode==this.modes.leftWall?this.center[1]+this.width/2:this.mode==this.modes.rightWall?this.center[1]-this.width/2:void 0}},{key:"top",get:function(){return this.mode==this.modes.floor?this.center[1]-Math.floor(this.height/2):this.mode==this.modes.ceiling?this.center[1]+Math.floor(this.height/2):this.mode==this.modes.leftWall?this.center[0]+Math.floor(this.height/2):this.mode==this.modes.rightWall?this.center[0]-Math.floor(this.height/2):void 0}},{key:"bottom",get:function(){return this.mode==this.modes.floor?this.center[1]+Math.floor(this.height/2):this.mode==this.modes.ceiling?this.center[1]-Math.floor(this.height/2):this.mode==this.modes.leftWall?this.center[0]-Math.floor(this.height/2):this.mode==this.modes.rightWall?this.center[0]+Math.floor(this.height/2):void 0}}])&&a(r.prototype,n),l&&a(r,l),Object.defineProperty(r,"prototype",{writable:!1}),p}();t.Actor=h}),require.register("legacy/Walker.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Walker=void 0;var i=e("./Actor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Actor);var e,r,n,c=s(u);function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),c.apply(this,arguments)}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.Walker=u}),require.register("legacy/actor.html",function(t,e,r){r.exports='<div class = "actor knuckles [[state]] [[facing]]" cv-ref = "actor" data-mode = "[[mode]]" style = "--animspeed:[[animspeed]]">\n\t<div class = "sprite" cv-ref = "sprite" ></div>\n</div>\n<div cv-each = "debugs:debug">[[debug]]</div>\n'}),require.register("mixin/CanPop.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanPop=void 0;var n=e("curvature/base/Tag"),i=(e("../actor/Explosion"),e("../actor/Projectile")),o=e("../audio/Sfx"),a={collideA:function(t,e){var r=this;if(!t.args.mercy){if(t.knocked)return t.pop&&t.pop(t.knocked),void this.pop(t.knocked);if(t.punching)return this.args.falling=!0,t.args.falling&&t.args.ySpeed<0?this.args.ySpeed=-10+t.args.ySpeed:(this.args.xSpeed=t.args.gSpeed*Math.sign(t.args.gSpeed)*2,this.args.ySpeed=-2),this.args.float=15,this.knocked=t,this.noClip=!0,this.static=!1,this.viewport.onFrameOut(30,function(){return r.pop(t)}),!1;var n=this.args.currentSheild,o=t.immune(this,n?n.type:"normal");if(n&&!o||this.args.gone||!this.viewport||!(o||t.dashed||t.args.jumping||t.args.spinning||t instanceof i.Projectile))return!this.knocked&&t&&t.controllable&&!t.punching&&("function"==typeof ga&&ga("send","event",{eventCategory:"badnik",eventAction:"damaged-player",eventLabel:"".concat(this.viewport.args.actName,"::").concat(this.args.id,"::").concat(t.args.id)}),t.damage(this,n?n.type:"normal")),!1;var a=t.args.currentSheild;this.damage(t,a?a.type:"normal")}},damage:function(t,e){var r=this.args.currentSheild,n=t.immune(this,r?r.type:"normal");r&&!n||this.args.gone||!this.viewport||!(n||t.dashed||t.args.jumping||t.args.spinning||t instanceof i.Projectile)||this.pop(t)},pop:function(t){var e=this,r=this.viewport;if(!(!r||this.args.gone||t&&t.args.owner===this)){var i=document.createElement("div");i.classList.add("particle-explosion");var a=new n.Tag(i);if(a.style({"--x":this.x,"--y":this.y-16}),r.particles.add(a),setTimeout(function(){return r.particles.remove(a)},512),setTimeout(function(){return e.screen&&e.screen.remove()},1024),this.box&&this.box.setAttribute("data-animation","broken"),t&&t.dashed&&(t.args.gSpeed=0,t.args.xSpeed=0,t.args.ySpeed=-9,t.args.x=this.x,t.dashed=!1),t){t.occupant&&(t=t.occupant),t.args.owner&&(t=t.args.owner),t.controllable&&"function"==typeof this.effect&&(this.args.gold?t.args.score+=1e4:t.args.score+=100,this.effect(t)),t.dashed&&(t.args.xSpeed/=4);var s=t.args.ySpeed;t.args.falling&&!t.punching&&this.onNextFrame(function(){s>0?t.args.ySpeed=Math.min(-s,-7):t.args.ySpeed+=4,t.args.falling=!0}),t.dashed=!1,this.viewport.settings.rumble&&t&&t.controller&&t.controller.rumble&&(t.controller.rumble({duration:40,strongMagnitude:0,weakMagnitude:1}),this.viewport.onTimeout(40,function(){t.controller.rumble({duration:110,strongMagnitude:.75,weakMagnitude:1})}))}if(o.Sfx.play("OBJECT_DESTROYED"),this.args.target&&this.viewport.actorsById[this.args.target]){var c=this.viewport.actorsById[this.args.target];c&&(this.viewport.auras.add(c),c.activate(t,this))}"function"==typeof ga&&ga("send","event",{eventCategory:"badnik",eventAction:"defeated",eventLabel:"".concat(this.viewport.args.actName,"::").concat(this.args.id)}),this.viewport.actors.remove(this),this.args.gone=!0}}};t.CanPop=a}),require.register("mixin/Constrainable.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Constrainable=void 0;var n=e("curvature/base/Tag"),i={onAttached:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite")},wakeUp:function(){var t=this;this.args._tiedTo||(this.args._tiedTo=this.viewport.actorsById[this.args.tiedTo]);var e=this.args._tiedTo;if(e&&!e.hanging.has(this.constructor)){e.hanging.set(this.constructor,new Set);var r=e.hanging.get(this.constructor);r.add(this),this.chain=new n.Tag('<div class = "chain">'),this.sprite.appendChild(this.chain.node),this.onRemove(function(){return r.delete(t)})}},sleep:function(){var t=this;this.viewport&&!this.args.stay&&this.viewport.onFrameOut(5,function(){t.args.x=t.def.get("x"),t.args.y=t.def.get("y"),t.args.xSpeed=0,t.args.ySpeed=0,t.viewport.setColCell(t)})},findNextStep:function(){return!1},setPos:function(){this.args._tiedTo||(this.args._tiedTo=this.viewport.actorsById[this.args.tiedTo]);var t=this.args._tiedTo;if(!t)return!1;this.args.ropeLength=this.args.ropeLength||t.args.ropeLength,this.args.falling=!0;var e=t.x-this.x,r=t.y-this.y,n=Math.atan2(r,e),i=Math.sqrt(Math.pow(r,2)+Math.pow(e,2)),o=this.args.ropeLength||64;this.chain&&this.chain.style({"--distance":Math.min(i,o)}),this.args.groundAngle=-(n+Math.PI/2);var a=n;if(i>o){var s=i-o,c=Math.cos(n)*o,u=Math.sin(n)*o,l=t.x-c,f=t.y-u;this.args.xSpeed+=Math.cos(a)*s,this.args.ySpeed+=Math.sin(a)*s,this.args.x=l,this.args.y=f,this.viewport&&this.viewport.setColCell(this),this.x!==t.x||t.args.xSpeed||(this.args.ySpeed=0)}t.args.ySpeed>0&&!t.args.xSpeed&&!this.args.xSpeed&&(this.args.x=t.x,this.args.y=t.y+this.args.ropeLength)}};t.Constrainable=i}),require.register("mixin/Pushable.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pushable=void 0;var n={collideA:function(t,e){if(-1===e||t.isEffect)return!1;var r=Math.ceil(Math.abs(t.args.gSpeed||t.args.xSpeed))*Math.sign(t.args.gSpeed||t.args.xSpeed);if(Math.abs(t.args.ySpeed)>Math.abs(t.args.xSpeed))return!0;if(!this.args.falling&&1===e&&r<=0)return!1;if(!this.args.falling&&3===e&&r>=0)return!1;var n=this.y-this.args.height;if((1===e||3===e)&&(t.y>=this.y||t.y>n)){if(!r)return!0;this.args.gSpeed=r,this.args.pushed=Math.sign(r)||this.args.pushed;var i=this.viewport.tileMap,o=1===e?1:3===e&&-1,a=this.scanBottomEdge(o);if(i.getSolid(this.x+Math.ceil(this.args.width/2)*o,this.y))return!0;var s=this.args.width/2;if(o>0&&0===a)this.args.falling=!0;else if(o<0&&0===a)this.args.falling=!0;else if(!this.args.falling||a>0){var c=this.findNextStep(o),u=this.findNextStep(o+s*Math.sign(o));if((!c[1]||c[2])&&!u[3]){var l=t.args.width,f=this.args.width/2;return this.args.x=t.args.x+o*(f+l),0===a}return!0}}return!0}};t.Pushable=n}),require.register("network/ChatBox.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ChatBox=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.View);var r,n,u,l=s(f);function f(t,r){var n,o,a,s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),n=l.call(this,t,r),o=c(n),a="template",s=e("./chat-box.html"),a in o?Object.defineProperty(o,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[a]=s,n.args.outputLines=[];return n.listen(t.pipe,"open",function(t){return n.args.outputLines=["You joined the chat."]}),n.listen(t.pipe,"message",function(t){var e=JSON.parse(t.detail);e.message&&(n.args.outputLines.push(i.View.from('> <span class = "incoming">[[message]]</span>',{message:e.message})),n.onNextFrame(function(){var t=n.tags.chatOutput;t&&t.scrollTo(0,t.scrollHeight)}))}),n}return r=f,(n=[{key:"send",value:function(t){var e=this;if(!t||!t.key||"Enter"===t.key){var r=this.args.chatInput;r&&(this.args.outputLines.push("< ".concat(r)),this.args.chatInput="",this.onNextFrame(function(){var t=e.tags.chatOutput;t.scrollTo(0,t.scrollHeight),t.focus()}),this.args.pipe.send(JSON.stringify({message:r})))}}}])&&o(r.prototype,n),u&&o(r,u),Object.defineProperty(r,"prototype",{writable:!1}),f}();t.ChatBox=l}),require.register("network/Rtc.js",function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Rtc=void 0;var i=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)});t.Rtc=i}),require.register("network/RtcClient.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RtcClient=void 0;var i=e("curvature/base/Mixin"),o=e("curvature/mixin/EventTargetMixin");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.Mixin["with"](o.EventTargetMixin));var e,r,n,l=c(f);function f(t){var e,r,n,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),e=l.call(this),r=u(e),i=500,(n="candidateTimeout")in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,e.peerClient=new RTCPeerConnection(t),e.peerClientChannel=e.peerClient.createDataChannel("chat"),e.peerClientChannel.addEventListener("open",function(t){var r=new CustomEvent("open",{detail:t.data});r.originalEvent=t,e.dispatchEvent(r),e.connected=!0}),e.peerClientChannel.addEventListener("close",function(t){var r=new CustomEvent("close",{detail:t.data});r.originalEvent=t,e.dispatchEvent(r),e.connected=!1}),e.peerClientChannel.addEventListener("message",function(t){var r=new CustomEvent("message",{detail:t.data});r.originalEvent=t,e.dispatchEvent(r)}),e}return e=f,(r=[{key:"send",value:function(t){this.peerClientChannel&&this.peerClientChannel.send(t)}},{key:"close",value:function(){this.peerClientChannel&&this.peerClientChannel.close()}},{key:"offer",value:function(){var t=this;this.peerClient.createOffer().then(function(e){t.peerClient.setLocalDescription(e)});var e=new Set;return new Promise(function(r){var n=null;t.peerClient.addEventListener("icecandidate",function(i){i.candidate&&(e.add(i.candidate),n&&clearTimeout(n),n=setTimeout(function(){return r(t.peerClient.localDescription)},t.candidateTimeout))})})}},{key:"accept",value:function(t){var e=new RTCSessionDescription(t);this.peerClient.setRemoteDescription(e)}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.RtcClient=f}),require.register("network/RtcClientTask.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RtcClientTask=void 0;var i=e("subspace-console/Task"),o=e("curvature/base/Tag"),a=e("./RtcClient");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=Symbol("accept"),g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(g,i.Task);var e,r,n,f=u(g);function g(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return h(l(t=f.call.apply(f,[this].concat(r))),"title","RTC Client Task"),h(l(t),"connected",!1),t}return e=g,(r=[{key:"init",value:function(){var t=this;return this.client=new a.RtcClient({iceServers:[{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}]}),this.finally(function(){console.log("Terminating connection..."),t.client.close()}),this.client.addEventListener("open",function(){t.print("Remote peer client accepted!")}),this.client.addEventListener("close",function(){t.print("Peer reset connection.")}),this.client.addEventListener("message",function(e){t.print("> ".concat(e.detail))}),this.client.offerToken.then(function(e){var r=JSON.stringify(e),n="s3ktp://request/".concat(btoa(r));t.print("Client request code: ".concat(n));var i=new o.Tag('<textarea style = "display:none">');i.innerText=n,document.body.append(i.node),i.select(),document.execCommand("copy"),i.node.remove()}),new Promise(function(e){t[p]=e})}},{key:"main",value:function(t){t&&(this.client.connected?(this.print("< ".concat(t)),this.client.send(t)):this.accept(t))}},{key:"accept",value:function(t){if(t){var e=/^s3ktp:\/\/accept\/(.+)/.exec(t);e&&(t=atob(e[1]));var r=JSON.parse(t);this.client.accept(r)}else this.print("Please supply server's accept string.")}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),g}();t.RtcClientTask=g,h(g,"helpText","RTC Client."),h(g,"useText","")}),require.register("network/RtcServer.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RtcServer=void 0;var i=e("curvature/base/Mixin"),o=e("curvature/mixin/EventTargetMixin");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.Mixin["with"](o.EventTargetMixin));var e,r,n,l=c(f);function f(t){var e,r,n,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),e=l.call(this),r=u(e),i=500,(n="candidateTimeout")in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,e.peerServer=new RTCPeerConnection(t),e.peerServer.addEventListener("datachannel",function(t){e.peerServerChannel=t.channel,e.peerServerChannel.addEventListener("open",function(t){var r=new CustomEvent("open",{detail:t.data});r.originalEvent=t,e.dispatchEvent(r),e.connected=!0}),e.peerServerChannel.addEventListener("close",function(t){var r=new CustomEvent("close",{detail:t.data});r.originalEvent=t,e.dispatchEvent(r),e.connected=!1}),e.peerServerChannel.addEventListener("message",function(t){var r=new CustomEvent("message",{detail:t.data});r.originalEvent=t,e.dispatchEvent(r)})}),e}return e=f,(r=[{key:"send",value:function(t){this.peerServerChannel&&this.peerServerChannel.send(t)}},{key:"close",value:function(){this.peerServerChannel&&this.peerServerChannel.close()}},{key:"answer",value:function(t){var e=this;return new Promise(function(r){e.peerServer.setRemoteDescription(t),e.peerServer.createAnswer(function(t){return e.peerServer.setLocalDescription(t)},function(t){return console.error(t)});var n=new Set,i=null;e.peerServer.addEventListener("icecandidate",function(t){t.candidate&&(n.add(t.candidate),i&&clearTimeout(i),i=setTimeout(function(){return r(e.peerServer.localDescription)},e.candidateTimeout))})})}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.RtcServer=f}),require.register("network/RtcServerTask.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RtcServerTask=void 0;var i=e("subspace-console/Task"),o=e("curvature/base/Tag"),a=e("./RtcServer");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=Symbol("accept"),g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(g,i.Task);var e,r,n,f=u(g);function g(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return h(l(t=f.call.apply(f,[this].concat(r))),"title","RTC Server Task"),h(l(t),"connected",!1),t}return e=g,(r=[{key:"init",value:function(){var t=this;return this.server=new a.RtcServer({iceServers:[{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}]}),this.finally(function(){t.print("Terminating connection..."),t.server.close()}),this.server.addEventListener("open",function(){t.print("Remote peer client accepted!")}),this.server.addEventListener("close",function(){t.print("Peer reset connection.")}),this.server.addEventListener("message",function(e){t.print("> ".concat(e.detail))}),this.server.answerToken.then(function(e){var r=JSON.stringify(e),n="s3ktp://accept/".concat(btoa(r));t.print("Server accept code: ".concat(n));var i=new o.Tag('<textarea style = "display:none">');i.innerText=n,document.body.append(i.node),i.select(),document.execCommand("copy"),i.node.remove()}),this.printErr("Please supply client's request code."),new Promise(function(e){t[p]=e})}},{key:"main",value:function(t){t&&(this.server.connected?(this.print("< ".concat(t)),this.server.send(t)):this.answer(t))}},{key:"answer",value:function(t){var e=/^s3ktp:\/\/request\/(.+)/.exec(t);console.log(e),e&&(t=atob(e[1]));var r=JSON.parse(t);this.server.answer(r)}},{key:"done",value:function(){}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),g}();t.RtcServerTask=g,h(g,"helpText","RTC Server."),h(g,"useText","")}),require.register("network/chat-box.html",function(t,e,r){r.exports='<div class = "chatbox">\n\n\t<div class = "chat-output" cv-each = "outputLines:line" cv-ref = "chatOutput">\n\t\t<p>[[line]]</p>\n\t</div>\n\n\t<div class = "chat-input">\n\t\t<input cv-bind = "chatInput" cv-ref = "chatInput" cv-on = "keydown:send(event)">\n\t\t<button cv-on = "click:send">send</button>\n\t</div>\n\n</div>\n'}),require.register("particle/Particle3d.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Particle3d=void 0;var i=e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Tag);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),t=c.call(this,'<div class = "particle-3d">');var e=new i.Tag('<div class = "front-3d">'),r=new i.Tag('<div class = "back-3d">'),n=new i.Tag('<div class = "right-3d">'),o=new i.Tag('<div class = "left-3d">'),a=new i.Tag('<div class = "top-3d">'),s=new i.Tag('<div class = "bottom-3d">');return t.append(r.node),t.append(n.node),t.append(o.node),t.append(e.node),t.append(a.node),t.append(s.node),t}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.Particle3d=u}),require.register("powerups/BubbleSheild.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BubbleSheild=void 0;var i=e("curvature/base/Bindable"),o=e("./Sheild"),a=e("../audio/Sfx");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(p,o.Sheild);var e,r,n,f=u(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return h(l(t=f.call.apply(f,[this].concat(r))),"template",'<div class = "sheild bubble-sheild [[bouncing]]"><div class = "bubble-sheild-shine"></div></div>'),h(l(t),"protect",!0),h(l(t),"type","water"),t}return e=p,(r=[{key:"acquire",value:function(t){var e=this;if(t.viewport){t.controllable&&a.Sfx.play("WATER_ACQUIRE");t.addEventListener("damage",function r(n){if(t.args.currentSheild===i.Bindable.make(e)){n.preventDefault();var o=n.detail.other;o&&o.pop&&o.pop(t),e.onNextFrame(function(){t.args.currentSheild=null,t.inventory.remove(e)}),t.removeEventListener("damage",r),t.startle()}})}}},{key:"command_0",value:function(t,e){t.canFly||t.dashed||t.args.standingOn&&t.args.standingOn.isVehicle||(this.args.force=10,t.args.jumping&&(t.impulse(14,Math.PI/2),this.args.bouncing="bouncing",t.args.bouncing=!0))}},{key:"hold_0",value:function(){this.args.bouncing&&this.args.force<25&&this.args.force++}},{key:"update",value:function(t){var e=this;t.args.ySpeed<-5&&this.onNextFrame(function(){t.args.bouncing=!1,e.args.bouncing=!1,e.args.force=0}),t.canFly||t.args.falling||this.args.bouncing&&this.args.force&&(this.onNextFrame(function(){t.args.standingOn=null,t.args.bouncing=!1,t.args.falling=!0,t.args.jumping=!0,t.impulse(e.args.force,-Math.PI/2,!0)}),this.args.bouncing="",a.Sfx.play("WATER_BOUNCE"),t.viewport.settings.rumble&&t.controller.rumble({duration:200,strongMagnitude:1,weakMagnitude:1}))}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.BubbleSheild=p}),require.register("powerups/ElectricSheild.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ElectricSheild=void 0;var i=e("curvature/base/Bindable"),o=e("./Sheild"),a=e("../audio/Sfx");function s(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}(this,r)}}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(p,o.Sheild);var e,r,n,c=f(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return g(h(t=c.call.apply(c,[this].concat(r))),"template",'<div class = "sheild electric-sheild [[boosted]]"></div>'),g(h(t),"protect",!0),g(h(t),"type","electric"),g(h(t),"jumps",3),g(h(t),"attract",new Set),g(h(t),"magnetism",0),g(h(t),"magnetTimeout",!1),t}return e=p,(r=[{key:"acquire",value:function(t){var e=this;if(t.viewport){t.controllable&&a.Sfx.play("ELECTRIC_ACQUIRE");t.addEventListener("damage",function r(n){if(t.args.currentSheild===i.Bindable.make(e)){n.preventDefault();var o=n.detail.other;e.immune(t,o,n.detail.type)?n.detail.immune=!0:(o&&o.damage&&o.damage(t,"electric"),e.onNextFrame(function(){t.args.currentSheild=null,t.inventory.remove(e)}),t.removeEventListener("damage",r),t.startle())}})}}},{key:"immune",value:function(t,e){return"electric"===(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"normal")}},{key:"command_0",value:function(t,e){var r=this;t.canFly||this.jumps>0&&t.args.jumping&&(t.args.ySpeed=0,t.impulse(10,-Math.PI/2),this.jumps--,this.args.boosted="boosted",this.onTimeout(250,function(){return r.args.boosted=""}),a.Sfx.play("ELECTRIC_JUMP"),t.xAxis&&Math.sign(t.xAxis)!==Math.sign(t.args.xSpeed)&&(t.args.xSpeed=1*t.xAxis))}},{key:"release_6",value:function(t,e){}},{key:"hold_6",value:function(t,e){var r=this;t.args.xOff=0,t.args.yOff=32,this.args.boosted="boosted",this.magnetism=Math.max(0,e.pressure-.25),t.pinch(260*this.magnetism,0);var n=t.viewport.objectPalette.ring,i=t.findNearestActor(function(t){return!r.attract.has(t)&&t instanceof n&&!t.args.gone&&!t.restore},386*this.magnetism);i&&(t.viewport.auras.add(i),this.attract.add(i))}},{key:"update",value:function(t){var e=this;if(t.args.falling||this.magnetTimeout||(this.magnetTimeout=this.onTimeout(100,function(){e.magnetTimeout=!1,e.args.boosted=""})),!t.canFly){t.args.falling||(this.jumps=3);var r,n=0,i=s(this.attract);try{var o=function(){var i=r.value;if(i.args.gone)return e.attract.delete(i),i.attract=null,e.onTimeout(500,function(){i.def&&(i.args.static=!1,i.args.xSpeed=0,i.args.ySpeed=0,i.args.x=i.def.get("x"),i.args.y=i.def.get("y"),t.viewport.setColCell(i),e.onTimeout(3e3,function(){t.viewport.auras.delete(i),i.args.float=-1,i.noClip=!1,i.restore=!0}))}),"continue";i.args.static=!1,i.attract=t,i.noClip=!0;var o=t.x-i.x,a=t.y-t.args.height/2-i.y,s=Math.atan2(a,o),c=Math.sqrt(Math.pow(a,2)+Math.pow(o,2)),u=Math.sign(o),l=Math.sign(a),f=Math.sign(i.args.xSpeed||0)===u,h=Math.sign(i.args.ySpeed||0)===l;if(c>512){if(n>45)return"continue";i.args.x=t.x-512*Math.cos(s),i.args.y=t.y-512*Math.sin(s)}t.viewport.setColCell(i),n++;var p=2*(e.magnetism||.75),g=Math.max(p,f?.45:.55),d=Math.max(p,.45);i.args.groundAngle=0;var y=e.magnetism?Math.random():1;(!f||Math.abs(i.args.xSpeed)<8||c>512)&&(i.args.xSpeed+=Math.max(.1,g*y)*u),(!h||Math.abs(i.args.ySpeed)<8||c>512)&&(i.args.ySpeed+=Math.max(.1,d*y)*l),i.args.falling=!0};for(i.s();!(r=i.n()).done;)o()}catch(t){i.e(t)}finally{i.f()}}}}])&&u(e.prototype,r),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.ElectricSheild=d}),require.register("powerups/FireSheild.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.FireSheild=void 0;var i=e("curvature/base/Bindable"),o=e("./Sheild"),a=e("../audio/Sfx");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(p,o.Sheild);var e,r,n,f=u(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return h(l(t=f.call.apply(f,[this].concat(r))),"template",'<div class = "sheild fire-sheild [[boosted]]"></div>'),h(l(t),"protect",!0),h(l(t),"type","fire"),t}return e=p,(r=[{key:"acquire",value:function(t){var e=this;if(t.viewport){t.controllable&&a.Sfx.play("FIRE_ACQUIRE");t.addEventListener("damage",function r(n){if(t.args.currentSheild===i.Bindable.make(e)){n.preventDefault();var o=n.detail.other;o&&o.pop&&o.pop(t),e.onNextFrame(function(){t.args.currentSheild=null,t.inventory.remove(e)}),t.removeEventListener("damage",r),t.startle()}})}}},{key:"immune",value:function(t,e){return"fire"===(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"normal")}},{key:"update",value:function(t){t.args.falling||(this.power=15)}},{key:"hold_4",value:function(t,e){var r=this;this.power<=0||(this.power--,t.canFly||(t.args.falling?(t.impulse(1,Math.PI),this.args.boosted||(this.args.boosted="boosted",a.Sfx.play("FIRE_DASH"),t.viewport.onFrameOut(15,function(){return r.args.boosted=""}))):this.args.boosted=""))}},{key:"hold_5",value:function(t,e){var r=this;this.power<=0||(this.power--,t.canFly||(t.args.falling?(t.impulse(1,0),this.args.boosted||(this.args.boosted="boosted",a.Sfx.play("FIRE_DASH"),t.viewport.onFrameOut(15,function(){return r.args.boosted=""}))):this.args.boosted=""))}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.FireSheild=p}),require.register("powerups/NormalSheild.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.NormalSheild=void 0;var i=e("curvature/base/Bindable"),o=e("./Sheild");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(h,o.Sheild);var e,r,n,l=c(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return f(u(t=l.call.apply(l,[this].concat(r))),"template",'<div class = "sheild normal-sheild"></div>'),f(u(t),"protect",!0),f(u(t),"type","normal"),t}return e=h,(r=[{key:"acquire",value:function(t){var e=this;if(t.viewport){t.addEventListener("damage",function r(n){if(t.args.currentSheild===i.Bindable.make(e)){n.preventDefault();var o=n.detail.other;o&&o.damage&&o.damage(t),e.onNextFrame(function(){t.args.currentSheild=null,t.inventory.remove(e)}),t.removeEventListener("damage",r),t.startle()}})}}},{key:"immune",value:function(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!1}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.NormalSheild=h}),require.register("powerups/Powerup.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Powerup=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.View);var e,r,n,c=s(u);function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),c.apply(this,arguments)}return e=u,(r=[{key:"equip",value:function(){}},{key:"unequip",value:function(){}},{key:"acquire",value:function(){}},{key:"drop",value:function(){}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.Powerup=u}),require.register("powerups/Sheild.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Sheild=void 0;var i=e("./Powerup");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Powerup);var e,r,n,c=s(u);function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),c.apply(this,arguments)}return e=u,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.Sheild=u}),require.register("powerups/StarSheild.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.StarSheild=void 0;var i=e("./Sheild"),o=e("../audio/Bgm"),a=e("curvature/base/Tag");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(p,i.Sheild);var e,r,n,f=u(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return h(l(t=f.call.apply(f,[this].concat(r))),"type","star"),h(l(t),"protect",!0),h(l(t),"template",'<div class = "sheild star-sheild">\n\t\t<div class = "star-sheild-stars"></div>\n\t</div>'),h(l(t),"frame",0),t}return e=p,(r=[{key:"acquire",value:function(t){var e=this,r=t.viewport;if(r){var n=t.args.currentSheild,i=function(e){e.preventDefault();var r=e.detail.other;r&&r.pop&&r.pop(t)};t.addEventListener("damage",i),r.onFrameOut(1560,function(){o.Bgm.stop("STAR_SHIELD"),t.inventory.remove(e),t.removeEventListener("damage",i),t.args.currentSheild=n,e.debindPaused&&e.debindPaused(),delete e.debindPaused}),t.onRemove(function(){return o.Bgm.stop("STAR_SHIELD")}),o.Bgm.play("STAR_SHIELD"),r.args.audio||o.Bgm.pause()}}},{key:"immune",value:function(){return!0}},{key:"drop",value:function(t){console.log(this,t),this.debindPaused&&this.debindPaused(),delete this.debindPaused}},{key:"update",value:function(t){var e=t.viewport;if(e){var r=new a.Tag('<div class = "particle-stars">'),n=t.rotatePoint(t.args.gSpeed,t.args.height/2),i=t.dashed||"springdash"===t.args.animation;r.style({"--x":n[0]+t.x+-3+t.args.xSpeed,"--y":n[1]+t.y+(i?-18:0)+t.args.ySpeed,"--frame":this.frame++,"z-index":-1,opacity:2*Math.random()}),e.particles.add(r),e.onFrameOut(15,function(){return e.particles.remove(r)})}}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.StarSheild=p}),require.register("powerups/SuperSheild.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SuperSheild=void 0;var i=e("./Sheild");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.Sheild);var e,r,n,u=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return l(c(t=u.call.apply(u,[this].concat(r))),"template",'<div class = "sheild super-sheild">\n\t\t<div class = "super-sheild-shine"></div>\n\t\t<div class = "super-sheild-spark"></div>\n\t\t<div class = "super-sheild-flare"></div>\n\t</div>'),l(c(t),"type","super"),t}return e=f,(r=[{key:"immune",value:function(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!(!t.isSuper&&!t.isHyper)}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.SuperSheild=f}),require.register("region/BgShadeRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BgShadeRegion=void 0;var i=e("./ShadeRegion");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.ShadeRegion);var e,r,n,u=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return l(c(t=u.call.apply(u,[this].concat(r))),"currentFilter",-1),l(c(t),"filters",["studio","western","heat","hydro","lava","frost","eight-bit","corruption","black-hole","normal"]),t.args.type="region region-shade bg-region-shade",t}return e=f,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.BgShadeRegion=f}),require.register("region/BossRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BossRegion=void 0;var i=e("./Region");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Region);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.type="region boss",t.args.hidden=!0,t}return e=u,(r=[{key:"updateActor",value:function(t){t.args.falling||(this.args._boss||(this.viewport.actorsById[this.args.boss].args.hitPoints?t.args.bossMode=!0:t.args.bossMode=!1))}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.BossRegion=u}),require.register("region/CorkscrewRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CorkscrewRegion=void 0;var i=e("./Region");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.Region);var e,r,n,l=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="region corkscrew",t.args.hidden=!0,t}return e=f,n=[{key:"fromDef",value:function(t){var e=t.width,r=t.height,n=(t.x,t.y),i=c(u(f),"fromDef",this).call(this,t);return i.args.width=e,i.args.height=r,i.args.y=n+r,i}}],(r=[{key:"updateActor",value:function(t){if(t.canRoll&&!(t.args.falling&&t.args.ySpeed<0)&&!(Math.abs(t.args.xSpeed)<5)){t.args.groundAngle=0;var e=(t.x-this.x)/this.args.width,r=1+Math.cos(-Math.PI+e*Math.PI*2),n=r*this.args.height*.5;t.args.y=this.y-n-1,t.args.ySpeed=0,t.args.xSpeed=Math.max(Math.abs(t.args.xSpeed)||t.args.width)*Math.sign(t.args.xSpeed),t.args.gSpeed=t.args.xSpeed,t.args.mode=0,t.args.ignore=-2,t.args.cameraMode="corkscrew",t.args.xSpeed-=Math.sign(t.args.xSpeed)*(-1+Math.abs(r))*.1,e>1||e<0?(t.args.falling=!1,t.args.y=this.y-1):t.args.animation="rolling"}}},{key:"collideA",value:function(t){return!1}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.CorkscrewRegion=l}),require.register("region/DarkRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.DarkRegion=void 0;var i=e("./Region"),o=e("curvature/base/Tag"),a=e("curvature/base/View");function s(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(d,i.Region);var e,r,n,u=p(d);function d(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=u.call.apply(u,[this].concat(r))).args.type="region region-shade region-dark",t.paths=new Map,t.actors=new Set,t}return e=d,(r=[{key:"onAttached",value:function(t){this.basePath="M 0 0\n    \t\t\t\t\tL 0 ".concat(544,"\n    \t\t\t\t\tL ").concat(544," ").concat(544,"\n    \t\t\t\t\tL ").concat(544," 0\n    \t\t\t\t\tZ"),this.mask=a.View.from('<svg style = "width: 100vw;height: 100vh">\n\t\t\t<defs>\n\t\t\t\t<clipPath id = "mask-'.concat(this.args.id,'" clipPathUnits="userSpaceOnUse">\n\t\t\t\t\t<path />\n\t\t\t\t</clipPath>\n\t\t\t</defs>\n\t\t<svg>')),this.mask.render(this.tags.sprite),this.path=this.mask.findTag("clipPath > path"),this.path.attr({d:"".concat(this.basePath," ").concat(this.lightPath)}),this.tags.sprite.style({"--maskImage":"url(#mask-".concat(this.args.id,")")})}},{key:"update",value:function(){f(g(d.prototype),"update",this).call(this),!this.filterWrapper&&this.tags.sprite&&(this.filterWrapper=new o.Tag('<div class = "region-filter-wrapper">'),this.colorWrapper=new o.Tag('<div class = "region-color-wrapper">'),this.filter=new o.Tag('<div class = "region-filter">'),this.color=new o.Tag('<div class = "region-color">'),this.filterWrapper.appendChild(this.filter.node),this.colorWrapper.appendChild(this.color.node),this.tags.sprite.appendChild(this.filterWrapper.node),this.tags.sprite.appendChild(this.colorWrapper.node))}},{key:"updateEnd",value:function(){f(g(d.prototype),"updateEnd",this).call(this);var t,e=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=c(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}(this.actors);try{for(e.s();!(t=e.n()).done;){var r=t.value,n=r.x+r.viewport.args.x,i=r.y+r.viewport.args.y-.5*r.args.height;this.paths.set(r,"M ".concat(n," ").concat(i+64,"\n\t\t\t\t A ").concat(64," ").concat(64,", 0, 1 1, ").concat(n," ").concat(i+-64,"\n\t\t\t\t A ").concat(64," ").concat(64,", 0, 0 1, ").concat(n," ").concat(i+64,"\n        \t\t Z"))}}catch(t){e.e(t)}finally{e.f()}this.path.attr({d:this.basePath+s(this.paths.values()).join(" ")}),this.actors.clear(),this.paths.clear()}},{key:"updateActor",value:function(t){t.controllable&&this.actors.add(t)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&l(e.prototype,r),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),d}();t.DarkRegion=d}),require.register("region/ExitRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ExitRegion=void 0;var i=e("./Region");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Region);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.type="region exit",t.args.hidden=!0,t}return e=u,(r=[{key:"updateActor",value:function(t){var e=this;if(t.occupant&&(t=t.occupant),t.controllable){var r=this.viewport;r.args.fade=!0,r.clearCheckpoints(t.args.id),r.onFrameOut(30,function(){r.actors.remove(e),e.args.nextStage?(r.quit(2),r.loadMap({mapUrl:"/map/"+e.args.nextStage})):r.quit()})}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.ExitRegion=u}),require.register("region/ExplodingRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ExplodingRegion=void 0;var i=e("./Region"),o=e("../audio/Sfx"),a=e("curvature/base/Tag");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(p,i.Region);var e,r,n,h=l(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=h.call.apply(h,[this].concat(r))).args.type="region region-exploding",t}return e=p,(r=[{key:"updateActor",value:function(t){this.args.active&&(t.controllable||(t.break&&(t.break(),this.viewport.actorIsOnScreen(t)||this.viewport.actors.remove(t)),t.pop&&(t.pop(),this.viewport.actorIsOnScreen(t)||this.viewport.actors.remove(t))))}},{key:"update",value:function(){var t=this;c(f(p.prototype),"update",this).call(this);var e=this.viewport;if(e)if(this.args.active){if(e){Math.random()>.85&&o.Sfx.play("BOSS_DAMAGED");for(var r=function(r){var n=document.createElement("div");n.classList.add("particle-explosion");var i=new a.Tag(n),o=(t.args.width,Math.random(),t.args.height,Math.random(),Math.max(t.x,-t.viewport.args.x)),s=Math.max(t.y,-t.viewport.args.y),c=Math.min(t.x+t.args.width,-t.viewport.args.x+t.viewport.args.width),u=Math.min(t.y-t.args.height,-t.viewport.args.y-t.viewport.args.height/2),l=c-o,f=s-u;i.style({"--x":o+l*Math.random(),"--y":u+f*Math.random()}),e.particles.add(i),setTimeout(function(){return e.particles.remove(i)},512)},n=0;n<1;n++)r()}}else{if(this.args.target&&e.actorsById[this.args.target]){var i=e.actorsById[this.args.target];e.auras.delete(i)}e.auras.delete(this)}}},{key:"activate",value:function(){var t=this;o.Sfx.play("BOSS_DAMAGED"),this.args.active=!0,this.viewport.onFrameOut(250,function(){return t.args.active=!1}),this.args.target&&this.viewport.actorsById[this.args.target]&&this.viewport.onFrameOut(60,function(){var e=t.viewport.actorsById[t.args.target];t.viewport.auras.add(e),e.activate(other,t)})}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),p}();t.ExplodingRegion=h}),require.register("region/FgShadeRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.FgShadeRegion=void 0;var i=e("./ShadeRegion");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.ShadeRegion);var e,r,n,u=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return l(c(t=u.call.apply(u,[this].concat(r))),"currentFilter",-1),l(c(t),"filters",["studio","western","heat","hydro","lava","frost","eight-bit","corruption","black-hole","normal"]),t.args.type="fg-region-shade region region-shade",t}return e=f,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.FgShadeRegion=f}),require.register("region/ForceRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ForceRegion=void 0;var i=e("./Region");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.Region);var e,r,n,l=c(f);function f(t,e){var r,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(n=l.call(this,t,e)).args.type="region region-force",n.args.xForce=n.args.xForce||0,n.args.yForce=n.args.yForce||-5,n.args.active=null!==(r=n.args.active)&&void 0!==r?r:1,n}return e=f,(r=[{key:"update",value:function(){this.originalHeight||(this.originalHeight=this.args.height),a(u(f.prototype),"update",this).call(this)}},{key:"onAttach",value:function(){var t=this;this.viewport&&this.args.switch&&(this.switch=this.viewport.actorsById[this.args.switch],this.switch&&this.switch.args.bindTo("active",function(e){t.args.active=e||t.args.active}))}},{key:"activate",value:function(){this.args.active=1}},{key:"updateActor",value:function(t){var e=this;if(!(t instanceof i.Region||t.args.static||this.args.active<=0))if(t.args.falling)this.onNextFrame(function(){t.args.xSpeed+=Math.sign(e.args.xForce),t.args.ySpeed+=Math.sign(e.args.yForce),t.args.animation="springdash",t.args.groundAngle=0});else switch(t.args.mode){case 0:t.args.gSpeed+=Math.sign(this.args.xForce);break;case 1:t.args.gSpeed+=Math.sign(this.args.yForce);break;case 2:t.args.gSpeed-=Math.sign(this.args.xForce);break;case 3:t.args.gSpeed-=Math.sign(this.args.yForce)}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.ForceRegion=l}),require.register("region/GrindingRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.GrindingRegion=void 0;var i=e("./Region");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(h,i.Region);var e,r,n,f=c(h);function h(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=f.call.apply(f,[this].concat(o)),e=u(t),n=!0,(r="grind")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="region grinding",t.args.hidden=!0,t}return e=h,(r=[{key:"update",value:function(){this.originalHeight||(this.originalHeight=this.args.height),a(l(h.prototype),"update",this).call(this)}},{key:"updateActor",value:function(t){t.args.falling||(t.args.grinding=!0)}},{key:"collideA",value:function(t,e){a(l(h.prototype),"collideA",this).call(this,t,e)}},{key:"collideB",value:function(t,e){a(l(h.prototype),"collideA",this).call(this,t,e)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.GrindingRegion=f}),require.register("region/LavaRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.LavaRegion=void 0;var i=e("./Region"),o=e("../actor/Ring"),a=e("../actor/MarbleBlock"),s=e("curvature/base/Tag"),c=e("curvature/base/Bindable");function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return p(t)}(this,r)}}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(y,i.Region);var e,r,n,d=h(y);function y(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=d.call.apply(d,[this].concat(o)),e=p(t),n=!0,(r="isWater")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="region region-lava",t.args.gravity=.5,t.args.drag=.85,t.args.density=15,t.skimSpeed=0,t}return e=y,(r=[{key:"update",value:function(){!this.filterWrapper&&this.tags.sprite&&(this.filterWrapper=new s.Tag('<div class = "region-filter-wrapper">'),this.colorWrapper=new s.Tag('<div class = "region-color-wrapper">'),this.filter=new s.Tag('<div class = "region-filter">'),this.color=new s.Tag('<div class = "region-color">'),this.filterWrapper.appendChild(this.filter.node),this.colorWrapper.appendChild(this.color.node),this.tags.sprite.appendChild(this.filterWrapper.node),this.tags.sprite.appendChild(this.colorWrapper.node)),this.originalHeight||(this.originalHeight=this.args.height),l(g(y.prototype),"update",this).call(this)}},{key:"updateActor",value:function(t){t instanceof o.Ring?t.args.ySpeed=-Math.abs(t.args.ySpeed||-6):t.noClip||(t.controllable||t instanceof o.Ring)&&(t.y<this.y+-this.args.height+8||t.args.ySpeed<0||t.args.ignore||!t.args.mercy&&t.immune(this,"fire"))}},{key:"collideA",value:function(t,e){if(!t.noClip)return!(t instanceof a.MarbleBlock)&&((!t.args.standingOn||t.args.standingOn===c.Bindable.make(this))&&(l(g(y.prototype),"collideA",this).call(this,t,e),!!t.controllable&&(!(!t.args.mercy&&!t.immune(this,"fire"))||(t.args.y=this.y+-this.args.height+-32,t.damage(this,"fire"),!1))))}},{key:"collideB",value:function(t,e){t.noClip||l(g(y.prototype),"collideA",this).call(this,t,e)}},{key:"solid",get:function(){return!0}},{key:"isEffect",get:function(){return!0}}])&&u(e.prototype,r),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),y}();t.LavaRegion=d}),require.register("region/RainRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RainRegion=void 0;var i=e("./Region"),o=e("curvature/base/Tag");e("curvature/base/View");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.Region);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="region region-shade region-rain",t}return e=h,(r=[{key:"update",value:function(){s(l(h.prototype),"update",this).call(this),!this.filterWrapper&&this.tags.sprite&&(this.filterWrapper=new o.Tag('<div class = "region-filter-wrapper">'),this.colorWrapper=new o.Tag('<div class = "region-color-wrapper">'),this.filter=new o.Tag('<div class = "region-filter">'),this.color=new o.Tag('<div class = "region-color">'),this.filterWrapper.appendChild(this.filter.node),this.colorWrapper.appendChild(this.color.node),this.tags.sprite.appendChild(this.filterWrapper.node),this.tags.sprite.appendChild(this.colorWrapper.node))}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.RainRegion=f}),require.register("region/Region.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Region=void 0;var i=e("curvature/base/Tag"),o=e("../actor/PointActor");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(h,o.PointActor);var e,r,n,f=c(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="region",t.args.width=t.args.width||32,t.args.height=t.args.height||32,t.args.density=1,t.args.gravity=1,t.args.drag=1,t.skimSpeed=1/0,t.args.float=-1,t.skimmers=new WeakSet,t}return e=h,n=[{key:"fromDef",value:function(t){var e=u(l(h),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.height=t.height,e.args.x=e.originalX=-0+Math.floor(t.x),e.args.y=e.originalY=-0+Math.floor(t.y),this.static=!0,e}}],(r=[{key:"onRendered",value:function(){this.mainElem=new i.Tag(this.tags.sprite.parentNode),u(l(h.prototype),"onRendered",this).call(this)}},{key:"skim",value:function(t){this.skimmers.add(t)}},{key:"updateStart",value:function(){this.skimmers=new WeakSet,u(l(h.prototype),"updateStart",this).call(this)}},{key:"update",value:function(){if(this.viewport){!this.focus&&this.args.focus&&(this.focus=this.viewport.actorsById[this.args.focus]),u(l(h.prototype),"update",this).call(this);var t=-this.viewport.args.y-(this.y-this.args.height),e=-this.viewport.args.x-this.x;this.mainElem&&this.mainElem.style({"--viewportWidth":this.viewport.args.width+"px","--viewportHeight":this.viewport.args.height+"px","--leftBoundry":e+"px","--topBoundry":t+"px","--vpX":this.viewport.args.x+"px","--vpY":this.viewport.args.y+"px"})}}},{key:"updateActor",value:function(t){}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.Region=f}),require.register("region/RollingRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RollingRegion=void 0;var i=e("./Region");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.Region);var e,r,n,l=c(f);function f(t,e){var r,n,i,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(o=l.call(this,t,e)).args.sticky=!0,o.args.type="region rolling",o.args.maxSpeed=null!==(r=o.args.maxSpeed)&&void 0!==r?r:-1,o.args.minSpeed=null!==(n=o.args.minSpeed)&&void 0!==n?n:-1,o.args.canJump=null!==(i=o.args.canJump)&&void 0!==i&&i,o.args.hidden=!0,o}return e=f,(r=[{key:"update",value:function(){this.originalHeight||(this.originalHeight=this.args.height),a(u(f.prototype),"update",this).call(this)}},{key:"updateActor",value:function(t){if(t.controllable&&!t.args.falling){t.willStick=!1;var e=t.args.modeTime>5?t.gSpeedLast:0;Math.abs(t.args.gSpeed)<this.args.minSpeed&&(t.args.gSpeed=this.args.minSpeed*Math.sign(t.args.gSpeed||e||t.args.direction)),this.args.maxSpeed>0&&Math.abs(t.args.gSpeed)>this.args.maxSpeed&&(t.args.gSpeed=this.args.maxSpeed*Math.sign(t.args.gSpeed||e||t.args.direction),1===t.args.mode&&(t.args.gSpeed=t.ySpeedLast),3===t.args.mode&&(t.args.gSpeed=-t.ySpeedLast)),t.args.gSpeed||(t.args.gSpeed=2*Math.sign(e||t.args.direction)),t.args.rolling||(t.args.rolling=!0),t.willJump&&(this.args.canJump||(t.willJump=!1))}}},{key:"collideA",value:function(t,e){a(u(f.prototype),"collideA",this).call(this,t,e)}},{key:"collideB",value:function(t,e){a(u(f.prototype),"collideA",this).call(this,t,e)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.RollingRegion=l}),require.register("region/ShadeRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ShadeRegion=void 0;var i=e("../ui/CharacterString"),o=e("../effects/Cylinder"),a=e("../effects/Pinch"),s=e("./Region"),c=e("curvature/base/Tag");function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return p(t)}(this,r)}}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(b,s.Region);var e,r,n,y=h(b);function b(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return d(p(t=y.call.apply(y,[this].concat(r))),"currentFilter",-1),d(p(t),"filters",["western","heat","hydro","lava","black-hole","normal"]),t.args.type="region region-shade",t}return e=b,(r=[{key:"onRendered",value:function(){l(g(b.prototype),"onRendered",this).call(this),this.actorFilterWrapper=new c.Tag('<div class = "region-filter-wrapper">'),this.actorColorWrapper=new c.Tag('<div class = "region-color-wrapper">'),this.filterWrapper=new c.Tag('<div class = "region-filter-wrapper">'),this.colorWrapper=new c.Tag('<div class = "region-color-wrapper">'),this.actorFilter=new c.Tag('<div class = "region-filter">'),this.actorColor=new c.Tag('<div class = "region-color">'),this.filter=new c.Tag('<div class = "region-filter">'),this.color=new c.Tag('<div class = "region-color">'),this.filterWrapper.appendChild(this.filter.node),this.colorWrapper.appendChild(this.color.node),this.tags.sprite.appendChild(this.filterWrapper.node),this.tags.sprite.appendChild(this.colorWrapper.node),this.text=new i.CharacterString({value:""}),this.text.render(this.tags.sprite),this.cylinder=new o.Cylinder({id:"shade-cylinder",width:this.args.width,height:this.args.height}),this.cylinder.render(this.tags.sprite),this.pinch=new a.Pinch({id:"shade-pinch",width:this.args.width,height:this.args.height,scale:150}),this.pinch.render(this.tags.sprite),this.args.filter&&(this.filters=[this.args.filter]),this.rotateFilter()}},{key:"update",value:function(){var t=this;l(g(b.prototype),"update",this).call(this),this.args.scale=175-Math.abs(25*Math.sin(Date.now()/200)),!this.switch&&this.args.switch&&(this.switch=this.viewport.actorsById[this.args.switch],this.switch&&this.switch.args.bindTo("active",function(e){e&&t.rotateFilter()}))}},{key:"rotateFilter",value:function(){this.mainElem&&this.args.filter&&this.mainElem.classList.remove(this.args.filter),this.mainElem&&(this.args.filter=this.filters[this.currentFilter++],this.currentFilter>=this.filters.length&&(this.currentFilter=0),this.args.filter&&this.mainElem.classList.add(this.args.filter),this.args.filter&&(this.text.remove(),this.text=new i.CharacterString({value:"".concat(this.currentFilter,": ").concat(this.args.filter)}),this.text.render(this.tags.sprite)))}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&u(e.prototype,r),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),b}();t.ShadeRegion=y}),require.register("region/SwitchRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SwitchRegion=void 0;var i=e("./Region"),o=e("../actor/Rocket");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(l,i.Region);var e,r,n,u=c(l);function l(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=u.call.apply(u,[this].concat(r))).args.type="region region-switch",t.activated=!1,t}return e=l,(r=[{key:"onAttach",value:function(t){return t&&t.preventDefault(),!1}},{key:"activate",value:function(t){if(!this.args.latch||!this.activated){var e=this.viewport.actorsById[this.args.target];e&&(this.args.latch&&(this.activated=!0),e.activate(t,this))}}},{key:"updateActor",value:function(t){var e=this;if(this.args.rocket){if(t instanceof o.Rocket){var r=this.viewport.actorsById[this.args.target];if(!r||!r.activate)return;this.viewport.onFrameOut(this.args.delay||1,function(){return r.activate(t,e)})}}else if(t.isVehicle&&t.occupant&&(t=t.occupant),t.controllable&&this.args.target){var n=this.viewport.actorsById[this.args.target];n&&n.activate&&this.viewport.onFrameOut(this.args.delay||1,function(){return e.activate(t)})}}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),l}();t.SwitchRegion=l}),require.register("region/WaterRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WaterRegion=void 0;var i=e("./Region"),o=e("curvature/base/Tag");e("curvature/base/View");function a(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}(this,r)}}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(g,i.Region);var e,r,n,s=f(g);function g(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=s.call.apply(s,[this].concat(o)),e=h(t),n=!0,(r="isWater")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="region region-water",t.entryParticle='<div class = "particle-splash">',t.args.gravity=.4,t.args.drag=.85,t.args.density=1,t.skimSpeed=15,t.draining=0,t}return e=g,(r=[{key:"skim",value:function(t){var e=this;if(u(p(g.prototype),"skim",this).call(this,t),!(this.viewport.args.frameId%4)){var r=new o.Tag('<div class = "particle-skim">'),n=t.rotatePoint(t.args.gSpeed,0);r.style({"--x":n[0]+t.x+t.args.gSpeed,"--y":n[1]+t.y,"z-index":0,"--flip":"".concat(t.args.direction)}),this.viewport.particles.add(r),this.viewport.onFrameOut(16,function(){return e.viewport.particles.remove(r)})}}},{key:"update",value:function(){var t=this;if(this.viewport){if(!this.filterWrapper&&this.tags.sprite&&(this.filterWrapper=new o.Tag('<div class = "region-filter-wrapper">'),this.colorWrapper=new o.Tag('<div class = "region-color-wrapper">'),this.filter=new o.Tag('<div class = "region-filter">'),this.color=new o.Tag('<div class = "region-color">'),this.colorWrapper.appendChild(this.color.node),this.filterWrapper.appendChild(this.filter.node),this.tags.sprite.appendChild(this.colorWrapper.node),this.tags.sprite.appendChild(this.filterWrapper.node)),this.args.controller){var e=this.viewport.actorsById[this.args.controller];e&&(this.args.height=e.args.level)}if(!this.switch&&this.args.switch&&(this.switch=this.viewport.actorsById[this.args.switch],this.switch&&this.switch.args.bindTo("active",function(e){!e&&t.draining,t.draining=e?1:-1})),this.originalHeight||(this.originalHeight=this.args.height),this.draining&&(this.draining>0&&this.args.height>=32?this.args.height-=3.5:this.draining<0&&this.args.height<this.originalHeight&&(this.args.height+=3.5),this.args.height<=0?(this.args.display="none",this.draining>0&&(this.draining=0)):this.args.display="initial"),this.target&&this.args.height!==this.target){var r,n,i=this.args.height-this.target,a=null!==(r=this.args.drainSpeed)&&void 0!==r?r:1,s=null!==(n=this.args.fillSpeed)&&void 0!==n?n:1,c=i>0?a:s;Math.abs(this.args.height-this.target)>c?this.args.height-=Math.abs(c)*Math.sign(i):this.args.height=this.target}u(p(g.prototype),"update",this).call(this)}}},{key:"updateActor",value:function(t){var e=this;if(t.controllable&&!(t.y-t.args.height<this.y-this.args.height)&&this.viewport.args.frameId%5==0&&Math.random()>.9){var r=this.viewport,n=new o.Tag('<div class = "particle-bubble">'),i=t.rotatePoint.apply(t,a(t.facePoint)),s=(t.x,i[0],t.y+i[1]);n.style({"--startY":s,"--size":Math.random()});var c=this.onFrame(function(){var r=t.facePoint,i=t.x+r[0],o=t.y+r[1];t.y<e.y-e.args.height&&n.style({display:"none"}),o<e.y-e.args.height&&n.style({display:"none"}),n.style({"--x":i,"--y":o})}),u=this.onFrame(function(){n.style({"--maxY":e.y-e.args.height})});r.particles.add(n),r.onTimeout(350,function(){n.classList.add("float"),c()}),r.onTimeout(1e3,function(){n.classList.add("floating")}),setTimeout(function(){r.particles.remove(n),u()},1500)}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&c(e.prototype,r),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),g}();t.WaterRegion=g}),require.register("region/WaterfallRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WaterfallRegion=void 0;var i=e("./Region"),o=e("curvature/base/Tag");e("curvature/base/View");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,i.Region);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="region region-shade region-waterfall",t}return e=h,(r=[{key:"update",value:function(){s(l(h.prototype),"update",this).call(this),!this.filterWrapper&&this.tags.sprite&&(this.filterWrapper=new o.Tag('<div class = "region-filter-wrapper">'),this.colorWrapper=new o.Tag('<div class = "region-color-wrapper">'),this.filter=new o.Tag('<div class = "region-filter">'),this.color=new o.Tag('<div class = "region-color">'),this.filterWrapper.appendChild(this.filter.node),this.colorWrapper.appendChild(this.color.node),this.tags.sprite.appendChild(this.filterWrapper.node),this.tags.sprite.appendChild(this.colorWrapper.node),this.tags.sprite.style({"--maskImage":"url(#mask-".concat(this.args.id,")")}))}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),h}();t.WaterfallRegion=f}),require.register("savestates/Savestate.js",function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Object.defineProperty(t,"__esModule",{value:!0}),t.Savestate=void 0;var s=i(function t(){o(this,t),a(this,"emeralds",{}),a(this,"characters",{})});t.Savestate=s}),require.register("savestates/SavestateDatabase.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SavestateDatabase=void 0;var i=e("curvature/model/Database");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(u,i.Database);var e,r,n,c=s(u);function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),c.apply(this,arguments)}return e=u,(r=[{key:"_version_1",value:function(t){this.createObjectStore("savestates",{keyPath:"id",autoIncrement:!0}).createIndex("id","id",{unique:!0})}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),u}();t.SavestateDatabase=u}),require.register("sprite/Png.js",function(t,e,r){"use strict";function n(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return e&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Object.defineProperty(t,"__esModule",{value:!0}),t.Png=void 0;var l=[137,80,78,71,13,10,26,10],f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;a(this,t),u(this,"r",0),u(this,"g",0),u(this,"b",0),u(this,"a",1),this.r=e,this.g=r,this.b=n,this.a=i}return c(t,[{key:"mean",value:function(){return(this.r+this.g+this.b)/3}},{key:"hex",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;return 3===t?"".concat(this.r.toString(16).padStart(2,"0")).concat(this.g.toString(16).padStart(2,"0")).concat(this.b.toString(16).padStart(2,"0")):4===t?"".concat(this.r.toString(16).padStart(2,"0")).concat(this.g.toString(16).padStart(2,"0")).concat(this.b.toString(16).padStart(2,"0")).concat(this.a.toString(16).padStart(2,"0")):void 0}},{key:"valueOf",value:function(){return"rgba(".concat(this.r,", ").concat(this.g,", ").concat(this.b,", ").concat(this.a,")")}}]),t}(),h=function(){function t(){a(this,t),u(this,"previous",null),u(this,"content",null),u(this,"length",0),u(this,"start",0),u(this,"type",""),u(this,"crc",0)}return c(t,[{key:"text",get:function(){return this.bytes.map(function(t){return String.fromCharCode(t)}).join("")}},{key:"bytes",get:function(){for(var t=[],e=0;e<this.length;e++)t.push(this.content.getUint8(e));return t}}]),t}(),p=function(){function t(e){var r=this;a(this,t),u(this,"buffer",null),u(this,"width",0),u(this,"height",0),u(this,"depth",0),u(this,"colorType",0),u(this,"compression",0),u(this,"filter",0),u(this,"interlace",0),"string"==typeof e?this.ready=fetch(e).then(function(t){return t.arrayBuffer()}).then(function(t){r.buffer=t,r.checkHeader(),r.indexChunks()}):"object"===o(e)&&e instanceof t&&(this.ready=Promise.resolve(),this.buffer=e.buffer.slice(0),this.checkHeader(),this.indexChunks())}return c(t,[{key:"checkHeader",value:function(){var t=new Uint8Array(this.buffer);for(var e in l)if(l[e]!==t[e])throw new Error("Png is not valid.")}},{key:"readIhdr",value:function(){var t=this.chunks[0];this.width=t.content.getUint32(0),this.height=t.content.getUint32(4),this.depth=t.content.getUint8(8),this.colorType=t.content.getUint8(9),this.compression=t.content.getUint8(10),this.filter=t.content.getUint8(11),this.interlace=t.content.getUint8(12)}},{key:"palette",get:function(){var t=[];for(var e in this.chunks){var r=this.chunks[e];if("PLTE"===r.type){for(var n=0;n<r.bytes.length;n+=3){var i=new f(r.bytes[n+0],r.bytes[n+1],r.bytes[n+2]);t.push(i)}return t}}}},{key:"recolor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.palette,i=[];for(var o in r){var a=r[o],s=(a.valueOf(),a.mean(),a.hex());if(e[s]){var c=e[s],u=[c.substring(0,2),c.substring(2,4),c.substring(4,6)].map(function(t){return parseInt(t,16)});i.push.apply(i,n(u))}else i.push(a.r,a.g,a.b)}var l=new t(this);for(var f in l.chunks){var h=l.chunks[f];if("PLTE"===h.type){var p=new Uint8Array(l.buffer),g=new DataView(l.buffer,h.start+h.length,4);p.set(i,h.start),g.setUint32(0,l.runCrc(h))}}return l}},{key:"runCrc",value:function(e){if(!t.crcTable){t.crcTable=new Uint32Array(256);for(var r=0;r<256;r++){for(var n=r,i=0;i<8;i++)1==(1&n)?n=3988292384^n>>>1:n>>>=1;t.crcTable[r]=n}}var o=4294967295,a=new Uint8Array(this.buffer).slice(e.start-4,e.start+e.length);for(var s in a){var c=a[s];o=t.crcTable[255&(o^c)]^o>>>8}return o=(4294967295^o)>>>0}},{key:"indexChunks",value:function(){for(var t=[],e=8;e<this.buffer.byteLength;){var r=new DataView(this.buffer,e,4);e+=4;var n=new DataView(this.buffer,e,4);e+=4;var i=new h;i.start=e,i.length=r.getUint32();for(var o=0;o<4;o++){var a=n.getUint8(o),s=String.fromCharCode(a);i.type+=s}i.content=new DataView(this.buffer,e,i.length),e+=i.length;var c=new DataView(this.buffer,e,4);i.crc=c.getUint32(),i.previous=t[t.length-1],t.push(i),e+=4}this.chunks=t}},{key:"toBlob",value:function(){return new Blob([new Uint8Array(this.buffer)],{type:"image/png"})}},{key:"toUrl",value:function(){return URL.createObjectURL(this.toBlob())}}]),t}();t.Png=p,p.Pixel=f,p.Chunk=h}),require.register("tileMap/Elicit.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Elicit=void 0;var i=e("curvature/base/Mixin"),o=e("curvature/mixin/EventTargetMixin"),a=e("curvature/mixin/PromiseMixin");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(f,i.Mixin["with"](o.EventTargetMixin,a.PromiseMixin));var e,r,n,l=u(f);function f(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=l.call(this)).fetch=fetch(t,r).then(function(t){return e.handleFetch(t)}),e}return e=f,(r=[{key:"headers",value:function(){return this.fetch.then(function(t){var e=t.response;t.stream;return e.headers})}},{key:"stream",value:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.fetch.then(function(t){var e=t.response,r=t.stream;return new Response(r,{headers:e.headers})})}},{key:"objectUrl",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.stream(t,e).then(function(t){return t.blob()}).then(function(t){return URL.createObjectURL(t)})}},{key:"emitProgressEvent",value:function(t,e){var r=t?e/t:0;this.dispatchEvent(new CustomEvent("progress",{detail:{length:t,received:e,done:r}}))}},{key:"iterateDownload",value:function(t,e,r){var n=this;this.emitProgressEvent(r,0);var i=0;return function o(){t.read().then(function(t){var s=t.done,c=t.value;return s?(n[a.PromiseMixin.Accept](),void e.close()):(e.enqueue(c),i+=c.length,n.emitProgressEvent(r,i),o())})}()}},{key:"handleFetch",value:function(t){var e=t.body.getReader(),r=t.headers.get("Content-Length"),n=this;return{response:t,stream:new ReadableStream({start:function(t){n.iterateDownload(e,t,r)}})}}}])&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.Elicit=f}),require.register("tileMap/TileMap.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TileMap=void 0;var i=e("curvature/base/Tag"),o=e("curvature/base/Mixin"),a=(e("curvature/base/Bindable"),e("curvature/mixin/EventTargetMixin")),s=e("./Elicit");function c(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||u(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){if(t){if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=d(t);if(e){var o=d(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return g(t)}(this,r)}}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(d,o.Mixin["with"](a.EventTargetMixin));var e,r,n,l=p(d);function d(t,e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),(r=l.call(this)).meta=new Map,r.heightMask=null,r.tileImages=new Map,r.tileNumberCache=new Map,r.tileSetCache=new Map,r.tileCache=new Map,r.heightMasks=new Map,r.heightMaskCache=new Map,r.solidCache=new Map,r.tileLayers=[],r.destructibleLayers=[],r.collisionLayers=[],r.objectLayers=[];var n=t.mapUrl;r.mapData=null,r.mapUrl=n,r.maps=new Map,r.replacements=new Map;var i=new s.Elicit(n);return i.addEventListener("progress",function(t){var e=t.detail,i=e.received,o=e.length,a=e.done;r.dispatchEvent(new CustomEvent("level-progress",{detail:{length:o,received:i,done:a,url:n}}))}),r.ready=i.stream().then(function(t){return t.json()}).then(function(t){if(r.mapData=t,t&&t.properties){var e,n=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=u(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}(t.properties);try{for(n.s();!(e=n.n()).done;){var i=e.value,o=i.name.replace(/-/g,"_");r.meta.set(o,i.value)}}catch(t){n.e(t)}finally{n.f()}}return r.loadLayers(t),r.loadTilesets(t.tilesets)}),Object.preventExtensions(g(r)),r}return e=d,(r=[{key:"loadTilesets",value:function(t){var e=this,r=[],n=new Map,o=new Map,a=function(t){var a=e.mapData.tilesets[t],u=new Image;e.tileImages.set(a,u);var l="/map/"+a.image;a.original=a.image=l;var f=new s.Elicit(l);f.addEventListener("progress",function(t){var r=t.detail,i=r.received,a=r.length;r.done;n.set(f,i),o.set(f,a);var s=c(n.values()).reduce(function(t,e){return Number(t)+Number(e)}),u=c(o.values()).reduce(function(t,e){return Number(t)+Number(e)}),h=s/u;e.dispatchEvent(new CustomEvent("texture-progress",{detail:{length:u,received:s,done:h,url:l}}))});var h=f.objectUrl().then(function(t){return new Promise(function(r){a.cachedImage=t,u.addEventListener("load",function(n){e.replacements.set(l,t);var o=new i.Tag("<canvas>");o.width=u.width,o.height=u.height,o.getContext("2d").drawImage(u,0,0,u.width,u.height),e.heightMasks.set(a,o),r(o)},{once:!0}),u.src=t})});r.push(h)};for(var u in t)a(u);return Promise.all(r)}},{key:"loadLayers",value:function(t){var e={};t.layers;t.layers.forEach(function(t){t.offsetX=!1,t.offsetY=!1,t.offsetXChanged=!1,t.offsetYChanged=!1,t.destroyed=!1,t.layer=null,Object.preventExtensions(t)}),this.objectLayers=t.layers.filter(function(t){return"objectLayers"===t.type}),this.tileLayers=t.layers.filter(function(t){return"tilelayer"===t.type}),e.tileLayers=this.tileLayers,this.collisionLayers=this.tileLayers.filter(function(t){return!!t.name.match(/^Collision\s\d+/)}),this.destructibleLayers=this.tileLayers.filter(function(t){return!!t.name.match(/^Destructible\s\d+/)}),e.destructibleLayers=this.destructibleLayers,e.collisionLayers=this.collisionLayers}},{key:"addMap",value:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2];var e=new s.Elicit(t);e.stream().then(function(t){return t.json()}).then(function(t){console.log(t)}),e.addEventListener("progress",function(t){var e=t.detail;e.received,e.length,e.done})}},{key:"reset",value:function(){for(var t=0;t<this.tileLayers.length;t++){this.tileLayers[t].destroyed=!1}}},{key:"coordsToTile",value:function(t,e,r){var n,i,o=this.blockSize,a=0,s=0;this.tileLayers[r]&&(a=null!==(n=this.tileLayers[r].offsetX)&&void 0!==n?n:0,s=null!==(i=this.tileLayers[r].offsetY)&&void 0!==i?i:0);return[Math.floor((t-a)/o),Math.floor((e-s)/o)]}},{key:"getTileNumber",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=t+","+e+","+r,i=this.tileNumberCache.get(n);if(void 0!==i)return i;var o=this.tileLayers,a=this.mapData;if(!o[r])return this.tileNumberCache.set(n,!1),!1;if(t>=a.width||t<0){if(t<0||!this.meta.get("wrapX"))return 0!==r?(this.tileNumberCache.set(n,!1),!1):(this.tileNumberCache.set(n,1),1);t<0&&t%this.mapData.width!=0&&e++,t%=this.mapData.width}if(e>=a.height||e<0){if(e<0||!this.meta.get("wrapY"))return 0!==r?(this.tileNumberCache.set(n,!1),!1):(this.tileNumberCache.set(n,1),1);e%=this.mapData.height}var s=e*a.width+t;if(s in o[r].data){var c=o[r].data[s],u=c>0?c-1:0;return this.tileNumberCache.set(n,u),u}return this.tileNumberCache.set(n,!1),!1}},{key:"getObjectDefs",value:function(){if(this.mapData)return this.mapData.layers.filter(function(t){return"objectgroup"===t.type}).map(function(t){return t.objects}).flat()}},{key:"getTile",value:function(t){var e=this.tileCache.get(t);if(void 0!==e)return this.replacements.has(e[3])&&(e[2]=this.replacements.get(e[3])),e;var r=this.blockSize,n=0,i=0,o="",a="",s=this.getTileset(t),c=this.tileImages.get(s);if(t){var u=t+-s.firstgid+1,l=Math.ceil(c.width/r);n=u%l,i=Math.floor(u/l),o=s.image,a=s.original}var f=[n,i,o,a];return this.tileCache.set(t,f),f}},{key:"getSolid",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t=Math.trunc(t),e=Math.trunc(e);var n=this.coordsToTile(t,e,r),i=this.getTileNumber.apply(this,c(n).concat([r])),o=this.collisionLayers.length;if(r>0&&r<o){if(this.getSolid(t,e,0))return this.tileLayers[0];for(var a=0+o;a<this.tileLayers.length;a++){var s=this.tileLayers[a];if("Art"!==s.name.substring(0,3)&&("Moving Art"!==s.name.substring(0,10)&&"Foreground"!==s.name.substring(0,10)&&("Destructible"!==s.name.substring(0,12)||!s.destroyed)&&this.getSolid(t,e,a)))return this.tileLayers[a]}}if(0===i)return!1;if(1===i)return this.tileLayers[r];var u=this.getTileset(i),l=this.mapData.tilewidth,f=this.getTile(i),h=[f[0]*l,f[1]*l],p=Number(t)%l,g=Number(e)%l,d=h[0]+p,y=h[1]+g,b=[d,y,i].join("::"),v=this.heightMaskCache;if(v.has(b))return v.get(b);var m=!1;return m=255===this.heightMasks.get(u).getContext("2d").getImageData(d,y,1,1).data[3]&&this.tileLayers[r],v.set(b,m),m}},{key:"getTileset",value:function(t){t=Number(t);var e=this.tileSetCache.get(t);if(void 0!==e)return this.replacements.has(e.original)&&(e.image=this.replacements.get(e.original)),e;if(this.mapData)for(var r in this.mapData.tilesets){var n=this.mapData.tilesets[r];if(t+1>=n.firstgid){var i=this.mapData.tilesets[Number(r)+1];if(!i)return this.tileSetCache.set(t,n),this.replacements.has(n.original)&&(n.image=this.replacements.get(n.original)),n;if(t+1<i.firstgid)return this.tileSetCache.set(t,n),this.replacements.has(n.original)&&(n.image=this.replacements.get(n.original)),n}}}},{key:"blockSize",get:function(){return this.mapData.tilewidth}}])&&f(e.prototype,r),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),d}();t.TileMap=y}),require.register("timer/Countdown.js",function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Object.defineProperty(t,"__esModule",{value:!0}),t.Countdown=void 0;var o=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,"time",0),i(this,"callback",function(){return console.warn("No callback set!")}),this.time=e,this.callback=r}var e,r,o;return e=t,(r=[{key:"extend",value:function(t){this.time+=t}},{key:"extendTo",value:function(t){this.time=Math.max(t,this.time)}},{key:"update",value:function(){this.time>0&&this.time--,this.time<=0&&(this.callback(),this.time=0)}}])&&n(e.prototype,r),o&&n(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.Countdown=o}),require.register("titlecard/Titlecard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Titlecard=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=Symbol("Accept"),f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(h,i.View);var r,n,u,f=s(h);function h(){var t,r,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),t=f.call(this,o,a),r=c(t),n="template",i=e("./titlecard.html"),n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,t.args.firstLine=o.firstLine||"First Line",t.args.secondLine=o.secondLine||"Second Line",t.args.creditLine=o.creditLine||"Credit Line",t.args.actNumber=o.actNumber||1,t.args.animation="start",t.played=new Promise(function(e){return t[l]=e}),t}return r=h,(n=[{key:"play",value:function(t){var e=this;if(this.playing)return this.playing;var r=new Promise(function(t){var r=e.args.waitFor||Promise.resolve(),n=750;e.onTimeout(n,function(){return e.onNextFrame(function(){return e.args.animation=""})}),n+=750,e.onTimeout(n,function(){return e.onNextFrame(function(){return e.args.animation="opening"})}),n+=500,r.finally(function(){e.onTimeout(n,function(){return e.onNextFrame(function(){return e.args.animation="opening2"})}),n+=750,e.onTimeout(n,function(){return e.onNextFrame(function(){return e.args.animation="closing"})}),e.onTimeout(n,function(){t([new Promise(function(t){return e.onTimeout(n+500,t)})]),e[l]()}),n+=1e3,e.onTimeout(n,function(){return e.onNextFrame(function(){return e.args.animation="closed"})}),n+=2500,e.onTimeout(n,function(){return e.onNextFrame(function(){e.args.animation="done",e.playing=!1})})})});this.playing=r}}])&&o(r.prototype,n),u&&o(r,u),Object.defineProperty(r,"prototype",{writable:!1}),h}();t.Titlecard=f}),require.register("titlecard/titlecard.html",function(t,e,r){r.exports='<div class = "titlecard [[animation]]">\n\n\t<div class = "titlecard-field"></div>\n\n\t<div class = "titlecard-bottom-border">\n\t\t<div class = "titlecard-border-text">[[creditLine]]</div>\n\t</div>\n\n\t<div class = "titlecard-left-border">\n\t\t<div class = "titlecard-border-shadow"></div>\n\t\t<div class = "titlecard-border-color"></div>\n\t</div>\n\n\t<div class = "titlecard-title">\n\n\t\t<div class = "titlecard-title-box">\n\n\t\t\t<div class = "titlecard-title-line-1">[[firstLine]]</div>\n\n\t\t\t<div class = "titlecard-title-line-2">\n\t\t\t\t[[secondLine]]<div class = "titlecard-title-number">[[actNumber]]</div>\n\t\t\t</div>\n\n\t\t</div>\n\n\t</div>\n\n</div>\n'}),require.register("ui/CharacterString.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterString=void 0;var i=e("curvature/base/View"),o=e("curvature/base/Bindable");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(f,i.View);var e,r,n,l=c(f);function f(t,e){var r,n,i,a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),t[o.Bindable.NoGetters]=!0,r=l.call(this,t,e),n=u(r),a='<div cv-ref = "main" class = "hud-character-string [[hide]] [[color]] [[font]]" cv-each = "chars:char:c"><span\n\t\t\t\tclass = "hud-character"\n\t\t\t\tdata-type  = "[[char.type]]"\n\t\t\t\tdata-value = "[[char.pos]]"\n\t\t\t\tdata-index = "[[c]]"\n\t\t\t\tstyle      = "--value:[[char.pos]];--index:[[c]];--length:[[chars.length]];"\n\t\t\t>[[char.original]]</span></div>',(i="template")in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a;var s=[];s[o.Bindable.NoGetters]=!0,r.args.chars=s,r.args.scale=r.args.scale||1;r.args.high,r.args.med,r.args.low;return r.args.bindTo("value",function(t){var e=String(t).split("").map(r.characterToModel.bind(u(r)));e.length!==r.args.chars.length&&r.args.chars.splice(e.length),Object.assign(r.args.chars,e)}),r}return e=f,(r=[{key:"characterToModel",value:function(t,e){var r=t,n="number";if(" "===t||Number(t)!=t)switch(t){case" ":t=-1,n="number";break;case"-":t=11,n="number";break;case":":t=10,n="number";break;case".":t=12,n="number";break;case"/":t=13,n="number";break;case",":t=14,n="number";break;case"?":t=15,n="number";break;case"!":t=16,n="number";break;case"@":t=17,n="number";break;case"#":t=18,n="number";break;case"$":t=19,n="number";break;case"%":t=20,n="number";break;case"^":t=21,n="number";break;case"&":t=22,n="number";break;case"*":t=23,n="number";break;case"(":t=24,n="number";break;case")":t=25,n="number";break;case"":t=0,n="symbol2";break;case"":t=1,n="symbol2";break;case"":t=2,n="symbol2";break;case"":t=3,n="symbol2";break;case"":t=4,n="symbol2";break;case"":t=5,n="symbol2";break;case"'":t=6,n="symbol2";break;case'"':t=7,n="symbol2";break;case'"':t=8,n="symbol2";break;case"=":t=9,n="symbol2";break;case"+":t=10,n="symbol2";break;case"[":t=11,n="symbol2";break;case"]":t=12,n="symbol2";break;case"{":t=13,n="symbol2";break;case"}":t=14,n="symbol2";break;case"\\":t=15,n="symbol2";break;case";":t=16,n="symbol2";break;case"~":t=17,n="symbol2";break;case"|":t=18,n="symbol2";break;case"_":t=19,n="symbol2";break;case">":t=20,n="symbol2";break;case"<":t=21,n="symbol2";break;case"":t=22,n="symbol2";break;case"":t=23,n="symbol2";break;case"":t=24,n="symbol2";break;case"`":t=25,n="symbol2";break;default:t=String(t).toLowerCase().charCodeAt(0)-97,n="letter"}return this.args.chars[e]?(this.args.chars[e].original=r,this.args.chars[e].type=n,this.args.chars[e].pos=t,this.args.chars[e]):{pos:t,type:n,original:r}}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),f}();t.CharacterString=f}),require.register("ui/ClickSwitch.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ClickSwitch=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(f,i.View);var r,n,u,l=s(f);function f(){var t,r,n,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return t=l.call.apply(l,[this].concat(a)),r=c(t),n="template",i=e("./click-switch.html"),n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,t}return r=f,(n=[{key:"toggle",value:function(){this.args.active=!this.args.active}}])&&o(r.prototype,n),u&&o(r,u),Object.defineProperty(r,"prototype",{writable:!1}),f}();t.ClickSwitch=l}),require.register("ui/HudFrame.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.HudFrame=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(l,i.View);var e,r,n,u=s(l);function l(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=u.call.apply(u,[this].concat(o)),e=c(t),n='<div class = "hud-frame [[type]] [[alert]]">\n\t\t<div class = "hud-value">[[value]]</div>\n\t</div>',(r="template")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t}return e=l,r&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}();t.HudFrame=l}),require.register("ui/click-switch.html",function(t,e,r){r.exports='<div class = "switch" data-active = "[[active]]"  cv-on = "click:toggle(event)">\n\n\t<div class = "label labelOff">\n\t\t<img src = "/ui/mute.svg" />\n\t</div>\n\n\t<div class = "slide">\n\t\t<div class = "head"></div>\n\t</div>\n\n\t<div class = "label labelOn">\n\t\t<img src = "/ui/unmute.svg" />\n\t</div>\n\n</div>\n'}),require.register("viewport/Layer.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Layer=void 0;var i=e("curvature/base/Bindable"),o=e("curvature/base/View"),a=e("curvature/base/Tag"),s=e("curvature/base/Bag");function c(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return p(t)}(this,r)}}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(d,o.View);var r,n,u,g=h(d);function d(t,r){var n,o,a,u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),t[i.Bindable.NoGetters]=!0,n=g.call(this,t,r),o=p(n),a="template",u=e("./layer.html"),a in o?Object.defineProperty(o,a,{value:u,enumerable:!0,configurable:!0,writable:!0}):o[a]=u,n[i.Bindable.NoGetters]=!0,n.args.width=t.width||320,n.args.height=t.height||200,n.args.blockSize=32,n.x=0,n.y=0,n.args.offsetX=0,n.args.offsetY=0,n.args.layerId=n.args.layerId,Object.defineProperty(p(n),"blocksXY",{value:new Map}),Object.defineProperty(p(n),"blocks",{value:new s.Bag}),Object.defineProperty(p(n),"offsets",{value:new Map}),Object.defineProperty(p(n),"blockSrcs",{value:new Map}),n.args.blocks=n.blocks.list,n.meta={};var l=n.args.viewport.tileMap.tileLayers[n.args.layerId];if(l.properties){var f,h=c(l.properties);try{for(h.s();!(f=h.n()).done;){var y=f.value;n.meta[y.name]=y.value}}catch(t){h.e(t)}finally{h.f()}l.layer=p(n)}return n.offsetXChanged=0,n.offsetYChanged=0,n.fallSpeed=0,Object.preventExtensions(p(n)),n}return r=d,(n=[{key:"move",value:function(){var t=this.args.viewport,e=t.tileMap.tileLayers[this.args.layerId],r=t.actorsById[this.meta.controller];if(this.offsetXChanged=0,this.offsetYChanged=0,e&&(e.offsetXChanged=0,e.offsetYChanged=0),r){e&&(e.offsetX=this.args.offsetX,e.offsetY=this.args.offsetY);var n=(r.args.xLayer||0)-this.args.offsetX,i=(r.args.yLayer||0)-this.args.offsetY;this.args.offsetX=r.args.xLayer||0,this.args.offsetY=r.args.yLayer||0,e&&(e.offsetXChanged=n,e.offsetYChanged=i),this.offsetXChanged=n,this.offsetYChanged=i}else this.args.offsetX=0,this.args.offsetY=0;this.fallSpeed=this.fallSpeed||0}},{key:"onAttach",value:function(t){var e=this,r=this.args.viewport,n=r.tileMap.tileLayers[this.args.layerId],i=r.actorsById[this.meta.controller];n&&this.args.bindTo("destroyed",function(t){e.args.viewport.tileMap.tileLayers[e.args.layerId].destroyed=!!t,i&&(i.args.destroyed=!!t)})}},{key:"update",value:function(t){var e=this.args.viewport;if(this.args.destroyed&&this.tags.background){var r=e.tileMap,n=this.args.layerId;return r.tileLayers[n].destroyed=!0,void this.tags.background.style({display:"none"})}for(var i=this.args.blockSize,o=Math.ceil(this.args.width/i)+2,s=Math.ceil(this.args.height/i)+1,c=this.blocksXY,u=o/2,l=s/2,f=this.blocks,h=this.offsets,p=this.blockSrcs,g=this.args.offsetX,d=this.args.offsetY,y=this.args.layerId,b=o,v=0,m=-1;m<=b;m+=Math.sign(o)){for(var w=m+-Math.ceil(this.x/i)+-Math.ceil(g/i)+(g>0?1:0),S=0;S<=s;S+=Math.sign(s)){var O=String(m)+"::"+String(S),j=S+Math.floor(-this.y/i)+(this.offsetYChange<0?-Math.ceil(d/i):-Math.floor(d/i))+(d<0?-1:0),k=t.getTileNumber(w,j,y),x=void 0;if(c.has(O))x=c.get(O);else{x=new a.Tag(document.createElement("div")),c.set(O,x),x.style({width:i+"px",height:i+"px"});var P=i*m,_=i*S;x.style({transform:"translate(".concat(P,"px, ").concat(_,"px) scale(").concat("1.02",", ").concat("1.02",")"),position:"absolute",left:0,top:0}),f.add(x)}var M=[];y&&!1===k?(M[0]=-1,M[1]=-1):M=t.getTile(k);var R=h.get(x),T=p.get(x),A=M[0]*i*-1+"px "+M[1]*i*-1+"px",E=M[2];R===A&&T===E||(!1!==k&&0!==k?x.style({display:"initial","background-position":A,"background-image":"url(".concat(E,")"),"--screenX":(u-v)/u,"--screenY":(S-l)/l}):x.style({display:"none"})),h.set(x,A),p.set(x,E)}v++}this.tags.background&&this.tags.background.style({"--offsetX":-g%i,"--offsetY":-d%i})}}])&&l(r.prototype,n),u&&l(r,u),Object.defineProperty(r,"prototype",{writable:!1}),d}();t.Layer=d}),require.register("viewport/Viewport.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;var i=e("curvature/base/Bindable"),o=e("curvature/base/Bag"),a=(e("curvature/base/Tag"),e("curvature/base/View")),s=e("curvature/base/Router"),c=e("curvature/input/Keyboard"),u=e("curvature/input/Sequence"),l=(e("../QuadCell"),e("../timer/Countdown")),f=e("../audio/Bgm"),h=e("../audio/Sfx"),p=e("../tileMap/TileMap"),g=e("../titlecard/Titlecard"),d=e("../particle/Particle3d"),y=(e("../backdrop/MarbleGarden"),e("../backdrop/ProtoLabrynth"),e("../backdrop/MysticCave"),e("../intro/Series")),b=(e("../intro/Card"),e("../intro/TitleScreenCard")),v=e("../intro/ThankYouCard"),m=e("../intro/LoadingCard"),w=e("../intro/BootCard"),S=e("../intro/DebianCard"),O=e("../intro/WebkitCard"),j=e("../intro/GamepadCard"),k=e("../intro/WarningCard"),x=e("../intro/NoWayCard"),P=e("../intro/SeanCard"),_=e("../Menu/PauseMenu.js"),M=e("../Menu/MainMenu.js"),R=e("../actor/LayerSwitch"),T=e("../region/Region"),A=e("../ui/CharacterString"),E=(e("../ui/HudFrame"),e("./Layer")),C=e("../controller/Controller"),B=e("../BackdropPalette"),D=e("../ObjectPalette"),I=e("../ui/ClickSwitch"),F=e("subspace-console/Console"),L=e("../console/task/Input"),N=e("../console/task/Impulse"),q=e("../console/task/Settings"),W=e("../console/task/Move"),U=e("../console/task/Pos"),V=e("../console/task/Spawn"),H=e("../network/RtcClient"),G=e("../network/RtcServer"),z=e("../Classifier"),Y=e("../network/ChatBox"),K=e("../actor/Sonic"),J=e("../actor/Tails"),X=e("../actor/Knuckles"),$=e("../actor/Seymour"),Z=e("../actor/Chalmers");function Q(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||rt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=rt(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function et(t){return function(t){if(Array.isArray(t))return nt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||rt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rt(t,e){if(t){if("string"==typeof t)return nt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?nt(t,e):void 0}}function nt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function it(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ot(t,e){return(ot=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function at(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=ct(t);if(e){var o=ct(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return st(t)}(this,r)}}function st(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ct(t){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ut(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var lt=Symbol("actor-point-cache"),ft=(Symbol("collision-cells-near"),Symbol("collision-cells")),ht=Symbol("run"),pt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ot(t,e)}(ct,a.View);var r,n,rt,nt=at(ct);function ct(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,ct),r[i.Bindable.NoGetters]=!0,ut(st(t=nt.call(this,r,n)),"secretsFound",new Set),ut(st(t),"template",e("./viewport.html")),window.viewport=st(t),t.listen(window,"focus",function(e){return t.args.windowFocused="window-focused"}),t.listen(window,"blur",function(e){return t.args.windowFocused="window-blurred"}),t.args.windowFocused=document.hasFocus()?"window-focused":"window-blurred",t[i.Bindable.NoGetters]=!0,s.Router.listen(st(t),{"":function(){return""}}),t.args.screenEffects=[],t.meta={},t.characters={Sonic:K.Sonic,Tails:J.Tails,Knuckles:X.Knuckles},t.objectPalette=D.ObjectPalette,t.timers=new Map,t.callIntervals=new Map,t.callFrames=new Map,t.willDetach=new Map,t.backdrops=new Map,t.checkpoints=new Map,t.server=null,t.client=null,t.args.networked=!1,t.args.mouse="moved",t.settings=i.Bindable.make({audio:!0,blur:!0,displace:!0,showHud:!0,shortcuts:!0,showFps:!0,debugOsd:!1,outline:1,musicVol:50,sfxVol:75,username:"player"}),t.vizi=!0,t.args.shakeX=0,t.args.shakeY=0,t.args.level="";var a="",c=s.Router.query.map,p=!1;c&&c.match(/^\w/)&&(a="/map/"+c,p=!0),t.args.startFrameId=0,t.args.lastFrameId=-1,a&&t.loadMap({mapUrl:a}).catch(function(e){console.warn(e),t.args.titlecard=new y.Series({cards:[new x.NoWayCard({errorString:'Cannot load map "'.concat(c,'"!'),timeout:-1})]},st(t)),t.args.titlecard.play()}),t.sprites=new o.Bag,t.world=null;var g=s.Router.query.nointro,d=[];p&&(g=!0),g?d.push(new M.MainMenu({timeout:-1},st(t))):d.push.apply(d,et(t.introCards())),t.args.titlecard=new y.Series({cards:d},st(t)),a||t.args.titlecard.play(),t.args.noIntro=g?"no-intro":"";var b=new u.Sequence({keys:["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowUp","ArrowUp","ArrowUp","ArrowUp"],timing:750}),v=new u.Sequence({keys:["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowLeft","ArrowRight","ArrowLeft","ArrowRight","KeyB","KeyA","Enter"],timing:750}),m=new u.Sequence({keys:["KeyS","KeyV","KeyG","KeyR","KeyA","KeyV"],timing:750});for(var w in t.sequences=[b,v,m],t.args.debugEnabled=!1,t.args.debugEditMode=!1,t.args.debugObjectCursor=0,t.args.debugObjectName=new A.CharacterString({value:""}),t.debugBank={},t.args.interacted=!1,b.addEventListener("complete",function(e){t.args.debugEnabled||(t.args.debugEnabled=!0,console.log("Debug variable set."),t.args.topLine.args.value=" Debug variable set! ",t.args.topLine.args.hide="",t.onTimeout(1750,function(){t.args.topLine.args.value="",t.args.status.args.hide="hide"}))}),v.addEventListener("complete",function(e){t.args.masterCheat||(t.args.masterCheat=!0,t.args.topLine.args.value=" Master cheat detected. ",t.args.topLine.args.hide="",console.log("Master cheat detected."),t.onTimeout(1750,function(){t.args.topLine.args.value="",t.args.status.args.hide="hide"}))}),m.addEventListener("complete",function(e){t.controlActor&&(t.controlActor.gravityCheat=!t.controlActor.gravityCheat,t.args.topLine.args.value=" Gravity cheat ".concat(t.controlActor.gravityCheat?"on":"off",". "),t.args.topLine.args.hide="",t.onTimeout(1750,function(){t.args.topLine.args.value="",t.args.status.args.hide="hide"}),t.controlActor.gravityCheat?t.controlActor.args.gravity*=.5:t.controlActor.args.gravity*=2)}),t.args.pauseMenu=new _.PauseMenu({},st(t)),t.particleObserver=new IntersectionObserver(function(t,e){var r,n=tt(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;0===i.intersectionRation?(i.target.style.display="none",i.target.remove()):delete i.target.style.display}}catch(t){n.e(t)}finally{n.f()}},{threshold:0}),t.particles=new o.Bag(function(e,r,n){n===o.Bag.ITEM_ADDED?(e.node&&t.particleObserver.observe(e.node),e.node&&t.tags.particles.appendChild(e.node)):n===o.Bag.ITEM_REMOVED&&e.remove()}),t[ht]=0,t.effects=new o.Bag,t.maxCameraBound=64,t.cameraBound=64,t.args.particles=t.particles.list,t.args.effects=t.effects.list,t.args.maxFps=120,t.args.maxFps=60,t.args.currentActor="",t.args.xOffset=.5,t.args.yOffset=.5,t.args.xOffsetTarget=.5,t.args.yOffsetTarget=.75,t.args.topLine=new A.CharacterString({value:""}),t.args.status=new A.CharacterString({value:""}),t.args.focusMe=new A.CharacterString({value:""}),t.args.labelChar=new A.CharacterString({value:"Char: "}),t.args.labelX=new A.CharacterString({value:"x pos: "}),t.args.labelY=new A.CharacterString({value:"y pos: "}),t.args.demoIndicator=null,t.args.labelGround=new A.CharacterString({value:"Grounded: "}),t.args.labelCamera=new A.CharacterString({value:"Camera: "}),t.args.labelAngle=new A.CharacterString({value:"Gnd theta: "}),t.args.labelGSpeed=new A.CharacterString({value:"Gnd spd: "}),t.args.labelXSpeed=new A.CharacterString({value:"X air spd: "}),t.args.labelYSpeed=new A.CharacterString({value:"Y air spd: "}),t.args.labelLayer=new A.CharacterString({value:"Layer: "}),t.args.labelMode=new A.CharacterString({value:"Mode: "}),t.args.labelFrame=new A.CharacterString({value:"Frame ID: "}),t.args.labelIgnore=new A.CharacterString({value:"Ignore: "}),t.args.labelFps=new A.CharacterString({value:"FPS: "}),t.args.labelAirAngle=new A.CharacterString({value:"Air theta: "}),t.args.char=new A.CharacterString({value:"..."}),t.args.xPos=new A.CharacterString({value:0}),t.args.yPos=new A.CharacterString({value:0}),t.args.layer=new A.CharacterString({value:0}),t.args.gSpeed=new A.CharacterString({value:0,high:199,med:99,low:49}),t.args.ground=new A.CharacterString({value:""}),t.args.xSpeed=new A.CharacterString({value:0}),t.args.ySpeed=new A.CharacterString({value:0}),t.args.mode=new A.CharacterString({value:0}),t.args.angle=new A.CharacterString({value:0}),t.args.ignore=new A.CharacterString({value:0}),t.args.cameraMode=new A.CharacterString({value:0}),t.args.airAngle=new A.CharacterString({value:0}),t.args.nowPlaying=new A.CharacterString({value:"Now playing"}),t.args.trackName=new A.CharacterString({value:""}),t.args.hideNowPlaying="hide-now-playing",h.Sfx.addEventListener("play",function(e){t.args.audio||e.preventDefault()}),f.Bgm.addEventListener("play",function(e){if(t.bgm=t.meta.bgm,!t.args.audio)return e.preventDefault(),void(t.args.hideNowPlaying="hide-now-playing");if(!e.detail)return t.args.trackName.args.value="",void(t.args.hideNowPlaying="hide-now-playing");if(t.args.trackName.args.value=e.detail.TIT2+" by "+e.detail.TPE1,t.args.trackName.args.value){var r=Promise.resolve();t.args.zonecard&&(r=t.args.zonecard.played),r.then(function(){t.args.started&&(t.onFrameOut(60,function(){return t.args.hideNowPlaying=""}),t.timers.has(f.Bgm)?t.timers.get(f.Bgm).extendTo(600):t.timers.set(f.Bgm,new l.Countdown(600,function(){t.args.hideNowPlaying="hide-now-playing"})))})}}),f.Bgm.addEventListener("stop",function(t){}),f.Bgm.addEventListener("pause",function(t){}),f.Bgm.addEventListener("unpause",function(e){t.args.audio||e.preventDefault()}),t.args.fpsSprite=new A.CharacterString({value:0}),t.args.frame=new A.CharacterString({value:0}),t.args.scoreLabel=new A.CharacterString({value:"SCORE:",color:"yellow"}),t.args.timerLabel=new A.CharacterString({value:"TIME: ",color:"yellow"}),t.args.ringLabel=new A.CharacterString({value:"RINGS: ",color:"yellow"}),t.args.actClearLabel=new A.CharacterString({value:"",color:"yellow"}),t.args.dialogLines=[],t.args.perfectBonusLabel=new A.CharacterString({value:"PERFECT BONUS: ",color:"yellow"}),t.args.perfectBonus=new A.CharacterString({value:0}),t.args.speedBonusLabel=new A.CharacterString({value:"SPEED BONUS: ",color:"yellow"}),t.args.speedBonus=new A.CharacterString({value:0}),t.args.ringBonusLabel=new A.CharacterString({value:"RING BONUS: ",color:"yellow"}),t.args.ringBonus=new A.CharacterString({value:0}),t.args.timeBonusLabel=new A.CharacterString({value:"TIME BONUS: ",color:"yellow"}),t.args.timeBonus=new A.CharacterString({value:0}),t.args.airBonusLabel=new A.CharacterString({value:"AIR TIME: ",color:"yellow"}),t.args.airBonus=new A.CharacterString({value:"0%"}),t.args.totalBonusLabel=new A.CharacterString({value:"TOTAL: ",color:"yellow"}),t.args.totalBonus=new A.CharacterString({value:0}),t.args.rings=new A.CharacterString({value:0}),t.args.score=new A.CharacterString({value:0}),t.args.timer=new A.CharacterString({value:"00:00"}),t.args.ntsc="ntsc",t.args.frameId=-1,t.settings.bindTo("displace",function(e){return t.args.displacement=e?"on":"off"}),t.settings.bindTo("outline",function(e){return t.args.outline=e}),t.settings.bindTo("debugOsd",function(e){return t.args.debugOsd=e}),t.settings.bindTo("showHud",function(e){return t.args.showHud=e}),t.settings.bindTo("shortcuts",function(e){return t.args.shortcuts=e}),t.settings.bindTo("showFps",function(e){return t.args.showFps=e}),t.settings.bindTo("musicVol",function(t){return f.Bgm.setVolume(t/100)}),t.settings.bindTo("sfxVol",function(t){return h.Sfx.setVolume(t/100)}),t.args.emeralds=[],t.settings){var S=localStorage.getItem("sonic-3000-setting-v0.0.0="+w);try{var O;t.settings[w]=null!==(O=JSON.parse(S))&&void 0!==O?O:t.settings[w]}catch(t){console.warn(t)}}t.settings.bindTo(function(t,e){localStorage.setItem("sonic-3000-setting-v0.0.0="+e,JSON.stringify(t))}),t.args.blockSize=32,t.args.populated=!1,t.args.willStick=!1,t.args.stayStuck=!1,t.args.willStick=!0,t.args.stayStuck=!0,t.args.width=512,t.args.height=288,t.args.scale=2,s.Router.query.noScale&&(t.args.width=896,t.args.height=512,t.args.scale=1),s.Router.query.bigScale&&(t.args.width=1920,t.args.height=1088,t.args.scale=1),t.collisions=new Map,t.args.x=t.args.x||0,t.args.y=t.args.y||0,t.args.fgLayers=[],t.args.layers=[],t.args.animation="",t.regions=new Set,t.spawn=new Set,t.auras=new Set,t.recent=new Set,t.actorsByName={},t.actorsById={},t.playable=new Set,t.actors=new o.Bag(function(e,r,n){n==o.Bag.ITEM_ADDED?(e.viewport=st(t),t.setColCell(e),e instanceof T.Region&&t.regions.add(e),e.controllable&&t.playable.add(e),t.actorsByName[e.args.name]=e,t.actorsById[e.args.id]=e,t.objectDb.add(e)):n==o.Bag.ITEM_REMOVED&&(e.viewport=null,e.remove(),e[ft]&&(t.playable.delete(e),e[ft].delete(e)),e instanceof T.Region&&t.regions.delete(e),t.auras.delete(e),delete t.actorsById[e.args.name],delete t.actorsById[e.args.id],delete e[ft],t.objectDb.remove(e))});return t.layerDb=new z.Classifier([/^Art\s+$/,/^Collision\s+$/,/^Destructible\s+$/],function(){}),t.objectDb=new z.Classifier(Object.values(D.ObjectPalette)),t.blocks=new o.Bag,t.args.blocks=t.blocks.list,t.args.actors=t.actors.list,t.listen(window,"gamepadconnected",function(e){return t.padConnected(e)}),t.listen(window,"gamepaddisconnected",function(e){return t.padRemoved(e)}),t.colCellDiv=.75*(t.args.width>t.args.height?t.args.width:t.args.height),t.colCellCache=new Map,t.colCells=new Map,t[lt]=new Map,t.startTime=null,t.args.audio=!1,t.nextControl=!1,t.updateStarted=new Set,t.updateEnded=new Set,t.updated=new Set,t.args.xBlur=0,t.args.yBlur=0,t.args.isRecording=!1,t.args.isReplaying=!1,t.replayInputs=[],t.replayFrames=new Map,t.args.standalone="",t.args.fullscreen="",t.args.initializing="initializing",t.args.muteSwitch=new I.ClickSwitch,t.args.muteSwitch.args.active=!1,t.args.bindTo("interacted",function(e){e&&(t.args.muteSwitch.args.active=t.getAudioSetting(),t.args.muteSwitch.args.bindTo("active",function(e){return t.args.audio=e}),t.args.bindTo("audio",function(e){localStorage.setItem("sonic-3000-audio-enabled",e),t.onNextFrame(function(){return e?f.Bgm.unpause():f.Bgm.pause()})}))}),t.args.showConsole=null,t.listen(document,"keydown",function(e){"Escape"===e.key&&(t.args.showConsole=!1),"F10"!==e.key&&"`"!==e.key||(t.args.subspace||(t.args.subspace=new F.Console({scroller:t.tags.subspace,path:{input:L.Input,move:W.Move,impulse:N.Impulse,pos:U.Pos,set:q.Settings,spawn:V.Spawn}})),t.args.showConsole=t.args.showConsole?null:"showConsole",e.preventDefault())}),t.args.bindTo("shakeY",function(e,r,n,i,o){t.controlActor&&t.controlActor.controller&&t.controlActor.controller.rumble&&(Math.abs(e)>40&&Math.abs(e)>Math.abs(o)?t.controlActor.controller&&t.controlActor.controller.rumble({duration:4*e,strongMagnitude:1,weakMagnitude:1}):Math.abs(e)>20&&Math.abs(e)>Math.abs(o)?t.controlActor.controller&&t.controlActor.controller.rumble({duration:8*e,strongMagnitude:e/20,weakMagnitude:1}):Math.abs(e)>1&&t.controlActor.controller&&t.controlActor.controller.rumble({duration:16*e,strongMagnitude:.1,weakMagnitude:1}))}),t.args.bindTo("showConsole",function(e){t.args.subspace&&(e?(t.onNextFrame(function(){return t.args.subspace.focus()}),t.args.showConsole="showConsole"):(t.onNextFrame(function(){return t.tags.viewport.focus()}),t.args.showConsole=null))}),t.controller=new C.Controller({deadZone:.2}),t.controller.zero(),t}return r=ct,(n=[{key:"loadMap",value:function(t){var e=this,r=t.mapUrl,n=t.networked,i=void 0!==n&&n,o=new p.TileMap({mapUrl:r});this.currentMap=r,this.args.networked=i,this.tileMap=o,this.args.started=!1,this.args.running=!1;var a=new m.LoadingCard({timeout:-1,text:"loading ... 0%"},this);return o.addEventListener("level-progress",function(t){var e=t.detail,r=(e.received,e.length,e.done);a.args.text="loading level ... ".concat((100*r).toFixed(4),"%")}),o.addEventListener("texture-progress",function(t){var e=t.detail,r=(e.received,e.length,e.done);a.args.text="loading textures ... ".concat((100*r).toFixed(4),"%"),1===r&&(a.args.text="initializing...")}),o.ready.then(function(){e.args.layers.length=0;for(var t=e.tileMap.tileLayers,r=t.length,n=0;n<r;n++){var i=new E.Layer({layerId:n,viewport:e,name:t[n].name,width:e.args.width,height:e.args.height});"Foreground"===t[n].name.substring(0,10)?e.args.fgLayers.push(i):e.args.layers.push(i)}}),this.args.titlecard=new y.Series({cards:[a]},this),this.args.titlecard.play(),o.ready.then(function(){return e.startLevel()})}},{key:"fullscreen",value:function(){var t=this;this.exitFullscreen(),this.args.focusMe.args.hide="hide",this.initScale=this.args.scale,this.showStatus(3500," hit escape to revert. "),this.tags.viewport.node.requestFullscreen().then(function(e){t.onTimeout(100,function(){t.fitScale(),t.args.fullscreen="fullscreen"})}).catch(function(t){return console.error(t)})}},{key:"exitFullscreen",value:function(){if(document.fullscreenElement)return document.exitFullscreen(),this.showStatus(0,""),this.args.focusMe.args.hide="",void(this.args.fullscreen="")}},{key:"fitScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=window.innerHeight/this.args.height,r=window.innerWidth/this.args.width;this.args.scale=t?e>r?e:r:e>r?r:e,this.tags.frame&&this.tags.frame.style({"--width":this.args.width,"--height":this.args.height,"--scale":this.args.scale})}},{key:"showStatus",value:function(t,e){var r=this;this.args.status.args.hide="",this.args.status.args.value=e,t>=0&&this.onTimeout(t,function(){r.args.status.args.hide="hide"})}},{key:"getAudioSetting",value:function(){var t;return!!JSON.parse(null===(t=localStorage.getItem("sonic-3000-audio-enabled"))||void 0===t||t)}},{key:"onAttached",value:function(t){var e=this;q.Settings.viewport=this,N.Impulse.viewport=this,L.Input.viewport=this,W.Move.viewport=this,U.Pos.viewport=this,V.Spawn.viewport=this,this.buildDetect(),this.cpuDetect(),this.gpuDetect(),this.onTimeout(100,function(){return e.fitScale(!1)}),this.onTimeout(5500,function(){return e.args.ntsc=""});var r=this.getAudioSetting();this.onTimeout(s.Router.query.map||s.Router.query.nointro?0:8e3,function(){e.args.bindTo("interacted",function(t){var n=!t&&r?" Click here to enable audio. ":" Click here to enable keyboard control. ";e.args.focusMe.args.value!==n&&(e.args.focusMe.args.value="",e.args.focusMe.args.value=n)},{wait:250})}),this.tags.blurDistance.setAttribute("style","filter:url(#motionBlur)"),this.tags.blurDistanceFg.setAttribute("style","filter:url(#motionBlur)"),this.listen(this.tags.frame,"click",function(t){t.target===e.tags.frame.node&&e.tags.viewport.focus()}),this.listen(window,"resize",function(t){e.onTimeout(100,function(){return e.fitScale(!1)})}),this.listen(document,"fullscreenchange",function(t){if(e.onTimeout(100,function(){return e.fitScale(!1)}),!document.fullscreenElement)return e.args.scale=e.initScale,void(e.args.fullscreen="")}),this.tags.frame.style({"--width":this.args.width,"--height":this.args.height,"--scale":this.args.scale}),this.startTime||(this.startTime=0),this.args.started=!1,this.args.running=!1,this.args.paused=!1,this.listen(document.body,"click",function(t){t.target===document.body&&e.tags.viewport.focus()}),this.args.scale=this.args.scale||1;var n=c.Keyboard.get();n.listening=!0,n.focusElement=this.tags.viewport.node,n.codes.bindTo(function(t,r,n,i){-1===t&&e.sequences.map(function(t){return t.check(r)})}),this.tags.viewport.node.focus(),(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: fullscreen)").matches)&&(this.args.standalone="standalone",document.title="Sonic 3000",this.listen(window,"resize",function(){return e.fitScale(!1)}),this.onTimeout(100,function(){return e.fitScale(!1)})),this.onTimeout(100,function(){return e.args.initializing=""})}},{key:"setZoneCard",value:function(){if(this.args.zonecard=new g.Titlecard({waitFor:this.tileMap.ready},this),this.tileMap.mapData&&this.tileMap.mapData.properties){var t,e=tt(this.tileMap.mapData.properties);try{for(e.s();!(t=e.n()).done;){var r=t.value,n=r.name.replace(/-/g,"_");this.meta[n]=r.value}}catch(t){e.e(t)}finally{e.f()}}var i=this.meta.titlecard_title_1,o=this.meta.titlecard_title_2,a=this.meta.titlecard_author,s=this.meta.titlecard_number;return this.args.zonecard.args.firstLine=i,this.args.zonecard.args.secondLine=o,this.args.zonecard.args.creditLine=a,this.args.zonecard.args.actNumber=s,this.args.actName="".concat(i," ").concat(o," ").concat(s),this.args.titlecard=new y.Series({cards:[this.args.zonecard]},this),this.args.titlecard.play()}},{key:"fillBackground",value:function(){if(!this.meta.backdrop||this.args.bg!==this.meta.backdrop){var t=B.BackdropPalette[this.meta.backdrop];delete this.args.backdrop,this.args.backdrop=t?new t:null,this.args.theme=this.meta.theme||"construct",this.args.bg=this.meta.backdrop}}},{key:"startLevel",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.clearDialog(),this.hideDialog(),e&&this.setZoneCard(),this.meta.bgm?f.Bgm.playing&&this.meta.bgm!==this.bgm?f.Bgm.fadeOut(250).then(function(){f.Bgm.play(t.meta.bgm,!0)}):f.Bgm.play(this.meta.bgm,!0):f.Bgm.fadeOut(250),this.args.audio||f.Bgm.pause(),this.args.startFrameId=this.args.frameId,this.fillBackground(),this.populateMap(),this.args.networked){var r=new Z.Chalmers({name:"Player 1"},this),n=new $.Seymour({name:"Player 2"},this),i=this.defsByName.get("player-start");r.args.x=i.x,r.args.y=i.y,n.args.x=i.x,n.args.y=i.y,this.spawn.add({object:r}),this.spawn.add({object:n}),this.auras.add(r),this.auras.add(n),this.actors.add(r),this.actors.add(n),1===this.args.playerId?(this.nextControl=r,this.remotePlayer=n):2===this.args.playerId&&(this.remotePlayer=r,this.nextControl=n)}for(var o=0,a=[].concat(et(this.args.layers),et(this.args.fgLayers));o<a.length;o++){a[o].args.destroyed=!1}if(!this.args.networked){this.actors.list;this.playableIterator||(this.playableIterator=this.playable.entries()),Object.values(this.args.actors)[0]&&Object.values(this.args.actors)[0].controllable&&(this.nextControl=Object.values(this.args.actors)[0])}this.nextControl&&this.nextControl.controller?this.nextControl.controller.zero():this.controller&&this.controller.zero(),c.Keyboard.get().reset(),this.args.started=!1,f.Bgm.unpause(),this.args.zonecard.played.then(function(){if(t.args.startFrameId=t.args.frameId,s.Router.query.start){var e=s.Router.query.start;if(e.match(/\d+(\.\d+)?,\d+(\.\d+)?/)){var r=Q(e.split(","),2),n=r[0],i=void 0===n?128:n,o=r[1],a=void 0===o?128:o;t.nextControl.args.x=Number(i),t.nextControl.args.y=Number(a)}else if(t.defsByName.has(e)){var c=t.defsByName.get(e);t.nextControl.args.x=Number(c.x),t.nextControl.args.y=Number(c.y)}t.nextControl.follower&&(t.nextControl.follower.args.x=t.nextControl.x,t.nextControl.follower.args.y=t.nextControl.y,t.setColCell(t.nextControl.follower))}else if(!t.args.isReplaying&&!t.args.isRecording&&(t.args.demoIndicator=null,t.nextControl)){var u=t.getCheckpoint(t.nextControl.args.canonical);if(u){var l=u?t.actorsById[u.checkpointId]:null;l&&(t.args.startFrameId=t.args.frameId-u.frames,l.args.wasActive=!0,l.args.active=!0,t.nextControl.args.x=l.x,t.nextControl.args.y=l.y,t.nextControl.follower&&(t.nextControl.follower.args.x=l.x,t.nextControl.follower.args.y=l.y,t.setColCell(t.nextControl.follower)),t.args.xOffset=.5,t.args.yOffset=.5)}}t.args.level="level",t.args.fade=!1,t.args.started=!0,t.args.running=!0,t.startTime=Date.now(),"function"==typeof ga&&ga("send","event",{eventCategory:"zone",eventAction:"started",eventLabel:"".concat(t.args.actName)})})}},{key:"takeInput",value:function(t){var e=c.Keyboard.get();if(e.update(),this.gamepad||this.args.cutScene)if(this.args.cutScene)this.controlActor.args.idleTime=0;else for(var r=navigator.getGamepads(),n=0;n<r.length;n++){var i=r[n];if(i)if(t.readInput({keyboard:e,gamepad:i}),i){var o=String(i.id);o.match(/xbox/i)?this.args.inputType="input-xbox":o.match(/playstation/i)?this.args.inputType="input-playstation":this.args.inputType="input-generic"}else this.args.inputName="keyboard",this.args.inputType="input-keyboard"}else t.readInput({keyboard:e}),this.args.inputType="input-keyboard";if(this.controlActor&&this.args.debugEditMode){if(t.buttons[0]&&1===t.buttons[0].time){var a=Object.keys(D.ObjectPalette)[this.args.debugObjectCursor];this.debugBank[a]||(this.debugBank[a]=new D.ObjectPalette[a]);var s=this.debugBank[a];this.spawn.add({object:s}),s.controllable&&(s.args.name="SPAWN",this.playable.add(s)),s[ht]=this[ht],s.args.x=this.controlActor.x,s.args.y=this.controlActor.y,delete this.debugBank[a]}if(t.buttons[1]&&1===t.buttons[1].time){this.args.debugObjectCursor++;var u=Object.keys(D.ObjectPalette);this.args.debugObjectCursor>=u.length&&(this.args.debugObjectCursor=0);var l=u[this.args.debugObjectCursor];for(this.debugBank[l]||(this.debugBank[l]=new D.ObjectPalette[l]);this.tags.spawnPreview.node.firstChild;)this.tags.spawnPreview.node.firstChild.remove();this.debugBank[l].render(this.tags.spawnPreview.node),this.args.debugObjectName.args.value=l}if(t.buttons[2]&&1===t.buttons[2].time){this.args.debugObjectCursor--;var f=Object.keys(D.ObjectPalette);this.args.debugObjectCursor<=0&&(this.args.debugObjectCursor=f.length-1);var h=f[this.args.debugObjectCursor];for(this.debugBank[h]||(this.debugBank[h]=new D.ObjectPalette[h]);this.tags.spawnPreview.node.firstChild;)this.tags.spawnPreview.node.firstChild.remove();this.debugBank[h].render(this.tags.spawnPreview.node),this.args.debugObjectName.args.value=h}}if(this.args.debugEnabled&&t.buttons[8]&&1===t.buttons[8].time&&(this.args.debugEditMode=!this.args.debugEditMode,this.settings.debugOsd=this.args.debugEditMode),t.buttons[2011]&&1===t.buttons[2011].time&&this.fullscreen(),t.buttons[2008]&&1===t.buttons[2008].time&&(this.args.muteSwitch.args.active=!this.args.muteSwitch.args.active),t.buttons[2009]&&1===t.buttons[2009].time&&(this.settings.debugOsd=!this.settings.debugOsd),t.buttons[1020]&&1===t.buttons[1020].time&&(this.args.fullscreen||(this.args.paused?this.unpauseGame():this.pauseGame()),this.exitFullscreen()),!this.args.networked&&t.buttons[1011]&&t.buttons[1011].time>0&&this.args.pauseMenu.input(t),!this.args.networked&&!this.args.paused&&!this.dontSwitch&&t.buttons[11]&&1===t.buttons[11].time){this.playableIterator=this.playableIterator||this.playable.entries();var p=this.playableIterator.next();p.done&&(this.playableIterator=!1,this.playableIterator=this.playable.entries(),p=this.playableIterator.next()),p.value&&(this.nextControl=p.value[0],this.dontSwitch=3)}if(this.args.started&&(this.controlActor&&(this.args.currentSheild=this.controlActor.args.currentSheild?this.controlActor.args.currentSheild.type:""),t.buttons[9]&&t.buttons[9].active&&1===t.buttons[9].time&&(this.args.paused?this.unpauseGame():this.pauseGame()),this.args.isRecording)){this.args.demoIndicator||(this.args.demoIndicator=new A.CharacterString({value:" REC",color:"red"}));var g=this.args.frameId,d=t.serialize(),y={};this.controlActor&&(y=ut({},this.controlActor.args.id,{x:this.controlActor.args.x,y:this.controlActor.args.y,gSpeed:this.controlActor.args.gSpeed,xSpeed:this.controlActor.args.xSpeed,ySpeed:this.controlActor.args.ySpeed})),this.replayInputs[g]={frame:g,input:d,args:y}}t.update({gamepad:this.gamepad})}},{key:"moveCamera",value:function(){if(this.controlActor){this.cameraBound<=this.maxCameraBound?this.cameraBound=this.maxCameraBound:this.cameraBound-=.05*this.cameraBound;var t=30,e=this.controlActor;if(e.args.standingOn&&e.args.standingOn.isVehicle&&(e=e.args.standingOn),e.focused){if("panning"!==this.cameraMode&&"panning"===e.args.cameraMode){var r=e.focused;this.cameraBound=this.maxCameraBound=Math.max(Math.abs(r.x-e.x),Math.abs(r.y-e.y)),this.args.x-=e.x-r.x,this.args.y-=e.y-r.y}this.cameraMode=e.args.cameraMode,e=e.focused}else this.cameraMode=e.args.cameraMode;var n=e.args.highJump,i=e.args.deepJump,o=(e.args.falling,e.args.ySpeed);switch(this.cameraMode){case"panning":this.args.xOffsetTarget=.5,this.args.yOffsetTarget=.85,t=8;break;case"cutScene":this.args.xOffsetTarget=[.5,.25,.5,.75][e.args.mode],this.args.yOffsetTarget=[.75,.5,.25,.5][e.args.mode],this.maxCameraBound=64,t=15;break;case"corkscrew":this.args.xOffsetTarget=.5,this.args.yOffsetTarget=.75,this.maxCameraBound=96,t=64;break;case"normal":this.args.xOffsetTarget=[.5,.25,.5,.75][e.args.mode],this.args.yOffsetTarget=[.55,.5,.45,.5][e.args.mode],this.maxCameraBound=64,t=24;break;case"airplane":var a=e.args.xSpeed,s=Math.abs(a);t=20;var c=Math.max(s/100,.45)*-Math.sign(a);this.args.xOffsetTarget=.5+c,this.args.yOffsetTarget=.5;break;case"aerial":this.args.xOffsetTarget=.5,t=25,e.args.flying||!i&&!n?this.args.yOffsetTarget=.5:this.args.yOffsetTarget=o<0?.75:.35;break;case"hooked":this.args.xOffsetTarget=.5,this.args.yOffsetTarget=.6,this.maxCameraBound=1,t=25;break;case"tube":this.args.xOffsetTarget=.5,this.args.yOffsetTarget=.5,this.maxCameraBound=64,t=45;break;case"cinematic":this.args.xOffsetTarget=.5,this.args.yOffsetTarget=.5,this.maxCameraBound=1,t=0;break;case"cliff":this.args.xOffsetTarget=.5+-.02*e.args.direction,this.args.yOffsetTarget=.45,t=30;break;case"bridge":this.args.xOffsetTarget=.5,this.args.yOffsetTarget=.4,t=18;break;case"boss":this.args.xOffsetTarget=.5,this.args.yOffsetTarget=.72,this.maxCameraBound=64,t=24;break;case"draggable":this.args.xOffsetTarget=.5,this.args.yOffsetTarget=.5,this.maxCameraBound=48,t=3;break;default:this.maxCameraBound=64,t=25}var u=e.args.gSpeed,l=e.args.xSpeed;if(["normal","bridge","cliff","aerial","hooked","cutScene","tube","hooked","corkscrew"].includes(this.cameraMode)&&!e.args.pushing&&e.args.modeTime>0){e.args.hangingFrom&&(l=e.args.hangingFrom.args.xSpeed),e.args.standingLayer&&(u+=e.args.standingLayer.offsetXChanged);var f=!e.args.falling,h=Math.abs(f?u:l),p=Math.min(h/17,1)*-Math.sign(u||l);switch(e.args.mode){case 0:this.args.xOffsetTarget+=.4*p;break;case 1:this.args.yOffsetTarget+=.4*p;break;case 2:this.args.xOffsetTarget-=.4*p;break;case 3:this.args.yOffsetTarget-=.4*p}this.args.speedBias=p}this.args.xOffsetTarget=Math.max(0,Math.min(1,this.args.xOffsetTarget)),e.args.jumping&&e.args.fallTime>15&&(this.maxCameraBound=128,(i||n)&&(t*=.75));var g=0,d=512,y=0;if("boss"!==this.cameraMode&&"rocket"!==this.cameraMode&&e.args.modeTime>0&&(e.args.falling||1!==e.args.mode?e.args.falling||3!==e.args.mode||(d=e.args.gSpeedMax,y=-e.args.gSpeed/12):(d=e.args.gSpeedMax,y=e.args.gSpeed/12),e.args.rolling&&(y/=4),e.args.falling&&e.args.ySpeed>0&&((i||n)&&(y=e.args.ySpeed),e.args.ySpeed>0?g+=e.args.ySpeed>24?.5:0:g+=e.args.deepJump||e.args.ySpeed<-24?-.5:0),e.args.hangingFrom&&(y=e.args.ySpeed),g+=y/d,e.args.hangingFrom&&(g+=.2)),this.args.yOffsetTarget+=e.args.cameraBias-g,t){var b=this.args.xOffsetTarget-this.args.xOffset,v=this.args.yOffsetTarget-this.args.yOffset;this.args.xOffset+=b/t,this.args.yOffset+=v/t}else this.args.xOffset=this.args.xOffsetTarget,this.args.yOffset=this.args.yOffsetTarget;var m=e.rotatePoint(0,-e.args.height/2),w=m[0]+-e.x,S=m[1]+-e.y,O=w+m[0]+this.args.width*this.args.xOffset,j=S+m[1]+this.args.height*this.args.yOffset,k=this.args.x+-O,x=this.args.y+-j,P=Math.sqrt(Math.pow(k,2)+Math.pow(x,2)),_=Math.atan2(x,k),M=this.cameraBound,R=Math.min(M,P),T=Math.abs(R/M),A=R/("panning"===this.cameraMode?6:12),E=O+R*Math.cos(_),C=j+R*Math.sin(_);E-=T*Math.cos(_)*A,C-=T*Math.sin(_)*A/2,E>0&&!this.meta.wrapX&&(E=0),C>0&&!this.meta.wrapY&&(C=0);var B=this.meta.deathLine||32*this.tileMap.mapData.height,D=-32*this.tileMap.mapData.width+this.args.width,I=-B+this.args.height;E<D&&!this.meta.wrapX&&(E=D),C<I&&!this.meta.wrapY&&(C=I),this.args.shakeX*=-.95,this.args.shakeY*=-.95,e.args.dead&&!e.args.respawning?this.args.x=E+this.args.shakeX:(this.args.x=E+this.args.shakeX,this.args.y=C+this.args.shakeY)}}},{key:"applyMotionBlur",value:function(){var t=this.controlActor;if(this.settings.blur&&t&&this.tags.blur){var e=this.args.x-this.xPrev,r=this.args.y-this.yPrev,n=Math.pow(Number(e)/5,2),i=Math.pow(Number(r)/5,2);n=n<32?n:32,i=i<32?i:32;var o=Math.sqrt(Math.pow(n,2)+Math.pow(i,2))/3,a=Math.atan2(r,e);o>.5?(this.tags.blurAngle.setAttribute("style","transform:rotate(calc(1rad * ".concat(a,"))")),this.tags.blurAngleFg.setAttribute("style","transform:rotate(calc(1rad * ".concat(a,"))")),this.tags.blurAngleCancel.setAttribute("style","transform:rotate(calc(-1rad * ".concat(a,"))")),this.tags.blurAngleCancelFg.setAttribute("style","transform:rotate(calc(-1rad * ".concat(a,"))")),this.tags.blur.setAttribute("stdDeviation","".concat(.75*o-1,", 0"))):(this.tags.blurAngle.setAttribute("style","transform:none;"),this.tags.blurAngleFg.setAttribute("style","transform:none;"),this.tags.blurAngleCancel.setAttribute("style","transform:none;"),this.tags.blurAngleCancelFg.setAttribute("style","transform:none;"),this.tags.blur.removeAttribute("stdDeviation")),this.xPrev=this.args.x,this.yPrev=this.args.y}else this.tags.blurAngle.setAttribute("style","transform:none;"),this.tags.blurAngleFg.setAttribute("style","transform:none;"),this.tags.blurAngleCancel.setAttribute("style","transform:none;"),this.tags.blurAngleCancelFg.setAttribute("style","transform:none;"),this.tags.blur.removeAttribute("stdDeviation")}},{key:"updateBackground",value:function(){var t=this.controlActor;t&&t.standingOn&&t.standingOn.isVehicle&&(t=this.controlActor.standingOn),this.tags.bgFilters.style({"--x":this.args.x,"--y":this.args.y}),this.tags.content.style({"--x":this.args.x,"--y":this.args.y,"--outlineWidth":this.settings.outline+"px"});var e=this.args.x<=0?this.args.x%this.args.blockSize:(-this.args.blockSize+this.args.x%this.args.blockSize)%this.args.blockSize,r=this.args.y<=0?this.args.y%this.args.blockSize:(-this.args.blockSize+this.args.y%this.args.blockSize)%this.args.blockSize;this.tags.background.style({transform:"translate( ".concat(e,"px, ").concat(r,"px )")}),this.tags.foreground.style({transform:"translate( ".concat(e,"px, ").concat(r,"px )")}),this.tags.frame.style({"--width":this.args.width,"--height":this.args.height,"--scale":this.args.scale})}},{key:"updateBackdrops",value:function(){var t,e=this,r=tt(this.backdrops);try{for(r.s();!(t=r.n()).done;){var n=Q(t.value,2)[1];if(!n.view){var i,o={},a="",s=tt(n.properties);try{for(s.s();!(i=s.n()).done;){var c=i.value;"backdrop"!==c.name?o[c.name]=c.value:a=c.value}}catch(t){s.e(t)}finally{s.f()}o.width=n.width,o.height=n.height,o.bX=n.x,o.bY=n.y;var u=B.BackdropPalette[a];u&&(n.view=new u(o,this),n.view.render(this.tags.backdrops))}this.args.width,this.args.x,n.x,n.width,this.args.x,n.x;var l=this.args.height+-this.args.y+-n.y,f=-(-n.height-this.args.y-n.y),h=this.tileMap?-32*this.tileMap.mapData.width:Math.pow(2,9);this.tileMap?this.tileMap.mapData.height:Math.pow(2,9);n.view&&Object.assign(n.view.args,{x:this.args.x,xPan:this.args.x,xMax:h,y:this.args.y+n.y,yMax:this.args.y+n.y+-n.view.stacked,stacked:-n.view.stacked+"px",frame:this.args.frameId,top:l,bottom:f})}}catch(t){r.e(t)}finally{r.f()}this.tileMap&&this.tileMap.ready.then(function(){var t=e.tileMap?-32*e.tileMap.mapData.width:Math.pow(2,9),r=e.tileMap?-32*e.tileMap.mapData.height:Math.pow(2,9);e.args.backdrop&&Object.assign(e.args.backdrop.args,{x:0,xPan:e.args.x,y:e.args.y+e.args.yOffset,xMax:null!==t&&void 0!==t?t:0,yMax:null!==r&&void 0!==r?r:0,frame:e.args.frameId,stacked:-e.args.backdrop.stacked+"px"})})}},{key:"populateMap",value:function(){if(!this.args.populated){this.tileMap.mapData.width,this.tileMap.mapData.height;this.args.populated=!0;var t=this.tileMap.getObjectDefs();this.defsByName=new Map,this.objDefs=new Map;var e,r=tt(this.backdrops);try{for(r.s();!(e=r.n()).done;){var n=Q(e.value,2),o=n[0],a=n[1];a.view&&(a.view.remove(),a.view=void 0),this.backdrops.delete(o)}}catch(t){r.e(t)}finally{r.f()}var c,u=tt(this.particles.list);try{for(u.s();!(c=u.n()).done;){var l=c.value;l&&(l.remove(),this.particles.remove(l))}}catch(t){u.e(t)}finally{u.f()}var f=String(this.args.selectedChar||s.Router.query.char||"Sonic").toLowerCase(),h=new(D.ObjectPalette[f]||K.Sonic)({name:f},this);for(var p in t){var g=t[p],y=g.type;if("particle"===y){var b=new d.Particle3d;b.style({"--x":g.x,"--y":g.y}),this.particles.add(b.node)}if("backdrop"!==y){if(this.defsByName.set(g.name,g),this.objDefs.set(g.id,g),D.ObjectPalette[y]){var v=D.ObjectPalette[y].fromDef(g);v[ht]=this[ht],v[i.Bindable.NoGetters]=!0;var m=i.Bindable.make(v);this.actors.add(m),m.render(this.tags.actors),this.actorIsOnScreen(m)||m.isRegion?m.args.display=m.defaultDisplay||null:(m.args.display="none",m.detach()),(m.onAttach&&!1===m.onAttach()||m.args.hidden)&&(m.args.display="none",m.detach()),m.controllable&&(m.name=g.name,m.args.display=m.defaultDisplay||null)}}else this.backdrops.set(g.id,g)}if(!this.args.networked){var w="player-start";!h.canRoll&&this.defsByName.has("wide-player-start")&&(w="wide-player-start");var S=this.defsByName.get(w);h.args.x=S.x,h.args.y=S.y,h.args.z=S.z=10,h.args.animation="dropping";var O=String(this.args.followerChar||s.Router.query.follower||"").toLowerCase();if(O){var j=new(D.ObjectPalette[O]||J.Tails)({following:!0,name:O,x:h.args.x,y:h.args.y,z:h.args.z-1},this);this.spawn.add({object:j}),this.auras.add(j),this.actors.add(j),h.follower=j}if(this.spawn.add({object:h}),this.auras.add(h),this.actors.add(h),S.properties){var k,x=tt(S.properties);try{for(x.s();!(k=x.n()).done;){var P=k.value;h.args[P.name]=P.value}}catch(t){x.e(t)}finally{x.f()}}this.nextControl=h}this.onFrameOut(1,function(){h.follower&&(h.follower.args.x=h.args.x,h.follower.args.y=h.args.y)});var _,M=tt(this.actors.list);try{for(M.s();!(_=M.n()).done;){var R=_.value;if(R){var T=this.getCheckpoint(R.args.id);if(T&&T.checkpointId){var A=this.actorsById[T.checkpointId];A.args.active=!0,A&&(R.args.x=A.x,R.args.y=A.y)}}}}catch(t){M.e(t)}finally{M.f()}}}},{key:"actorIsOnScreen",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:512;if(t){var r=this.args.width,n=this.args.height,i=-this.args.x-16-e,o=16-this.args.x+e+r,a=-this.args.y-e,s=-this.args.y+n+e,c=t.args.width,u=t.y-t.args.height,l=t.x-(t.isRegion?0:c/2);return!(i>t.x+(t.isRegion?c:c/2)||l>o)&&!(a>t.y||u>s)}}},{key:"spawnActors",value:function(){var t,e=new DocumentFragment,r=(new DocumentFragment,!1),n=tt(this.spawn);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o.frame){if(o.frame<=this.args.frameId){this.spawn.delete(o),o.object[i.Bindable.NoGetters]=!0,o.object[ht]=this[ht],o.object.startFrame=this.args.frameId,this.actors.add(i.Bindable.make(o.object));o.object,T.Region;var a=e;o.object.render(a),o.object.onRendered(),o.object.onAttach&&!1===o.object.onAttach()&&(o.object.args.hidden||o.object.detach()),r=!0}}else this.spawn.delete(o),o.object[i.Bindable.NoGetters]=!0,o.object[ht]=this[ht],o.object.startFrame=this.args.frameId,this.actors.add(i.Bindable.make(o.object)),o.object.render(e),o.object.onRendered(),o.object.onAttached&&o.object.onAttached(),o.object.onAttach&&!1===o.object.onAttach()&&o.object.detach(),r=!0}}catch(t){n.e(t)}finally{n.f()}r&&this.tags.actors.append(e)}},{key:"actorUpdateStart",value:function(t){this.updateStarted.has(t)||(this.updateStarted.add(t),t.updateStart(),t.colliding&&(t.colliding=!1))}},{key:"actorUpdate",value:function(t){this.updated.has(t)||(this.updated.add(t),t.update())}},{key:"actorUpdateEnd",value:function(t){this.updateEnded.has(t)||(this.updateEnded.add(t),t.args.colliding=t.colliding,t.updateEnd(),this.setColCell(t))}},{key:"nearbyActors",value:function(t){var e=this.getNearbyColCells(t),r=(this.args.width,this.args.height,this.args.x,this.args.y,new Set);for(var n in e){var i,o=tt(e[n]);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.removed||r.add(a)}}catch(t){o.e(t)}finally{o.f()}}return r}},{key:"update",value:function(){var t=this;this.args.paused>0&&this.args.paused--;var e=this.controlActor?this.controlActor.controller:this.controller;if(this.args.frameId%600==0&&(ga("set","metric1",this.args.frameId/60),"function"==typeof ga&&ga("send","event",{eventCategory:"fps-check",eventAction:"fps-check::".concat(navigator.platform,"::cores_").concat(navigator.hardwareConcurrency),eventLabel:"".concat(this.args.actName),eventValue:Math.trunc(this.args.fps)})),this.args.started||(this.startTime=Date.now(),e&&(this.takeInput(e),this.args.titlecard&&this.args.titlecard.input(e))),!1!==this.args.paused&&(this.takeInput(e),this.args.pauseMenu.input(e)),!1===this.args.paused||this.args.paused>0||this.args.networked){this.callFrameOuts(),this.callFrameIntervals();var r,n=tt(this.timers);try{for(n.s();!(r=n.n()).done;){var i=Q(r.value,2);i[0];i[1].update()}}catch(t){n.e(t)}finally{n.f()}this.args.lastFrameId=this.args.frameId,this.args.cutScene?(this.args.startFrameId++,this.args.showHud=!1):this.settings.showHud&&(this.args.showHud=!0),this.args.debugEditMode||this.args.frameId++,this.args.frame.args.value=this.args.frameId}if(!(!this.args.networked&&this.args.started&&!1!==this.args.paused&&this.args.paused<=0)&&(this.tileMap&&this.tileMap.mapData&&this.updateBackdrops(),this.args.started)){var o,a=tt(this.willDetach);try{for(a.s();!(o=a.n()).done;){var s=Q(o.value,2),c=s[0],u=s[1];this.willDetach.delete(c),u()}}catch(t){a.e(t)}finally{a.f()}Number(this.args.rings.args.value)?this.args.ringLabel.args.color="yellow":this.args.ringLabel.args.color="red-alert",this.args.fpsSprite.args.value=Number(this.args.fps).toFixed(2);var l=(this.args.frameId-this.args.startFrameId)/60,f=String(Math.trunc(Math.abs(l)/60)).padStart(2,"0"),h=String(Math.trunc(Math.abs(l)%60)).padStart(2,"0"),p=l<0?"-":"";if(p&&(f=Number(f)),this.args.timer.args.value="".concat(p).concat(f,":").concat(h),this.dontSwitch>0&&this.dontSwitch--,this.dontSwitch<0&&(this.dontSwitch=0),this.args.rippleFrame=this.args.frameId%128,this.args.displaceWater=this.args.frameId%128,this[lt].clear(),this.args.isReplaying||this.args.isRecording||(this.args.demoIndicator=null),this.updateBackground(),this.controlActor)if(this.args.isReplaying)if(this.args.demoIndicator||(this.args.demoIndicator=new A.CharacterString({value:" PLAY",color:"green"})),this.args.focusMe.args.hide="hide",this.args.frameId<this.replayInputs.length){var g=this.replayInputs[this.args.frameId];if(g)for(var d in g.args){var y=this.controlActor;y&&(g.args&&Object.assign(y.args,g.args[d]),g.input&&(y.controller.replay(g.input),y.readInput()))}this.args.hasRecording=!0,this.args.topLine.args.value=" i cant believe its not canvas. ",this.args.topLine.args.hide="",this.args.status.args.value=" click here to exit demo. ",this.args.status.args.hide=""}else this.args.topLine.args.hide="hide",this.args.status.args.hide="hide",this.args.isReplaying=!1;else this.gamepad&&(this.args.focusMe.args.hide="hide"),this.controlActor.controller&&this.takeInput(this.controlActor.controller),this.args.cutScene||this.controlActor.readInput();this.collisions=new Map,this.updateStarted.clear(),this.updated.clear(),this.controlActor&&this.controlActor.setCameraMode(),this.updateEnded.clear();for(var b=0,v=[].concat(et(this.args.layers),et(this.args.fgLayers));b<v.length;b++){var m=v[b],w=Math.sign(m.x-this.args.x),S=Math.sign(m.y-this.args.y);m.x=this.args.x,m.y=this.args.y,m.update(this.tileMap,w,S)}for(var O=0,j=[].concat(et(this.args.layers),et(this.args.fgLayers));O<j.length;O++){j[O].move()}if(this.args.running&&!this.args.debugEditMode){var k,x=new Set,P=tt(this.regions);try{for(P.s();!(k=P.n()).done;){var _=k.value;this.actorIsOnScreen(_,768)&&x.add(_)}}catch(t){P.e(t)}finally{P.f()}var M,E=tt(this.auras);try{for(E.s();!(M=E.n()).done;){var C=M.value;C!==this.controlActor&&x.add(C);var B,D=tt(this.nearbyActors(C));try{for(D.s();!(B=D.n()).done;){var I=B.value;I!==this.controlActor&&x.add(I)}}catch(t){D.e(t)}finally{D.f()}}}catch(t){E.e(t)}finally{E.f()}var F,L=tt(x);try{for(L.s();!(F=L.n()).done;){var N=F.value;N[ht]===this[ht]&&this.actorUpdateStart(N)}}catch(t){L.e(t)}finally{L.f()}this.controlActor&&this.controlActor[ht]===this[ht]&&this.actorUpdateStart(this.controlActor);var q,W=tt(x);try{for(W.s();!(q=W.n()).done;){var U=q.value;U[ht]===this[ht]&&this.actorUpdate(U)}}catch(t){W.e(t)}finally{W.f()}this.controlActor&&this.controlActor[ht]===this[ht]&&this.actorUpdate(this.controlActor);var V,H=tt(x);try{for(H.s();!(V=H.n()).done;){var G=V.value;G[ht]===this[ht]&&this.actorUpdateEnd(G)}}catch(t){H.e(t)}finally{H.f()}this.controlActor&&this.controlActor[ht]===this[ht]&&this.actorUpdateEnd(this.controlActor);var z,Y=tt(x);try{for(Y.s();!(z=Y.n()).done;){var K=z.value;K[ht]===this[ht]&&this.setColCell(K)}}catch(t){Y.e(t)}finally{Y.f()}if(this.controlActor&&this.controlActor[ht]===this[ht]&&this.setColCell(this.controlActor),this.collisions){var J,X=tt(this.collisions);try{for(X.s();!(J=X.n()).done;){var $,Z=Q(J.value,2),rt=(Z[0],tt(Z[1]));try{for(rt.s();!($=rt.n()).done;){var nt=Q($.value,2),it=nt[0];nt[1];it&&it.pause(!1)}}catch(t){rt.e(t)}finally{rt.f()}}}catch(t){X.e(t)}finally{X.f()}}if(this.controlActor&&(this.args.score.args.value=String(this.controlActor.args.score).padStart(4," "),this.args.rings.args.value=String(this.controlActor.args.rings).padStart(4," "),this.args.hasRings=!!this.controlActor.args.rings,this.args.hasEmeralds=!!this.controlActor.args.emeralds,this.args.char.args.value=this.controlActor.args.name,this.args.charName=this.controlActor.args.name,this.args.debugOsd)){this.args.xPos.args.value=Number(this.controlActor.x).toFixed(3),this.args.yPos.args.value=Number(this.controlActor.y).toFixed(3),this.args.layer.args.value=Number(this.controlActor.args.layer),this.args.ground.args.value=this.controlActor.args.landed,this.args.gSpeed.args.value=Number(this.controlActor.args.gSpeed).toFixed(3),this.args.xSpeed.args.value=Number(this.controlActor.args.xSpeed).toFixed(3),this.args.ySpeed.args.value=Number(this.controlActor.args.ySpeed).toFixed(3),this.args.angle.args.value=(Math.round(1e3*this.controlActor.args.groundAngle)/1e3).toFixed(3),this.args.airAngle.args.value=(Math.round(1e3*this.controlActor.args.airAngle)/1e3).toFixed(3),this.args.ignore.args.value=this.controlActor.args.ignore;this.args.mode.args.value=["FLOOR (0)","L-WALL (1)","CEILING (2)","R-WALL (3)"][Math.floor(this.controlActor.args.mode)]||Math.floor(this.controlActor.args.mode),this.args.cameraMode.args.value=this.controlActor.args.cameraMode}}else this.args.running&&this.args.debugEditMode&&this.controlActor&&(this.controlActor.args.x+=4*e.axes[0].magnitude,this.controlActor.args.y+=4*e.axes[1].magnitude,this.controlActor.args.respawning=!1,this.controlActor.args.dead=!1,this.controlActor.noClip=!1,this.controlActor.args.xSpeed=0,this.controlActor.args.ySpeed=0,this.controlActor.args.gSpeed=0);var ot=this.args.width,at=this.args.height,st=(this.args.x,this.args.x,this.args.y,this.args.y,new WeakSet);if(this.controlActor&&function(){var e=new DocumentFragment,r=(new DocumentFragment,!1),n=t.controlActor;t.controlActor.focused&&(n=t.controlActor.focused);for(var i=0,o=[t.nearbyActors(n)||[],t.regions];i<o.length;i++){var a,s=tt(o[i]);try{for(s.s();!(a=s.n()).done;){var c=a.value;if(c[ht]===t[ht])c.args.hidden||c.nodes.length||c.render(t.tags.actors),!t.actorIsOnScreen(c)||c instanceof R.LayerSwitch||(c.args.display=c.defaultDisplay||null,c.vizi||(c.nodes.length||c.onAttach&&!1===c.onAttach()&&c.detach(),c.args.hidden||(T.Region,c.nodes.map(function(t){return e.append(t)}),r=!0),c.wakeUp()),t.willDetach.delete(c),c.vizi=!0),st.add(c),t.recent.add(c)}}catch(t){s.e(t)}finally{s.f()}}var u,l=tt(t.recent);try{var f=function(){var e=u.value;if(e[ht]!==t[ht])return t.recent.delete(e),"continue";var r=t.actorIsOnScreen(e);!e.vizi||t.willDetach.has(e)||r||(t.willDetach.set(e,function(){e.sleep(),e.args.display="none",e.detach(),e.vizi=!1,e.willhide=null,t.willDetach.delete(e)}),t.recent.delete(e))};for(l.s();!(u=l.n()).done;)f()}catch(t){l.e(t)}finally{l.f()}r&&t.tags.actors.append(e)}(),this.nextControl&&(!this.args.networked&&this.auras.clear(),this.controlActor&&this.controlActor.sprite&&this.controlActor.sprite.parentNode&&this.controlActor.sprite.parentNode.classList.remove("actor-selected"),this.controlActor&&(this.controlActor.args.selected=!1),this.controlActor=this.nextControl,this.controlActor.args.selected=!0,this.auras.add(this.controlActor),this.controlActor.args.display=this.controlActor.defaultDisplay||null,this.controlActor.nodes.map(function(e){return t.tags.actors.append(e)}),this.controlActor.vizi=!0,this.args.maxSpeed=null,this.nextControl=null),this.controlActor&&(this.moveCamera(),this.applyMotionBlur()),this.updated.forEach(function(t){if(t.args.standingLayer){var e=t.args.standingLayer.offsetXChanged;if(e){var r=t.scanForward(e);t.args.x+=!1===r?e||0:r*Math.sign(e)}t.args.y+=t.args.standingLayer.offsetYChanged||0}}),this.args.networked&&this.controlActor){var ct={frame:this.serializePlayer()};1===this.args.playerId?this.server.send(JSON.stringify(ct)):2===this.args.playerId&&this.client.send(JSON.stringify(ct))}this.spawnActors()}}},{key:"click",value:function(t){this.args.isReplaying&&(this.controlActor&&this.controlActor.controller.zero(),this.stop())}},{key:"regionsAtPoint",value:function(t,e){var r,n=new Set,i=tt(this.regions);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o[ht]===this[ht]){var a=o.args,s=a.x,c=a.y,u=a.width,l=a.height;Math.floor(u/2);t>=s&&s+u>t&&c>=e&&e>c-l&&n.add(o)}}}catch(t){i.e(t)}finally{i.f()}return n}},{key:"actorsAtPoint",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t+"::"+e+"::"+r+"::"+n,o=this[lt];if(o.has(i))return o.get(i);var a,s=[],c=tt(this.nearbyActors({x:t,y:e}));try{for(c.s();!(a=c.n()).done;){var u=a.value;if(u[ht]===this[ht]){var l=u.args,f=l.x,h=l.y,p=l.width,g=l.height,d=Math.max(Math.floor(r/2),0),y=t-d,b=t+d,v=e-Math.max(n,0),m=e,w=p/2,S=u.isRegion;b>=f-(S?0:w)&&f+(S?p:w)>y&&h>=v&&m>=h-g&&s.push(u)}}}catch(t){c.e(t)}finally{c.f()}return o.set(i,s),s}},{key:"padConnected",value:function(t){this.gamepad=t.gamepad,this.interact(),"function"==typeof ga&&ga("send","event",{eventCategory:"gamepad",eventAction:"connected",eventLabel:t.gamepad.id})}},{key:"padRemoved",value:function(t){this.gamepad&&(this.args.started&&this.pauseGame(),this.gamepad.index===t.gamepad.index&&(this.gamepad=null),"function"==typeof ga&&ga("send","event",{eventCategory:"gamepad",eventAction:"disconnected",eventLabel:t.gamepad.id}))}},{key:"getColCell",value:function(t){var e=this.colCellDiv,r=this.colCells,n=Math.floor(t.x/e),i=Math.floor(t.y/e),o="".concat(n,":").concat(i);if(!r.has(o)){var a=new Set;return r.set(o,a),a.name=o,a}return r.get(o)}},{key:"getColCells",value:function(t){for(var e=this.colCellDiv,r=t.y-t.args.height,n=t.args.width,i=t.x-n/2,o=t.x+n/2,a=Math.floor(i/e),s=Math.ceil(o/e),c=Math.floor(r/e),u=Math.ceil(t.y/e),l=new Set,f=a;f<=s;f++)for(var h=c;h<=u;h++)l.add(this.getColCell({x:f*e,y:h*e}));return l}},{key:"setColCell",value:function(t){t[i.Bindable.NoGetters]=!0,t=i.Bindable.make(t);var e=this.getColCell(t);return t[ft]&&t[ft].delete(t),e.add(t),t[ft]=e,e}},{key:"getNearbyColCells",value:function(t){var e=t.x,r=t.y,n=this.colCellDiv,i=Math.floor(e/n),o=Math.floor(r/n),a="".concat(i,"::").concat(o),s=this.colCellCache.get(a);if(s)return s.filter(function(t){return t.size});var c=e-n,u=e,l=e+n,f=r-n,h=r,p=r+n;return this.colCellCache.set(a,s=[this.getColCell({x:c,y:f}),this.getColCell({x:c,y:h}),this.getColCell({x:c,y:p}),this.getColCell({x:u,y:f}),this.getColCell({x:u,y:h}),this.getColCell({x:u,y:p}),this.getColCell({x:l,y:f}),this.getColCell({x:l,y:h}),this.getColCell({x:l,y:p})]),s.filter(function(t){return t.size})}},{key:"screenFilter",value:function(t){this.args.screenFilter=t}},{key:"reset",value:function(){console.clear(),this[ht]++,this.stop(),this.clearDialog(),this.hideDialog(),this.tileMap.replacements.clear(),this.tileMap.tileSetCache.clear(),this.tileMap.tileCache.clear(),this.callFrames.clear(),this.callIntervals.clear(),this.collisions.clear(),this.colCellCache.clear(),this.colCells.clear(),this.regions.clear(),this.spawn.clear(),this.auras.clear(),this.updateStarted.clear(),this.updateEnded.clear(),this.updated.clear(),this.objectDb.clear(),this.args.actClear=!1,this.args.cutScene=!1,this.args.fade=!1,this.args.xOffset=.5,this.args.yOffset=.5;var t,e=tt(this.tileMap.tileLayers);try{for(e.s();!(t=e.n()).done;){var r=t.value;r.offsetX=0,r.offsetY=0,r.offsetXChanged=0,r.offsetYChanged=0}}catch(t){e.e(t)}finally{e.f()}for(var n=0,i=[].concat(et(this.args.layers),et(this.args.fgLayers));n<i.length;n++){var o=i[n];o.args.destroyed=!1,o.args.offsetX=0,o.args.offsetY=0,o.args.offsetXChanged=0,o.args.offsetYChanged=0}var a,s=tt(this.actors.items());try{for(s.s();!(a=s.n()).done;){var c=a.value;this.actors.remove(c)}}catch(t){s.e(t)}finally{s.f()}this.controlActor&&this.actors.remove(this.controlActor),this.nextControl=null,this.actorsById={};var u,l=tt(this.effects.list);try{for(l.s();!(u=l.n()).done;){var f=u.value;f&&this.effects.remove(f)}}catch(t){l.e(t)}finally{l.f()}var h,p=tt(this.particles.list);try{for(p.s();!(h=p.n()).done;){var g=h.value;g&&this.particles.remove(g)}}catch(t){p.e(t)}finally{p.f()}this.spawn.clear(),this[lt].clear(),this.args.isRecording=!1,this.args.isReplaying=!1,this.args.populated=!1,this.controlActor=null,this.tags.viewport.focus(),this.args.paused=!0}},{key:"quit",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.args.actClear=!1,this.args.cutScene=!1,this.args.fade=!0,this.callFrames.clear(),this.callIntervals.clear(),this.collisions.clear(),this.colCellCache.clear(),this.colCells.clear(),this.regions.clear(),this.spawn.clear(),this.auras.clear(),this.args.timeBonus.args.value=0,this.args.ringBonus.args.value=0,this.args.speedBonus.args.value=0,this.args.totalBonus.args.value=0,this.meta={};var e,r=tt(this.actors.items());try{for(r.s();!(e=r.n()).done;){var n=e.value;this.actors.remove(n)}}catch(t){r.e(t)}finally{r.f()}for(var i=0,o=[].concat(et(this.args.layers),et(this.args.fgLayers));i<o.length;i++){o[i].args.destroyed=!1}this.willDetach.clear(),this.objectDb.clear(),this.args.isRecording=!1,this.args.isReplaying=!1,this.playableIterator=!1,this.args.populated=!1,this.args.paused=!1,this.args.started=!1,this.controlActor=null,this.args.frameId=-1,this.args.timer.args.value="",this.args.rings.args.value=0,this.args.hasRings=!1,this.args.hasCoins=!1,this.args.hasEmeralds=!1,this.args.char.args.value="",this.args.charName="",this.args.level=!1;this.args.layers.length;var a,s=tt(this.args.layers);try{for(s.s();!(a=s.n()).done;){a.value.remove()}}catch(t){s.e(t)}finally{s.f()}var u,l=tt(this.args.fgLayers);try{for(l.s();!(u=l.n()).done;){u.value.remove()}}catch(t){l.e(t)}finally{l.f()}var h=[];2===t?h.push(new m.LoadingCard({timeout:15e3,text:"loading"},this)):t?(f.Bgm.fadeOut(2e3),h.push.apply(h,et(this.homeCards()))):(f.Bgm.fadeOut(3e3),h.push.apply(h,et(this.returnHomeCards()))),this.args.titlecard=new y.Series({cards:h},this),this.args.bg=this.args.backdrop=null,c.Keyboard.get().reset(),this.args.titlecard.play(),this.controller.zero()}},{key:"introCards",value:function(){return[new m.LoadingCard({timeout:3500,text:"loading"},this),new w.BootCard({timeout:3500}),new S.DebianCard({timeout:4500}),new O.WebkitCard({timeout:3500}),new k.WarningCard({timeout:8e3}),new j.GamepadCard({timeout:2500}),new P.SeanCard({timeout:5e3},this)].concat(et(this.homeCards()))}},{key:"homeCards",value:function(){return[new b.TitleScreenCard({timeout:51e3},this),new M.MainMenu({timeout:-1},this)]}},{key:"returnHomeCards",value:function(){return[new v.ThankYouCard({timeout:5e3},this)].concat(et(this.homeCards()))}},{key:"record",value:function(){this.args.demoIndicator=null,this.reset(),this.args.frameId=0,this.replayInputs=[],this.args.isRecording=!0,this.args.isReplaying=!1,this.args.hasRecording=!0,this.args.paused=!1,this.startLevel()}},{key:"playback",value:function(){this.args.demoIndicator=null,this.reset(),this.replayInputs=JSON.parse(localStorage.getItem("replay"))||[],this.startLevel(),this.args.frameId=0,this.args.isReplaying=!0,this.args.isRecording=!1,this.args.paused=!1}},{key:"stop",value:function(){if(this.args.isRecording){var t=JSON.stringify(et(this.replayInputs));localStorage.setItem("replay",t)}this.args.isReplaying=!1,this.args.isRecording=!1,this.args.paused=!1,this.controlActor&&this.controlActor.controller.zero(),this.tags.viewport.focus()}},{key:"focus",value:function(){this.tags.viewport&&this.tags.viewport.focus()}},{key:"getServer",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&e||new G.RtcServer({iceServers:[{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}]});return this.listen(e,"open",function(r){console.log("Connection opened!"),t.args.chatBox=new Y.ChatBox({pipe:e}),t.args.playerId=1},{once:!0}),this.listen(e,"message",function(e){t.actors.list;if(t.remotePlayer){var r=JSON.parse(e.detail),n=t.remotePlayer;r.frame&&(r.frame.frame>t.args.frameId&&(t.args.frameId=r.frame.frame),r.frame.input&&(n.controller.replay(r.frame.input),n.readInput()),r.frame.args&&Object.assign(n.args,r.frame.args),n.noClip=n.args.dead)}}),this.server=e,e}},{key:"getClient",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.client||new H.RtcClient({iceServers:[{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}]});return this.listen(e,"open",function(r){console.log("Connection opened!"),t.args.chatBox=new Y.ChatBox({pipe:e}),t.args.playerId=2},{once:!0}),this.listen(e,"message",function(e){t.actors.list;if(t.remotePlayer){var r=JSON.parse(e.detail),n=t.remotePlayer;r.frame&&(r.frame.frame>t.args.frameId&&(t.args.frameId=r.frame.frame),r.frame.input&&(n.controller.replay(r.frame.input),n.readInput()),r.frame.args&&Object.assign(n.args,r.frame.args),n.noClip=n.args.dead)}}),this.client=e,e}},{key:"serializePlayer",value:function(){return this.controlActor&&this.controlActor.controller?{frame:this.args.frameId,input:this.controlActor.controller.serialize(),args:{x:this.controlActor.args.x,y:this.controlActor.args.y,gSpeed:this.controlActor.args.gSpeed,xSpeed:this.controlActor.args.xSpeed,ySpeed:this.controlActor.args.ySpeed,direction:this.controlActor.args.direction,facing:this.controlActor.args.facing,falling:this.controlActor.args.falling,rolling:this.controlActor.args.rolling,jumping:this.controlActor.args.jumping,flying:this.controlActor.args.flying,float:this.controlActor.args.float,angle:this.controlActor.args.angle,mode:this.controlActor.args.mode,groundAngle:this.controlActor.args.groundAngle,respawning:this.controlActor.args.respawning,dead:!!this.controlActor.args.dead}}:{}}},{key:"onFrameOut",value:function(t,e){if(!(t<=0)){var r=this.args.frameId+t;this.callFrames.has(r)||this.callFrames.set(r,new Set);var n=this.callFrames.get(r);return n.add(e),function(){return n.delete(e)}}e()}},{key:"onFrameInterval",value:function(t,e){if(!(frames<=0)){var r=t;this.callIntervals.has(r)||this.callIntervals.set(r,new Set);var n=this.callIntervals.get(r);return n.add(e),function(){return n.delete(e)}}}},{key:"callFrameOuts",value:function(){for(var t=this.args.lastFrameId;t<=this.args.frameId;t++)if(this.callFrames.has(t)){var e,r=tt(this.callFrames.get(t));try{for(r.s();!(e=r.n()).done;){(0,e.value)()}}catch(t){r.e(t)}finally{r.f()}this.callFrames.delete(t)}}},{key:"callFrameIntervals",value:function(){for(var t=this.args.lastFrameId;t<=this.args.frameId;t++){var e,r=tt(this.callIntervals);try{for(r.s();!(e=r.n()).done;){var n=Q(e.value,2),i=n[0],o=n[1];if(t%i==0){var a,s=tt(o);try{for(s.s();!(a=s.n()).done;){(0,a.value)()}}catch(t){s.e(t)}finally{s.f()}}}}catch(t){r.e(t)}finally{r.f()}}}},{key:"pauseGame",value:function(){var t=this;this.focus(),this.args.paused=-1,this.args.pauseMenu.focusFirst(),f.Bgm.pause(),this.onTimeout(6,function(){t.controller&&t.controller.zero()})}},{key:"unpauseGame",value:function(){var t=this;this.args.pauseMenu.reset(),f.Bgm.unpause(),this.onTimeout(15,function(){t.controller&&t.controller.zero()}),this.onTimeout(30,function(){t.focus()}),this.onTimeout(60,function(){t.args.paused=!1})}},{key:"mousemove",value:function(t){var e=this;this.args.mouse="moved",this.onTimeout(5e3,function(){e.args.mouse="hide"})}},{key:"hyphenate",value:function(t){return String(t).replace(/\s/g,"-").toLowerCase()}},{key:"storeCheckpoint",value:function(t,e){this.checkpoints[this.tileMap.mapUrl]||(this.checkpoints[this.tileMap.mapUrl]={}),this.checkpoints[this.tileMap.mapUrl][t]={checkpointId:e,frames:this.args.frameId-this.args.startFrameId},localStorage.setItem("checkpoints:::".concat(this.tileMap.mapUrl),JSON.stringify(this.checkpoints[this.tileMap.mapUrl]))}},{key:"getCheckpoint",value:function(t){if(!this.checkpoints[this.tileMap.mapUrl]){var e=localStorage.getItem("checkpoints:::".concat(this.tileMap.mapUrl))||"{}";this.checkpoints[this.tileMap.mapUrl]=JSON.parse(e)||{}}return this.checkpoints[this.tileMap.mapUrl][t]}},{key:"setCheckpoint",value:function(t,e){localStorage.setItem("checkpoints:::".concat(t),JSON.stringify(e))}},{key:"clearCheckpoints",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===t&&(t=this.controlActor.args.canonical),this.checkpoints[this.tileMap.mapUrl]||(this.checkpoints[this.tileMap.mapUrl]={}),delete this.checkpoints[this.tileMap.mapUrl][t],localStorage.setItem("checkpoints:::".concat(this.tileMap.mapUrl),JSON.stringify(this.checkpoints[this.tileMap.mapUrl]))}},{key:"showCenterMessage",value:function(t,e){this.args.centerMessage=new A.CharacterString({value:t,color:e})}},{key:"hideCenterMessage",value:function(){this.args.centerMessage=!1}},{key:"showDialog",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.args.dialog=!0,this.clearDialog();var r,n=0,i=tt(t=t.map(function(t){return new A.CharacterString({value:t})}));try{for(i.s();!(r=i.n()).done;){var o=r.value;o.offset=n,n+=o.args.value.length}}catch(t){i.e(t)}finally{i.f()}this.args.dialogLines=t,this.args.dialogClasses=e}},{key:"hideDialog",value:function(t){this.clearDialog(),this.args.dialog=!1}},{key:"clearDialog",value:function(){this.args.dialogLines=[]}},{key:"clearAct",value:function(t){var e=this;console.log(t),this.args.actClearLabel.args.value=t;var r=Math.trunc(10*this.controlActor.args.clearSpeed),n=100*this.controlActor.args.rings,i=Math.round(1e4*this.controlActor.args.airTimeTotal/(this.controlActor.args.airTimeTotal+this.controlActor.args.groundTimeTotal))/100+"%",o=0,a=(this.args.frameId-this.args.startFrameId)/60,s=Math.trunc(Math.abs(a)),c=(o=s<30?5e4:s<45?1e4:s<60?5e3:s<90?4e3:s<120?3e3:s<180?2e3:s<240?1e3:500)+n+r;this.controlActor.args.score+=c,this.args.actClear=!0,this.args.timeBonus.args.value=0,this.args.ringBonus.args.value=0,this.args.airBonus.args.value=0,this.args.speedBonus.args.value=0,this.args.totalBonus.args.value=0,this.onFrameOut(45,function(){return e.args.timeBonus.args.value=o}),this.onFrameOut(90,function(){return e.args.ringBonus.args.value=n}),this.onFrameOut(135,function(){return e.args.speedBonus.args.value=r}),this.onFrameOut(180,function(){return e.args.airBonus.args.value=i}),this.onFrameOut(205,function(){return e.args.totalBonus.args.value=c}),this.onFrameOut(420,function(){return e.args.actClear=!1})}},{key:"cpuDetect",value:function(){try{ga("send","event",{eventCategory:"cpu",eventAction:"cores",eventLabel:"core check",eventValue:navigator.hardwareConcurrency})}catch(t){ga&&ga("send","event",{eventCategory:"cpu",eventAction:"core check fail",eventLabel:"Cpu Detect Failure: ".concat(t)})}}},{key:"gpuDetect",value:function(){try{this.gpuDetector=this.gpuDetector||document.createElement("canvas").getContext("webgl");var t=this.gpuDetector.getExtension("WEBGL_debug_renderer_info"),e=this.gpuDetector.getParameter(t.UNMASKED_VENDOR_WEBGL),r=this.gpuDetector.getParameter(t.UNMASKED_RENDERER_WEBGL);ga("send","event",{eventCategory:"gpu",eventAction:e,eventLabel:r})}catch(t){ga&&ga("send","event",{eventCategory:"gpu",eventAction:"fail",eventLabel:"Gpu Detect Failure: ".concat(t)})}}},{key:"buildDetect",value:function(){var t=document.head.querySelector('meta[name="x-build-time"]').getAttribute("content");ga&&ga("send","event",{eventCategory:"build",eventAction:"build check",eventLabel:t})}},{key:"interact",value:function(){this.args.interacted=!0}}])&&it(r.prototype,n),rt&&it(r,rt),Object.defineProperty(r,"prototype",{writable:!1}),ct}();t.Viewport=pt}),require.register("viewport/layer.html",function(t,e,r){r.exports='<div data-name = "[[name]]" class = "viewport-background" cv-each = "blocks:block:b" cv-ref = "background" data-layer = "[[layerId]]">[[block]]</div>\n'}),require.register("viewport/viewport.html",function(t,e,r){r.exports='<section class = "filters" cv-each = "effects:effect">[[effect]]</section>\n\n<div class = "viewport-frame [[initializing]] [[standalone]] [[secret]] [[level]] [[noIntro]] [[inputType]] [[ntsc]] [[windowFocused]]" data-theme = "[[theme]]" data-bg = "[[bg]]" cv-ref = "frame" data-paused = "[[paused]]" cv-on = "mousedown:interact:c;keydown:interact:c;">\n\t<div class = "viewport-header">\n\t\t<span class = "sean-icon"></span>\n\t\t<h1>Pixel Physics</h1>\n\t</div>\n\t<div class = "viewport [[standalone]] [[fullscreen]] displacement-[[displacement]] mouse-[[mouse]] [[theme]] [[hideNowPlaying]]" cv-ref = "viewport" tabindex="0" cv-on = "click(event);mousemove(event)">\n\n\t\t<svg height="32" width="32">\n\t\t<defs>\n\n\t\t\t<filter id="motionBlur" x="0%"\n y="0%" width="100%" height="100%">\n\t\t\t\t<feGaussianBlur in="SourceGraphic" stdDeviation="0,0" cv-ref = "blur" />\n\t\t\t</filter>\n\t\t</defs>\n\t\t</svg>\n\n\t\t<svg height="100" width="100">\n\t\t<defs>\n\t\t\t<filter id="waterBlur">\n\t\t\t\t<feGaussianBlur in="SourceGraphic" stdDeviation="0.25,0" />\n\t\t\t</filter>\n\n\t\t\t<filter id="dilate">\n\t\t\t\t<feMorphology operator="dilate" radius="0.25" result = "expanded"/>\n\t\t\t\t<feMerge>\n\t\t\t\t\t<feMergeNode in="expanded" />\n\t\t\t\t\t<feMergeNode in="SourceGraphic" />\n\t\t\t\t</feMerge>\n\t\t\t</filter>\n\n\t\t\t<filter id = "waves"\n\t\t\t\tcolor-interpolation-filters="sRGB"\n\t\t\t\tx      ="0%"\n\t\t\t\ty      ="0%"\n\t\t\t\theight ="100%"\n\t\t\t\twidth  ="100%"\n\t\t\t>\n\t\t\t\t<feFlood\n\t\t\t\t\tflood-color="#408000"\n\t\t\t\t\tresult = "DisplacementGreen"\n\t\t\t\t></feFlood>\n\n\t\t\t\t<feImage\n\t\t\t\t\txlink:href="/effects/wave.png"\n\t\t\t\t\tresult="DisplacementSource"\n\t\t\t\t\theight="64"\n\t\t\t\t\twidth="64"\n\t\t\t\t></feImage>\n\n\t\t\t\t<feTile\n\t\t\t\t\tin="DisplacementSource"\n\t\t\t\t\tresult="DisplacementTile"\n\t\t\t\t></feTile>\n\n\t\t\t\t<feComposite\n\t\t\t\t\tin  = "DisplacementTile"\n\t\t\t\t\tin2 = "DisplacementGreen"\n\t\t\t\t\tresult ="DisplacementField"\n\t\t\t\t\toperator ="over"\n\t\t\t\t></feComposite>\n\n\t\t\t\t<feOffset\n\t\t\t\t\tin  = "DisplacementField"\n\t\t\t\t\tout = "DisplacementOffset"\n\t\t\t\t\tdx  = "0"\n\t\t\t\t>\n\t\t\t\t\t<animate\n\t\t\t\t\t\tattributeName="dy"\n\t\t\t\t\t\tvalues = "0;-64"\n\t\t\t\t\t\tdur="1500ms"\n\t\t\t\t\t\trepeatCount="indefinite" />\n\n\t\t\t\t</feOffset>\n\n\t\t\t\t<feDisplacementMap\n\t\t\t\t\tin="SourceGraphic"\n\t\t\t\t\tin2="DisplacementOffset"\n\t\t\t\t\tresult="Displaced"\n\t\t\t\t\txChannelSelector="R"\n\t\t\t\t\tyChannelSelector="G"\n\t\t\t\t\tscale="4"\n\t\t\t\t></feDisplacementMap>\n\n\t\t\t\t<feGaussianBlur\n\t\t\t\t\tin="Displaced"\n\t\t\t\t\tstdDeviation="0.35"\n\t\t\t\t></feGaussianBlur>\n\n\t\t\t</filter>\n\n\t\t\t<filter id = "ntsc"\n\t\t\t\tcolor-interpolation-filters="sRGB"\n\t\t\t\tx      = "0%"\n\t\t\t\ty      = "0%"\n\t\t\t\twidth  = "100%"\n\t\t\t\theight = "200%"\n\t\t\t>\n\t\t\t\t<feFlood\n\t\t\t\t\tflood-color="#808000"\n\t\t\t\t\tresult = "DisplacementGreen"\n\t\t\t\t></feFlood>\n\n\t\t\t\t<feImage\n\t\t\t\t\txlink:href="/effects/ntsc-static.png"\n\t\t\t\t\tresult ="DisplacementSource"\n\t\t\t\t\twidth  = "128"\n\t\t\t\t\theight = "128"\n\t\t\t\t></feImage>\n\n\t\t\t\t<feTile\n\t\t\t\t\tin="DisplacementSource"\n\t\t\t\t\tresult="DisplacementTile"\n\t\t\t\t></feTile>\n\n\t\t\t\t<feComposite\n\t\t\t\t\tin  = "DisplacementTile"\n\t\t\t\t\tin2 = "DisplacementGreen"\n\t\t\t\t\tresult ="DisplacementField"\n\t\t\t\t\toperator ="over"\n\t\t\t\t></feComposite>\n\n\t\t\t\t<feOffset\n\t\t\t\t\tin  = "DisplacementField"\n\t\t\t\t\tout = "DisplacementOffset"\n\t\t\t\t\tdx  = "0"\n\t\t\t\t\tdy  = "0"\n\t\t\t\t>\n\t\t\t\t\t<animate\n\t\t\t\t\t\tattributeName="dy"\n\t\t\t\t\t\tvalues = "-128;0"\n\t\t\t\t\t\tbegin="2000ms"\n\t\t\t\t\t\tdur="2000ms"\n\t\t\t\t\t\trepeatCount="8"\n\t\t\t\t\t></animate>\n\n\t\t\t\t</feOffset>\n\n\t\t\t\t<feDisplacementMap\n\t\t\t\t\tin="SourceGraphic"\n\t\t\t\t\tin2="DisplacementOffset"\n\t\t\t\t\tresult="Displaced"\n\t\t\t\t\txChannelSelector="R"\n\t\t\t\t\tyChannelSelector="G"\n\t\t\t\t\tscale = "0"\n\t\t\t\t>\n\t\t\t\t\t<animate\n\t\t\t\t\t\tattributeName="scale"\n\t\t\t\t\t\tvalues = "512;192;0"\n\t\t\t\t\t\tbegin="2000ms"\n\t\t\t\t\t\tdur="2000ms"\n\t\t\t\t\t\trepeatCount="1"\n\t\t\t\t\t></animate>\n\n\t\t\t\t</feDisplacementMap>\n\n\t\t\t</filter>\n\n\t\t</defs>\n\t\t</svg>\n\n\t\t<div class = "viewport-zoom">\n\n\t\t\t[[backdrop]]\n\n\t\t\t<div class = "backdrops" cv-ref ="backdrops"></div>\n\n\t\t\t<div class = "blurAngle" cv-ref = "blurAngle">\n\t\t\t<div class = "blurDistance" cv-ref = "blurDistance">\n\t\t\t<div class = "blurAngleCancel" cv-ref = "blurAngleCancel">\n\t\t\t\t<div\n\t\t\t\t\tcv-ref  = "background"\n\t\t\t\t\tclass   = "viewport-bg-layers"\n\t\t\t\t\tcv-each = "layers:layer"\n\t\t\t\t>[[layer]]</div>\n\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class = "filters filters-background" cv-ref = "bgFilters"></div>\n\n\t\t\t<div cv-ref = "content" class = "viewport-content">\n\t\t\t\t<div cv-ref = "actors" class = "viewport-actors"></div>\n\t\t\t\t<div cv-ref = "particles" class = "viewport-particles"></div>\n \t\t\t</div>\n\n\t\t\t<div class = "blurAngle" cv-ref = "blurAngleFg">\n\t\t\t<div class = "blurDistance" cv-ref = "blurDistanceFg">\n \t\t\t<div class = "blurAngleCancel" cv-ref = "blurAngleCancelFg">\n\t\t\t\t<div\n\t\t\t\t\tcv-ref  = "foreground"\n\t\t\t\t\tclass   = "viewport-bg-layers"\n\t\t\t\t\tcv-each = "fgLayers:layer"\n\t\t\t\t>[[layer]]</div>\n\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n \t\t</div>\n\n \t\t<div class = "viewport-overlay">\n \t\t\t<div class = "debug-spawn" cv-if = "debugEditMode">\n \t\t\t\t<div class = "debug-spawn" cv-ref = "spawnPreview"></div>\n \t\t\t\t<div class = "debug-spawn">[[debugObjectName]]</div>\n \t\t\t</div>\n\t\t\t<div class = "hud hud-top-right hud-table"  cv-if = "debugOsd">\n\t\t\t\t<table>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td colspan = "2">[[char]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelGround]]</td>\n\t\t\t\t\t\t<td>[[ground]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelCamera]]</td>\n\t\t\t\t\t\t<td>[[cameraMode]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelMode]]</td>\n\t\t\t\t\t\t<td>[[mode]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelX]]</td>\n\t\t\t\t\t\t<td>[[xPos]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelY]]</td>\n\t\t\t\t\t\t<td>[[yPos]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelLayer]]</td>\n\t\t\t\t\t\t<td>[[layer]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelGSpeed]]</td>\n\t\t\t\t\t\t<td>[[gSpeed]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelXSpeed]]</td>\n\t\t\t\t\t\t<td>[[xSpeed]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelYSpeed]]</td>\n\t\t\t\t\t\t<td>[[ySpeed]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelAirAngle]]</td>\n\t\t\t\t\t\t<td>[[airAngle]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelAngle]]</td>\n\t\t\t\t\t\t<td>[[angle]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelFrame]]</td>\n\t\t\t\t\t\t<td>[[frame]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelIgnore]]</td>\n\t\t\t\t\t\t<td>[[ignore]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t</table>\n\t\t\t</div>\n\n\t\t\t<div class = "hud hud-top-right" cv-if = "showHud">\n\n\t\t\t\t<div class = "char-hud">\n\t\t\t\t\t[[char]]\n\t\t\t\t\t<div class = "char-icon [[charName|hyphenate]]"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class = "emerald-hud" cv-each = "emeralds:emerald:e">\n\t\t\t\t\t<img src = "/Sonic/emerald-[[emerald]]-mini.png" />\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t\t<div class = "hud hud-bottom-right">\n\n\t\t\t\t<div cv-if = "showHud" class ="sheild-hud [[currentSheild]] [[hasElectric]] [[hasFire]] [[hasWater]] [[hasNormal]]">\n\t\t\t\t\t<div class = "sheild-icon sheild-electric"></div>\n\t\t\t\t\t<div class = "sheild-icon sheild-normal"></div>\n\t\t\t\t\t<div class = "sheild-icon sheild-fire"></div>\n\t\t\t\t\t<div class = "sheild-icon sheild-water"></div>\n\t\t\t\t</div>\n\n\t\t\t\t<span class = "contents" cv-if = "showFps">\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>[[labelFps]]</td>\n\t\t\t\t\t\t\t<td>[[fpsSprite]]</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</span>\n\t\t\t</div>\n\n\t\t\t<div class = "hud hud-dark hud-bottom-left" cv-if = "showHud">\n\t\t\t\t[[nowPlaying]]\n\t\t\t\t[[trackName]]\n\t\t\t</div>\n\n\t\t\t<div class = "hud hud-top-left hud-table"  cv-if = "showHud">\n\t\t\t\t<table>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[scoreLabel]]</td><td>[[score]]</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[timerLabel]]</td><td>[[timer]]</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[ringLabel]]</td><td>[[rings]]</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t\t<div class = "demo-hud" cv-if = "demoIndicator">[[demoIndicator]]</div>\n\t\t\t</div>\n\n\t\t\t<div class = "hud hud-dark hud-centered" cv-if = "actClear">\n\t\t\t\t<table>\n\t\t\t\t\t<tr><td colspan="2">\n\t\t\t\t\t\t<div class = "centered">[[actClearLabel]]</div>\n\t\t\t\t\t</td></tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[timeBonusLabel]]</td>\n\t\t\t\t\t\t<td>[[timeBonus]]</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[ringBonusLabel]]</td>\n\t\t\t\t\t\t<td>[[ringBonus]]</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t\x3c!-- <tr>\n\t\t\t\t\t\t<td>[[perfectBonusLabel]]</td>\n\t\t\t\t\t\t<td>[[perfectBonus]]</td>\n\t\t\t\t\t</tr> --\x3e\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[speedBonusLabel]]</td>\n\t\t\t\t\t\t<td>[[speedBonus]]</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[airBonusLabel]]</td>\n\t\t\t\t\t\t<td>[[airBonus]]</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[totalBonusLabel]]</td>\n\t\t\t\t\t\t<td>[[totalBonus]]</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</div>\n\n\t\t\t<div class = "hud hud-dark hud-centered" cv-if = "centerMessage">\n\t\t\t\t[[centerMessage]]\n\t\t\t</div>\n\n\t\t\t<div class = "hud hud-dark hud-centered-raised" cv-if = "dialog">\n\t\t\t\t<div class = "dialog-frame [[dialogClasses]]">\n\t\t\t\t\t<div class = "dialog-icon">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div cv-each = "dialogLines:line" class = "dialog-text">\n\t\t\t\t\t\t<span style = "--text-offset:[[line.offset]]">[[line]]</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class = "screen-effects" cv-each = "screenEffects:effect">\n\t\t\t\t[[effect]]\n\t\t\t</div>\n\n\t\t\t<section class = "pause-menu full" cv-if = "paused">[[pauseMenu]]</section>\n\n\t\t\t[[titlecard]]\n\n\t\t\t<div class = "topLine">\n\t\t\t\t<div class = "status-message">[[topLine]]</div>\n\t\t\t</div>\n\n\t\t\t<div class = "focus-me">\n\t\t\t\t<div class = "status-message">[[focusMe]]</div>\n\t\t\t</div>\n\n\t\t\t<div class = "status-message">[[status]]</div>\n\n\t\t\t<section class = "contents" cv-if = "networked">[[chatBox]]</section>\n\n\t\t\t\x3c!-- <div class = "filters filters-foreground" cv-ref = "fgFilters"></div> --\x3e\n\n\t\t\t<div class = "console [[showConsole]]" cv-ref = "subspace" tab-index = "0">[[subspace]]</div>\n\n\t\t\t<div class = "shade" data-fade = "[[fade]]"></div>\n\n\t\t</div>\n\n\t\t<div class = "quick-controls" cv-if = "shortcuts">\n\n\t\t\t[[muteSwitch]]\n\n\t\t\t<div class = "button" cv-on = "click:fullscreen()">\n\t\t\t\t<image src = "/ui/fullscreen.svg" />\n\t\t\t</div>\n\n\t\t</div>\n\n\n\t</div>\n\n</div>\n'}),require.register("___globals___",function(t,e,r){})}(),require("___globals___");
