!function(){"use strict";var t="undefined"==typeof global?self:global;if("function"!=typeof t.require){var e={},r={},n={},i={}.hasOwnProperty,o=/^\.\.?(\/|$)/,a=function(t,e){for(var r,n=[],i=(o.test(e)?t+"/"+e:e).split("/"),a=0,s=i.length;a<s;a++)".."===(r=i[a])?n.pop():"."!==r&&""!==r&&n.push(r);return n.join("/")},s=function(t){return t.split("/").slice(0,-1).join("/")},c=function(e,n){var i,o={id:e,exports:{},hot:p&&p.createHot(e)};return r[e]=o,n(o.exports,(i=e,function(e){var r=a(s(i),e);return t.require(r,i)}),o),o.exports},u=function(t){var e=n[t];return e&&t!==e?u(e):t},l=function(t,n){null==n&&(n="/");var o=u(t);if(i.call(r,o))return r[o].exports;if(i.call(e,o))return c(o,e[o]);throw new Error("Cannot find module '"+t+"' from '"+n+"'")};l.alias=function(t,e){n[e]=t};var f=/\.[^.\/]+$/,h=/\/index(\.[^\/]+)?$/;l.register=l.define=function(t,o){if(t&&"object"==typeof t)for(var a in t)i.call(t,a)&&l.register(a,t[a]);else e[t]=o,delete r[t],function(t){if(f.test(t)){var e=t.replace(f,"");i.call(n,e)&&n[e].replace(f,"")!==e+"/index"||(n[e]=t)}if(h.test(t)){var r=t.replace(h,"");i.call(n,r)||(n[r]=t)}}(t)},l.list=function(){var t=[];for(var r in e)i.call(e,r)&&t.push(r);return t};var p=t._hmr&&new t._hmr(function(t,e){return u(a(s(t),e))},l,e,r);l._cache=r,l.hmr=p&&p.wrap,l.brunch=!0,t.require=l}}(),function(){"undefined"==typeof window||window;var t=function(t,e,r){var n={},i=function(e,r){try{return t(r+"/node_modules/"+e)}catch(t){if(-1===t.toString().indexOf("Cannot find module"))throw t;if(-1!==r.indexOf("node_modules")){var o=r.split("/"),a=o.lastIndexOf("node_modules"),s=o.slice(0,a).join("/");return i(e,s)}}return n};return function(o){if(o in e&&(o=e[o]),o){if("."!==o[0]&&r){var a=i(o,r);if(a!==n)return a}return t(o)}}};require.register("curvature/animate/Ease.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Ease=void 0;var n=r("../base/Mixin"),i=r("../mixin/PromiseMixin");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=c(e);if(r){var o=c(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e)}(this,n)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(l,n.Mixin["with"](i.PromiseMixin));var e,r,c,u=s(l);function l(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=u.call(this)).interval=t,e.terminal=!1,e.initial=!1,e.timeout=!1,e.final=!1,e.canceled=!1,e.done=!1,e.calculate=!!(e.calculate||"calculate"in r)&&r.calculate,e.bounded=!("bounded"in r)||r.bounded,e.repeat="repeat"in r?r.repeat:1,e.reverse="reverse"in r&&r.reverse,e}return e=l,(r=[{key:"start",value:function(){var t=this;this.done=!1,requestAnimationFrame(function(){t.initial=Date.now(),t.terminal=t.initial+t.interval,t.repeat>=0&&(t.terminal=t.initial+t.interval*t.repeat,t.timeout=setTimeout(function(){if(t.done)return t.reverse?0:1;t.done=!0,t[i.PromiseMixin.Accept](t.reverse?0:1)},t.interval*t.repeat))})}},{key:"cancel",value:function(){return this.done?this.final:(clearTimeout(this.timeout),this.final=this.current(),this.canceled=this.done=!0,this[i.PromiseMixin.Reject](this.final),this.final)}},{key:"fraction",value:function(){if(this.done)return this.reverse?0:1;if(!1===this.initial)return this.reverse?1:0;var t=Date.now()-this.initial;if(t/this.interval>=this.repeat)return this.reverse?0:1;var e=t%this.interval/this.interval;return this.reverse?1-e:e}},{key:"current",value:function(){var t=this.fraction();return this.calculate?this.calculate(t):t}}])&&o(e.prototype,r),c&&o(e,c),l}();e.Ease=u}()}),require.register("curvature/animate/ease/CubicInOut.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.CubicInOut=void 0;var n=r("../Ease");function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=s(e);if(r){var o=s(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;return a(e)}(this,n)}}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(r,n.Ease);var e=o(r);function r(){var t,n,i,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];return t=e.call.apply(e,[this].concat(c)),n=a(t),o=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},(i="calculate")in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,t}return r}();e.CubicInOut=c}()}),require.register("curvature/animate/ease/QuintInOut.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.QuintInOut=void 0;var n=r("../Ease");function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=s(e);if(r){var o=s(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;return a(e)}(this,n)}}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(r,n.Ease);var e=o(r);function r(){var t,n,i,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];return t=e.call.apply(e,[this].concat(c)),n=a(t),o=function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},(i="calculate")in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,t}return r}();e.QuintInOut=c}()}),require.register("curvature/base/Bag.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Bag=void 0;var n=r("./Bindable"),i=r("./Mixin"),o=r("../mixin/EventTargetMixin");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=u(e);if(r){var o=u(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e)}(this,n)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.Mixin["with"](o.EventTargetMixin));var e,r,u,l=c(f);function f(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(t=l.call(this)).meta=Symbol("meta"),t.content=new Map,t.list=n.Bindable.makeBindable([]),t.current=0,t.type=void 0,t.length=0,t.changeCallback=e,t}return e=f,(r=[{key:"has",value:function(t){return this.content.has(t)}},{key:"add",value:function(t){if(void 0===t||!(t instanceof Object))throw new Error("Only objects may be added to Bags.");if(this.type&&!(t instanceof this.type))throw console.error(this.type,t),new Error("Only objects of type ".concat(this.type," may be added to this Bag."));if(!this.content.has(t)){var e=new CustomEvent("adding",{detail:{item:t}});if(this.dispatchEvent(e)){var r,n=(r=this.current++,Number(r));this.content.set(t,n),this.list[n]=t,this.changeCallback&&this.changeCallback(t,this.meta,f.ITEM_ADDED,n);var i=new CustomEvent("added",{detail:{item:t,id:n}});this.dispatchEvent(i),this.length=this.size}}}},{key:"remove",value:function(t){if(void 0===t||!(t instanceof Object))throw new Error("Only objects may be removed from Bags.");if(this.type&&!(t instanceof this.type))throw console.error(this.type,t),new Error("Only objects of type ".concat(this.type," may be removed from this Bag."));if(!this.content.has(t))return this.changeCallback&&this.changeCallback(t,this.meta,0,void 0),!1;var e=new CustomEvent("removing",{detail:{item:t}});if(this.dispatchEvent(e)){var r=this.content.get(t);delete this.list[r],this.content.delete(t),this.changeCallback&&this.changeCallback(t,this.meta,f.ITEM_REMOVED,r);var n=new CustomEvent("removed",{detail:{item:t,id:r}});return this.dispatchEvent(n),this.length=this.size,t}}},{key:"size",get:function(){return this.content.size}},{key:"items",value:function(){return Array.from(this.content.entries()).map(function(t){return t[0]})}}])&&a(e.prototype,r),u&&a(e,u),f}();e.Bag=l,Object.defineProperty(l,"ITEM_ADDED",{configurable:!1,enumerable:!1,writable:!0,value:1}),Object.defineProperty(l,"ITEM_REMOVED",{configurable:!1,enumerable:!1,writable:!0,value:-1})}()}),require.register("curvature/base/Bindable.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e,n,i){return(t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o}).apply(null,arguments)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function n(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||o(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=o(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,a=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function o(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t){"@babel/helpers - typeof";return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Object.defineProperty(e,"__esModule",{value:!0}),e.Bindable=void 0;var l=Symbol("ref"),f=Symbol("original"),h=Symbol("deck"),p=Symbol("binding"),g=Symbol("subBinding"),d=Symbol("bindingAll"),y=Symbol("isBindable"),b=Symbol("wrapping"),v=Symbol("Names"),m=Symbol("executing"),w=Symbol("stack"),S=(Symbol("object"),Symbol("wrapped")),O=Symbol("unwrapped"),x=Symbol("getProto"),k=Symbol("onGet"),j=Symbol("onAllGet"),P=Symbol("bindChain"),_=Symbol("Descriptors"),M=Symbol("NoGetters"),R=Object.getPrototypeOf(Int8Array),A=Set.prototype[Symbol.iterator],T=Map.prototype[Symbol.iterator],C=globalThis,E=[C.Node,C.File,C.Map,C.Set,C.WeakMap,C.WeakSet,C.ArrayBuffer,C.ResizeObserver,C.MutationObserver,C.PerformanceObserver,C.IntersectionObserver].filter(function(t){return"function"==typeof t}),B=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,o,a;return r=e,a=[{key:"isBindable",value:function(t){return!(!t||!t[y])&&t[y]===e}},{key:"onDeck",value:function(t,e){return t[h][e]||!1}},{key:"ref",value:function(t){return t[l]||t||!1}},{key:"makeBindable",value:function(t){return this.make(t)}},{key:"shuck",value:function(t,r){r=r||new Map;var n={};if(t instanceof R||t instanceof ArrayBuffer){var i=t.slice(0);return r.set(t,i),i}var o=Object.keys(t);for(var a in o){var c=o[a];if("___"!==c.substring(0,3)){var u=r.get(t[c]);if(u)n[c]=u;else if(t[c]!==t){if(t[c]&&"object"===s(t[c])){var l=t[c];e.isBindable(t[c])&&(l=t[c][f]),n[c]=this.shuck(l,r)}else n[c]=t[c];r.set(t[c],n[c])}else r.set(t[c],n),n[c]=n}}return e.isBindable(t)&&(delete n.bindTo,delete n.isBound),n}},{key:"make",value:function(r){var o=this;if(!r||!["function","object"].includes(s(r)))return r;if(E.filter(function(t){return r instanceof t}).length||Object.isSealed(r)||!Object.isExtensible(r))return r;if(r[l])return r[l];if(r[p])return r;Object.defineProperty(r,l,{configurable:!0,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(r,f,{configurable:!1,enumerable:!1,writable:!1,value:r}),Object.defineProperty(r,h,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(r,p,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(r,g,{configurable:!1,enumerable:!1,writable:!1,value:new Map}),Object.defineProperty(r,d,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(r,y,{configurable:!1,enumerable:!1,writable:!1,value:e}),Object.defineProperty(r,m,{enumerable:!1,writable:!0}),Object.defineProperty(r,b,{enumerable:!1,writable:!0}),Object.defineProperty(r,w,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(r,"___before___",{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(r,"___after___",{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(r,S,{configurable:!1,enumerable:!1,writable:!1,value:new Map}),Object.defineProperty(r,O,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(r,_,{configurable:!1,enumerable:!1,writable:!1,value:new Map});Object.defineProperty(r,"bindTo",{configurable:!1,enumerable:!1,writable:!1,value:function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=!1;if(Array.isArray(n)){var u=n.map(function(e){return t(e,i,a)});return function(){return u.map(function(t){return t()})}}if(n instanceof Function&&(a=i||{},i=n,c=!0),a.delay>=0&&(i=o.wrapDelayCallback(i,a.delay)),a.throttle>=0&&(i=o.wrapThrottleCallback(i,a.throttle)),a.wait>=0&&(i=o.wrapWaitCallback(i,a.wait)),a.frame&&(i=o.wrapFrameCallback(i,a.frame)),a.idle&&(i=o.wrapIdleCallback(i)),c){var l=r[d].length;if(r[d].push(i),!("now"in a)||a.now)for(var f in r)i(r[f],f,r,!1);return function(){delete r[d][l]}}if(r[p][n]||(r[p][n]=new Set),a.children){var h=i;i=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var o=n[0],c=r[g].get(h);if(c&&(r[g].delete(h),c()),"object"===s(o)){var u=e.make(o);e.isBindable(u)&&r[g].set(h,u.bindTo(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return h.apply(void 0,n.concat(e))},Object.assign({},a,{children:!1}))),h.apply(void 0,n)}else h.apply(void 0,n)}}r[p][n].add(i),"now"in a&&!a.now||i(r[n],n,r,!1);var y=function(){var t=r[g].get(i);t&&(r[g].delete(i),t()),r[p][n]&&r[p][n].has(i)&&r[p][n].delete(i)};return a.removeWith&&a.removeWith instanceof View&&a.removeWith.onRemove(function(){return y}),y}});Object.defineProperty(r,P,{configurable:!1,enumerable:!1,writable:!1,value:function(t,e){var n=t.split("."),i=n.shift(),a=n.slice(0),s=[];return s.push(r.bindTo(i,function(t,r,n,i){var c=a.join(".");0!==a.length?(void 0===t&&(t=n[r]=o.makeBindable({})),s=s.concat(t[P](c,e))):e(t,r,n,i)})),function(){return s.map(function(t){return t()})}}}),Object.defineProperty(r,"___before",{configurable:!1,enumerable:!1,writable:!1,value:function(t){var e=r.___before___.length;r.___before___.push(t);var n=!1;return function(){n||(n=!0,delete r.___before___[e])}}}),Object.defineProperty(r,"___after",{configurable:!1,enumerable:!1,writable:!1,value:function(t){var e=r.___after___.length;r.___after___.push(t);var n=!1;return function(){n||(n=!0,delete r.___after___[e])}}});if(Object.defineProperty(r,"isBound",{configurable:!1,enumerable:!1,writable:!1,value:function(){for(var t in r[d])if(r[d][t])return!0;for(var e in r[p])for(var n in r[p][e])if(r[p][e][n])return!0;return!1}}),!r[M]){var a=function(t){r[t]&&r[t]instanceof Object&&!r[t]instanceof Promise&&(E.filter(function(e){return r[t]instanceof e}).length||!Object.isExtensible(r[t])||Object.isSealed(r[t])||(r[t]=e.make(r[t])))};for(var c in r)a(c)}var u=r[_],C=r[S],B=r[w],D={get:function(n,o){if(C.has(o))return C.get(o);if(o===l||o===f||"apply"===o||"isBound"===o||"bindTo"===o||"__proto__"===o||"constructor"===o)return r[o];var a;if(u.has(o)?a=u.get(o):(a=Object.getOwnPropertyDescriptor(r,o),u.set(o,a)),a&&!a.configurable&&!a.writable)return r[o];if(j in r)return r[j](o);if(k in r&&!(o in r))return r[k](o);if(a&&!a.configurable&&!a.writable)return C.set(o,r[o]),r[o];if("function"==typeof r[o]){if(v in r[o])return r[o];Object.defineProperty(r[O],o,{configurable:!1,enumerable:!1,writable:!1,value:r[o]});var s=Object.getPrototypeOf(r)[o]===r[o],c="function"==typeof Promise&&r instanceof Promise||"function"==typeof Map&&r instanceof Map||"function"==typeof Set&&r instanceof Set||"function"==typeof T&&r.prototype===T||"function"==typeof A&&r.prototype===A||"function"==typeof A&&r.prototype===A||"function"==typeof WeakMap&&r instanceof WeakMap||"function"==typeof WeakSet&&r instanceof WeakSet||"function"==typeof Date&&r instanceof Date||"function"==typeof R&&r instanceof R||"function"==typeof ArrayBuffer&&r instanceof ArrayBuffer||"function"==typeof EventTarget&&r instanceof EventTarget||"function"==typeof ResizeObserver&&r instanceof ResizeObserver||"function"==typeof MutationObserver&&r instanceof MutationObserver||"function"==typeof PerformanceObserver&&r instanceof PerformanceObserver||"function"==typeof IntersectionObserver&&r instanceof IntersectionObserver||"function"==typeof r[Symbol.iterator]&&"next"===o?r:r[l],h=function(){r[m]=o,B.unshift(o);for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var u,l,f=i(r.___before___);try{for(f.s();!(u=f.n()).done;)(0,u.value)(r,o,B,r,n)}catch(t){f.e(t)}finally{f.f()}if(new.target)l=t(r[O][o],n);else{var h=r[O][o];l=s?h.apply(c||r,n):h.apply(void 0,n)}var p,g=i(r.___after___);try{for(g.s();!(p=g.n()).done;)(0,p.value)(r,o,B,r,n)}catch(t){g.e(t)}finally{g.f()}return r[m]=null,B.shift(),l};(h[v]=h[v]||new WeakMap).set(r,o),h[j]=function(t){var e=h[v].get(r);return r[e][t]};var p=e.make(h);return C.set(o,p),p}return r[o]},set:function(t,n,o){if(n===f)return!0;if(void 0!==r[h][n]&&r[h][n]===o)return!0;if("string"==typeof n&&"___"===n.substring(0,3)&&"___"===n.slice(-3))return!0;if(t[n]===o)return!0;for(var a in o&&o instanceof Object&&(E.filter(function(t){return r instanceof t}).length||!Object.isExtensible(r)||Object.isSealed(r)||r[M]||(o=e.makeBindable(o))),r[h][n]=o,r[d])r[d][a]&&r[d][a](o,n,t,!1);var s=!1;if(n in r[p]){var c,u=i(r[p][n]);try{for(u.s();!(c=u.n()).done;)!1===(0,c.value)(o,n,t,!1,t[n])&&(s=!0)}catch(t){u.e(t)}finally{u.f()}}if(delete r[h][n],!s){var l=Object.getOwnPropertyDescriptor(t,n);t instanceof File&&"lastModifiedDate"==n||l&&!l.writable||t[n]!==o||(t[n]=o)}var g=Reflect.set(t,n,o);if(Array.isArray(t)&&r[p].length)for(var y in r[p].length)(0,r[p].length[y])(t.length,"length",t,!1,t.length);return g},construct:function(i,o){var a="constructor";for(var s in i.___before___)i.___before___[s](i,a,r[w],void 0,o);var c=e.make(t(i[f],n(o)));for(var u in i.___after___)i.___after___[u](i,a,r[w],c,o);return c},getPrototypeOf:function(t){return x in r?r[x]:Reflect.getPrototypeOf(t)},deleteProperty:function(t,e){if(!(e in t))return!0;if(u.has(e)){var n=u.get(e);if(n&&!n.configurable)return!1;u.delete(e)}for(var i in r[d])r[d][i](void 0,e,t,!0,t[e]);if(e in r[p])for(var o in r[p][e])r[p][e][o]&&r[p][e][o](void 0,e,t,!0,t[e]);return delete t[e],!0}};return r[M]&&delete D.get,Object.defineProperty(r,l,{configurable:!1,enumerable:!1,writable:!1,value:new Proxy(r,D)}),r[l]}},{key:"clearBindings",value:function(t){var e;(e=function(t){return Object.keys(t).map(function(e){return delete t[e]})},function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.map(e)})(t[S],t[p],t[d],t.___after___,t.___before___)}},{key:"resolve",value:function(t,e){for(var r,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.split("."),o=i[0];i.length;){if(n&&1===i.length)return[t.NoGetters?this.make(t):t,i.shift(),o];!(!(r=i.shift())in t)&&t[r]&&t[r]instanceof Object||(t[r]={}),t=t.NoGetters?this.make(t[r]):t[r]}return[this.make(t),r,o]}},{key:"wrapDelayCallback",value:function(t,e){return function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return setTimeout(function(){return t.apply(void 0,n)},e)}}},{key:"wrapThrottleCallback",value:function(t,e){var r=this;return this.throttles.set(t,!1),function(){r.throttles.get(t,!0)||(t.apply(void 0,arguments),r.throttles.set(t,!0),setTimeout(function(){r.throttles.set(t,!1)},e))}}},{key:"wrapWaitCallback",value:function(t,e){var r=this;return function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var a;(a=r.waiters.get(t))&&(r.waiters.delete(t),clearTimeout(a)),a=setTimeout(function(){return t.apply(void 0,i)},e),r.waiters.set(t,a)}}},{key:"wrapFrameCallback",value:function(t,e){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];requestAnimationFrame(function(){return t.apply(void 0,r)})}}},{key:"wrapIdleCallback",value:function(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];(window.requestIdleCallback||requestAnimationFrame)(function(){return t.apply(void 0,r)})}}}],(o=null)&&c(r.prototype,o),a&&c(r,a),e}();e.Bindable=B,u(B,"waiters",new WeakMap),u(B,"throttles",new WeakMap),Object.defineProperty(B,"OnGet",{configurable:!1,enumerable:!1,writable:!1,value:k}),Object.defineProperty(B,"NoGetters",{configurable:!1,enumerable:!1,writable:!1,value:M}),Object.defineProperty(B,"GetProto",{configurable:!1,enumerable:!1,writable:!1,value:x}),Object.defineProperty(B,"OnAllGet",{configurable:!1,enumerable:!1,writable:!1,value:j})}()}),require.register("curvature/base/Cache.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Cache=void 0;var r=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,n,i;return r=e,i=[{key:"store",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"standard",i=0;r&&(i=1e3*r+(new Date).getTime()),this.buckets||(this.buckets=new Map),this.buckets.has(n)||this.buckets.set(n,new Map);var o=new CustomEvent("cvCacheStore",{cancelable:!0,detail:{key:t,value:e,expiry:r,bucket:n}});document.dispatchEvent(o)&&this.buckets.get(n).set(t,{value:e,expiration:i})}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"standard",n=new CustomEvent("cvCacheLoad",{cancelable:!0,detail:{key:t,defaultvalue:e,bucket:r}});if(!document.dispatchEvent(n))return e;if(this.buckets&&this.buckets.has(r)&&this.buckets.get(r).has(t)){var i=this.buckets.get(r).get(t);if(0===i.expiration||i.expiration>(new Date).getTime())return this.buckets.get(r).get(t).value}return e}}],(n=null)&&t(r.prototype,n),i&&t(r,i),e}();e.Cache=r}()}),require.register("curvature/base/Config.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Config=void 0;var n={};try{n=r("/Config").Config||{}}catch(t){!0===window.devMode&&console.error(t)}var i=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,n,i;return r=e,i=[{key:"get",value:function(t){return this.configs[t]}},{key:"set",value:function(t,e){return this.configs[t]=e,this}},{key:"dump",value:function(){return this.configs}},{key:"init",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];for(var n in e){var i=e[n];for(var o in"string"==typeof i&&(i=JSON.parse(i)),i){var a=i[o];return this.configs[o]=a}}return this}}],(n=null)&&t(r.prototype,n),i&&t(r,i),e}();e.Config=i,Object.defineProperty(i,"configs",{configurable:!1,enumerable:!1,writable:!1,value:n})}()}),require.register("curvature/base/Dom.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Dom=void 0;var r=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,n,i;return r=e,i=[{key:"mapTags",value:function(t,e,r,n,i){var o=[],a=!0;n&&(a=!1);var s=!1,c=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,{acceptNode:function(t,r){if(!a){if(t!==n)return NodeFilter.FILTER_SKIP;a=!0}return i&&t===i&&(s=!0),s?NodeFilter.FILTER_SKIP:e?t instanceof Element&&t.matches(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}},!1);for(0;c.nextNode();)o.push(r(c.currentNode,c));return o}},{key:"dispatchEvent",value:function(t,r){t.dispatchEvent(r),e.mapTags(t,!1,function(t){t.dispatchEvent(r)})}}],(n=null)&&t(r.prototype,n),i&&t(r,i),e}();e.Dom=r}()}),require.register("curvature/base/Mixin.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Mixin=void 0;var t=r("./Bindable");function n(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t){"@babel/helpers - typeof";return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=a(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}function a(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,n=h(t);if(e){var i=h(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l(this,r)}}function l(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?f(t):e}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var d=Symbol("constructor"),y=(Symbol("mixinList"),function(){function e(){p(this,e)}var r,a,s;return r=e,s=[{key:"from",value:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return function(r){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(s,t);var a=u(s);function s(){var t;p(this,s);for(var r=arguments.length,c=new Array(r),u=0;u<r;u++)c[u]=arguments[u];var h,g=t=a.call.apply(a,[this].concat(c)),d=o(n);try{for(d.s();!(h=d.n()).done;){var y=h.value;switch(y[e.Constructor]&&y[e.Constructor].apply(f(t)),i(y)){case"object":e.mixObject(y,f(t))}}}catch(t){d.e(t)}finally{d.f()}return l(t,g)}return s}()}},{key:"to",value:function(t){for(var e={},r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];n.map(function(r){switch(i(r)){case"object":Object.assign(e,Object.getOwnPropertyDescriptors(r));break;case"function":Object.assign(e,Object.getOwnPropertyDescriptors(r.prototype))}delete e.constructor,Object.defineProperties(t.prototype,e)})}},{key:"with",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.from.apply(this,[Object].concat(e))}},{key:"mixObject",value:function(t,e){var r,n=o(Object.getOwnPropertyNames(t));try{for(n.s();!(r=n.n()).done;){var i=r.value;"function"!=typeof t[i]?e[i]=t[i]:e[i]=t[i].bind(e)}}catch(t){n.e(t)}finally{n.f()}var a,s=o(Object.getOwnPropertySymbols(t));try{for(s.s();!(a=s.n()).done;){var c=a.value;"function"!=typeof t[c]?e[c]=t[c]:e[c]=t[c].bind(e)}}catch(t){s.e(t)}finally{s.f()}}},{key:"mixClass",value:function(t,e){var r,n=o(Object.getOwnPropertyNames(t.prototype));try{for(n.s();!(r=n.n()).done;){var i=r.value;e.prototype[i]=t.prototype[i].bind(e.prototype)}}catch(t){n.e(t)}finally{n.f()}var a,s=o(Object.getOwnPropertySymbols(t.prototype));try{for(s.s();!(a=s.n()).done;){var c=a.value;e.prototype[c]=t.prototype[c].bind(e.prototype)}}catch(t){s.e(t)}finally{s.f()}var u,l=o(Object.getOwnPropertyNames(t));try{var f=function(){var r=u.value;if("function"!=typeof t[r])return"continue";var n=e[r]||!1,i=t[r].bind(e);e[r]=function(){return n&&n.apply(void 0,arguments),i.apply(void 0,arguments)}};for(l.s();!(u=l.n()).done;)f()}catch(t){l.e(t)}finally{l.f()}var h,p=o(Object.getOwnPropertySymbols(t));try{var g=function(){var r=h.value;if("function"!=typeof t[r])return"continue";var n=e[r]||!1,i=t[r].bind(e);e[r]=function(){return n&&n.apply(void 0,arguments),i.apply(void 0,arguments)}};for(p.s();!(h=p.n()).done;)g()}catch(t){p.e(t)}finally{p.f()}}},{key:"mix",value:function(e){for(var r={},i={},a=t.Bindable.makeBindable(e),s=function(t){var e,s=Object.getOwnPropertyNames(t.prototype),c=/^(before|after)__(.+)/,u=o(Object.getOwnPropertyNames(t));try{var l=function(){var i=e.value,o=i.match(c);if(o){switch(o[1]){case"before":a.___before(function(e,r,a,s,c){if(r===o[2])return t[i].bind(s).apply(void 0,n(c))});break;case"after":a.___after(function(e,r,a,s,c){if(r===o[2])return t[i].bind(s).apply(void 0,n(c))})}return"continue"}return r[i]?"continue":"function"!=typeof t[i]?"continue":void(r[i]=t[i])};for(u.s();!(e=u.n()).done;)l()}catch(t){u.e(t)}finally{u.f()}var f,h=o(s);try{var p=function(){var e=f.value,r=e.match(c);if(r){switch(r[1]){case"before":a.___before(function(i,o,a,s,c){if(o===r[2])return t.prototype[e].bind(s).apply(void 0,n(c))});break;case"after":a.___after(function(i,o,a,s,c){if(o===r[2])return t.prototype[e].bind(s).apply(void 0,n(c))})}return"continue"}return i[e]?"continue":"function"!=typeof t.prototype[e]?"continue":void(i[e]=t.prototype[e])};for(h.s();!(f=h.n()).done;)p()}catch(t){h.e(t)}finally{h.f()}},c=this;c&&c.prototype;c=Object.getPrototypeOf(c))s(c);for(var u in r)e[u]=r[u].bind(e);var l=function(t){e.prototype[t]=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return i[t].apply(this,r)}};for(var f in i)l(f);return a}}],(a=null)&&g(r.prototype,a),s&&g(r,s),e}());e.Mixin=y,y.Constructor=d}()}),require.register("curvature/base/Router.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Router=void 0;var t=r("./View"),n=(r("./Cache"),r("./Config")),i=r("./Routes");function o(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=Symbol("NotFound"),u=Symbol("Internal"),l=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,a,u;return r=e,u=[{key:"wait",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DOMContentLoaded";(arguments.length>2&&void 0!==arguments[2]?arguments[2]:document).addEventListener(r,function(){e.listen(t)})}},{key:"listen",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.routes=r||t.routes,Object.assign(this.query,this.queryOver({}));var n=function(r){for(var n in r.preventDefault(),r.state&&"routedId"in r.state?r.state.routedId<=e.routeCount?(e.history.splice(r.state.routedId),e.routeCount=r.state.routedId):r.state.routedId>e.routeCount&&(e.history.push(r.state.prev),e.routeCount=r.state.routedId):null!==e.prevPath&&e.prevPath!==location.pathname&&e.history.push(e.prevPath),"null"!==location.origin?e.match(location.pathname,t):e.match(e.nextPath,t),e.query)delete e.query[n];Object.assign(e.query,e.queryOver({}))};window.addEventListener("popstate",n),window.addEventListener("cvUrlChanged",n);var i="null"!==location.origin&&location.pathname+location.search;location.origin&&location.hash&&(i+=location.hash),this.go(!1!==i?i:"/")}},{key:"go",value:function(t,e){var r=n.Config.get("title");for(var i in r&&(document.title=r),"null"===location.origin?this.nextPath=t:2===e&&location.pathname!==t?history.replaceState({routedId:this.routeCount,prev:this.prevPath,url:location.pathname},null,t):location.pathname!==t&&history.pushState({routedId:++this.routeCount,prev:this.prevPath,url:location.pathname},null,t),e||(!1===e&&(this.path=null),"#"===t.substring(0,1)?window.dispatchEvent(new HashChangeEvent("hashchange")):window.dispatchEvent(new CustomEvent("cvUrlChanged"))),this.query)delete this.query[i];Object.assign(this.query,this.queryOver({})),this.prevPath=t}},{key:"match",value:function(e,r){var n=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.path!==e||o){this.queryString=location.search,this.path=e;var a=this.prevPath,s=r.args.content,u=this.routes||r.routes||i.Routes.dump();new URLSearchParams(location.search);for(var l in this.query)delete this.query[l];Object.assign(this.query,this.queryOver({}));var f={},h=!1,p="";for(var g in e=e.substr(1).split("/"),this.query)f[g]=this.query[g];t:for(var d in u){var y=d.split("/");if(!(y.length<e.length&&"*"!==y[y.length-1])){for(var b in y)if("%"==y[b].substr(0,1)){var v=null,m=/^%(\w+)\??/.exec(y[b]);if(m&&m[1]&&(v=m[1]),!v)throw new Error("".concat(y[b],' is not a valid argument segment in route "').concat(d,'"'));if(e[b])f[v]=e[b];else{if("?"!=y[b].substr(y[b].length-1,1))continue t;f[v]=""}}else if("*"!==y[b]&&e[b]!==y[b])continue t;h=d,p=u[d],"*"===y[y.length-1]&&(f.pathparts=e.slice(y.length-1));break}}var w=new CustomEvent("cvRouteStart",{cancelable:!0,detail:{path:e,prev:a,root:r,selected:h,routes:u}});if(document.dispatchEvent(w)){if(!o&&r&&s&&p instanceof Object&&s instanceof p&&!(p instanceof Promise)&&s.update(f))return r.args.content=s,!0;try{h in u||(u[h]=u[c]);var S=function(e){return"function"==typeof u[e]?u[e].prototype instanceof t.View?new u[e](f):u[e](f):u[e]};return!1===(p=S(h))&&(p=S(c)),p instanceof Promise?p.then(function(t){n.update(r,e,t,u,h,f,o)}).catch(function(t){throw document.dispatchEvent(new CustomEvent("cvRouteError",{detail:{error:t,path:e,prev:a,view:r,routes:u,selected:h}})),n.update(r,e,window.devMode?String(t):"Error: 500",u,h,f,o),t}):this.update(r,e,p,u,h,f,o)}catch(t){throw document.dispatchEvent(new CustomEvent("cvRouteError",{detail:{error:t,path:e,prev:a,view:r,routes:u,selected:h}})),this.update(r,e,window.devMode?String(t):"Error: 500",u,h,f,o),t}}}}},{key:"update",value:function(e,r,n,i,o,a,s){if(e){var c=this.prevPath,u=new CustomEvent("cvRoute",{cancelable:!0,detail:{result:n,path:r,prev:c,view:e,routes:i,selected:o}});!1!==n&&(e.args.content instanceof t.View&&(e.args.content.pause(!0),e.args.content.remove()),document.dispatchEvent(u)&&(e.args.content=n),n instanceof t.View&&(n.pause(!1),n.update(a,s)));var l=new CustomEvent("cvRouteEnd",{cancelable:!0,detail:{result:n,path:r,prev:c,view:e,routes:i,selected:o}});document.dispatchEvent(l)}}},{key:"queryOver",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={},n={},i=o(new URLSearchParams(location.search));try{for(i.s();!(t=i.n()).done;){var a=t.value;n[a[0]]=a[1]}}catch(t){i.e(t)}finally{i.f()}return delete(r=Object.assign(r,n,e)).api,r}},{key:"queryToString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],n=t;for(var i in e||(n=this.queryOver(t)),n)""!==n[i]&&r.push(i+"="+encodeURIComponent(n[i]));return r.join("&")}},{key:"setQuery",value:function(t,e,r){var n=this.queryOver();n[t]=e,void 0===e&&delete n[t];var i=this.queryToString(n,!0);this.go(location.pathname+(i?"?"+i:""),r)}}],(a=null)&&s(r.prototype,a),u&&s(r,u),e}();e.Router=l,Object.defineProperty(l,"query",{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(l,"history",{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(l,"routeCount",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(l,"prevPath",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(l,"queryString",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(l,"InternalError",{configurable:!1,enumerable:!1,writable:!1,value:u}),Object.defineProperty(l,"NotFoundError",{configurable:!1,enumerable:!1,writable:!1,value:c})}()}),require.register("curvature/base/Routes.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Routes=void 0;var n={};try{Object.assign(n,r("Routes").Routes||{})}catch(t){!0===globalThis.devMode&&console.warn(t)}var i=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,n,i;return r=e,i=[{key:"get",value:function(t){return this.routes[t]}},{key:"dump",value:function(){return this.routes}}],(n=null)&&t(r.prototype,n),i&&t(r,i),e}();e.Routes=i,Object.defineProperty(i,"routes",{configurable:!1,enumerable:!1,writable:!1,value:n})}()}),require.register("curvature/base/RuleSet.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RuleSet=void 0;r("./Dom");var t=r("./Tag"),n=r("./View");function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}(t,e)||a(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=a(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}function a(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,a,s;return r=e,s=[{key:"add",value:function(t,e){return this.globalRules=this.globalRules||{},this.globalRules[t]=this.globalRules[t]||[],this.globalRules[t].push(e),this}},{key:"apply",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var r in this.globalRules)for(var n in this.globalRules[r]){var i,a=this.globalRules[r][n],s=this.wrap(t,a,e),c=o(t.querySelectorAll(r));try{for(c.s();!(i=c.n()).done;){s(i.value)}}catch(t){c.e(t)}finally{c.f()}}}},{key:"wait",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"DOMContentLoaded",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n=function(e,r){return function(){return r.removeEventListener(e,n),t.apply()}}(e,r);r.addEventListener(e,n)}},{key:"wrap",value:function(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=r;return(r instanceof n.View||r&&r.prototype&&r.prototype instanceof n.View)&&(o=function(){return r}),function(e){if(void 0===e.___cvApplied___&&Object.defineProperty(e,"___cvApplied___",{enumerable:!1,writable:!1,value:new WeakSet}),!e.___cvApplied___.has(r)){var a,s;i&&(a=s=i,i.viewList&&(s=i.viewList.parent));var c,u=new t.Tag(e,s,null,void 0,a),l=u.element.parentNode,f=u.element.nextSibling,h=o(u);if(!1!==h&&e.___cvApplied___.add(r),h instanceof HTMLElement&&(h=new t.Tag(h)),h instanceof t.Tag){if(!h.element.contains(u.element)){for(;u.element.firstChild;)h.element.appendChild(u.element.firstChild);u.remove()}f?l.insertBefore(h.element,f):l.appendChild(h.element)}h&&h.prototype&&h.prototype instanceof n.View&&(h=new h({},i)),h instanceof n.View&&(i&&(i.cleanup.push((c=h,function(){c.remove()})),i.cleanup.push(i.args.bindTo(function(t,e,r){r[e]=t,h.args[e]=t})),i.cleanup.push(h.args.bindTo(function(t,e,r,n){r[e]=t,i.args[e]=t}))),u.clear(),h.render(u.element))}}}}],(a=[{key:"add",value:function(t,e){return this.rules=this.rules||{},this.rules[t]=this.rules[t]||[],this.rules[t].push(e),this}},{key:"apply",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var n in e.apply(t,r),this.rules)for(var i in this.rules[n]){var a,s=this.rules[n][i],c=e.wrap(t,s,r),u=o(t.querySelectorAll(n));try{for(u.s();!(a=u.n()).done;){c(a.value)}}catch(t){u.e(t)}finally{u.f()}}}},{key:"purge",value:function(){if(this.rules)for(var t=0,e=Object.entries(this.rules);t<e.length;t++){var r=i(e[t],2),n=r[0];r[1];if(this.rules[n])for(var o in this.rules[n])delete this.rules[n][o]}}}])&&c(r.prototype,a),s&&c(r,s),e}();e.RuleSet=u}()}),require.register("curvature/base/SetMap.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e,n,i){return(t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o}).apply(null,arguments)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function n(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||i(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.SetMap=void 0;var s=function(){function e(){var t,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,r="_map",n=new Map,r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}var r,o,s;return r=e,(o=[{key:"has",value:function(t){return this._map.has(t)}},{key:"get",value:function(t){return this._map.get(t)}},{key:"getOne",value:function(t){var e,r=function(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=i(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,a=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}(this.get(t));try{for(r.s();!(e=r.n()).done;){return e.value}}catch(t){r.e(t)}finally{r.f()}}},{key:"add",value:function(t,e){var r=this._map.get(t);return r||this._map.set(t,r=new Set),r.add(e)}},{key:"remove",value:function(t,e){var r=this._map.get(t);if(r){var n=r.delete(e);return r.size||this._map.delete(t),n}}},{key:"values",value:function(){return t(Set,n(n(this._map.values()).map(function(t){return n(t.values())})))}}])&&a(r.prototype,o),s&&a(r,s),e}();e.SetMap=s}()}),require.register("curvature/base/Tag.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tag=void 0;var t=r("./Bindable");function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=function(){function e(r,n,i,o,a){var s=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),"string"==typeof r){var c=document.createRange().createContextualFragment(r);r=c.firstChild}this.element=t.Bindable.makeBindable(r),this.node=this.element,this.parent=n,this.direct=a,this.ref=i,this.index=o,this.cleanup=[],this[t.Bindable.OnAllGet]=function(t){return"function"==typeof s[t]?s[t]:s.node&&"function"==typeof s.node[t]?function(){var e;return(e=s.node)[t].apply(e,arguments)}:s.node&&t in s.node?s.node[t]:s[t]};var u;return this.style=(u=this,t.Bindable.make(function(t){if(u.node)for(var e in t)"-"===e[0]?u.node.style.setProperty(e,t[e]):u.node.style[e]=t[e]})),this.proxy=t.Bindable.make(this),this.proxy.style.bindTo(function(t,e){s.element.style[e]=t}),this.proxy.bindTo(function(t,e){return e in r&&(r[e]=t),!1}),this.proxy}var r,i,o;return r=e,(i=[{key:"attr",value:function(t){for(var e in t)void 0===t[e]?this.node.removeAttribute(e):null===t[e]?this.node.setAttribute(e,""):this.node.setAttribute(e,t[e])}},{key:"remove",value:function(){var e;for(this.node&&this.node.remove(),t.Bindable.clearBindings(this);e=this.cleanup.shift();)e();if(this.clear(),this.node){var r=new Event("cvDomDetached");this.node.dispatchEvent(r),this.node=this.element=this.ref=this.parent=void 0}}},{key:"clear",value:function(){if(this.node)for(var t=new Event("cvDomDetached");this.node.firstChild;)this.node.firstChild.dispatchEvent(t),this.node.removeChild(this.node.firstChild)}},{key:"pause",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}},{key:"listen",value:function(t,e,r){var n=this.node;n.addEventListener(t,e,r);var i=function(){n.removeEventListener(t,e,r)},o=function(){i(),i=function(){return console.warn("Already removed!")}};return this.parent.onRemove(function(){return o()}),o}}])&&n(r.prototype,i),o&&n(r,o),e}();e.Tag=i}()}),require.register("curvature/base/View.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.View=void 0;var n=r("./Bindable"),i=r("./ViewList"),o=r("./Router"),a=r("./Dom"),s=r("./Tag"),c=r("./Bag"),u=r("./RuleSet"),l=r("./Mixin"),f=(r("../mixin/PromiseMixin"),r("../mixin/EventTargetMixin"));function h(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||d(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}(t,e)||d(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=d(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function d(t,e){if(t){if("string"==typeof t)return y(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=S(e);if(r){var o=S(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;return w(e)}(this,n)}}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var O=Symbol("dontParse"),x=Symbol("expandBind"),k=Symbol("uuid"),j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(j,l.Mixin["with"](f.EventTargetMixin));var e,d,y,S=m(j);function j(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,j),t=S.call(this,e,r),Object.defineProperty(w(t),"args",{value:n.Bindable.make(e)}),Object.defineProperty(w(t),k,{value:t.constructor.uuid()}),Object.defineProperty(w(t),"nodesAttached",{value:new c.Bag(function(t,e,r){})}),Object.defineProperty(w(t),"nodesDetached",{value:new c.Bag(function(t,e,r){})}),Object.defineProperty(w(t),"_onRemove",{value:new c.Bag(function(t,e,r){})}),Object.defineProperty(w(t),"cleanup",{value:[]}),Object.defineProperty(w(t),"parent",{value:r}),Object.defineProperty(w(t),"views",{value:new Map}),Object.defineProperty(w(t),"viewLists",{value:new Map}),Object.defineProperty(w(t),"withViews",{value:new Map}),Object.defineProperty(w(t),"tags",{value:n.Bindable.make({})}),Object.defineProperty(w(t),"nodes",{value:n.Bindable.make([])}),Object.defineProperty(w(t),"timeouts",{value:new Map}),Object.defineProperty(w(t),"intervals",{value:[]}),Object.defineProperty(w(t),"frames",{value:[]}),Object.defineProperty(w(t),"ruleSet",{value:new u.RuleSet}),Object.defineProperty(w(t),"preRuleSet",{value:new u.RuleSet}),Object.defineProperty(w(t),"subBindings",{value:{}}),Object.defineProperty(w(t),"templates",{value:{}}),Object.defineProperty(w(t),"eventCleanup",{value:[]}),Object.defineProperty(w(t),"unpauseCallbacks",{value:new Map}),Object.defineProperty(w(t),"interpolateRegex",{value:/(\[\[((?:\$+)?[\w\.\|-]+)\]\])/g}),Object.defineProperty(w(t),"rendered",{value:new Promise(function(e,r){return Object.defineProperty(w(t),"renderComplete",{value:e})})}),t.template="",t.firstNode=null,t.lastNode=null,t.viewList=null,t.mainView=null,t.preserve=!1,t.removed=!1,t}return e=j,d=[{key:"_id",get:function(){return this[k]}},{key:"onFrame",value:function(t){var e=this,r=!1,n=function(){r=!0};return requestAnimationFrame(function(){return function n(i){e.removed||r||(e.paused||t(Date.now()),requestAnimationFrame(n))}(Date.now())}),this.frames.push(n),n}},{key:"onNextFrame",value:function(t){return requestAnimationFrame(function(){return t(Date.now())})}},{key:"onIdle",value:function(t){return requestIdleCallback(function(){return t(Date.now())})}},{key:"onTimeout",value:function(t,e){var r=this,n={timeout:null,callback:null,time:t,fired:!1,created:(new Date).getTime(),paused:!1},i=function(){e(),n.fired=!0,r.timeouts.delete(n.timeout)},o=setTimeout(i,t);return n.callback=i,n.timeout=o,this.timeouts.set(n.timeout,n),o}},{key:"clearTimeout",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){var e,r=g(this.timeouts);try{for(r.s();!(e=r.n()).done;){var n=p(e.value,2),i=(n[0],n[1]);clearTimeout(i.timeout),this.timeouts.delete(i.timeout)}}catch(t){r.e(t)}finally{r.f()}})},{key:"onInterval",value:function(t,e){var r=setInterval(e,t);return this.intervals.push({timeout:r,callback:e,time:t,paused:!1}),r}},{key:"clearInterval",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){for(var e in this.intervals)t===this.intervals[e].timeout&&(clearInterval(this.intervals[e].timeout),delete this.intervals[e])})},{key:"pause",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(void 0===t&&(this.paused=!this.paused),this.paused=t,this.paused){var e,r=g(this.timeouts);try{for(r.s();!(e=r.n()).done;){var n=p(e.value,2),i=(n[0],n[1]);i.fired?this.timeouts.delete(i.timeout):(clearTimeout(i.timeout),i.paused=!0,i.time=Math.max(0,i.time-(Date.now()-i.created)))}}catch(t){r.e(t)}finally{r.f()}for(var o in this.intervals)clearInterval(this.intervals[o].timeout)}else{var a,s=g(this.timeouts);try{for(s.s();!(a=s.n()).done;){var c=p(a.value,2),u=(c[0],c[1]);u.paused&&(u.fired?this.timeouts.delete(u.timeout):(u.timeout=setTimeout(u.callback,u.time),u.paused=!1))}}catch(t){s.e(t)}finally{s.f()}for(var l in this.intervals)this.intervals[l].timeout.paused&&(this.intervals[l].timeout.paused=!1,this.intervals[l].timeout=setInterval(this.intervals[l].callback,this.intervals[l].time));var f,h=g(this.unpauseCallbacks);try{for(h.s();!(f=h.n()).done;){(0,p(f.value,2)[1])()}}catch(t){h.e(t)}finally{h.f()}this.unpauseCallbacks.clear()}var d,y=g(this.viewLists);try{for(y.s();!(d=y.n()).done;){var b=p(d.value,2);b[0];b[1].pause(!!t)}}catch(t){y.e(t)}finally{y.f()}for(var v in this.tags)if(Array.isArray(this.tags[v]))for(var m in this.tags[v])this.tags[v][m].pause(!!t);else this.tags[v].pause(!!t)}},{key:"render",value:function(){var t,e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(r instanceof j&&(r=r.firstNode.parentNode),n instanceof j&&(n=n.firstNode),this.firstNode)return this.reRender(r,n);this.dispatchEvent(new CustomEvent("render"));var i=this.template instanceof DocumentFragment?this.template.cloneNode(!0):j.templates.has(this.template),o=i?this.template instanceof DocumentFragment?i:j.templates.get(this.template).cloneNode(!0):document.createRange().createContextualFragment(this.template);if(i||this.template instanceof DocumentFragment||j.templates.set(this.template,o.cloneNode(!0)),this.mainView||this.preRuleSet.apply(o,this),this.mapTags(o),this.mainView||this.ruleSet.apply(o,this),!0===window.devMode?(this.firstNode=document.createComment("Template ".concat(this._id," Start")),this.lastNode=document.createComment("Template ".concat(this._id," End"))):(this.firstNode=document.createTextNode(""),this.lastNode=document.createTextNode("")),(t=this.nodes).push.apply(t,[this.firstNode].concat(h(Array.from(o.childNodes)),[this.lastNode])),this.postRender(r),this.dispatchEvent(new CustomEvent("rendered")),this.dispatchAttach()){if(r){var a=r.getRootNode(),s=!1;if(a.isConnected&&("external",s=!0),n?(r.insertBefore(this.firstNode,n),r.insertBefore(this.lastNode,n)):(r.appendChild(this.firstNode),r.appendChild(this.lastNode)),r.insertBefore(o,this.lastNode),0,s)this.attached(a,r),this.dispatchAttached(a,r);else{r.addEventListener("cvDomAttached",function t(n){n.target.isConnected&&(e.attached(a,r),e.dispatchAttached(a,r),r.removeEventListener("cvDomAttached",t))})}}return this.renderComplete(this.nodes),this.nodes}}},{key:"dispatchAttach",value:function(){return this.dispatchEvent(new CustomEvent("attach",{cancelable:!0,target:this}))}},{key:"dispatchAttached",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.dispatchEvent(new CustomEvent("attached",{detail:{view:r||this,node:e,root:t,mainView:this}}));var n=this.nodesAttached.items();for(var i in n)n[i](t,e);this.dispatchDomAttached(r)}},{key:"dispatchDomAttached",value:function(t){var e=this;this.nodes.filter(function(t){return t.nodeType!==Node.COMMENT_NODE}).map(function(r){r.matches&&(a.Dom.mapTags(r,!1,function(r,n){r.matches&&r.dispatchEvent(new CustomEvent("cvDomAttached",{target:r,detail:{view:t||e,mainView:e}}))}),r.dispatchEvent(new CustomEvent("cvDomAttached",{target:r,detail:{view:t||e,mainView:e}})))})}},{key:"reRender",value:function(t,e){if(this.dispatchEvent(new CustomEvent("reRender"),{cancelable:!0,target:this})){var r=new DocumentFragment;if(this.firstNode.isConnected){var n=this.nodesDetached.items();for(var i in n)n[i]()}if(r.append.apply(r,h(this.nodes)),t){e?(t.insertBefore(this.firstNode,e),t.insertBefore(this.lastNode,e)):(t.appendChild(this.firstNode),t.appendChild(this.lastNode)),t.insertBefore(r,this.lastNode),this.dispatchEvent(new CustomEvent("reRendered"),{cancelable:!0,target:this});var o=t.getRootNode();o.isConnected&&(this.attached(o,t),this.dispatchAttached(o,t))}return this.nodes}}},{key:"mapTags",value:function(t){var e=this;a.Dom.mapTags(t,!1,function(t,r){t[O]||(t=t.matches?(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=e.mapInterpolatableTag(t)).matches("[cv-template]")&&e.mapTemplateTag(t)||t).matches("[cv-slot]")&&e.mapSlotTag(t)||t).matches("[cv-prerender]")&&e.mapPrendererTag(t)||t).matches("[cv-link]")&&e.mapLinkTag(t)||t).matches("[cv-attr]")&&e.mapAttrTag(t)||t).matches("[cv-expand]")&&e.mapExpandableTag(t)||t).matches("[cv-ref]")&&e.mapRefTag(t)||t).matches("[cv-on]")&&e.mapOnTag(t)||t).matches("[cv-each]")&&e.mapEachTag(t)||t).matches("[cv-bind]")&&e.mapBindTag(t)||t).matches("[cv-with]")&&e.mapWithTag(t)||t).matches("[cv-if]")&&e.mapIfTag(t)||t).matches("[cv-view]")&&e.mapViewTag(t)||t:e.mapInterpolatableTag(t))!==r.currentNode&&(r.currentNode=t)})}},{key:"mapExpandableTag",value:function(t){var e=t[x];e&&(e(),t[x]=!1);var r=p(n.Bindable.resolve(this.args,t.getAttribute("cv-expand"),!0),2),i=r[0],o=r[1];return t.removeAttribute("cv-expand"),i[o]||(i[o]={}),i[o]=n.Bindable.make(i[o]),this.onRemove(t[x]=i[o].bindTo(function(e,r,n,i,o){i||void 0===e?t.removeAttribute(r,e):null!==e?t.setAttribute(r,e):t.setAttribute(r,"")})),t}},{key:"compileExpandableTag",value:function(t){return function(e){var r=t.cloneNode(!0),i=r.getAttribute("cv-expand"),o=n.Bindable.make(e.args[i]||{});r.removeAttribute("cv-expand");var a=function(t){if("name"===t||"type"===t)return"continue";var i=o.bindTo(t,function(t,e){return function(r){t.setAttribute(e,r)}}(r,t));e.onRemove(function(){i(),o.isBound()&&n.Bindable.clearBindings(o)})};for(var s in o)a(s);return r}}},{key:"mapAttrTag",value:function(t){var e=this.compileAttrTag(t)(this);return t.replaceWith(e),e}},{key:"compileAttrTag",value:function(t){var e=t.getAttribute("cv-attr").split(",").map(function(t){return t.split(":")});return t.removeAttribute("cv-attr"),function(r){var i=t.cloneNode(!0),o=function(t){var o=e[t][1]||e[t][0],a=p(n.Bindable.resolve(r.args,o,!0),2),s=a[0],c=a[1],u=e[t][0];r.onRemove(s.bindTo(c,function(t,e,r,n){n||void 0===t?i.removeAttribute(u,t):null!==t?i.setAttribute(u,t):i.setAttribute(u,"")}))};for(var a in e)o(a);return i}}},{key:"mapInterpolatableTag",value:function(t){var e=this,r=this.interpolateRegex;if(t.nodeType===Node.TEXT_NODE){var i=t.nodeValue;if(!this.interpolatable(i))return t;for(var o,a=0,c=function(){var r=o[2],c=!1,u=!1,l=r.split("|"),f=!1;if(l.length>1&&(f=e.stringTransformer(l.slice(1)),r=l[0]),"$$"===r.substr(0,2)&&(c=!0,u=!0,r=r.substr(2)),"$"===r.substr(0,1)&&(c=!0,r=r.substr(1)),"000"===r.substr(0,3))return expand=!0,r=r.substr(3),"continue";var h=i.substring(a,o.index);a=o.index+o[1].length;var g=document.createTextNode(h);g[O]=!0,t.parentNode.insertBefore(g,t);var d=void 0;(d=c?document.createElement("div"):document.createTextNode(""))[O]=!0;var y=e.args,b=r;if(r.match(/\./)){var v=p(n.Bindable.resolve(e.args,r,!0),2);y=v[0],b=v[1]}t.parentNode.insertBefore(d,t);var m=y.bindTo(b,function(r,n,i){if(i[n]!==r&&(i[n]instanceof j||i[n]instanceof Node||i[n]instanceof s.Tag)&&(i[n].preserve||i[n].remove()),d.nodeValue="",u&&!(r instanceof j)){var o=r;(r=new j(e.args,e)).template=o}if(f&&(r=f(r)),r instanceof j){var a=function(t,n){r.dispatchDomAttached(e)};e.nodesAttached.add(a),r.render(t.parentNode,d);var l=function(){r.preserve||r.remove()};e.onRemove(l),r.onRemove(function(){e.nodesAttached.remove(a),e._onRemove.remove(l)})}else r instanceof Node?(t.parentNode.insertBefore(r,d),e.onRemove(function(){return r.remove()})):r instanceof s.Tag?(t.parentNode.insertBefore(r.node,d),e.onRemove(function(){return r.remove()})):(r instanceof Object&&r.__toString instanceof Function&&(r=r.__toString()),c?d.innerHTML=r:d.nodeValue=r);d[O]=!0});e.onRemove(m)};o=r.exec(i);)c();var u=i.substring(a),l=document.createTextNode(u);l[O]=!0,t.parentNode.insertBefore(l,t),t.nodeValue=""}else if(t.nodeType===Node.ELEMENT_NODE)for(var f=function(i){if(!e.interpolatable(t.attributes[i].value))return"continue";for(var o=0,a=void 0,s=t.attributes[i].value,c=t.attributes[i],u={},l=[];a=r.exec(s);)l.push(s.substring(o,a.index)),u[a[2]]||(u[a[2]]=[]),u[a[2]].push(l.length),l.push(a[1]),o=a.index+a[1].length;l.push(s.substring(o));var f=function(r){var i=e.args,o=r,a=r.split("|"),s=!1,f=r;if(a.length>1&&(s=e.stringTransformer(a.slice(1)),o=a[0]),o.match(/\./)){var h=p(n.Bindable.resolve(e.args,o,!0),2);i=h[0],o=h[1]}u[f];e.onRemove(i.bindTo(o,function(r,n,i,a){for(var h in s&&(r=s(r)),u)for(var p in u[f])l[u[f][p]]=i[h],n===o&&(l[u[f][p]]=r);e.paused?e.unpauseCallbacks.set(c,function(){return t.setAttribute(c.name,l.join(""))}):t.setAttribute(c.name,l.join(""))})),e.onRemove(function(){i.isBound()||n.Bindable.clearBindings(i)})};for(var h in u)f(h)},h=0;h<t.attributes.length;h++)f(h);return t}},{key:"mapRefTag",value:function(t){var e=p(t.getAttribute("cv-ref").split(":"),3),r=e[0],n=e[1],i=void 0===n?null:n,o=e[2],a=void 0===o?null:o,c=s.Tag;i&&(c=this.stringToClass(i)),t.removeAttribute("cv-ref"),Object.defineProperty(t,"___tag___",{enumerable:!1,writable:!0}),this.onRemove(function(){t.___tag___=null,t.remove()});var u=this;this.viewList&&(u=this.viewList.parent);var l=new c(t,this,r,void 0,this);for(t.___tag___=l,this.tags[r]=l;u;){u.parent;var f=this.args[a];void 0!==f?(u.tags[r]||(u.tags[r]=[]),u.tags[r][f]=l):u.tags[r]=l,u=u.parent}return t}},{key:"mapBindTag",value:function(t){var e=this,r=t.getAttribute("cv-bind"),i=this.args,o=r,c=null;if(r.match(/\./)){var u=p(n.Bindable.resolve(this.args,r,!0),3);i=u[0],o=u[1],c=u[2]}i!==this.args&&(this.subBindings[r]=this.subBindings[r]||[],this.onRemove(this.args.bindTo(c,function(){for(;e.subBindings.length;)e.subBindings.shift()()})));var l=!1;"$"===o.substr(0,1)&&(o=o.substr(1),l=!0);var f=i.bindTo(o,function(r,n,i,o,c){(c instanceof j||c instanceof Node||c instanceof s.Tag)&&c!==r&&c.remove();var u=new CustomEvent("cvAutoChanged",{bubbles:!0});if(["INPUT","SELECT","TEXTAREA"].includes(t.tagName)){var f=t.getAttribute("type");if(f&&"checkbox"===f.toLowerCase())t.checked=!!r,t.dispatchEvent(u);else if(f&&"radio"===f.toLowerCase())t.checked=r==t.value,t.dispatchEvent(u);else if("file"!==f){if("SELECT"===t.tagName){var h=function(){for(var e=0;e<t.options.length;e++){t.options[e].value==r&&(t.selectedIndex=e)}};h(),e.nodesAttached.add(h)}else t.value=null==r?"":r;t.dispatchEvent(u)}}else if(r instanceof j){var p,d=g(t.childNodes);try{for(d.s();!(p=d.n()).done;){p.value.remove()}}catch(t){d.e(t)}finally{d.f()}var y=function(t){r.dispatchDomAttached(e)};e.nodesAttached.add(y),r.render(t),r.onRemove(function(){return e.nodesAttached.remove(y)})}else if(r instanceof Node)t.insert(r);else if(r instanceof s.Tag)t.append(r.node);else if(l){if(t.innerHTML!==r){if(r=String(r),t.innerHTML===r.substring(0,t.innerHTML.length))t.innerHTML+=r.substring(t.innerHTML.length);else{var b,v=g(t.childNodes);try{for(v.s();!(b=v.n()).done;){b.value.remove()}}catch(t){v.e(t)}finally{v.f()}t.innerHTML=r}a.Dom.mapTags(t,!1,function(t){return t[O]=!0})}}else if(t.textContent!==r){var m,w=g(t.childNodes);try{for(w.s();!(m=w.n()).done;){m.value.remove()}}catch(t){w.e(t)}finally{w.f()}t.textContent=r}});i!==this.args&&this.subBindings[r].push(f),this.onRemove(f);var h=t.getAttribute("type"),d=t.getAttribute("multiple"),y=function(e){if(e.target===t)if(h&&"checkbox"===h.toLowerCase())t.checked?i[o]=e.target.getAttribute("value"):i[o]=!1;else if(e.target.matches("[contenteditable=true]"))i[o]=e.target.innerHTML;else if("file"===h&&d){var r=Array.from(e.target.files),a=i[o]||n.Bindable.onDeck(i,o);if(a&&r.length){var s=function(t){if(r[t]!==a[t])return r[t].toJSON=function(){return{name:file[t].name,size:file[t].size,type:file[t].type,date:file[t].lastModified}},a[t]=r[t],"break"};for(var c in r){if("break"===s(c))break}}else i[o]=r}else if("file"===h&&!d&&e.target.files.length){var u=e.target.files.item(0);u.toJSON=function(){return{name:u.name,size:u.size,type:u.type,date:u.lastModified}},i[o]=u}else i[o]=e.target.value};return"file"===h||"radio"===h?t.addEventListener("change",y):(t.addEventListener("input",y),t.addEventListener("change",y),t.addEventListener("value-changed",y)),this.onRemove(function(){"file"===h||"radio"===h?t.removeEventListener("change",y):(t.removeEventListener("input",y),t.removeEventListener("change",y),t.removeEventListener("value-changed",y))}),t.removeAttribute("cv-bind"),t}},{key:"mapOnTag",value:function(t){var e=this;return String(t.getAttribute("cv-on")).split(";").map(function(t){return t.split(":")}).map(function(r){var n,i=(r=r.map(function(t){return t.trim()})).length,o=String(r.shift()).trim(),a=String(r.shift()||o).trim(),s=String(r.shift()||"").trim(),c=[],u=/(\w+)(?:\(([$\w\s-'",]+)\))?/.exec(a);u?(a=u[1].replace(/(^[\s\n]+|[\s\n]+$)/,""),u[2]&&(c=u[2].split(",").map(function(t){return t.trim()})),u.length):c.push("$event"),o&&1!==i||(o=a);for(var l=e;l;){if("function"==typeof l[a])if("break"===function(){var t=l,e=a;return n=function(){t[e].apply(t,arguments)},"break"}())break;if(!l.parent)break;l=l.parent}var f=function(r){var i=c.map(function(n){var i;return Number(n)==n?n:"event"===n||"$event"===n?r:"$view"===n?l:"$tag"===n?t:"$parent"===n?e.parent:"$subview"===n?e:n in e.args?e.args[n]:(i=/^['"]([\w-]+?)["']$/.exec(n))?i[1]:void 0});if("function"!=typeof n)throw new Error("".concat(a," is not defined on View object.")+"\nTag:\n"+"".concat(t.outerHTML));n.apply(void 0,h(i))},p={};switch(s.includes("p")?p.passive=!0:s.includes("P")&&(p.passive=!1),s.includes("c")?p.capture=!0:s.includes("C")&&(p.capture=!1),s.includes("o")?p.once=!0:s.includes("O")&&(p.once=!1),o){case"_init":f();break;case"_attach":e.nodesAttached.add(f);break;case"_detach":e.nodesDetached.add(f);break;default:t.addEventListener(o,f,p),e.onRemove(function(){t.removeEventListener(o,f,p)})}return[o,a,c]}),t.removeAttribute("cv-on"),t}},{key:"mapLinkTag",value:function(t){var e=t.getAttribute("cv-link");t.setAttribute("href",e);var r=function(r){r.preventDefault(),"http"!==e.substring(0,4)&&"//"!==e.substring(0,2)?o.Router.go(t.getAttribute("href")):window.open(t.getAttribute("href",e))};return t.addEventListener("click",r),this.onRemove(function(t,e){return function(){t.removeEventListener("click",e),t=void 0,e=void 0}}(t,r)),t.removeAttribute("cv-link"),t}},{key:"compileLinkTag",value:function(t){var e=t.getAttribute("cv-link");return t.removeAttribute("cv-link"),function(r){var n=t.cloneNode(!0);return n.setAttribute("href",e),n}}},{key:"mapPrendererTag",value:function(t){var e=t.getAttribute("cv-prerender"),r=window.prerenderer||navigator.userAgent.match(/prerender/i);return r&&(window.prerenderer=window.prerenderer||!0),("never"===e&&r||"only"===e&&!r)&&t.parentNode.removeChild(t),t}},{key:"mapWithTag",value:function(t){var e=this,r=t.getAttribute("cv-with"),i=t.getAttribute("cv-carry"),o=t.getAttribute("cv-view");t.removeAttribute("cv-with"),t.removeAttribute("cv-carry"),t.removeAttribute("cv-view");var a=o?this.stringToClass(o):j,s=new DocumentFragment;h(t.childNodes).map(function(t){return s.appendChild(t)});var c=[];i&&(c=i.split(",").map(function(t){return t.trim()}));var u=this.args.bindTo(r,function(r,i,o,u){for(e.withViews.has(t)&&e.withViews.delete(t);t.firstChild;)t.removeChild(t.firstChild);var l=new a({},e);e.onRemove(function(t){return function(){t.remove()}}(l)),l.template=s;var f=function(t){var r=e.args.bindTo(c[t],function(t,e){l.args[e]=t});l.onRemove(r),e.onRemove(function(){r(),l.remove()})};for(var h in c)f(h);var p=function(t){var i=r.bindTo(t,function(t,e){l.args[e]=t});l.args.bindTo(t,function(t,e){r[e]=t});e.onRemove(function(){i(),r.isBound()||n.Bindable.clearBindings(r),l.remove()}),l.onRemove(function(){i(),r.isBound()||n.Bindable.clearBindings(r)})};for(var g in r)p(g);l.render(t),e.withViews.set(t,l)});return this.onRemove(function(){e.withViews.delete(t),u()}),t}},{key:"mapViewTag",value:function(t){var e=this,r=t.getAttribute("cv-view");t.removeAttribute("cv-view");var n=new DocumentFragment;h(t.childNodes).map(function(t){return n.appendChild(t)});var i=r.split(":"),o=i.pop()?this.stringToClass(r):j,a=i.shift(),s=new o(this.args,this);return this.views.set(t,s),a&&this.views.set(a,s),this.onRemove(function(r){return function(){r.remove(),e.views.delete(t),e.views.delete(a)}}(s)),s.template=n,s.render(t),t}},{key:"mapEachTag",value:function(t){var e=this,r=t.getAttribute("cv-each"),n=t.getAttribute("cv-view");t.removeAttribute("cv-each"),t.removeAttribute("cv-view");var o=n?this.stringToClass(n):j,a=new DocumentFragment;Array.from(t.childNodes).map(function(t){return a.appendChild(t)});var s=p(r.split(":"),3),c=s[0],u=s[1],l=s[2],f=this.args.bindTo(c,function(r,n,s,c,f){e.viewLists.has(t)&&e.viewLists.get(t).remove();var h=new i.ViewList(a,u,r,e,l,o),p=function(){return h.remove()};e.onRemove(p),h.onRemove(function(){return e._onRemove.remove(p)});var g=e.args.bindTo(function(t,e,r,n){"_id"!==e&&(n&&delete h.subArgs[e],h.subArgs[e]=t)}),d=h.args.bindTo(function(t,r,n,i,o){"_id"!==r&&"value"!==r&&"___"!==r.substring(0,3)&&(i&&delete e.args[r],r in e.args&&(e.args[r]=t))});for(h.onRemove(g),h.onRemove(d),e.onRemove(g),e.onRemove(d);t.firstChild;)t.removeChild(t.firstChild);e.viewLists.set(t,h),h.render(t)});return this.onRemove(f),t}},{key:"mapIfTag",value:function(t){var e=this,r=t,i=r.getAttribute("cv-view"),o=r.getAttribute("cv-if"),a=r.getAttribute("cv-is"),s=!1,c=!1;r.removeAttribute("cv-view"),r.removeAttribute("cv-if"),r.removeAttribute("cv-is");var u=i?this.stringToClass(i):j;"!"===o.substr(0,1)&&(o=o.substr(1),s=!0),"?"===o.substr(0,1)&&(o=o.substr(1),c=!0);var l=new DocumentFragment;Array.from(r.childNodes).map(function(t){return l.appendChild(t)});var f=this,h=new DocumentFragment,g=new u(this.args,f);this.onRemove(g.tags.bindTo(function(t,r){e.tags[r]=t})),g.template=l;var d=f.args,y=o;if(o.match(/\./)){var b=p(n.Bindable.resolve(f.args,o,!0),2);d=b[0],y=b[1]}g.render(h);var v=d.bindTo(y,function(e,r){var n=e;c&&(e=null!==e&&void 0!==e),Array.isArray(e)&&(e=!!e.length),s&&(e=!e),e?null!==a&&n==a?t.appendChild(h):null===a&&t.appendChild(h):g.nodes.map(function(t){return h.appendChild(t)})},{wait:0,children:Array.isArray(d[y])});f.onRemove(v);var m=function(){d.isBound()||n.Bindable.clearBindings(d)};return f.onRemove(function(){v(),m(),f._onRemove.remove(v),f._onRemove.remove(m)}),this.onRemove(function(){g.remove(),f!==e&&f.remove()}),t}},{key:"compileIfTag",value:function(t){var e=t.getAttribute("cv-if"),r=!1;t.removeAttribute("cv-if"),"!"===e.substr(0,1)&&(e=e.substr(1),r=!0);var i=new DocumentFragment;return Array.from(t.childNodes).map(function(t){return i.appendChild(t.cloneNode(!0))}),function(o){var a=t.cloneNode(),s=new DocumentFragment,c=new j({},o);c.template=i,o.syncBind(c);var u=o.args,l=e;if(e.match(/\./)){var f=p(n.Bindable.resolve(o.args,e,!0),2);u=f[0],l=f[1]}var h=!1,g=u.bindTo(l,function(t,e){if(!h){var n=o.args[l]||r?a:s;return c.render(n),void(h=!0)}Array.isArray(t)&&(t=!!t.length),r&&(t=!t),t?a.appendChild(s):c.nodes.map(function(t){return s.appendChild(t)})});o.onRemove(g);var d=function(){u.isBound()||n.Bindable.clearBindings(u)};return c.onRemove(function(){g(),d(),o._onRemove.remove(g),o._onRemove.remove(d)}),a}}},{key:"mapTemplateTag",value:function(t){var e=t.getAttribute("cv-template");return t.removeAttribute("cv-template"),this.templates[e]=function(){return"TEMPLATE"===t.tagName?t.content.cloneNode(!0):new DocumentFragment(t.innerHTML)},this.rendered.then(function(){return t.remove()}),t}},{key:"mapSlotTag",value:function(t){var e=t.getAttribute("cv-slot"),r=this.templates[e];if(!r){for(var n=this;n&&!(r=n.templates[e]);)n=this.parent;if(!r)return void console.error("Template ".concat(e," not found."))}var i=r();for(t.removeAttribute("cv-slot");t.firstChild;)t.firstChild.remove();return t.appendChild(i),t}},{key:"syncBind",value:function(t){var e=this,r=this.args.bindTo(function(e,r,n,i){"_id"!==r&&t.args[r]!==e&&(t.args[r]=e)}),n=t.args.bindTo(function(t,r,n,i,o){if("_id"!==r){var a=t,s=o;a instanceof j&&(a=a.___ref___),s instanceof j&&(s=s.___ref___),a!==s&&s instanceof j&&o.remove(),r in e.args&&(e.args[r]=t)}});this.onRemove(r),this.onRemove(n),t.onRemove(function(){e._onRemove.remove(r),e._onRemove.remove(n)})}},{key:"postRender",value:function(t){}},{key:"attached",value:function(t){}},{key:"interpolatable",value:function(t){return!!String(t).match(this.interpolateRegex)}},{key:"remove",value:function(){var t=this,e=function(){for(var e in t.tags)Array.isArray(t.tags[e])?(t.tags[e]&&t.tags[e].map(function(t){return t.remove()}),t.tags[e].splice(0)):(t.tags[e]&&t.tags[e].remove(),t.tags[e]=void 0);for(var r in t.nodes)t.nodes[r]&&t.nodes[r].dispatchEvent(new Event("cvDomDetached")),t.nodes[r]&&t.nodes[r].remove(),t.nodes[r]=void 0;t.nodes.splice(0),t.firstNode=t.lastNode=void 0};arguments.length>0&&void 0!==arguments[0]&&arguments[0]?e():requestAnimationFrame(e);var r,n,i=g(this._onRemove.items());try{for(i.s();!(r=i.n()).done;){var o=r.value;this._onRemove.remove(o),o()}}catch(t){i.e(t)}finally{i.f()}for(;n=this.cleanup.shift();)n&&n();var a,s=g(this.viewLists);try{for(s.s();!(a=s.n()).done;){var c=p(a.value,2);c[0];c[1].remove()}}catch(t){s.e(t)}finally{s.f()}this.viewLists.clear();var u,l=g(this.timeouts);try{for(l.s();!(u=l.n()).done;){var f=p(u.value,2),h=(f[0],f[1]);clearTimeout(h.timeout),this.timeouts.delete(h.timeout)}}catch(t){l.e(t)}finally{l.f()}for(var d in this.intervals)clearInterval(this.intervals[d].timeout),delete this.intervals[d];for(var d in this.frames)this.frames[d](),delete this.frames[d];this.preRuleSet.purge(),this.ruleSet.purge(),this.removed=!0}},{key:"findTag",value:function(t){for(var e in this.nodes){var r;if(this.nodes[e].querySelector){if(this.nodes[e].matches(t))return new s.Tag(this.nodes[e],this,void 0,void 0,this);if(r=this.nodes[e].querySelector(t))return new s.Tag(r,this,void 0,void 0,this)}}}},{key:"findTags",value:function(t){var e=this;return this.nodes.filter(function(t){return t.querySelectorAll}).map(function(e){return h(e.querySelectorAll(t))}).flat().map(function(t){return new s.Tag(t,e,void 0,void 0,e)})}},{key:"onRemove",value:function(t){this._onRemove.add(t)}},{key:"update",value:function(){}},{key:"beforeUpdate",value:function(t){}},{key:"afterUpdate",value:function(t){}},{key:"stringTransformer",value:function(t){var e=this;return function(r){for(var n in t){for(var i=e,o=t[n];i&&!i[o];)i=i.parent;if(!i)return;r=i[t[n]](r)}return r}}},{key:"stringToClass",value:function(t){if(j.refClasses.has(t))return j.refClasses.get(t);var e=t.split("/"),n=e[e.length-1],i=r(t);return j.refClasses.set(t,i[n]),i[n]}},{key:"preventParsing",value:function(t){t[O]=!0}},{key:"toString",value:function(){return this.nodes.map(function(t){return t.outerHTML}).join(" ")}},{key:"listen",value:function(t,e,r,n){var i=this;if("string"==typeof t&&(n=r,r=e,e=t,t=this),t instanceof j)return this.listen(t.nodes,e,r,n);if(Array.isArray(t)){var o=t.map(function(t){return i.listen(t,e,r,n)});return function(){return o.map(function(t){return t()})}}if(t instanceof s.Tag)return this.listen(t.element,e,r,n);t.addEventListener(e,r,n);var a=function(){return t.removeEventListener(e,r,n)},c=function(){a(),a=function(){}};return this.onRemove(function(){return c()}),c}},{key:"detach",value:function(){for(var t in this.nodes)this.nodes[t].remove();return this.nodes}}],y=[{key:"from",value:function(t){var e=new this(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2&&void 0!==arguments[2]?arguments[2]:null);return e.template=t,e}},{key:"isView",value:function(){return j}},{key:"uuid",value:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})}}],d&&b(e.prototype,d),y&&b(e,y),j}();e.View=j,Object.defineProperty(j,"templates",{value:new Map}),Object.defineProperty(j,"refClasses",{value:new Map})}()}),require.register("curvature/base/ViewList.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ViewList=void 0;var t=r("./Bindable"),n=r("./SetMap"),i=r("./View"),o=r("./Bag");function a(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw o}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t){"@babel/helpers - typeof";return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var l=function(){function e(r,n,a,s){var u=this,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.removed=!1,this.args=t.Bindable.makeBindable({}),this.args.value=t.Bindable.makeBindable(a||{}),this.subArgs=t.Bindable.makeBindable({}),this.views=[],this.cleanup=[],this.viewClass=f||i.View,this._onRemove=new o.Bag,this.template=r,this.subProperty=n,this.keyProperty=l,this.tag=null,this.paused=!1,this.parent=s,this.rendered=new Promise(function(t,e){Object.defineProperty(u,"renderComplete",{configurable:!1,writable:!0,value:t})}),this.willReRender=!1,this.args.___before(function(t,e,r,n,i){"bindTo"!=e&&(u.paused=!0)}),this.args.___after(function(t,e,r,n,i){"bindTo"!=e&&(u.paused=r.length>1,u.reRender())});var h=this.args.value.bindTo(function(t,e,r,n){if(!u.paused){var i=e;if("symbol"!==c(e))if(isNaN(e)&&(i="_"+e),n)for(var o in u.views[i]&&u.views[i].remove(),delete u.views[i],u.views)isNaN(o)?u.views[o].args[u.keyProperty]=o.substr(1):u.views[o].args[u.keyProperty]=o;else u.views[i]||u.willReRender?u.views[i]&&u.views[i].args&&(u.views[i].args[u.keyProperty]=e,u.views[i].args[u.subProperty]=t):(cancelAnimationFrame(u.willReRender),u.willReRender=requestAnimationFrame(function(){u.reRender()}))}});this._onRemove.add(h)}var r,s,l;return r=e,(s=[{key:"render",value:function(t){var e,r=this,n=[],i=a(this.views);try{var o=function(){var r=e.value;r.render(t),n.push(r.rendered.then(function(){return r}))};for(i.s();!(e=i.n()).done;)o()}catch(t){i.e(t)}finally{i.f()}this.tag=t,Promise.all(n).then(function(t){return r.renderComplete(t)}),this.parent.dispatchEvent(new CustomEvent("listRendered",{detail:{detail:{key:this.subProperty,value:this.args.value}}}))}},{key:"reRender",value:function(){var t=this;if(!this.paused&&this.tag){var e=[],r=new n.SetMap;for(var i in this.views){var o=this.views[i],a=o.args[this.subProperty];r.add(a,o),e[i]=o}var s=[],c=new Set;this.upDebind&&this.upDebind.map(function(t){return t&&t()}),this.downDebind&&this.downDebind.map(function(t){return t&&t()}),this.upDebind=[],this.downDebind=[];var u=1/0,l=1/0,f=function(e){var n=!1,i=e;if(isNaN(i)?i="_"+e:String(i).length&&(i=Number(i)),void 0!==t.args.value[e]&&r.has(t.args.value[e])){var o=r.getOne(t.args.value[e]);o&&(o.args[t.keyProperty]=e,s[i]=o,c.add(o),n=!0,isNaN(i)||(u=Math.min(u,i),i>0&&(l=Math.min(l,i))),r.remove(t.args.value[e],o))}if(!n){var a={},f=s[i]=new t.viewClass(a,t.parent);isNaN(i)||(u=Math.min(u,i),i>0&&(l=Math.min(l,i))),s[i].template=(t.template,Object,t.template),s[i].viewList=t,s[i].args[t.keyProperty]=e,s[i].args[t.subProperty]=t.args.value[e],t.upDebind[i]=a.bindTo(t.subProperty,function(e,r,n,i){var o=a[t.keyProperty];i?delete t.args.value[o]:t.args.value[o]=e}),t.downDebind[i]=t.subArgs.bindTo(function(t,e,r,n){n?delete a[e]:a[e]=t});var h=function(){t.upDebind.filter(function(t){return t}).map(function(t){return t()}),t.upDebind.splice(0)},p=function(){t.downDebind.filter(function(t){return t}).map(function(t){return t()}),t.downDebind.splice(0)};f.onRemove(function(){t._onRemove.remove(h),t._onRemove.remove(p),t.upDebind[i]&&t.upDebind[i](),t.downDebind[i]&&t.downDebind[i](),delete t.upDebind[i],delete t.downDebind[i]}),t._onRemove.add(h),t._onRemove.add(p),a[t.subProperty]=t.args.value[e]}};for(var h in this.args.value)f(h);for(var p in e)c.has(e[p])||e[p].remove();if(Array.isArray(this.args.value)){var g=0===u&&void 0!==s[1]&&s.length>1||l===1/0?u:l;this.rendered=function e(){for(var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=s.length-r-1;n>g&&void 0===s[n];)n--;return n<g?Promise.resolve():s[n]===t.views[n]?s[n].firstNode?e(Number(r)+1):(s[n].render(t.tag,s[n+1]),s[n].rendered.then(function(){return e(Number(r)+1)})):(s[n].render(t.tag,s[n+1]),t.views.splice(n,0,s[n]),s[n].rendered.then(function(){return e(Number(r)+1)}))}(),this.rendered.then(function(){return s.splice(0)})}else{var d=[],y=Object.assign({},s),b=function(e){if(delete y[e],s[e].firstNode&&s[e]===t.views[e])return"continue";s[e].render(t.tag),d.push(s[e].rendered.then(function(){return s[e]}))};for(var v in s)b(v);for(var m in y)delete this.args.views[m],y.remove();this.rendered=Promise.all(d)}for(var w in s)isNaN(w)?s[w].args[this.keyProperty]=w.substr(1):s[w].args[this.keyProperty]=w;this.views=[].concat(s),c.clear(),this.willReRender=!1,this.parent.dispatchEvent(new CustomEvent("listRendered",{detail:{detail:{key:this.subProperty,value:this.args.value}}}))}}},{key:"pause",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];for(var e in this.views)this.views[e].pause(t)}},{key:"onRemove",value:function(t){this._onRemove.add(t)}},{key:"remove",value:function(){for(var e in this.views)this.views[e].remove();var r=this._onRemove.items();for(var n in r)this._onRemove.remove(r[n]),r[n]();for(;this.cleanup.length;)this.cleanup.pop()();for(this.views=[];this.tag&&this.tag.firstChild;)this.tag.removeChild(this.tag.firstChild);this.subArgs&&t.Bindable.clearBindings(this.subArgs),t.Bindable.clearBindings(this.args),this.args.value&&!this.args.value.isBound()&&t.Bindable.clearBindings(this.args.value),this.removed=!0}}])&&u(r.prototype,s),l&&u(r,l),e}();e.ViewList=l}()}),require.register("curvature/input/Keyboard.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Keyboard=void 0;var t=r("../base/Bindable");function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=function(){function e(){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.maxDecay=120,this.comboTime=500,this.listening=!1,this.focusElement=document.body,Object.defineProperty(this,"combo",{value:t.Bindable.make([])}),Object.defineProperty(this,"whichs",{value:t.Bindable.make({})}),Object.defineProperty(this,"codes",{value:t.Bindable.make({})}),Object.defineProperty(this,"keys",{value:t.Bindable.make({})}),Object.defineProperty(this,"pressedWhich",{value:t.Bindable.make({})}),Object.defineProperty(this,"pressedCode",{value:t.Bindable.make({})}),Object.defineProperty(this,"pressedKey",{value:t.Bindable.make({})}),Object.defineProperty(this,"releasedWhich",{value:t.Bindable.make({})}),Object.defineProperty(this,"releasedCode",{value:t.Bindable.make({})}),Object.defineProperty(this,"releasedKey",{value:t.Bindable.make({})}),Object.defineProperty(this,"keyRefs",{value:t.Bindable.make({})}),document.addEventListener("keyup",function(t){r.listening&&(!r.focusElement||document.activeElement===r.focusElement||r.focusElement.contains(document.activeElement)&&!document.activeElement.matches("input,textarea"))&&(t.preventDefault(),r.releasedWhich[t.which]=Date.now(),r.releasedCode[t.code]=Date.now(),r.releasedKey[t.key]=Date.now(),r.whichs[t.which]=-1,r.codes[t.code]=-1,r.keys[t.key]=-1)}),document.addEventListener("keydown",function(t){r.listening&&(!r.focusElement||document.activeElement===r.focusElement||r.focusElement.contains(document.activeElement)&&!document.activeElement.matches("input,textarea"))&&(t.preventDefault(),t.repeat||(r.combo.push(t.code),clearTimeout(r.comboTimer),r.comboTimer=setTimeout(function(){return r.combo.splice(0)},r.comboTime),r.pressedWhich[t.which]=Date.now(),r.pressedCode[t.code]=Date.now(),r.pressedKey[t.key]=Date.now(),r.keys[t.key]>0||(r.whichs[t.which]=1,r.codes[t.code]=1,r.keys[t.key]=1)))});var n=function(t){for(var e in r.keys)r.keys[e]<0||(r.releasedKey[e]=Date.now(),r.keys[e]=-1);for(var n in r.codes)r.codes[n]<0||(r.releasedCode[n]=Date.now(),r.codes[n]=-1);for(var i in r.whichs)r.whichs[i]<0||(r.releasedWhich[i]=Date.now(),r.whichs[i]=-1)};window.addEventListener("blur",n),window.addEventListener("visibilitychange",function(){"visible"!==document.visibilityState&&n()})}var r,i,o;return r=e,o=[{key:"get",value:function(){return this.instance=this.instance||t.Bindable.make(new this)}}],(i=[{key:"getKeyRef",value:function(e){return this.keyRefs[e]=this.keyRefs[e]||t.Bindable.make({})}},{key:"getKeyTime",value:function(t){var e=this.releasedKey[t],r=this.pressedKey[t];return r?!e||e<r?Date.now()-r:-1*(Date.now()-e):0}},{key:"getCodeTime",value:function(t){var e=this.releasedCode[t],r=this.pressedCode[t];return r?!e||e<r?Date.now()-r:-1*(Date.now()-e):0}},{key:"getWhichTime",value:function(t){var e=this.releasedWhich[t],r=this.pressedWhich[t];return r?!e||e<r?Date.now()-r:-1*(Date.now()-e):0}},{key:"getKey",value:function(t){return this.keys[t]?this.keys[t]:0}},{key:"getKeyCode",value:function(t){return this.codes[t]?this.codes[t]:0}},{key:"reset",value:function(){for(var t in this.keys)delete this.keys[t];for(var t in this.codes)delete this.codes[t];for(var t in this.whichs)delete this.whichs[t]}},{key:"update",value:function(){for(var t in this.keys)this.keys[t]>0?this.keys[t]++:this.keys[t]>-this.maxDecay?this.keys[t]--:delete this.keys[t];for(var t in this.codes){var e=this.releasedCode[t],r=this.pressedCode[t],n=this.getKeyRef(t);if(this.codes[t]>0){if(n.frames=this.codes[t]++,n.time=r?Date.now()-r:0,n.down=!0,!e||e<r)return;return-1*(Date.now()-e)}this.codes[t]>-this.maxDecay?(n.frames=this.codes[t]--,n.time=e-Date.now(),n.down=!1):(n.frames=0,n.time=0,n.down=!1,delete this.codes[t])}for(var t in this.whichs)this.whichs[t]>0?this.whichs[t]++:this.whichs[t]>-this.maxDecay?this.whichs[t]--:delete this.whichs[t]}}])&&n(r.prototype,i),o&&n(r,o),e}();e.Keyboard=i}()}),require.register("curvature/mixin/EventTargetMixin.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventTargetMixin=void 0;var t,n=r("../base/Mixin");function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=Symbol("Target"),a=(i(t={},n.Mixin.Constructor,function(){try{this[o]=new EventTarget}catch(t){this[o]=document.createDocumentFragment()}}),i(t,"dispatchEvent",function(){for(var t,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r[0];(t=this[o]).dispatchEvent.apply(t,r);var a="on".concat(i.type[0].toUpperCase()+i.type.slice(1));return"function"==typeof this[a]&&this[a](i),i.returnValue}),i(t,"addEventListener",function(){var t;(t=this[o]).addEventListener.apply(t,arguments)}),i(t,"removeEventListener",function(){var t;(t=this[o]).removeEventListener.apply(t,arguments)}),t);e.EventTargetMixin=a}()}),require.register("curvature/mixin/PromiseMixin.js",function(e,r,n){r=t(r,{},"curvature"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PromiseMixin=void 0;var t,n=r("../base/Mixin");function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=Symbol("Promise"),a=Symbol("Accept"),s=Symbol("Reject"),c=(i(t={},n.Mixin.Constructor,function(){var t=this;this[o]=new Promise(function(e,r){t[a]=e,t[s]=r})}),i(t,"then",function(){var t;return(t=this[o]).then.apply(t,arguments)}),i(t,"catch",function(){var t;return(t=this[o]).catch.apply(t,arguments)}),i(t,"finally",function(){var t;return(t=this[o]).finally.apply(t,arguments)}),t);e.PromiseMixin=c,Object.defineProperty(c,"Reject",{value:s}),Object.defineProperty(c,"Accept",{value:a})}()}),require.register("subspace-console/Console.js",function(e,r,n){r=t(r,{},"subspace-console"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Console=void 0;var t=r("curvature/base/View"),n=r("curvature/base/Bag"),i=r("./view/MeltingText"),o=r("./view/EchoMessage"),a=r("./Task"),s=r("./Path");function c(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t){"@babel/helpers - typeof";return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,n=g(t);if(e){var i=g(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(y,t.View);var r,u,g,d=p(y);function y(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),t=d.call(this,r);var i={init:!1,path:s.Path},o=Object.assign({},i,e);return t.template='<div class = "terminal [[inverted]]" cv-on = "click:focus(event)">\n\t<div class = "output" cv-each = "output:line:l" cv-ref = "output:curvature/base/Tag">\n\t\t<p>[[line]]</p>\n\t</div>\n\t<div class = "bottom">\n\t\t<div>[[prompt]]&nbsp;</div>\n\t\t<div>\n\t\t\t<form cv-on = "submit:cancel(event)">\n\t\t\t\t<textarea\n\t\t\t\t\tcv-bind = "input"\n\t\t\t\t\tcv-on   = ":keydown(event);:keyup(event)"\n\t\t\t\t\tcv-ref  = "input:curvature/base/Tag"\n\t\t\t\t\trow     = "1"\n\t\t\t\t></textarea>\n\t\t\t</form>\n\n\t\t\t<form cv-on = "submit:cancel(event)">\n\t\t\t\t<input\n\t\t\t\t\tautocomplete = "one-time-code"\n\t\t\t\t\tname    = "pw-input"\n\t\t\t\t\ttype    = "password"\n\t\t\t\t\tcv-bind = "input"\n\t\t\t\t\tcv-ref  = "password:curvature/base/Tag"\n\t\t\t\t\tcv-on   = ":keydown(event,false);:keyup(event,false)"\n\t\t\t\t/>\n\t\t\t</form>\n\n\t\t\t<input\n\t\t\t\tcv-on  = "input:fileLoaded(event)"\n\t\t\t\tcv-ref = "file:curvature/base/Tag"\n\t\t\t\tname   = "file-input"\n\t\t\t\ttype   = "file"\n\t\t\t\tstyle  = "display: none"\n\t\t\t/>\n\t\t</div>\n\t</div>\n</div>\n\n<div class = "scanlines"></div>\n',t.args.input="",t.args.output=[],t.args.inverted="",t.localEcho=!0,t.postToken=null,t.args.prompt="::",t.routes={},t.args.passwordMode=!1,t.tasks=[],t.taskList=new n.Bag,t.taskList.type=a.Task,t.max=512,t.historyCursor=-1,t.history=[],t.env=new Map,t.args.output.___after(function(e,r,n,i){if("push"===r){if(t.args.output.length>t.max){var o=t.args.output.shift();"object"===l(o)&&o.remove()}t.scrollToBottom()}}),o.init&&t.runScript(o.init),t.scroller=o.scroller||document.body,t.path=o.path||{},t.originalInput="",t}return r=y,(u=[{key:"runCommand",value:function(t){var e=this;return 0!=this.historyCursor&&this.history.unshift(t),new Promise(function(r){var n;if("/"===t.substring(0,1)){if(!e.args.passwordMode){var i=new o.EchoMessage({message:t});e.args.output.push(i)}n=e.interpret(t.substr(1))}else if(e.tasks.length){if(!e.args.passwordMode){var s=new o.EchoMessage({message:t,prompt:e.tasks[0].prompt});e.args.output.push(s)}n=e.tasks[0].write(t)||Promise.resolve()}else{e.args.passwordMode||e.args.output.push(":: ".concat(t)),n=e.interpret(t);var c=new o.EchoMessage({message:t});e.args.output.push(c)}n instanceof a.Task||n instanceof Promise||(n=Promise.resolve(n),e.args.output.push(":: ".concat(t))),e.historyCursor=-1,e.originalInput=e.args.input="",n.then(function(t){return r(t)})}).catch(function(t){e.args.output.push("Unexpected error: ".concat(t))})}},{key:"runScript",value:function(t){var e=this;fetch(t+"?api=txt").then(function(t){return t.text()}).then(function(t){!function t(r){if(r.length){var n=r.shift();n&&"!"==n[0]?(e.args.output.push(n.substring(1)),t(r)):n?e.runCommand(n).then(function(){return t(r)}):t(r)}}(t.split("\n"))})}},{key:"postRender",value:function(){var t=this,e=this.tags.input.element,r=this.tags.password.element;this.args.bindTo("input",function(t){e.style.height="auto",e.style.height=e.scrollHeight+"px"},{frame:1}),this.args.bindTo("passwordMode",function(t){t?(e.style.display="none",r.style.display="unset"):(e.style.display="unset",r.style.display="none")}),this.args.bindTo("passwordMode",function(e){t.focus(null,e)},{frame:1})}},{key:"focus",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t&&t.preventDefault(),t&&t.target&&t.target.matches("input,textarea")||window.getSelection().toString()||(e||this.args.passwordMode?this.tags.password.element.focus():this.tags.input.element.focus())}},{key:"interpret",value:function(t){var e=this;this.historyCursor=-1;var r,n=null,i=c(t.split(/\s*\;\s*/));try{var o=function(){var t=r.value,i=e.pipe(t.split(/\s*\|\s*/));if(i){e.tasks.unshift(i);var o=function(t){var r=i.outPrompt||i.prompt||e.args.prompt||"::";e.args.output.push("".concat(r," ").concat(t.detail))},a=function(t){var r=i.errorPrompt||"!!";e.args.output.push("".concat(r," ").concat(t.detail))};i.addEventListener("output",o),i.addEventListener("error",a),i.execute(),i.catch(function(t){return console.error(t)}),i.catch(function(t){return e.args.output.push("!! ".concat(t))}),e.args.prompt=i.prompt,i.finally(function(t){i.removeEventListener("error",a),i.removeEventListener("output",o),e.tasks.shift(),e.tasks.length?e.args.prompt=e.tasks[0].prompt:e.args.prompt="::"})}n=i};for(i.s();!(r=i.n()).done;)o()}catch(t){i.e(t)}finally{i.f()}return n}},{key:"pipe",value:function(t,e){var r=null,n=t.shift().trim().split(" "),o=n.shift().trim();if(!(o.length>1&&"?"==o.substr(-1))){if(o in this.path)r=new(0,this.path[o])(n,e,this);else switch(o){case"clear":this.args.output.splice(0);break;case"z":this.args.output.splice(0),this.args.output.push(new i.MeltingText({input:"!!!"}));break;case"commands":case"?":for(var a in this.args.output.push("   Subspace Console 0.29a 2018-2021 Sean Morris"),this.path)this.args.output.push(" * ".concat(a," - ").concat(this.path[a].helpText)),this.path[a].useText&&this.args.output.push("   ".concat(this.path[a].useText)),this.args.output.push("  ");break;default:this.args.output.push("!! Bad command: ".concat(o))}return t.length?this.pipe(t,r):r}(o=o.substr(0,o.length-1))in this.path&&(this.args.output.push("?? ".concat(this.path[o].helpText)),this.args.output.push("?? ".concat(this.path[o].useText)))}},{key:"keydown",value:function(t,e){switch(t.key){case"Tab":if(e)break;t.preventDefault();break;case"Enter":t.ctrlKey||t.preventDefault()}}},{key:"keyup",value:function(t,e){var r=this;switch(t.key){case"ArrowDown":if(this.historyCursor--,this.historyCursor<=-1)return this.historyCursor=-1,void(this.args.input=this.originalInput);this.args.input=this.history[this.historyCursor],this.onNextFrame(function(){var t=r.tags.input.element;t.selectionStart=t.value.length,t.selectionEnd=t.value.length});break;case"ArrowUp":if(-1==this.historyCursor&&(this.originalInput=this.args.input),this.historyCursor++,this.historyCursor>=this.history.length)return void this.historyCursor--;this.args.input=this.history[this.historyCursor],this.onNextFrame(function(){var t=r.tags.input.element;t.selectionStart=t.value.length,t.selectionEnd=t.value.length});break;case"Escape":this.tasks.length&&(console.log(a.Task.KILL),this.tasks[0].finally(function(){return r.args.output.push(":: Killed.")}),this.tasks[0].signal(a.Task.KILL),this.tasks[0].signal("kill")),this.args.passwordMode=!1;break;case"Tab":if(t.preventDefault(),!this.args.input||"/"!==this.args.input[0])break;var n=this.args.input.substr(1);for(var i in this.path)if(!(i.length<n.length)&&n===i.substr(0,n.length)){this.args.input="/"+i;break}break;case"Enter":if(t.ctrlKey)return;t.preventDefault(),this.runCommand(this.args.input),this.args.input="";break;default:this.historyCursor=-1,this.scrollToBottom()}}},{key:"cancel",value:function(t){t.preventDefault(),t.stopPropagation()}},{key:"scrollToBottom",value:function(){var t=(this.scroller===document.body?window:this.scroller)||window,e=(this.scroller===document.body?this.scroller:document.body).scrollHeight;this.onNextFrame(function(){t.scrollTo({behavior:"smooth",left:0,top:e})})}}])&&f(r.prototype,u),g&&f(r,g),y}();e.Console=d}()}),require.register("subspace-console/Path.js",function(e,r,n){r=t(r,{},"subspace-console"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Path=void 0;r("subspace-console/Task");e.Path={}}()}),require.register("subspace-console/Task.js",function(e,n,i){n=t(n,{},"subspace-console"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Task=void 0;n("curvature/base/Bindable");var t=n("curvature/base/Mixin"),i=n("./mixin/Target"),o=n("./mixin/TaskSignals");function a(t){"@babel/helpers - typeof";return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,n=g(t);if(e){var i=g(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h(this,r)}}function h(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?p(t):e}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var y=0,b=(Symbol("target"),Symbol("accept")),v=Symbol("reject"),m=Symbol("execute"),w=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(w,t.Mixin["with"](i.Target,o.TaskSignals));var n,a,c,g=f(w);function w(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,w),d(p(t=g.call(this)),"title","Generic Task"),d(p(t),"prompt","::"),t.args=e,t.prev=r,t.term=n,t.status=-1,t.thread=new Promise(function(e,r){t[b]=e,t[v]=r}),t.id=y++,h(t,p(t))}return n=w,(a=[{key:"then",value:function(t){return this.thread.then(t)}},{key:"catch",value:function(t){return this.thread.catch(t)}},{key:"finally",value:function(t){return this.thread.finally(t)}},{key:"print",value:function(t){this.dispatchEvent(new CustomEvent("output",{detail:t}))}},{key:"printErr",value:function(t){this.dispatchEvent(new CustomEvent("error",{detail:t}))}},{key:"write",value:function(t){return this.main(t)}},{key:"signal",value:function(t){switch(this["signal::".concat(t)]&&this["signal::".concat(t)](),t){case"close":this.dispatchEvent(new CustomEvent("close"))&&(this.status>0?this[v]():this[b]());break;case"kill":this.status>0?this[v]():this[b]()}}},{key:"execute",value:function(){return this[m](this.prev)}},{key:m,value:function(){var t=this,e=function(e){var r=e.detail;return t.write(r)},n=this.init.apply(this,s(this.args)),i=this.prev;return i&&i.addEventListener("output",e),n instanceof Promise||(n=Promise.resolve(n)),i?(i[m](),Promise.allSettled([i,n]).finally(function(){return i.then(function(e){return t[b](e)}),i.catch(function(e){return t[v](r)}),i.removeEventListener("output",e),t.done()})):Promise.allSettled([n]).then(function(e){try{t.main(void 0),t[b]()}catch(e){t[v]()}t.done()})}},{key:"init",value:function(){}},{key:"main",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]}},{key:"done",value:function(t){return this.status}}])&&u(n.prototype,a),c&&u(n,c),w}();e.Task=w}()}),require.register("subspace-console/mixin/Target.js",function(e,r,n){r=t(r,{},"subspace-console"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Target=void 0;var t,n=r("curvature/base/Mixin");function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=Symbol("target"),a=0,s=(i(t={},n.Mixin.Constructor,function(){try{this[o]=new EventTarget}catch(t){this[o]=document.createDocumentFragment()}this[o].x=a++}),i(t,"dispatchEvent",function(){var t;(t=this[o]).dispatchEvent.apply(t,arguments)}),i(t,"addEventListener",function(){var t;(t=this[o]).addEventListener.apply(t,arguments)}),i(t,"removeEventListener",function(){var t;(t=this[o]).removeEventListener.apply(t,arguments)}),t);e.Target=s}()}),require.register("subspace-console/mixin/TaskSignals.js",function(e,r,n){r=t(r,{},"subspace-console"),function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Object.defineProperty(e,"__esModule",{value:!0}),e.TaskSignals=void 0;var n=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,n,i;return r=e,(n=[{key:"signal::kill",value:function(){console.log("KILL!"),this.status>0?this[Reject]():this[Accept]()}},{key:"signal::close",value:function(){this.dispatchEvent(new CustomEvent("error",{detail:detail}))&&(this.status>0?this[Reject]():this[Accept]())}}])&&t(r.prototype,n),i&&t(r,i),e}();e.TaskSignals=n,r(n,"KILL","kill"),r(n,"CLOSE","close")}()}),require.register("subspace-console/view/EchoMessage.js",function(e,r,n){r=t(r,{},"subspace-console"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EchoMessage=void 0;var t=r("curvature/base/View");function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=a(t);if(e){var o=a(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var s=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t.View);var r=o(n);function n(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(t=r.call(this,e)).args.prompt=t.args.prompt||"<<",t.template='<span>[[prompt]]&nbsp;</span><span class = "text">[[message]]</span>',t}return n}();e.EchoMessage=s}()}),require.register("subspace-console/view/MeltingText.js",function(e,r,n){r=t(r,{},"subspace-console"),function(){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeltingText=void 0;var t=r("curvature/base/View");function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=s(t);if(e){var o=s(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(u,t.View);var r,n,s,c=a(u);function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=c.call(this,t)).last=e.init=Date.now(),e.charUp=["","",""],e.charMid=["","","","","","","","","","","","","","","","","","","","",""],e.charDown=["","","",""],e.template='\n\t\t\t<div cv-bind = "output" class = "melting"></div>\n\t\t',e.args.input="Magic is no more than the art of employing consciously invisible means to produce visible effects. Will, love, and imagination are magic powers that everyone possesses; and whoever knows how to develop them to their fullest extent is a magician. Magic has but one dogma, namely, that the seen is the measure of the unseen\n",e.args.output="uh.",e.corruptors=[],e.maxMaxCorrupt=25,e.maxCorrupt=0,e.type="",e.onFrame(function(){e.typewriter(e.args.input)}),e.onInterval(64,function(){var t=window.getSelection();t.anchorOffset===t.focusOffset&&t.anchorNode===t.focusNode&&(e.args.output=e.corrupt(e.type))}),e.args.bindTo("input",function(t){e.type="",e.corruptors=[]}),e}return r=u,(n=[{key:"age",value:function(){return this.init-Date.now()}},{key:"lastFrame",value:function(){return this.last-Date.now()}},{key:"corrupt",value:function(t){if(1.15*t.length<this.args.input.length)return this.type;var e=t.split(""),r=function(t){return parseInt(Math.random()*t)};for(var n in r(1024)<256&&this.maxCorrupt<this.maxMaxCorrupt&&(this.maxCorrupt+=5),e)if(this.corruptors[n]=this.corruptors[n]||[],!e[n].match(/\W/)){var i=[this.charDown,this.charMid],o=i[r(i.length)];r(8192)<1&&this.corruptors[n].unshift(o[r(o.length)]),this.corruptors[n].length<this.maxCorrupt&&this.corruptors[n].unshift(o[r(o.length)]),r(2048)<1&&this.maxCorrupt>25&&this.corruptors[n].splice(5*r(5)),this.corruptors[n].push(this.corruptors[n].shift())}for(var a in e)this.corruptors[a]&&(e[a]+=this.corruptors[a].join(""));return e.join("")}},{key:"typewriter",value:function(t){return this.type=this.type||"",this.type===t||(this.type+=t.substr(this.type.length,1),this.onTimeout(150,function(){var t=window.scrollY+window.innerHeight;document.body.scrollHeight>t&&window.scrollTo({top:document.body.scrollHeight,left:0,behavior:"smooth"})}),!1)}}])&&i(r.prototype,n),s&&i(r,s),u}();e.MeltingText=c}()}),require.register("BackdropPalette.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackdropPalette=void 0;var n=e("backdrop/MarbleGarden"),i=e("backdrop/ProtoLabrynth"),o=e("backdrop/Industrial"),a=e("backdrop/MysticCave"),s=e("backdrop/WestSide"),c={"proto-labrynth":i.ProtoLabrynth,"marble-garden":n.MarbleGarden,industrial:o.Industrial,"mystic-cave":a.MysticCave,"west-side":s.WestSide};t.BackdropPalette=c}),require.register("Classifier.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Classifier=void 0;var i=e("curvature/base/Mixin"),o=e("curvature/mixin/EventTargetMixin");function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||c(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=c(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function c(t,e){if(t){if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(u,i.Mixin["with"](o.EventTargetMixin));var e,r,n,c=h(u);function u(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t,e){return e instanceof t};for(var n in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=c.call(this)).compare=r,e.index=new Map,t)e.index.set(t[n],new Set);return e}return e=u,(r=[{key:"add",value:function(t){var e=new CustomEvent("adding",{detail:{object:t}});if(this.dispatchEvent(e)){var r,n=new Set,i=s(this.index.entries());try{for(i.s();!(r=i.n()).done;){var o=a(r.value,2),c=o[0],u=o[1];this.compare(c,t)&&(n.add(c),u.add(t))}}catch(t){i.e(t)}finally{i.f()}var l=new CustomEvent("added",{detail:{object:t,indexes:n}});this.dispatchEvent(l)}}},{key:"remove",value:function(t){var e=new CustomEvent("removing",{detail:{object:t}});if(this.dispatchEvent(e)){var r,n=new Set,i=s(this.index.entries());try{for(i.s();!(r=i.n()).done;){var o=a(r.value,2),c=o[0],u=o[1];this.compare(c,t)&&(n.add(c),u.delete(t))}}catch(t){i.e(t)}finally{i.f()}var l=new CustomEvent("added",{detail:{object:t,indexes:n}});this.dispatchEvent(l)}}},{key:"get",value:function(t){return this.index.get(t)}},{key:"count",value:function(t){return this.index.has(t)&&this.get(t).size}},{key:"has",value:function(t){return!!this.count(t)}}])&&l(e.prototype,r),n&&l(e,n),u}();t.Classifier=g}),require.register("Menu/MainMenu.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MainMenu=void 0;e("../intro/Card"),e("../effects/Cylinder");var i=e("../effects/Pinch"),o=(e("../effects/Droop"),e("../effects/Twist")),a=e("./Menu"),s=e("./SettingsMenu"),c=e("../tileMap/TileMap");function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,r){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return p(t)}(this,r)}}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(b,a.Menu);var r,n,d,y=h(b);function b(t,r){var n,i,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b),n=y.call(this,t,r),i=p(n),o="template",a=e("./main-menu.html"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n.args.cardName="main-menu",n.args.haveToken=!1,n.args.joinGame=!1,n.args.hostGame=!1,n.args.copy="copy",n.refreshConnection(),n.args.items={"Single Player":{available:"available",children:{"Radical City Zone":{subtext:"Gotta go fast!",callback:function(){var t=new c.TileMap({mapUrl:"/map/empty-zone.json"});n.parent.args.networked=!1,n.parent.tileMap=t,n.parent.args.started=!1,t.ready.then(function(){n.parent.startLevel(),n.accept()})}},"Sonic Control Tutorial":{subtext:"Learn the controls for Sonic",callback:function(){var t=new c.TileMap({mapUrl:"/map/sonic-movement.json"});n.parent.args.networked=!1,n.parent.tileMap=t,t.ready.then(function(){n.parent.startLevel(),n.accept()})}},"Pixel Hill Zone":{subtext:"Movement Sandbox - all characters",callback:function(){var t=new c.TileMap({mapUrl:"/map/pixel-hill-zone.json"});n.parent.args.networked=!1,n.parent.tileMap=t,t.ready.then(function(){n.parent.startLevel(),n.accept()})}},"Tails Control Tutorial":{subtext:"Learn the controls for Tails",callback:function(){var t=new c.TileMap({mapUrl:"/map/tails-movement.json"});n.parent.args.networked=!1,n.parent.tileMap=t,t.ready.then(function(){n.parent.startLevel(),n.accept()})}},"Knuckles Control Tutorial":{subtext:"Learn the controls for Knuckles",callback:function(){var t=new c.TileMap({mapUrl:"/map/knuckles-movement.json"});n.parent.args.networked=!1,n.parent.tileMap=t,t.ready.then(function(){n.parent.startLevel(),n.accept()})}},"Terrain Test":{callback:function(){var t=new c.TileMap({mapUrl:"/map/bendy-bridges.json"});n.parent.args.networked=!1,n.parent.tileMap=t,n.parent.args.started=!1,t.ready.then(function(){n.parent.startLevel(),n.accept()})}},"Light Dash Test":{callback:function(){var t=new c.TileMap({mapUrl:"/map/light-dash-test.json"});n.parent.args.networked=!1,n.parent.tileMap=t,n.parent.args.started=!1,t.ready.then(function(){n.parent.startLevel(),n.accept()})}},"Block Test":{callback:function(){var t=new c.TileMap({mapUrl:"/map/block-test.json"});n.parent.args.networked=!1,n.parent.tileMap=t,n.parent.args.started=!1,t.ready.then(function(){n.parent.startLevel(),n.accept()})}},"Vehicle Test":{callback:function(){var t=new c.TileMap({mapUrl:"/map/vehicle-test.json"});n.parent.args.networked=!1,n.parent.tileMap=t,n.parent.args.started=!1,t.ready.then(function(){n.parent.startLevel(),n.accept()})}},"Half Pipe Test":{callback:function(){var t=new c.TileMap({mapUrl:"/map/half-pipe-test.json"});n.parent.args.networked=!1,n.parent.tileMap=t,n.parent.args.started=!1,t.ready.then(function(){n.parent.startLevel(),n.accept()})}},"Flickie Test":{callback:function(){var t=new c.TileMap({mapUrl:"/map/flickie-test.json"});n.parent.args.networked=!1,n.parent.tileMap=t,n.parent.args.started=!1,t.ready.then(function(){n.parent.startLevel(),n.accept()})}},"Water Test":{callback:function(){var t=new c.TileMap({mapUrl:"/map/water-test.json"});n.parent.args.networked=!1,n.parent.tileMap=t,n.parent.args.started=!1,t.ready.then(function(){n.parent.startLevel(),n.accept()})}},locked:{available:"unavailable"},"locked ":{available:"unavailable"},"locked  ":{available:"unavailable"}}},"2 Player P2P":{children:{"Host a game":{callback:function(){n.args.hostOutput="",n.args.hostGame=!0,n.args.copy="copy"}},"Join a game":{callback:function(){n.args.joinOutput="",n.args.joinGame=!0,n.args.copy="copy",n.client.offer().then(function(t){var e=JSON.stringify(t),r="s3ktp://request/".concat(btoa(e));n.args.joinOutput=r,n.args.haveToken=!0})}}}},"Connect To Server":{available:"unavailable"},Settings:(0,s.SettingsMenu)(r)},n.bgm=new Audio("/Sonic/s3k-competition.mp3"),n.bgm.volume=.5,n.onRemove(function(){return n.bgm.pause()}),n.bgm.loop=!0,n}return r=b,(n=[{key:"clear",value:function(){this.args.input="",this.args.joinOutput="",this.args.hostOutput=""}},{key:"input",value:function(t){if(l(g(b.prototype),"input",this).call(this,t),this.args.pinch){var e=t.axes[2]?t.axes[2].magnitude:0,r=t.axes[3]?t.axes[3].magnitude:0,n=0;t.buttons[6]&&(n=.25+t.buttons[6].pressure-t.buttons[7].pressure),this.args.pinch.args.scale=256*n,this.args.pinch.args.dx=103.552*e,this.args.pinch.args.dy=64*r}}},{key:"disconnect",value:function(){this.clear(),this.args.hostGame?this.server.close():this.args.joinGame&&this.client.close(),this.args.connected=!1,this.args.hostGame=!1,this.args.joinGame=!1,this.refreshConnection()}},{key:"onRendered",value:function(){var t=this,e=this.parent.args.bindTo("audio",function(e){e?t.onTimeout(500,function(){return t.bgm.play()}):t.bgm.pause()});l(g(b.prototype),"onRendered",this).call(this,event),this.onRemove(e),this.args.pinch=new o.Twist({id:"menu-twist",scale:64,width:Math.floor(103.552),height:64}),this.args.pinch=new i.Pinch({id:"menu-pinch",scale:64,width:Math.floor(103.552),height:64})}},{key:"back",value:function(){l(g(b.prototype),"back",this).call(this),this.disconnect()}},{key:"answer",value:function(){var t=this,e=this.args.input,r=/^s3ktp:\/\/request\/(.+)/.exec(e);r&&(e=atob(r[1]));var n=JSON.parse(e),i=this.server.answer(n);return i.then(function(e){var r=JSON.stringify(e),n="s3ktp://accept/".concat(btoa(r));t.args.hostOutput=n,t.args.haveToken=!0}),i}},{key:"acceptRtp",value:function(){var t=this.args.input,e=/^s3ktp:\/\/accept\/(.+)/.exec(t);e&&(t=atob(e[1]));var r=JSON.parse(t);this.client.accept(r)}},{key:"select",value:function(){this.args.hostGame?this.tags.hostOutput.select():this.args.joinGame&&this.tags.joinOutput.select()}},{key:"copy",value:function(){if(this.args.hostGame){if(!this.args.input)return;this.tags.hostOutput.select()}else if(this.args.joinGame){if(!this.args.joinOutput)return;this.tags.joinOutput.select()}document.execCommand("copy"),this.args.copy="copied!"}},{key:"paste",value:function(t){var e=this;navigator.clipboard.readText().then(function(t){e.args.hostGame&&t.match(/^s3ktp:\/\/request\//)&&(e.args.input=t,e.answer().then(function(t){e.copy()})),e.args.joinGame&&t.match(/^s3ktp:\/\/accept\//)&&(e.args.input=t,e.acceptRtp())})}},{key:"refreshConnection",value:function(){var t=this;this.server=this.parent.getServer(!0),this.client=this.parent.getClient(!0);var e=this.server,r=this.client,n=function(e){var r=new c.TileMap({mapUrl:"/map/pixel-hill-zone.json"});t.parent.args.networked=!0,t.parent.tileMap=r,r.ready.then(function(){t.parent.startLevel(),t.accept(),console.log("Peer connection opened!")})},i=function(e){return t.disconnect()};this.listen(e,"open",n),this.listen(e,"close",i),this.listen(r,"open",n),this.listen(r,"close",i)}},{key:"play",value:function(){var t=this;l(g(b.prototype),"play",this).call(this);var e=this.done;return e.then(function(){return t.onTimeout(250,function(){return t.remove()})}),e}}])&&u(r.prototype,n),d&&u(r,d),b}();t.MainMenu=d}),require.register("Menu/Menu.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Menu=void 0;var i=e("../intro/Card");e("../effects/Cylinder"),e("../effects/Pinch");function o(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.Card);var r,n,a,f=u(h);function h(t,r){var n,i,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),n=f.call(this,t,r),i=l(n),o="template",a=e("./main-menu.html"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n.args.cardName="menu",n.args.items={},n.currentItem=null,n.include="a, button, input, textarea, select, details,[tabindex]",n.exclude='[tabindex="-1"]',n.onRemove(function(){return r.focus()}),n}return r=h,(n=[{key:"onRendered",value:function(t){var e=this;this.args.bindTo("items",function(t){for(var e in t){var r=t[e];r.get&&(r.setting=r.get())}}),this.args.bindTo("items",function(t){if(t&&Object.keys(t).length){var r=e.findNext(e.currentItem,e.tags.bound.node);r&&e.focus(r)}},{wait:10}),this.focusFirst()}},{key:"focusFirst",value:function(){if(this.tags.bound){var t=this.tags.bound,e=this.findNext(null,t);e&&this.focus(e)}}},{key:"findNext",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.querySelectorAll(this.include);if(n.length){var i,a=!1,s=null,c=null,u=o(n);try{for(u.s();!(i=u.n()).done;){var l=i.value;if(!l.matches(this.exclude)){if(!s){if(!t&&!r)return l;s=l}if(!r&&a)return l;if(l===t){if(r&&c)return c;a=!0}c=l}}}catch(t){u.e(t)}finally{u.f()}return r?c:this.findNext(void 0,e,r)}}},{key:"focus",value:function(t){this.currentItem&&this.currentItem!==t&&this.blur(this.currentItem),t&&(t.classList.add("focused"),t.focus()),this.currentItem=t}},{key:"blur",value:function(t){t.classList.remove("focused"),t.blur()}},{key:"input",value:function(t){var e,r=this;(this.zeroMe=t,this.tags.bound)&&(t.buttons[12]&&1===t.buttons[12].time?e=this.findNext(this.currentItem,this.tags.bound.node,!0):t.buttons[13]&&1===t.buttons[13].time?(e=this.findNext(this.currentItem,this.tags.bound.node),this.focus(e)):t.buttons[14]&&1===t.buttons[14].time?this.currentItem&&this.contract(this.currentItem):t.buttons[15]&&1===t.buttons[15].time&&this.expand(this.currentItem),t.buttons[0]&&1===t.buttons[0].time?(this.currentItem&&this.currentItem.click(),this.args.last="A"):t.buttons[1]&&1===t.buttons[1].time&&(this.back(),this.args.last="B"),e&&this.onTimeout(100,function(){return r.focus(e)}))}},{key:"run",value:function(t){var e=this;if(this.zeroMe&&this.zeroMe.zero(),t.callback&&this.onTimeout(100,function(){return t.callback()}),t.children){var r=this.args.items,n={callback:function(){e.args.items=r,e.onNextFrame(function(){return e.focusFirst()})}};this.args.items=t.children,this.args.items.back=this.args.items.back||n,this.onNextFrame(function(){return e.focusFirst()})}}},{key:"back",value:function(){this.args.items.back&&this.args.items.back.callback()}},{key:"expand",value:function(t){var e=t.querySelector("input"),r=t.getAttribute("data-title"),n=this.args.items[r];n&&("number"===n.input?(n.setting=Number(n.setting)+1,n.setting>n.max&&(n.setting=n.max),n.set(n.setting)):"boolean"===n.input?(n.setting=!n.setting,n.set(n.setting)):e&&e.focus())}},{key:"contract",value:function(t){var e=t.getAttribute("data-title"),r=this.args.items[e];"number"===r.input?(r.setting=Number(r.setting)-1,r.setting<r.min&&(r.setting=r.min),r.set(r.setting)):"boolean"===r.input?(r.setting=!r.setting,r.set(r.setting)):this.focus(t)}},{key:"keyup",value:function(t){if("ArrowUp"===t.key||"ArrowDown"===t.key){t.preventDefault(),t.stopPropagation();var e=this.findNext(this.currentItem,this.tags.bound.node,"ArrowUp"===t.key);e&&this.focus(e)}}},{key:"change",value:function(t){if(this.currentItem){var e=this.currentItem.getAttribute("data-title"),r=this.args.items[e];r.setting=t.target.value,r.set(r.setting)}}},{key:"toggle",value:function(t,e){t.preventDefault(),e.setting=!e.setting,e.set(e.setting)}}])&&s(r.prototype,n),a&&s(r,a),h}();t.Menu=h}),require.register("Menu/PauseMenu.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PauseMenu=void 0;e("../intro/Card"),e("../effects/Cylinder"),e("../effects/Pinch");var i=e("./Menu"),o=e("./SettingsMenu");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(g,i.Menu);var r,n,h,p=u(g);function g(t,r){var n,i,a,s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),n=p.call(this,t,r),i=l(n),a="template",s=e("./pause-menu.html"),a in i?Object.defineProperty(i,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[a]=s,n.args.cardName="pause-menu",n.args.animation="",n.args.items={Continue:{callback:function(){return r.unpauseGame()}},Reset:{callback:function(){r.unpauseGame(),r.reset(),r.startLevel()}},Settings:(0,o.SettingsMenu)(r),Quit:{children:{No:{callback:function(){return n.args.items.back.callback()}},Yes:{callback:function(){n.args.items.back.callback(),r.unpauseGame(),r.quit()}}}}},n}return r=g,(n=[{key:"input",value:function(t){t.buttons[4]&&t.buttons[4].active?this.args.hideMenu="pause-menu-hide":this.args.hideMenu="",t.buttons[5]&&1===t.buttons[5].time&&(this.args.hideMenu="pause-menu-hide",this.parent.args.paused=1),s(f(g.prototype),"input",this).call(this,t)}}])&&a(r.prototype,n),h&&a(r,h),g}();t.PauseMenu=h}),require.register("Menu/SettingsMenu.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SettingsMenu=void 0;t.SettingsMenu=function(t){return{children:{Video:{children:{"Motion Blur Effects":{input:"boolean",subtext:"Enable/Disable motion blur effects",set:function(e){return t.settings.blur=e},get:function(){return t.settings.blur}},"Displacement Effects":{input:"boolean",subtext:"Enable/Disable displacement effects",set:function(e){return t.settings.displace=e},get:function(){return t.settings.displace}},"Outline Thickness":{input:"number",subtext:"Change the outline thickness",set:function(e){return t.settings.outline=e},get:function(){return t.settings.outline},max:15,min:0},"Display HUD":{input:"boolean",subtext:"Enable/Disable the HUD",set:function(e){return t.settings.showHud=e},get:function(){return t.settings.showHud}},"Debug OSD":{input:"boolean",subtext:"Enable/Disable debug OSD",set:function(e){return t.settings.debugOsd=e},get:function(){return t.settings.debugOsd}},"FPS Meter":{input:"boolean",subtext:"Enable/Disable the FPS meter",set:function(e){return t.settings.showFps=e},get:function(){return t.settings.showFps}},"Mute/Fullscreen":{input:"boolean",subtext:"Show the mute & fullscreen controls in the bottom right.",set:function(e){return t.settings.shortcuts=e},get:function(){return t.settings.shortcuts}}}},Network:{children:{Username:{input:"string",subtext:"Name to display in online games",set:function(e){return t.settings.username=e},get:function(){return t.settings.username},max:15,min:0},"Subspace Hub Servers":{},"ICE Servers":{children:{"ICE Server #1":{input:"string",subtext:"ICE candidate server.",available:"unavailable"},"ICE Server #2":{input:"string",subtext:"ICE candidate server.",available:"unavailable"},"ICE Server #3":{input:"string",subtext:"ICE candidate server.",available:"unavailable"},"ICE Server #4":{input:"string",subtext:"ICE candidate server.",available:"unavailable"}}}}},Audio:{children:{"Music Volume":{input:"number",subtext:"Background music volume - 0% - 100%",available:"unavailable",set:function(e){return t.settings.musicVol=e},get:function(){return t.settings.musicVol},max:100,min:0},SFX:{input:"number",subtext:"Sound effect music volume - 0% - 100%",available:"unavailable",set:function(e){return t.settings.sfxVol=e},get:function(){return t.settings.sfxVol},max:100,min:0},"Mono / Stereo":{available:"unavailable"}}}}}}}),require.register("Menu/main-menu.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]]">\n\n\t<div class = "menu-scroller"></div>\n\n\t[[pinch]]\n\t[[twist]]\n\n\t<section class = "contents" cv-if = "!connected">\n\t\t<div class = "menu-container">\n\n\t\t\t<div>Sonic 3000</div>\n\n\t\t\t<div>\n\n\t\t\t\t<ul cv-ref = "bound" cv-each = "items:item:title">\n\n\t\t\t\t\t<li data-title = "[[title]]" class = "[[item.available]]" cv-on = "click:run(item);" tabindex="0">\n\t\t\t\t\t\t<span class = "title">[[title]]</span>\n\t\t\t\t\t\t<span class = "subtext">[[item.subtext]]</span>\n\t\t\t\t\t\t<span cv-if = "item.input" cv-is = "string">\n\t\t\t\t\t\t\t: <span data-wraps = "string"><input cv-ref = "string" cv-bind = "item.setting" cv-on = "keyup(event);input:change(event)" tabindex="-1" /></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span cv-if = "item.input" cv-is = "number">\n\t\t\t\t\t\t\t: <span data-wraps = "number"><input cv-ref = "number" cv-bind = "item.setting" type = "number" cv-on = "keyup(event);change(event)" tabindex="-1" max = "[[item.max]]" min = "[[item.min]]" /></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span cv-if = "item.input" cv-is = "boolean">\n\t\t\t\t\t\t\t: <span data-wraps = "select"><select cv-on = "mousedown:toggle(event, item);change(event)" cv-ref = "boolean" cv-bind = "item.setting" tabindex="-1">\n\t\t\t\t\t\t\t\t<option value = "1">on</option>\n\t\t\t\t\t\t\t\t<option value = "0">off</option>\n\t\t\t\t\t\t\t</select></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</li>\n\n\t\t\t\t</ul>\n\n\t\t\t</div>\n\n\t\t</div>\n\n\t</section>\n\n\t<section class = "contents" cv-if = "!connected">\n\n\t\t<section class = "contents" cv-if = "hostGame">\n\t\t\t<div class = "token-exchange" data-have-token = "[[haveToken]]">\n\n\t\t\t\t<label>\n\t\t\t\t\t<p>Input the token from your friend here.</p>\n\t\t\t\t\t<textarea cv-bind = "input" cv-on = "click:paste(event)"></textarea>\n\t\t\t\t\t<button cv-on = "click:answer">go!</button>\n\t\t\t\t</label>\n\n\t\t\t\t<label>\n\t\t\t\t\t<p>Send this token to your friend to get started.</p>\n\t\t\t\t\t<textarea cv-on = "click:copy" cv-ref = "hostOutput" cv-bind = "hostOutput" readonly = "true"></textarea>\n\t\t\t\t\t<button cv-on = "click:copy">[[copy]]</button>\n\n\t\t\t\t\t<div class = "close" cv-on = "click:disconnect"></div>\n\t\t\t\t</label>\n\n\t\t\t</div>\n\t\t</section>\n\n\t\t<section class = "contents" cv-if = "joinGame">\n\t\t\t<div class = "token-exchange">\n\n\t\t\t\t<label cv-if = "haveToken">\n\t\t\t\t\t<p>Send this token to your friend to get started.</p>\n\t\t\t\t\t<textarea cv-on = "click:copy" cv-ref = "joinOutput" cv-bind = "joinOutput" readonly = "true"></textarea>\n\t\t\t\t\t<button cv-on = "click:copy">[[copy]]</button>\n\t\t\t\t</label>\n\n\t\t\t\t<label cv-if = "haveToken">\n\t\t\t\t\t<p>Input the token they send back here.</p>\n\t\t\t\t\t<textarea cv-bind = "input" cv-on = "click:paste(event)"></textarea>\n\t\t\t\t\t<button cv-on = "click:acceptRtp">go!</button>\n\t\t\t\t\t<div class = "close" cv-on = "click:disconnect"></div>\n\t\t\t\t</label>\n\n\t\t\t</div>\n\t\t</section>\n\n\t</section>\n</div>\n'}),require.register("Menu/menu.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]]">\n\n\t<div class = "menu-scroller"></div>\n\n\t[[warp]]\n\n\t<div class = "menu-container">\n\n\t\t<ul cv-ref = "bound" cv-each = "items:item:title">\n\n\t\t\t<li data-title = "[[title]]" class = "[[item.available]]" cv-on = "click:run(item);" tabindex="0">\n\t\t\t\t<span class = "title">[[title]]</span>\n\t\t\t\t<span class = "subtext">[[item.subtext]]</span>\n\t\t\t\t<span cv-if = "item.input" cv-is = "string">\n\t\t\t\t\t: <span data-wraps = "string"><input cv-ref = "string" cv-bind = "item.setting" cv-on = "keyup(event);input:change(event)" tabindex="-1" /></span>\n\t\t\t\t</span>\n\t\t\t\t<span cv-if = "item.input" cv-is = "number">\n\t\t\t\t\t: <span data-wraps = "number"><input cv-ref = "number" cv-bind = "item.setting" type = "number" cv-on = "keyup(event);change(event)" tabindex="-1" max = "[[item.max]]" min = "[[item.min]]" /></span>\n\t\t\t\t</span>\n\t\t\t\t<span cv-if = "item.input" cv-is = "boolean">\n\t\t\t\t\t: <span data-wraps = "select"><select cv-on = "mousedown:toggle(event, item);change(event)" cv-ref = "boolean" cv-bind = "item.setting" tabindex="-1">\n\t\t\t\t\t\t<option value = "1">on</option>\n\t\t\t\t\t\t<option value = "0">off</option>\n\t\t\t\t\t</select></span>\n\t\t\t\t</span>\n\t\t\t</li>\n\n\t\t</ul>\n\n\t</div>\n\n\t</section>\n\n</div>\n'}),require.register("Menu/pause-menu.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]] [[hideMenu]]">\n\n\t<div class = "menu-scroller"></div>\n\n\t[[warp]]\n\n\t<section class = "contents" cv-if = "!connected">\n\n\t\t<div class = "menu-container">\n\n\t\t\t<div>Sonic 3000</div>\n\n\t\t\t<ul cv-ref = "bound" cv-each = "items:item:title">\n\n\t\t\t\t<li data-title = "[[title]]" class = "[[item.available]]" cv-on = "click:run(item);" tabindex="0">\n\t\t\t\t\t<span class = "title">[[title]]</span>\n\t\t\t\t\t<span class = "subtext">[[item.subtext]]</span>\n\t\t\t\t\t<span cv-if = "item.input" cv-is = "string">\n\t\t\t\t\t\t: <input cv-ref = "string" cv-bind = "item.setting" cv-on = "keyup(event);input:change(event)" tabindex="-1" />\n\t\t\t\t\t</span>\n\t\t\t\t\t<span cv-if = "item.input" cv-is = "number">\n\t\t\t\t\t\t: <input cv-ref = "number" cv-bind = "item.setting" type = "number" cv-on = "keyup(event);change(event)" tabindex="-1" max = "[[item.max]]" min = "[[item.min]]" />\n\t\t\t\t\t</span>\n\t\t\t\t\t<span cv-if = "item.input" cv-is = "boolean">\n\t\t\t\t\t\t: <select cv-on = "mousedown:toggle(event, item);change(event)" cv-ref = "boolean" cv-bind = "item.setting" tabindex="-1">\n\t\t\t\t\t\t\t<option value = "1">on</option>\n\t\t\t\t\t\t\t<option value = "0">off</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\n\t\t</ul>\n\n\t\t</div>\n\n\t</section>\n\n</div>\n'}),require.register("ObjectPalette.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectPalette=void 0;e("./actor/PointActor");var n=e("./actor/LayerSwitch"),i=e("./region/Region"),o=e("./region/ShadeRegion"),a=e("./region/WaterRegion"),s=e("./region/LavaRegion"),c=e("./region/RollingRegion"),u=e("./region/GrindingRegion"),l=e("./region/ForceRegion"),f=e("./region/CorkscrewRegion"),h=e("./region/BossRegion"),p=e("./region/ExitRegion"),g=e("./actor/CompanionBlock"),d=e("./actor/QuestionBlock"),y=e("./actor/MarbleBlock"),b=e("./actor/BreakableBlock"),v=e("./actor/Stopper"),m=e("./actor/Block"),w=(e("./actor/Monitor"),e("./actor/monitor/RingMonitor")),S=e("./actor/monitor/SheildStarMonitor"),O=e("./actor/monitor/SheildFireMonitor"),x=e("./actor/monitor/SheildWaterMonitor"),k=e("./actor/monitor/SheildElectricMonitor"),j=e("./actor/Bumper"),P=e("./actor/Cinematic"),_=e("./actor/Flickie"),M=e("./actor/Bubbles"),R=e("./actor/CrabMeat"),A=e("./actor/BuzzBomber"),T=e("./actor/MechaFroggy"),C=e("./actor/Explosion"),E=e("./actor/StarPost"),B=e("./actor/ArrowSign"),D=e("./actor/Emerald"),I=e("./actor/Window"),F=e("./actor/Spring"),L=(e("./actor/BrokenMonitor"),e("./actor/Ring")),N=e("./actor/Coin"),q=e("./actor/WaterFall"),W=e("./actor/WaterJet"),V=e("./actor/PowerupGlow"),G=e("./actor/Projectile"),z=e("./actor/TextActor"),U=e("./actor/EggMobile"),H=e("./actor/DrillCar"),J=e("./actor/Tornado"),K=e("./actor/RailCar"),Y=e("./actor/NuclearSuperball"),X=e("./actor/MechaSonic"),$=e("./actor/Eggrobo"),Z=e("./actor/Eggman"),Q=e("./actor/Sonic"),tt=e("./actor/Tails"),et=e("./actor/Knuckles"),rt=e("./actor/Seymour"),nt=e("./actor/Chalmers"),it=e("./actor/Sean"),ot=e("./actor/Rocks"),at=e("./actor/Switch"),st=e("./actor/Balloon"),ct=e("./actor/StarBalloon"),ut=e("./actor/Spinner"),lt=e("./actor/GrapplePoint"),ft=e("./actor/WoodenCrate"),ht=e("./actor/SteelCrate"),pt=e("./actor/UnbreakableCrate"),gt=e("./actor/Rocket"),dt=e("./actor/RoadBarrier"),yt=e("./actor/Spikes"),bt=e("./actor/Cone"),vt=e("./actor/Signpost"),mt=e("./actor/RedEyeJet"),wt=e("./actor/MiniMace"),St=e("./actor/Magnet"),Ot=e("./actor/Orb"),xt={player:Y.NuclearSuperball,cinematic:P.Cinematic,spring:F.Spring,"layer-switch":n.LayerSwitch,"star-post":E.StarPost,"arrow-sign":B.ArrowSign,projectile:G.Projectile,block:m.Block,"q-block":d.QuestionBlock,"marble-block":y.MarbleBlock,"companion-block":g.CompanionBlock,"breakable-block":b.BreakableBlock,stopper:v.Stopper,bumper:j.Bumper,"drill-car":H.DrillCar,"rail-car":K.RailCar,tornado:J.Tornado,"egg-mobile":U.EggMobile,"rocks-tall":ot.Rocks,"rocks-med":ot.Rocks,"rocks-short":ot.Rocks,"mecha-sonic":X.MechaSonic,sonic:Q.Sonic,tails:tt.Tails,knuckles:et.Knuckles,eggman:Z.Eggman,eggrobo:$.Eggrobo,seymour:rt.Seymour,chalmers:nt.Chalmers,sean:it.Sean,switch:at.Switch,window:I.Window,emerald:D.Emerald,"base-region":i.Region,region:a.WaterRegion,"lava-region":s.LavaRegion,"shade-region":o.ShadeRegion,"force-region":l.ForceRegion,"corkscrew-region":f.CorkscrewRegion,"rolling-region":c.RollingRegion,"grinding-region":u.GrindingRegion,"boss-region":h.BossRegion,"exit-region":p.ExitRegion,ring:L.Ring,coin:N.Coin,"powerup-glow":V.PowerupGlow,explosion:C.Explosion,"text-actor":z.TextActor,"water-jet":W.WaterJet,"water-fall":q.WaterFall,balloon:st.Balloon,"star-balloon":ct.StarBalloon,"ring-monitor":w.RingMonitor,"sheild-fire-monitor":O.SheildFireMonitor,"sheild-star-monitor":S.SheildStarMonitor,"sheild-water-monitor":x.SheildWaterMonitor,"sheild-electric-monitor":k.SheildElectricMonitor,flickie:_.Flickie,crabmeat:R.CrabMeat,"mecha-froggy":T.MechaFroggy,"buzz-bomber":A.BuzzBomber,bubbles:M.Bubbles,"grapple-point":lt.GrapplePoint,rocket:gt.Rocket,spinner:ut.Spinner,"wooden-crate":ft.WoodenCrate,"steel-crate":ht.SteelCrate,"unbreakable-crate":pt.UnbreakableCrate,"road-barrier":dt.RoadBarrier,signpost:vt.Signpost,"red-eye-jet":mt.RedEyeJet,"mini-mace":wt.MiniMace,magnet:St.Magnet,spikes:yt.Spikes,cone:bt.Cone,orb:Ot.Orb};t.ObjectPalette=xt}),require.register("World.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.World=void 0;var n=e("curvature/base/Bag"),i=e("curvature/base/Bindable"),o=e("tileMap/TileMap");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var c=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,"tileMap",new o.TileMap),this.viewports=new n.Bag(function(t,r,n){switch(n){case BAG.ITEM_ADDED:t.world=e;break;case BAG.ITEM_REMOVED:t.world=null}}),this.actors=new n.Bag(function(t,r,n){switch(n){case BAG.ITEM_ADDED:t.world=e;break;case BAG.ITEM_REMOVED:t.world=null}})}var e,r,i;return e=t,(r=[{key:"getOnScreenObjects",value:function(t){}},{key:"update",value:function(){}}])&&a(e.prototype,r),i&&a(e,i),t}();t.World=c,s(c,"globals",i.Bindable.make({}))}),require.register("abilities/LightDash.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LightDash=void 0;t.LightDash=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}}),require.register("actor/ArrowSign.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ArrowSign=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag");e("../actor/Projectile"),e("./Monitor"),e("./monitor/RingMonitor"),e("./monitor/SheildFireMonitor"),e("./monitor/SheildWaterMonitor"),e("./monitor/SheildElectricMonitor");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t,e,r){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(h,i.PointActor);var e,r,n,f=c(h);function h(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(r=f.call(this,t,e)).args.type="actor-item actor-arrow-sign",r.args.float=-1,r.args.static=!0,r.args.width=t.width||32,r.args.height=t.height||64,r}return e=h,n=[{key:"fromDef",value:function(t){var e=u(l(h),"fromDef",this).call(this,t);return e.args.rotation=t.rotation,e.args.height=t.height,e}}],(r=[{key:"onAttached",value:function(){var t=this;this.headBox||(this.sprite=this.findTag("div.sprite"),this.box=this.findTag("div"),this.headBox=new o.Tag('<div class = "arrow-sign-head-box">'),this.post=new o.Tag('<div class = "arrow-sign-post">'),this.head=new o.Tag('<div class = "arrow-sign-head">'),this.sprite.appendChild(this.post.node),this.headBox.appendChild(this.head.node),this.sprite.appendChild(this.headBox.node),this.args.bindTo(["point","height"],function(e,r){var n,i,o;t.headBox.style((o=e,(i="--"+r)in(n={})?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,n))}))}},{key:"solid",get:function(){return!1}}])&&a(e.prototype,r),n&&a(e,n),h}();t.ArrowSign=f}),require.register("actor/Balloon.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Balloon=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.type="actor-item actor-balloon",t.args.width=32,t.args.height=33,t.args.float=-1,t.args.airAngle=-Math.PI,t}return e=u,(r=[{key:"collideA",value:function(t){t.controllable}}])&&o(e.prototype,r),n&&o(e,n),u}();t.Balloon=u}),require.register("actor/Block.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Block=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag"),a=e("curvature/animate/ease/QuintInOut");e("curvature/animate/ease/CubicInOut");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t,e,r){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(p,i.PointActor);var e,r,n,h=u(p);function p(){var t,e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(e=h.call(this,r,n)).args.yForce=0,e.args.yLean=0,e.args.type="actor-item actor-block",e.args.width=r.width||32,e.args.height=r.height||32,e.originalX=e.args.x,e.originalY=e.args.y,e.args.solid=!0,e.args.gravity=.5,e.args.collapse=null!==(t=r.collapse)&&void 0!==t&&t,e.ease=new a.QuintInOut(e.public.period),e.args.active=-1,e.args.active&&e.ease.start(),e}return e=p,n=[{key:"fromDef",value:function(t){var e=l(f(p),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.height=t.height,e.args.tileId=t.gid,e.args.y=e.originalY=t.y,e}}],(r=[{key:"onRendered",value:function(t){l(f(p.prototype),"onRendered",this).call(this,t),this.screen||(this.screen=new o.Tag('<input type = "text" placeholder = "this effect is dynamic">'),this.screen2=new o.Tag('<input tabindex = "0" type = "button" value = "submit">'),this.args.spriteSheet=this.args.spriteSheet||"/Sonic/marble-zone-block.png")}},{key:"collideA",value:function(t,e){var r=this;if(t instanceof this.constructor)return!1;if(this.args.droop&&t.args.ySpeed>=0&&t.args.standingOn!==this)return!0;if(-1!==e||this.args.platform||!t.controllable||!t.args.ySpeed){if(this.public.droop&&(0===e||2===e)){var n=this.originalY+-this.public.height,i=Math.floor(this.args.width/2),o=t.public.gSpeed;if(Math.abs(o)>i)return this.args.y=this.originalY,t.args.y=n+-1,this.args.yForce=0,this.args.yLean=0,!0;var a=(this.x+-t.x+-2*o)/i,s=.9*Number(this.public.droop),c=Math.abs(a);if(this.screen.placeholder="drooping at ".concat(a.toFixed(2)),c>=.9)return this.args.yForce=0,this.args.yLean=0,!0;var u=Math.round(s*(1-Math.abs(a))*4)/4;if(this.args.yForce+=Math.max(t.args.ySpeed,4),this.args.yForce=Math.min(u,this.public.yForce),this.args.yForce=Math.max(this.args.yForce,-u),this.droopPos=this.x-t.x,this.args.output){var l=this.viewport.actorsById[this.args.output];l&&(l.args.content=this.screen.value)}}if(this.public.platform){if(t.willStick)return!1;t.y,t.public.height;var f=this.y-this.public.height;return t.y<=f&&(!1===t.public.falling||t.args.ySpeed>0)}if(!t.controllable&&!t.isVehicle)return!0;if(this.args.collapse&&(0===e||2===e)&&this.args.float<=0)if(t.public.ySpeed>15){this.args.float=1,this.args.goBack=!1;var h=t.public.ySpeed;this.onNextFrame(function(){r.public.falling||r.public.float?(r.args.ySpeed=h,r.args.float=1):(r.args.ySpeed=-1,r.args.float=1),r.public.falling=!0})}else(t.public.ySpeed>0||t.public.gSpeed)&&(this.args.float=this.args.float>0?this.args.float:5);return!0}t.args.y<this.args.y?(t.args.y=this.y+-this.args.height+this.args.ySpeed+-1,t.args.ySpeed<0&&(t.args.ySpeed=this.args.ySpeed)):(t.args.y=this.y+t.args.height+-this.args.ySpeed+1,t.args.ySpeed=this.args.ySpeed)}},{key:"onAttach",value:function(t){var e=this;if(this.public.collapse&&this.tags.sprite.classList.add("collapse"),this.public.platform&&this.tags.sprite.classList.add("platform"),this.public.hidden)return t&&t.preventDefault(),!1;this.viewport.tileMap.ready.then(function(t){var r=e.viewport.tileMap.getTile(e.public.tileId-1);r&&(e.args.spriteX=r[0],e.args.spriteY=r[1],e.args.spriteSheet="/map/"+r[2],e.public.droop&&e.droop(0))})}},{key:"activate",value:function(){var t=this;this.args.active=!0,this.viewport.onFrameOut(10,function(){t.args.active&&t.ease.start()})}},{key:"deactivate",value:function(){this.args.active=!1}},{key:"update",value:function(){var t=this;if(this.public.collapse&&(this.args.gSpeed=0),this.public.float&&(this.public.oscillateX||this.public.oscillateY)){var e=this.ease.current();if(this.ease.done&&!this.nextEase){var r=this.ease.reverse,n=a.QuintInOut;this.nextEase=new n(this.public.period,{reverse:!r})}if(this.nextEase&&this.args.active&&(this.ease=this.nextEase,this.nextEase=!1,-1===this.args.active?this.viewport.onFrameOut(60,function(){t.args.active&&t.ease.start()}):this.args.active=!1),this.public.oscillateX){var i=Math.round(e*this.public.oscillateX);this.args.x=this.originalX-i}if(this.public.oscillateY){var o=Math.round(e*this.public.oscillateY);this.args.y=this.originalY-o}}if(this.args.collapse){if(this.reset||(this.reset=!0,this.viewport.onFrameOut(300,function(){t.args.groundAngle=0,t.args.falling=!0,t.args.goBack=!0,t.args.float=-1,t.reset=!1})),this.args.goBack){this.args.float=-1,this.noClip=!0;var s=this.originalX-this.args.x,c=this.originalY-this.args.y;this.args.xSpeed=0,this.args.ySpeed=0,this.args.gSpeed=0,Math.abs(s)>3?this.args.x+=3*Math.sign(s):this.args.x=this.originalX,Math.abs(c)>3?this.args.y+=3*Math.sign(c):this.args.y=this.originalY,this.public.x===this.originalX&&this.args.y===this.originalY&&(this.args.goBack=!1,this.noClip=!1),this.args.groundAngle=0,this.args.airAngle=0}}else if(this.public.droop){if(this.snapBack=this.snapBack||!1,!this.args.colliding&&this.args.yForce&&this.viewport.onFrameOut(4,function(){t.args.colliding||(t.snapBack=!0)}),!this.args.colliding&&this.args.yForce&&this.snapBack&&(this.args.yForce*=.15),Math.abs(this.public.yForce)<=1&&(this.screen.placeholder="flat.",this.args.yForce=0,this.snapBack=!1),this.args.yForce!==this.args.yLean){var u=this.args.yLean-this.args.yForce;this.args.yLean-=16*Math.sign(u),Math.abs(u)<16&&(this.args.yLean=this.args.yForce)}this.public.yLean?(this.args.y=Math.ceil(this.originalY+this.public.yLean)||this.originalY,this.droop(-1*this.public.yLean,this.droopPos||0),this.onNextFrame(function(){t.args.y=Math.ceil(t.originalY+t.public.yLean)||t.originalY,t.droop(-1*t.public.yLean,t.droopPos||0)})):this.args.y=this.originalY}l(f(p.prototype),"update",this).call(this)}},{key:"popOut",value:function(t){this.args.platform||l(f(p.prototype),"popOut",this).call(this,t)}},{key:"rotateLock",get:function(){return!0}},{key:"canStick",get:function(){return!this.public.platform}},{key:"solid",get:function(){return!this.public.collapse||0!==this.public.float||!this.public.goBack}}])&&s(e.prototype,r),n&&s(e,n),p}();t.Block=h}),require.register("actor/Block3d.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Block3d=void 0;var i=e("./MarbleBlock");e("../region/LavaRegion");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=s(t);if(e){var o=s(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.MarbleBlock);var e=a(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(t=e.call(this,n)).args.type="actor-item actor-block-3d",t}return r}();t.Block3d=c}),require.register("actor/BreakableBlock.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BreakableBlock=void 0;var i=e("./Block"),o=e("./Orb"),a=e("curvature/base/Tag");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(p,i.Block);var e,r,n,h=l(p);function p(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(t=h.call(this,e,r)).args.type="actor-item actor-breakable-block",t.args.static=!0,t.fragmentsX=new a.Tag('<div class = "fragmentsX">'),t.fragmentsY=new a.Tag('<div class = "fragmentsY">'),t.fragmentTopLeft=new a.Tag('<div class = "fragment fragment-top-left">'),t.fragmentTopRight=new a.Tag('<div class = "fragment fragment-top-right">'),t.fragmentBottomLeft=new a.Tag('<div class = "fragment fragment-bottom-left">'),t.fragmentBottomRight=new a.Tag('<div class = "fragment fragment-bottom-right">'),t.fragmentsY.append(t.fragmentTopLeft.node),t.fragmentsY.append(t.fragmentTopRight.node),t.fragmentsY.append(t.fragmentBottomLeft.node),t.fragmentsY.append(t.fragmentBottomRight.node),t.fragmentsX.append(t.fragmentsY.node),t.broken=!1,t}return e=p,(r=[{key:"onRendered",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.box.append(this.fragmentsX.node),c(f(p.prototype),"onRendered",this).call(this)}},{key:"callCollideHandler",value:function(){var t;if(this.broken)return!1;for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c(f(p.prototype),"callCollideHandler",this)).call.apply(t,[this].concat(r))}},{key:"collideA",value:function(t,e){var r=this;if(!(t.args.rolling&&t.args.mode||t.isVehicle)&&(t.args.falling&&!t.dashed&&!t.args.jumping||!t.args.falling&&0===e))return!0;if(t instanceof i.Block&&(t.public.float||this.public.float))return!1;if(!(t instanceof o.Orb||t.isVehicle||t.controllable||t.args.rolling))return!this.broken;if(!(t instanceof o.Orb||t.falling||t.isVehicle||t.public.gSpeed||t.public.xSpeed||t.public.ySpeed))return!this.broken;if(t instanceof o.Orb||t.isVehicle||t.public.rolling||t.public.jumping||t.public.dashed||t.punching){var n=this.y-this.public.height;return this.public.bounceBack&&t.public.jumping&&t.y<n&&(t.args.ySpeed*=-bounceBack,t.args.y=n),this.onNextFrame(function(){return r.break(t)}),!1}return!this.broken}},{key:"sleep",value:function(){this.box.classList.remove("broken"),this.args.x=this.def.get("x"),this.args.y=this.def.get("y")+1,this.broken=!1}},{key:"break",value:function(t){var e=this;if(this.box.classList.add("broken"),this.box.classList.add("breaking"),this.viewport.onFrameOut(4,function(){e.box.classList.remove("breaking")}),t&&t.public.mode%2==0){var r=t.public.xSpeed||t.public.gSpeed;t.isVehicle?this.fragmentsX.style({"--xSpeed":Math.round(1.1*r)}):this.fragmentsX.style({"--xSpeed":Math.round(r)})}this.refresher||(this.refresher=!0),this.broken=!0}},{key:"solid",get:function(){return!this.broken}}])&&s(e.prototype,r),n&&s(e,n),p}();t.BreakableBlock=h}),require.register("actor/BrokenMonitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BrokenMonitor=void 0;var i=e("./PointActor");e("../actor/Explosion"),e("../actor/Monitor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-monitor actor-monitor-broken",t.args.width=28,t.args.height=32,t}return e=f,(r=[{key:"collideA",value:function(t){return a(u(f.prototype),"collideA",this).call(this,t),!0}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),f}();t.BrokenMonitor=l}),require.register("actor/Bubbles.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Bubbles=void 0;var i=e("curvature/base/Mixin"),o=e("curvature/base/Tag"),a=(e("./Flickie"),e("./PointActor")),s=e("../behavior/SkidDust"),c=e("../mixin/CanPop"),u=(e("../actor/Explosion"),e("../actor/Projectile"),e("../powerups/ElectricSheild"));function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e,r){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(y,i.Mixin.from(a.PointActor,c.CanPop));var e,r,n,d=p(y);function y(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=d.call.apply(d,[this].concat(r))).behaviors.add(new s.SkidDust),t.args.type="actor-item actor-bubbles",t.args.animation="standing",t.args.accel=.1,t.args.decel=.5,t.args.gSpeedMax=5,t.args.jumpForce=5,t.args.gravity=.5,t.args.width=32,t.args.height=32,t.willStick=!1,t.stayStuck=!1,t.args.float=-1,t.args.static=!0,t.sample=new Audio("/Sonic/object-destroyed.wav"),t.sample.volume=.6+-.3*Math.random(),t.aiming=!1,t}return e=y,(r=[{key:"onAttached",value:function(){this.shield=new u.ElectricSheild,this.args.electric&&(this.inventory.add(this.shield),this.args.currentSheild=this.shield),this.autoAttr.get(this.box)["data-gold"]="gold",this.autoAttr.get(this.box)["data-fade"]="fade",this.chain=new o.Tag('<div class = "bubbles-flame">'),this.sprite.appendChild(this.chain.node)}},{key:"update",value:function(){var t=this;if(this.viewport){if(this.args.gold&&!this.args.fading&&Math.abs(this.viewport.controlActor.x-this.x)<256&&Math.abs(this.viewport.controlActor.y-this.y)<128){this.args.fading=!0;var e=this.viewport;e.onFrameOut(25,function(){return t.args.fade=!0}),e.onFrameOut(55,function(){return e.actors.remove(t)})}this.viewport&&this.args.electric&&this.viewport.args.frameId%100==0&&(this.args.currentSheild=this.args.currentSheild?null:this.shield),this.args.ySpeed=this.yAxis,this.box.setAttribute("data-animation","standing"),this.args.falling=!0,this.args.flying=!0,f(g(y.prototype),"update",this).call(this)}}},{key:"hold_1",value:function(){this.aiming=!0}},{key:"release_1",value:function(){this.aiming=!1}},{key:"effect",value:function(t){}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}}])&&l(e.prototype,r),n&&l(e,n),y}();t.Bubbles=d}),require.register("actor/Bumper.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Bumper=void 0;var i=e("./PointActor");function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||a(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return h(t)}(this,r)}}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(g,i.PointActor);var e,r,n,s=f(g);function g(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=s.call.apply(s,[this].concat(o)),e=h(t),n=-1,(r="float")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="actor-item actor-bumper",t.args.width=16,t.args.height=16,t.ignores=new Map,t.sample=new Audio("/Sonic/S3K_AA.wav"),t}return e=g,(r=[{key:"update",value:function(){u(p(g.prototype),"update",this).call(this);var t,e=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=a(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}(this.ignores);try{for(e.s();!(t=e.n()).done;){var r=o(t.value,2),n=r[0],i=r[1];this.ignores.set(n,-1+i),0===i&&this.ignores.delete(n)}}catch(t){e.e(t)}finally{e.f()}}},{key:"collideA",value:function(t){if(!this.ignores.has(t)){if(t.args.falling){this.viewport.args.audio&&(this.sample.volume=.15+-.05*Math.random(),this.sample.currentTime=0,this.sample.play());var e=this.x-t.x,r=this.y-t.y,n=Math.max(12,Math.sqrt(Math.pow(t.args.xSpeed,2),Math.pow(t.args.ySpeed,2))),i=Math.atan2(r,e);t.args.width;t.args.x=this.x,t.args.y=this.y,t.args.xSpeed=-n*Math.cos(i),t.args.ySpeed=-n*Math.sin(i)}else t.args.gSpeed*=-1,Math.abs(t.args.gSpeed)<7&&(t.args.gSpeed=7*Math.sign(t.args.gSpeed));this.ignores.set(t,4)}}},{key:"canStick",get:function(){return!1}},{key:"rotateLock",get:function(){return!0}},{key:"solid",get:function(){return!0}}])&&c(e.prototype,r),n&&c(e,n),g}();t.Bumper=g}),require.register("actor/BuzzBomber.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BuzzBomber=void 0;e("./Flickie");var i=e("curvature/base/Mixin"),o=e("curvature/base/Tag"),a=e("./PointActor"),s=e("../behavior/SkidDust"),c=e("../mixin/CanPop"),u=(e("../actor/Explosion"),e("../actor/Projectile"));function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e,r){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(y,i.Mixin.from(a.PointActor,c.CanPop));var e,r,n,d=p(y);function y(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=d.call.apply(d,[this].concat(r))).behaviors.add(new s.SkidDust),t.args.type="actor-item actor-buzz-bomber",t.args.animation="standing",t.args.accel=.1,t.args.decel=.5,t.args.gSpeedMax=5,t.args.jumpForce=5,t.args.gravity=.5,t.args.width=32,t.args.height=16,t.willStick=!1,t.stayStuck=!1,t.args.float=-1,t.sample=new Audio("/Sonic/object-destroyed.wav"),t.sample.volume=.6+-.3*Math.random(),t.aiming=!1,t}return e=y,(r=[{key:"update",value:function(){var t=this;if(this.args.ySpeed=this.yAxis,this.flame||(this.flame=new o.Tag('<div class = "buzz-bomber-flame">'),this.wings=new o.Tag('<div class = "buzz-bomber-wings">'),this.sprite.appendChild(this.flame.node),this.sprite.appendChild(this.wings.node)),this.aiming)this.box.setAttribute("data-animation","aiming");else{var e=this.args.direction;Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?this.box.setAttribute("data-animation","skidding"):this.args.moving&&this.args.gSpeed?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}0===this.args.xSpeed&&this.viewport.onFrameOut(10,function(){t.attack()}),this.args.falling=!0,this.args.flying=!0,f(g(y.prototype),"update",this).call(this)}},{key:"command_1",value:function(){this.aiming=!this.aiming}},{key:"command_2",value:function(){if(this.aiming&&this.viewport){var t=[0,-24],e=new u.Projectile({direction:this.public.direction,x:this.args.x+t[0]+(this.args.xSpeed||this.args.gSpeed),y:this.args.y+t[1],owner:this,xSpeed:this.args.xSpeed||this.args.gSpeed,YSpeed:this.args.YSpeed});e.impulse(18,1.57+Math.PI/4*1),this.viewport.auras.add(e),this.viewport.spawn.add({object:e})}}},{key:"effect",value:function(t){}},{key:"wakeUp",value:function(){if(this.viewport){this.viewport;this.sleeping=!1,this.attack()}}},{key:"attack",value:function(){var t=this;if(!this.sleeping&&!this.attacking&&this.viewport){var e=this.viewport;this.args.direction=-1,this.args.facing="left",this.args.xSpeed=-10,this.aiming=!1,this.attacking=!0,e.onFrameOut(15,function(){t.aiming=!0,e.onFrameOut(10,function(){var r=2,n=e.onFrameInterval(15,function(){t.command_2(),r--||n()})})}),e.onFrameOut(50,function(){var r=t.args.xSpeed;t.args.xSpeed=.5*-r,e.onFrameOut(100,function(){t.aiming=!1,t.attacking=!1,t.args.xSpeed=0,t.args.ySpeed=0})})}}},{key:"sleep",value:function(){var t=this;this.args.x=this.def.get("x"),this.args.y=this.def.get("y"),this.onNextFrame(function(){t.viewport&&(t.args.x=t.def.get("x"),t.args.y=t.def.get("y"),t.viewport.setColCell(t),t.args.xSpeed=0,t.args.ySpeed=0,t.args.pushed=0,t.args.float=0,t.attacking=!1,t.sleeping=!0)})}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}}])&&l(e.prototype,r),n&&l(e,n),y}();t.BuzzBomber=d}),require.register("actor/Chalmers.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Chalmers=void 0;var i=e("./PointActor"),o=(e("curvature/base/Tag"),e("../behavior/SkidDust"));function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).behaviors.add(new o.SkidDust),t.args.type="actor-item actor-chalmers",t.args.normalHeight=64,t.args.rollingHeight=23,t.args.accel=.25,t.args.decel=.4,t.args.gSpeedMax=18,t.args.jumpForce=11,t.args.gravity=.5,t.args.width=16,t.args.height=48,t}return e=h,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div")}},{key:"update",value:function(){var t=this.args.falling;if(this.box){if(t)this.args.standingOn&&this.args.standingOn.isVehicle?this.box.setAttribute("data-animation","standing"):this.args.jumping&&this.box.setAttribute("data-animation","jumping");else{this.yAxis>0?this.args.crouching=!0:this.args.crouching=!1;var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;this.public.rolling?this.box.setAttribute("data-animation","rolling"):Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?this.box.setAttribute("data-animation","standing"):n>.25*i?this.box.setAttribute("data-animation","running"):this.args.moving&&r?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}s(l(h.prototype),"update",this).call(this)}else s(l(h.prototype),"update",this).call(this)}},{key:"solid",get:function(){return!1}},{key:"canRoll",get:function(){return!0}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),h}();t.Chalmers=f}),require.register("actor/Cinematic.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Cinematic=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(p,i.PointActor);var e,r,n,h=c(p);function p(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),f(u(r=h.call(this,t,e)),"noClip",!0),f(u(r),"panSpeed",9),r.args.float=-1,r.target=null,r.targets=[[250,6500],[5900,6600],[250,6500],[7700,7800],[6800,4200],[6800,4200],[8e3,4300],[1450,1800]],r}return e=p,(r=[{key:"setCameraMode",value:function(){this.args.cameraMode="cinematic"}},{key:"update",value:function(){if(a(l(p.prototype),"update",this).call(this),this.selected){if(!this.target||this.x===this.target[0]&&this.y===this.target[1])return this.targets.length||this.remove(),void(this.target=this.targets.shift());var t=this.target;if(this.x!==t[0]){var e=t[0]-this.x;this.args.x+=Math.sign(e)*this.panSpeed,Math.abs(e)<this.panSpeed&&(this.args.x=t[0])}if(this.y!==t[1]){var r=t[1]-this.y;this.args.y+=Math.sign(r)*this.panSpeed,Math.abs(r)<this.panSpeed&&(this.args.y=t[1])}}}},{key:"isGhost",get:function(){return!0}},{key:"controllable",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),p}();t.Cinematic=h}),require.register("actor/Coin.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Coin=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(h,i.PointActor);var e,r,n,f=c(h);function h(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=f.call.apply(f,[this].concat(o)),e=u(t),n=-1,(r="float")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="actor-item actor-coin",t.args.width=32,t.args.height=32,t.args.gone=!1,t}return e=h,(r=[{key:"update",value:function(){a(l(h.prototype),"update",this).call(this),this.viewport.args.audio&&!this.sample&&(this.sample=new Audio("/mario/smw_coin.wav"),this.sample.volume=1)}},{key:"collideA",value:function(t){var e=this;if(a(l(h.prototype),"collideA",this).call(this,t),!this.args.gone){if(this.args.type="actor-item actor-coin collected",!this.args.gone){this.viewport.args.audio&&this.sample&&this.sample.play(),this.viewport.onFrameOut(40,function(){e.args.type="actor-item actor-coin collected gone"}),this.viewport.onFrameOut(80,function(){e.viewport.actors.remove(e),e.remove()});this.x,this.y;t.args.owner?t.args.owner.args.coins+=1:t.occupant?t.occupant.args.coins+=1:t.args.coins+=1}this.args.gone=!0}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),h}();t.Coin=f}),require.register("actor/CompanionBlock.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CompanionBlock=void 0;var i=e("./MarbleBlock"),o=e("../region/LavaRegion");function a(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw o}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(p,i.MarbleBlock);var e,r,n,s=f(p);function p(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(t=s.call(this,e)).args.type="actor-item actor-marble-companion-block",t.args.density=t.args.density||9.5,t.sample=new Audio("/Sonic/S3K_35.wav"),t.played=!1,t}return e=p,(r=[{key:"update",value:function(){var t=this;this.public.pushed&&(this.viewport.tileMap.getSolid(this.x+this.public.width/2*(this.public.pushed||0),this.y)?this.public.pushed=0:this.args.falling&&(this.args.x+=this.public.pushed));var e,r=a(this.regions);try{for(r.s();!(e=r.n()).done;){var n=e.value;!this.played&&n instanceof o.LavaRegion&&(this.onTimeout(50,function(){t.viewport.args.audio&&(t.sample.volume=.15+-.05*Math.random(),t.sample.play())}),this.played=!0)}}catch(t){r.e(t)}finally{r.f()}u(h(p.prototype),"update",this).call(this)}},{key:"sleep",value:function(){var t=this;this.args.x=this.def.get("x"),this.args.y=this.def.get("y"),this.onNextFrame(function(){t.args.x=t.def.get("x"),t.args.y=t.def.get("y"),t.viewport.setColCell(t),t.args.xSpeed=0,t.args.ySpeed=0,t.args.pushed=0,t.args.float=0})}}])&&c(e.prototype,r),n&&c(e,n),p}();t.CompanionBlock=p}),require.register("actor/Cone.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Cone=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.width=16,t.args.height=32,t.args.type="actor-item actor-cone",t}return e=u,(r=[{key:"solid",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),u}();t.Cone=u}),require.register("actor/CrabMeat.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CrabMeat=void 0;e("./Flickie");var i=e("curvature/base/Mixin"),o=(e("curvature/base/Tag"),e("./PointActor")),a=e("../behavior/SkidDust"),s=e("../mixin/CanPop");e("../actor/Explosion"),e("../actor/Projectile");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(g,i.Mixin.from(o.PointActor,s.CanPop));var e,r,n,p=f(g);function g(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=p.call.apply(p,[this].concat(r))).behaviors.add(new a.SkidDust),t.args.type="actor-item actor-crabmeat",t.args.animation="standing",t.args.accel=.1,t.args.decel=.5,t.args.gSpeedMax=5,t.args.jumpForce=5,t.args.gravity=.5,t.args.width=18,t.args.height=32,t.willStick=!1,t.stayStuck=!1,t.sample=new Audio("/Sonic/object-destroyed.wav"),t.sample.volume=.6+-.3*Math.random(),t}return e=g,(r=[{key:"update",value:function(){var t=this.args.direction;Math.sign(this.args.gSpeed)!==t&&Math.abs(this.args.gSpeed-t)>5?this.box.setAttribute("data-animation","skidding"):this.args.moving&&this.args.gSpeed?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing"),u(h(g.prototype),"update",this).call(this)}},{key:"effect",value:function(t){}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}}])&&c(e.prototype,r),n&&c(e,n),g}();t.CrabMeat=p}),require.register("actor/DrillCar.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.DrillCar=void 0;var i=e("./Vehicle"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(p,i.Vehicle);var e,r,n,h=u(p);function p(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=h.call.apply(h,[this].concat(o)),e=l(t),n=["Jump ","Fly +"],(r="instructions")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="actor-item actor-drill-car",t.args.width=38,t.args.height=48,t.removeTimer=null,t.args.gSpeedMax=20,t.args.decel=.3,t.args.accel=.75,t.args.seatHeight=34,t.args.skidTraction=.95,t.dustCount=0,t.args.particleScale=2,t}return e=p,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.backSprite=new o.Tag('<div class = "sprite-back sprite">'),this.drill=new o.Tag('<div class = "drill-car-drill">'),this.seat=new o.Tag('<div class = "drill-car-seat">'),this.windsheild=new o.Tag('<div class = "drill-car-windsheild">'),this.copterCap=new o.Tag('<div class = "drill-car-copter-cap">'),this.copterBladeA=new o.Tag('<div class = "drill-car-copter-blade-a">'),this.copterBladeB=new o.Tag('<div class = "drill-car-copter-blade-b">'),this.frontWheelA=new o.Tag('<div class = "drill-car-tire drill-car-tire-front-a">'),this.frontWheelB=new o.Tag('<div class = "drill-car-tire drill-car-tire-front-b">'),this.backWheelA=new o.Tag('<div class = "drill-car-tire drill-car-tire-back-a">'),this.backWheelB=new o.Tag('<div class = "drill-car-tire drill-car-tire-back-b">'),this.sprite.appendChild(this.drill.node),this.backSprite.appendChild(this.copterCap.node),this.backSprite.appendChild(this.copterBladeA.node),this.backSprite.appendChild(this.copterBladeB.node),this.sprite.appendChild(this.windsheild.node),this.backSprite.appendChild(this.seat.node),this.sprite.appendChild(this.frontWheelA.node),this.backSprite.appendChild(this.frontWheelB.node),this.sprite.appendChild(this.backWheelA.node),this.backSprite.appendChild(this.backWheelB.node),this.box.appendChild(this.backSprite.node)}},{key:"update",value:function(){var t=this.args.falling;if(this.viewport.args.audio&&!this.flyingSound&&(this.flyingSound=new Audio("/Sonic/drill-car-copter.wav"),this.flyingSound.volume=.35+-.2*Math.random(),this.flyingSound.loop=!0),this.flyingSound&&(this.flyingSound.paused||(this.flyingSound.volume=.25+-.2*Math.random()),this.flyingSound.currentTime>.2&&(this.flyingSound.currentTime=0)),this.box){if(t)this.args.flying?this.box.setAttribute("data-animation","flying"):this.args.falling&&(this.flyingSound&&this.flyingSound.pause(),this.box.setAttribute("data-animation","jumping"));else{this.flyingSound&&this.flyingSound.pause();var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;if(this.dustCount>0&&this.dustCount--,Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5){this.box.setAttribute("data-animation","skidding");var a=this.viewport,c=new o.Tag('<div class = "particle-dust">'),u=this.rotatePoint(this.args.gSpeed,0);c.style({"--x":u[0]+this.x,"--y":u[1]+this.y,"z-index":0,opacity:2*Math.random()});var l=new o.Tag('<div class = "particle-dust">'),h=this.rotatePoint(this.args.gSpeed+40*this.args.direction,0);l.style({"--x":h[0]+this.x,"--y":h[1]+this.y,"z-index":0,opacity:2*Math.random()}),a.particles.add(c),a.particles.add(l),setTimeout(function(){a.particles.remove(c),a.particles.remove(l)},350)}else this.args.moving&&n>.75*i?this.box.setAttribute("data-animation","running"):this.args.moving&&n?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}0==this.args.copterCoolDown?this.args.ySpeed>5&&(this.flyingSound&&this.flyingSound.pause(),this.args.flying=!1):this.args.copterCoolDown>0&&this.args.copterCoolDown--,s(f(p.prototype),"update",this).call(this)}else s(f(p.prototype),"update",this).call(this)}},{key:"command_0",value:function(){if(!this.args.falling)return this.args.copterCoolDown=15,void s(f(p.prototype),"command_0",this).call(this);this.args.copterCoolDown>0||this.args.ySpeed>-16&&(this.args.flying||this.flyingSound&&this.flyingSound.play(),this.args.flying=!0,0==this.args.copterCoolDown&&(this.args.copterCoolDown=7),this.args.ySpeed=-1,this.args.ySpeed=-4,this.args.float=8)}},{key:"sleep",value:function(){this.flyingSound&&this.flyingSound.pause()}},{key:"solid",get:function(){return!this.occupant}}])&&a(e.prototype,r),n&&a(e,n),p}();t.DrillCar=h}),require.register("actor/EggMobile.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.EggMobile=void 0;var i=e("./Vehicle");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.Vehicle);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-vehicle actor-eggmobile",t.args.accel=.15,t.args.decel=.8,t.args.gSpeedMax=15,t.args.xSpeedMax=45,t.args.ySpeedMax=45,t.args.jumpForce=12,t.args.gravity=.6,t.args.width=28,t.args.height=20,t.args.yMargin=42,t.args.falling=!0,t.args.flying=!0,t.args.float=-1,t}return e=f,(r=[{key:"update",value:function(){if(this.checkBelow(this.x,this.y)&&this.args.y--,Math.abs(this.yAxis)>.5){if(Math.abs(this.args.ySpeed)<this.args.ySpeedMax){var t=this.args.ySpeed;Math.sign(this.yAxis)===Math.sign(this.args.ySpeed)?t+=this.yAxis*this.args.accel*3:t+=this.yAxis*this.args.accel*6,t=t>0?Math.floor(1e3*t)/1e3:Math.ceil(1e3*t)/1e3,this.args.ySpeed=t}}else this.args.ySpeed=this.args.ySpeed*this.args.decel;this.xAxis||(Math.abs(this.public.xSpeed)<=1&&(this.public.xSpeed=0),this.args.xSpeed>0?this.args.xSpeed=Math.floor(this.args.xSpeed*this.args.decel):this.args.xSpeed=Math.ceil(this.args.xSpeed*this.args.decel)),this.occupant||(this.args.xSpeed=0,this.args.ySpeed=0),this.args.falling=!0,this.args.flying=!0,this.args.mode=0,this.args.cameraMode="aerial",a(u(f.prototype),"update",this).call(this)}},{key:"solid",get:function(){return!this.occupant}}])&&o(e.prototype,r),n&&o(e,n),f}();t.EggMobile=l}),require.register("actor/Eggman.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Eggman=void 0;var i=e("./PointActor"),o=(e("curvature/base/Tag"),e("../behavior/SkidDust"));function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).behaviors.add(new o.SkidDust),t.args.type="actor-item actor-eggman",t.accelNormal=.15,t.accelSuper=.3,t.args.accel=.15,t.args.decel=.3,t.args.normalHeight=40,t.args.rollingHeight=32,t.gSpeedMaxNormal=18,t.gSpeedMaxSuper=28,t.args.gSpeedMax=t.gSpeedMaxNormal,t.args.normalHeight=57,t.args.rollingHeight=29,t.jumpForceNormal=11,t.jumpForceSuper=18,t.args.jumpForce=t.jumpForceNormal,t.args.gravity=.5,t.args.width=18,t.args.height=57,t.args.spriteSheet=t.spriteSheet="/Sonic/eggman.png",t.superSpriteSheet="/Sonic/eggman-super.png",t}return e=h,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div")}},{key:"update",value:function(){var t=this.args.falling;if(this.box){this.yAxis>0?this.args.crouching=!0:this.args.crouching=!1;var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;t?(this.public.jumping&&this.box.setAttribute("data-animation","jumping"),this.args.height=this.public.rollingHeight):this.public.rolling?(this.args.height=this.public.rollingHeight,this.public.direction!==Math.sign(this.public.gSpeed)&&(this.args.direction=Math.sign(this.public.gSpeed),this.args.direction<0?this.args.facing="left":this.args.facing="right"),this.box.setAttribute("data-animation","rolling")):(this.args.height=this.public.normalHeight,Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?this.box.setAttribute("data-animation","skidding"):n>i/2?this.box.setAttribute("data-animation","running"):this.args.moving&&r?this.box.setAttribute("data-animation","walking"):this.args.crouching||this.args.standingOn&&this.args.standingOn.isVehicle?this.box.setAttribute("data-animation","crouching"):this.box.setAttribute("data-animation","standing")),s(l(h.prototype),"update",this).call(this)}else s(l(h.prototype),"update",this).call(this)}},{key:"command_3",value:function(){var t=this;this.isSuper=!this.isSuper,this.onTimeout(150,function(){0===t.args.rings&&t.setProfile()}),this.setProfile()}},{key:"setProfile",value:function(){this.isSuper?(this.args.spriteSheet=this.superSpriteSheet,this.args.gSpeedMax=this.gSpeedMaxSuper,this.args.jumpForce=this.jumpForceSuper,this.args.accel=this.accelSuper):(this.args.spriteSheet=this.spriteSheet,this.args.gSpeedMax=this.gSpeedMaxNormal,this.args.jumpForce=this.jumpForceNormal,this.args.accel=this.accelNormal)}},{key:"solid",get:function(){return!1}},{key:"canRoll",get:function(){return!0}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),h}();t.Eggman=f}),require.register("actor/Eggrobo.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Eggrobo=void 0;var i=e("./PointActor"),o=e("./Projectile"),a=e("curvature/base/Tag"),s=e("../behavior/SkidDust");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(g,i.PointActor);var e,r,n,p=f(g);function g(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=p.call.apply(p,[this].concat(r))).behaviors.add(new s.SkidDust),t.args.type="actor-item actor-eggrobo",t.args.accel=.125,t.args.decel=.3,t.args.gSpeedMax=14,t.args.jumpForce=11,t.args.gravity=.5,t.args.width=18,t.args.height=57,t}return e=g,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.flame=new a.Tag('<div class = "eggrobo-flame">'),this.muzzleFlash=new a.Tag('<div class = "eggrobo-muzzle-flash">'),this.sprite.appendChild(this.flame.node),this.sprite.appendChild(this.muzzleFlash.node)}},{key:"update",value:function(){var t=this.args.falling;if(this.viewport.args.audio&&!this.shootingSample&&(this.shootingSample=new Audio("/Sonic/shot-fired.wav"),this.thrusterSound=new Audio("/Sonic/mecha-sonic-thruster.wav"),this.thrusterSound.loop=!0),this.thrusterSound&&(this.thrusterSound.currentTime>.4+Math.random()/10&&(this.thrusterSound.currentTime=.05),this.thrusterSound.volume=.2+-.05*Math.random()),this.box){if(t)this.args.crouching=!1,this.public.jumping&&this.box.setAttribute("data-animation","jumping");else{this.yAxis>0?this.args.crouching=!0:this.args.crouching=!1;var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?(this.thrusterSound&&this.thrusterSound.pause(),this.box.setAttribute("data-animation","skidding")):n>i/2?(this.thrusterSound&&this.thrusterSound.pause(),this.box.setAttribute("data-animation","running")):this.args.moving&&r?this.box.setAttribute("data-animation","walking"):this.args.crouching||this.standingOn&&this.standingOn.isVehicle?this.box.setAttribute("data-animation","crouching"):this.box.setAttribute("data-animation","standing")}this.args.falling||(this.args.flying=!1),this.args.flying?this.box.setAttribute("data-animation","flying"):this.args.falling&&this.box.setAttribute("data-animation","jumping"),this.args.shotCoolDown>0&&this.args.shotCoolDown--,0==this.args.rocketCoolDown&&this.thrusterSound&&this.thrusterSound.pause(),this.args.rocketCoolDown>0&&this.args.rocketCoolDown--,0==this.args.rocketCoolDown&&(this.args.flying=!1),u(h(g.prototype),"update",this).call(this)}else u(h(g.prototype),"update",this).call(this)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"hold_0",value:function(){this.args.falling?(this.args.ySpeed>1||this.args.flying)&&(this.args.flying=!0,this.args.rocketCoolDown<=1&&(this.thrusterSound&&this.thrusterSound.play(),this.args.rocketCoolDown=3),this.args.ySpeed=0,this.args.float=4):this.args.rocketCoolDown=5}},{key:"hold_2",value:function(){var t=this;if(!(this.args.shotCoolDown>0)){var e,r,n,i=Math.sign(this.args.direction),a=this.args.groundAngle;switch(this.args.mode){case 0:n=-a-Math.PI/2+Math.PI/4*i,r=-a;break;case 1:n=-a+Math.PI/4*i,r=-a+Math.PI/2;break;case 2:n=-a+Math.PI/2+Math.PI/4*i,r=-a-Math.PI;break;case 3:n=-a-Math.PI+Math.PI/4*i,r=-a-Math.PI/2}e=[50*Math.cos(n),50*Math.sin(n)],(this.args.falling||this.args.crouching)&&(r=0,e=[26*i,-26]);var s=new o.Projectile({direction:this.public.direction,x:this.args.x+e[0]+(this.args.xSpeed||this.args.gSpeed),y:this.args.y+e[1],owner:this,xSpeed:this.args.xSpeed||this.args.gSpeed,YSpeed:this.args.YSpeed});s.impulse(18,r+(i<0?Math.PI:0),!0),s.update(),this.viewport.auras.add(s),this.viewport.spawn.add({object:s}),this.box.setAttribute("data-shooting","true"),this.onTimeout(140,function(){t.box.setAttribute("data-shooting","false")}),this.viewport.args.audio&&this.shootingSample&&(this.shootingSample.volume=.6+-.3*Math.random(),this.shootingSample.currentTime=0,this.shootingSample.play()),this.args.shotCoolDown=4}}},{key:"canFly",get:function(){return!0}},{key:"controllable",get:function(){return!0}}])&&c(e.prototype,r),n&&c(e,n),g}();t.Eggrobo=p}),require.register("actor/Emerald.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Emerald=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-emerald emerald-"+(t.args.color||"white"),t.args.width=12,t.args.height=12,t}return e=f,(r=[{key:"update",value:function(){a(u(f.prototype),"update",this).call(this);var t=this.viewport;t&&t.args.audio&&!this.sample&&(this.sample=new Audio("/Sonic/S3K_9C.wav"),this.sample.volume=.25+.5*Math.random())}},{key:"collideA",value:function(t){a(u(f.prototype),"collideA",this).call(this,t),this.args.gone||(this.args.type="actor-item actor-emerald collected emerald-"+(this.args.color||"white"),this.args.gone||(this.viewport.args.audio&&this.sample&&this.sample.play(),this.args.type="actor-item actor-emerald collected gone emerald-"+(this.args.color||"white"),t.args.owner?t.args.owner.args.emeralds+=1:t.occupant?t.occupant.args.emeralds+=1:t.args.emeralds+=1,this.viewport.args.emeralds.includes(this.args.color)||this.viewport.args.emeralds.push(this.args.color),this.viewport.actors.remove(this),this.remove()),this.args.gone=!0)}},{key:"solid",get:function(){return!1}},{key:"effect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Emerald=l}),require.register("actor/Explosion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Explosion=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(h,i.PointActor);var e,r,n,f=c(h);function h(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=f.call.apply(f,[this].concat(o)),e=u(t),n=-1,(r="float")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="actor-item actor-explosion",t.args.width=48,t.args.height=48,t.removeTimer=null,t}return e=h,(r=[{key:"update",value:function(){if(a(l(h.prototype),"update",this).call(this),!this.removeTimer){this.viewport;this.removeTimer=this.onTimeout(360,function(){})}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),h}();t.Explosion=f}),require.register("actor/Flickie.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Flickie=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(h,i.PointActor);var e,r,n,f=c(h);function h(t,e){var r,n,i,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),r=f.call(this,t,e),n=u(r),o=1,(i="noClip")in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,r.args.type="actor-item actor-flickie",r.args.float=-1,r.args.width=16,r.args.height=16,r.args.z=-1,r.args.palletShift=Math.floor(8*Math.random()),r}return e=h,(r=[{key:"update",value:function(){var t=this;a(l(h.prototype),"update",this).call(this),this.args.standingOn=!1;var e=this.viewport.controlActor;if(e){this.args.falling=!0,this.args.float=-1;var r=Math.random(),n=Math.random(),i=e.x+-this.x,o=e.y+-this.y,s=Math.atan2(o,i),c=Math.sqrt(Math.pow(o,2)+Math.pow(i,2)),u=1.1*Math.max(Math.abs(e.args.gSpeed),Math.abs(e.args.xSpeed),Math.abs(e.args.ySpeed),1),f=this.args.xSpeed-(e.args.xSpeed||e.args.gSpeed),p=u+3,g=null;c<64?(Math.abs(this.public.xSpeed)<1&&(this.args.xSpeed=1*Math.sign(-.5+Math.random())),Math.abs(this.public.ySpeed)<1&&(this.args.ySpeed=1*Math.sign(-.5+Math.random()))):c>=256&&(this.args.x=Math.floor(e.x-256*Math.cos(s)),this.args.y=Math.floor(e.y-256*Math.sin(s)),this.args.xSpeed=i/60+(e.args.xSpeed||e.args.gSpeed),this.args.ySpeed=0,this.viewport.setColCell(this),g=this.x>e.x?"left":"right",p*=4);var d=Math.sign(i),y=Math.sign(o),b=Math.sign(this.args.xSpeed)===d,v=this.args.ySpeed&&Math.sign(this.args.ySpeed)===y,m=.35*Math.max(r)*(b?.85:.55),w=.1*Math.max(r)*(b?.75:1.5);if(!b||Math.abs(this.args.xSpeed)<p){var S=m*d*n,O=this.args.xSpeed+S;if(Math.abs(this.public.xSpeed)>p&&(O=p*Math.sign(this.public.xSpeed)),this.args.xSpeed=O,c>=256){var x=e.args.xSpeed||e.args.gSpeed,k=e.args.ySpeed;g&&(this.args.xSpeed=i/90+x,this.args.ySpeed=o/90+k)}}if(!g&&this.public.xSpeed<0?g="left":g||(g="right"),!v||Math.abs(this.public.ySpeed)<p){var j=this.public.ySpeed+w*y;Math.abs(this.args.ySpeed)>p&&(j=p*Math.sign(this.args.ySpeed)),this.args.ySpeed=j}Math.sign(f)&&Math.sign(e.args.xSpeed||e.args.gSpeed)!==Math.sign(f)&&(Math.abs(this.x-e.x)>64||Math.abs(this.y-e.y)>64)&&(this.args.z=this.args.z>-1e3?-1e5:1e5),g&&(this.args.facing=g),this.args.ySpeed>0?this.onTimeout(250,function(){t.args.ySpeed<=0||u<1.5||t.box&&(t.box.classList.add("decending"),t.box.classList.remove("ascending"))}):this.box&&(this.box.classList.remove("decending"),this.box.classList.add("ascending"))}}},{key:"solid",get:function(){return!1}},{key:"isGhost",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),h}();t.Flickie=f}),require.register("actor/GrapplePoint.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.GrapplePoint=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.width=22,t.args.height=32,t.args.type="actor-item actor-grapple-point",t.ignoreOthers=new Set,t.noClip=!0,t}return e=h,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.chain=new o.Tag('<div class = "chain">'),this.sprite.appendChild(this.chain.node)}},{key:"findNextStep",value:function(){return!1}},{key:"update",value:function(){if(!this.args._tiedTo){var t=this.viewport.actorsById[this.args.tiedTo];return this.args._tiedTo=t,void t.hanging.set(this.constructor,this)}var e=this.args._tiedTo;if(!e.args.falling)return this.args.groundAngle=-1.57,!1;this.args.falling=!0,s(l(h.prototype),"update",this).call(this);var r=e.x-this.x,n=e.y-this.y,i=Math.sqrt(Math.pow(n,2)+Math.pow(r,2)),o=Math.atan2(n,r),a=this.args.ropeLength||64;if(this.chain.style({"--distance":Math.min(i,a)}),this.args.groundAngle=-(o+Math.PI/2),i>=a){var c=e.x-Math.cos(o)*a-e.args.xSpeed,u=e.y-Math.sin(o)*a-e.args.ySpeed;this.args.xSpeed-=Math.cos(o+Math.PI),this.args.ySpeed-=Math.sin(o+Math.PI),this.hooked&&this.hooked.xAxis&&this.args.ySpeed>0&&(Math.sign(this.args.xSpeed)||Math.sign(this.args.xSpeed)===Math.sign(this.hooked.xAxis))&&(this.args.xSpeed+=.5*this.hooked.xAxis),this.args.x=c,this.args.y=u,this.viewport.setColCell(this),this.x!==e.x||e.args.xSpeed||(this.args.ySpeed=0)}this.hooked&&(this.hooked.args.x=this.x,this.hooked.args.y=this.y+this.hooked.args.height,this.hooked.xAxis>0?(this.hooked.args.facing="right",this.hooked.args.direction=1):this.hooked.xAxis<0&&(this.hooked.args.facing="left",this.hooked.args.direction=-1))}},{key:"collideB",value:function(t){var e=this,r=this.args._tiedTo;if(!r||!r.args.falling)return!1;if(!t.args.hangingFrom&&!this.ignoreOthers.has(t)){if(this.args.ignore)return!1;if(!(Math.abs(t.y-this.y)>8||!t.controllable||this.hooked)&&(t.args.falling=!0,this.hooked=t,this.viewport.auras.add(this),this.args.xSpeed=t.args.xSpeed,this.args.ySpeed=t.args.ySpeed,t.args.xSpeed=0,t.args.ySpeed=0,t.args.gSpeed=0,t.args.ignore=-4,t.args.float=-1,t.args.x=this.x,t.args.y=this.y+t.args.height,t.args.hangingFrom=this,t.args.jumping=!1,this.args._tiedTo)){var n,i=this.args._tiedTo;i.dispatchEvent(new CustomEvent("hooked"),{detail:{hook:this,subject:t}}),i.activate&&i.activate();var o=function(){e.viewport&&e.hooked&&i.explode&&(e.hooked.args.gSpeed=0,e.unhook(),i.explode(),e.args.ignore=30,e.args.float=60,e.args.x=e.def.get("x"),e.args.y=e.def.get("y"),e.viewport.setColCell(e))};this.viewport.onFrameOut(null!==(n=i.args.flightTime)&&void 0!==n?n:85,o),i.onRemove(o)}}}},{key:"unhook",value:function(){var t,e,r=this,n=this.hooked;if(this.hooked=null,n){this.args._tiedTo;n.args.ignore=n.args.float=0,n.args.y++,n.args.xSpeed+=null!==(t=this.xSpeedLast)&&void 0!==t?t:0,n.args.ySpeed+=null!==(e=this.ySpeedLast)&&void 0!==e?e:0,n.args.hangingFrom=null,this.ignoreOthers.add(n),n.args.falling=!0,n.args.jumping=!0,this.viewport.onFrameOut(15,function(){r.ignoreOthers.delete(n),r.viewport.auras.delete(r)})}}}])&&a(e.prototype,r),n&&a(e,n),h}();t.GrapplePoint=f}),require.register("actor/Knuckles.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Knuckles=void 0;var i=e("./PointActor"),o=(e("curvature/base/Tag"),e("./KnuxBomb")),a=e("../behavior/SkidDust");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(p,i.PointActor);var e,r,n,h=l(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=h.call.apply(h,[this].concat(r))).behaviors.add(new a.SkidDust),t.args.type="actor-item actor-knuckles",t.args.accel=.25,t.args.decel=.4,t.args.gSpeedMax=18,t.args.jumpForce=11,t.args.gravity=.5,t.args.width=15,t.args.height=41,t.args.normalHeight=41,t.args.rollingHeight=23,t.punchTime=0,t.punched=0,t.beforePunch="standing",t.bombsDropped=0,t.args.bindTo("falling",function(e){!e&&t.public.flying&&(1!==t.public.mode&&2!==t.public.mode&&3!==t.public.mode||(t.args.climbing=!0,t.args.gSpeed=0,t.args.xSpeed=0,t.args.ySpeed=0))}),t}return e=p,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div")}},{key:"update",value:function(){var t=this.public.falling;if(this.box){if(this.throwing&&Date.now()-this.throwing>320){this.throwing=!1,this.holdBomb=!1;var e=new o.KnuxBomb({x:this.public.x,y:this.public.y-16,owner:this,xSpeed:10*this.public.direction+(2*Math.random()-1),ySpeed:-2*Math.random()});this.viewport.spawn.add({object:e})}if(this.readying=!1,this.punchTime&&Date.now()-this.punchTime>(this.willPunch?1536:512)&&(this.punchMomentum=0,this.punchTime=!1,this.willPunch=!1,this.punching=!1,this.punched=0),this.punchTime&&Date.now()-this.punchTime>384&&(this.readying=!0),this.punchTime&&Date.now()-this.punchTime>128&&(this.punching=!0),this.willStick=!1,this.stayStuck=!1,t)this.public.flying?this.box.setAttribute("data-animation","flying"):this.public.jumping&&this.box.setAttribute("data-animation","jumping"),this.public.climbing&&(this.args.ySpeed=0,this.args.xSpeed=0,this.args.ignore=10,this.args.falling=!1,this.box.setAttribute("data-animation","walking"),this.args.groundAngle=0,1===this.args.mode?this.args.x+=-4:3===this.args.mode&&(this.args.x+=4),this.args.mode=0);else{this.bombsDropped=0;var r=this.public.direction,n=this.public.gSpeed,i=Math.abs(n),a=this.public.gSpeedMax;this.public.flying&&(this.args.flying=!1,this.args.float=0),this.args.knucklesFlyCoolDown=15,this.args.flying=!1,this.public.rolling?this.box.setAttribute("data-animation","rolling"):this.public.climbing?this.yAxis<0?(this.box.setAttribute("data-animation","climbing-up"),Math.abs(this.args.gSpeed)<4&&(this.args.direction=1===this.public.mode?1:-1,this.args.gSpeed-=this.public.direction)):this.yAxis>0?(this.box.setAttribute("data-animation","climbing-down"),Math.abs(this.args.gSpeed)<4&&(this.args.direction=1===this.public.mode?1:-1,this.args.gSpeed+=this.public.direction)):(this.box.setAttribute("data-animation","climbing"),this.args.gSpeed=0):Math.sign(this.public.gSpeed)!==r&&Math.abs(this.public.gSpeed-r)>5?this.box.setAttribute("data-animation","skidding"):this.holdBomb?this.box.setAttribute("data-animation","hold-bomb"):this.throwing?this.box.setAttribute("data-animation","throw-bomb"):!this.readying&&this.punched?this.punched%2?this.box.setAttribute("data-animation","jabbing"):this.box.setAttribute("data-animation","punching"):this.readying||this.willPunch?this.box.setAttribute("data-animation","readying"):i>.75*a?this.box.setAttribute("data-animation","running"):this.public.moving&&this.public.gSpeed?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}if(this.public.flying){if(this.yAxis>0||this.checkBelow(this.x,this.y))return void(this.args.flying=!1);this.public.ySpeed>0&&(this.args.ySpeed=0),this.public.ySpeed<1&&(this.args.ySpeed+=1),this.public.ySpeed>1&&(this.args.ySpeed-=1),this.xAxis&&(this.args.flyDirection=Math.sign(this.xAxis)),this.args.direction=Math.sign(this.public.xSpeed),this.public.direction<0?this.args.facing="left":this.args.facing="right",this.public.flyDirection&&Math.abs(this.args.xSpeed)<16&&(this.public.flyDirection!==Math.sign(this.public.xSpeed)?this.args.xSpeed+=.15625*Math.sign(this.public.flyDirection)*4:this.args.xSpeed+=.15625*Math.sign(this.public.flyDirection)),Math.abs(this.args.xSpeed)>18&&(this.args.xSpeed=18*Math.sign(this.args.xSpeed)),this.args.float=3,this.willStick=!0,this.stayStuck=!0,this.args.groundAngle=0}else(this.public.mode%2==0||this.public.groundAngle)&&(this.args.flyDirection=0);this.args.knucklesFlyCoolDown>0&&this.args.knucklesFlyCoolDown--,c(f(p.prototype),"update",this).call(this),0!==this.public.mode&&2!==this.public.mode||(this.args.climbing=!1)}else c(f(p.prototype),"update",this).call(this)}},{key:"dropBomb",value:function(){this.public.falling&&(this.args.ySpeed=-8);var t=new o.KnuxBomb({x:this.public.x,y:this.public.y-16,owner:this,xSpeed:this.public.xSpeed,ySpeed:-3});this.viewport.spawn.add({object:t})}},{key:"release_0",value:function(){c(f(p.prototype),"release_0",this).call(this)}},{key:"command_0",value:function(){c(f(p.prototype),"command_0",this).call(this),this.args.falling&&(this.args.flying=!0,this.args.xSpeed=9*this.args.direction,this.args.willJump=!1)}},{key:"command_1",value:function(){return this.punchTime&&Date.now()-this.punchTime<72?(this.punchMomentum=0,this.args.ignore=8,this.willPunch=!1,this.punchTime=!1,void(this.punched=0)):(this.willPunch=!0,this.punchTime?(this.args.ignore=15,void(this.args.gSpeed=0)):(this.punchMomentum=this.punchMomentum||this.args.gSpeed||4*this.args.direction,this.args.ignore=15,void(this.args.gSpeed=0)))}},{key:"release_1",value:function(){if(this.punchTime&&Date.now()-this.punchTime<96)return this.willPunch=!1,this.punchMomentum=0,void(this.punched=0);this.args.gSpeed=this.punchMomentum,this.punchTime=Date.now(),this.willPunch=!1,this.throwing||this.args.climbing||this.punched++}},{key:"command_2",value:function(){if(!this.public.ignore&&this.public.falling&&!this.public.flying&&this.bombsDropped<3)return this.dropBomb(),void this.bombsDropped++;this.public.falling||this.public.climbing||Math.abs(this.args.gSpeed)>3||this.punchTime||this.throwing||(this.holdBomb=Date.now(),this.args.ignore=-1,this.args.gSpeed=0)}},{key:"release_2",value:function(){this.public.falling||this.public.climbing||Math.abs(this.args.gSpeed)>3||this.holdBomb&&(this.args.ignore=4,this.holdBomb=!1,this.throwing=Date.now())}},{key:"setCameraMode",value:function(){this.args.climbing?this.args.cameraMode="aerial":c(f(p.prototype),"setCameraMode",this).call(this)}},{key:"solid",get:function(){return!1}},{key:"canRoll",get:function(){return!this.public.climbing}},{key:"canFly",get:function(){return!0}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&s(e.prototype,r),n&&s(e,n),p}();t.Knuckles=h}),require.register("actor/KnuxBomb.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.KnuxBomb=void 0;var i=e("./PointActor"),o=(e("../actor/Explosion"),e("curvature/base/Tag"));e("../region/Region"),e("./Spring");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-knux-bomb",t.args.width=16,t.args.height=16,t.removeTimer=null,t}return e=h,(r=[{key:"update",value:function(){var t=this;this.removed||(s(l(h.prototype),"update",this).call(this),this.args.xSpeed||this.args.ySpeed||this.args.gSpeed||(this.removeTimer=this.onTimeout(250,function(){return t.explode()})),this.removeTimer||(this.removeTimer=this.onTimeout(1500,function(){return t.explode()})))}},{key:"explode",value:function(){var t=this.viewport;if(t){var e=new o.Tag('<div class = "particle-explosion">');e.style({"--x":this.x,"--y":this.y}),t.particles.add(e),setTimeout(function(){return t.particles.remove(e)},350),this.viewport.actors.remove(this),this.remove()}}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!1}}])&&a(e.prototype,r),n&&a(e,n),h}();t.KnuxBomb=f}),require.register("actor/LayerSwitch.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.LayerSwitch=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e,r){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(h,i.PointActor);var e,r,n,f=s(h);function h(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=f.call.apply(f,[this].concat(o)),e=c(t),n=-1,(r="float")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="actor-item actor-layer-switch",t.args.width=32,t.args.height=32,t}return e=h,n=[{key:"fromDef",value:function(t){var e=u(l(h),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.height=t.height,e}}],(r=[{key:"onAttach",value:function(t){return t&&t.preventDefault(),!1}},{key:"collideA",value:function(t,e){var r=this,n=t.public.gSpeed||t.public.direction||t.xAxis,i=!!Number(this.public.back),o=!!Number(this.public.roll),a=this.args.width/2+(n>0?-1:0);if(!(t.x<this.x+-a||t.x>this.x+a||t.y<this.y+-this.public.height||t.y>this.y)){if(o&&(!t.public.rolling||t.public.height>28))return t.args.layer=1===s?2:1,!1;i&&t.public.falling&&(n=t.public.xSpeed||t.public.direction,i=!i);var s=t.public.layer;n>0&&(s=i?1:2),n<0&&(s=i?2:1),this.viewport.tileMap.getSolid(t.x,t.y,s)?this.onNextFrame(function(){r.viewport.tileMap.getSolid(t.x,t.y,s)||(t.args.layer=s)}):t.args.layer=s}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),h}();t.LayerSwitch=f}),require.register("actor/Magnet.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Magnet=void 0;var i=e("./PointActor"),o=e("curvature/base/Mixin"),a=e("../mixin/Constrainable");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(p,o.Mixin.from(i.PointActor,a.Constrainable));var e,r,n,h=l(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=h.call.apply(h,[this].concat(r))).args.gravity=.8,t.args.width=48,t.args.height=28,t.args.type="actor-item actor-magnet",t}return e=p,(r=[{key:"collideA",value:function(t,e){}},{key:"collideB",value:function(t){t.controllable}},{key:"update",value:function(){c(f(p.prototype),"update",this).call(this),this.setPos()}}])&&s(e.prototype,r),n&&s(e,n),p}();t.Magnet=h}),require.register("actor/MarbleBlock.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MarbleBlock=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-block-marble",t.args.width=32,t.args.height=32,t.args.spriteSheet=t.args.spriteSheet||"/Sonic/marble-zone-block.png",t}return e=f,(r=[{key:"collideA",value:function(t,e){if(a(u(f.prototype),"collideA",this).call(this,t,e),t.isEffect)return!1;var r=Math.ceil(Math.abs(t.args.gSpeed||t.args.xSpeed))*Math.sign(t.args.gSpeed||t.args.xSpeed);if(Math.abs(t.public.ySpeed)>Math.abs(t.public.xSpeed))return!0;if(!this.args.falling&&1===e&&r<=0)return!1;if(!this.args.falling&&3===e&&r>=0)return!1;var n=this.y-this.args.height;if((1===e||3===e)&&(t.y>=this.y||t.y>n)){if(!r)return!0;this.args.pushed=Math.sign(t.public.gSpeed)||this.args.pushed;var i=this.viewport.tileMap,o=1===e?1:3===e&&-1,s=this.scanBottomEdge(o);if(i.getSolid(this.x+Math.ceil(this.args.width/2)*o,this.y))return!0;var c=this.args.width/2;if(o>0&&0===s)this.args.falling=!0;else if(o<0&&0===s)this.args.falling=!0;else if(!this.args.falling||s>0){var l=this.findNextStep(o),h=this.findNextStep(o+c*Math.sign(o));if((!l[1]||l[2])&&!h[3]){var p=t.args.width,g=this.args.width/2;return this.args.x=t.args.x+o*(g+p),0===s}return!0}}return!0}},{key:"isPushable",get:function(){return!0}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!0}},{key:"rotateLock",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.MarbleBlock=l}),require.register("actor/MechaFroggy.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MechaFroggy=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag"),a=e("../behavior/SkidDust");e("../actor/Explosion"),e("../actor/Projectile");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(p,i.PointActor);var e,r,n,h=l(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=h.call.apply(h,[this].concat(r))).behaviors.add(new a.SkidDust),t.args.type="actor-item actor-mecha-froggy",t.args.animation="standing",t.args.accel=.7,t.args.decel=.5,t.args.gSpeedMax=10,t.args.jumpForce=15,t.args.gravity=.5,t.args.width=15,t.args.height=32,t.willStick=!1,t.stayStuck=!1,t.sample=new Audio("/Sonic/object-destroyed.wav"),t.sample.volume=.6+-.3*Math.random(),t}return e=p,(r=[{key:"update",value:function(){var t=this.args.direction;this.flame||(this.flame=new o.Tag('<div class = "mecha-froggy-flame">'),this.sprite.appendChild(this.flame.node)),this.args.jumping&&!this.args.falling||(Math.sign(this.args.gSpeed)!==t&&Math.abs(this.args.gSpeed-t)>5?this.box.setAttribute("data-animation","skidding"):this.args.moving&&this.args.gSpeed&&Math.abs(this.args.gSpeed)>=10?this.box.setAttribute("data-animation","running"):this.args.moving&&this.args.gSpeed&&Math.abs(this.args.gSpeed)?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")),this.args.jumping&&this.box.setAttribute("data-animation","jumping"),c(f(p.prototype),"update",this).call(this)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&s(e.prototype,r),n&&s(e,n),p}();t.MechaFroggy=h}),require.register("actor/MechaSonic.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MechaSonic=void 0;var i=e("./PointActor"),o=(e("./Vehicle"),e("curvature/base/Tag")),a=e("../behavior/SkidDust");function s(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,r){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(g,i.PointActor);var e,r,n,c=h(g);function g(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).behaviors.add(new a.SkidDust("particle-sparks")),t.args.type="actor-item actor-mecha-sonic",t.args.accel=.45,t.args.decel=.3,t.args.skidTraction=2,t.args.gSpeedMax=18,t.args.jumpForce=11,t.args.gravity=.5,t.args.takeoffPlayed=!1,t.public.rollingHeight=52,t.public.normalHeight=31,t.args.width=18,t.args.height=52,t.args.bindTo("falling",function(e){e||t.landSound()}),t}return e=g,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite")}},{key:"update",value:function(){var t=this;if(this.sprite){var e=this.args.falling;this.args.accel=.3;var r=this.public.direction,n=this.public.gSpeed,i=Math.abs(n),a=.75*this.public.gSpeedMax;this.flame||(this.sparks=new o.Tag('<div class = "mecha-sonic-sparks">'),this.flame=new o.Tag('<div class = "mecha-sonic-flame">'),this.sprite.appendChild(this.sparks.node),this.sprite.appendChild(this.flame.node)),this.viewport.args.audio&&!this.thrusterSound&&(this.takeoffSound=new Audio("/Sonic/mecha-sonic-takeoff.wav"),this.thrusterSound=new Audio("/Sonic/mecha-sonic-thruster.wav"),this.scrapeSound=new Audio("/Sonic/mecha-sonic-scrape.wav"),this.thrusterCloseSound=new Audio("/Sonic/mecha-sonic-thruster-close.wav"),this.thrusterCloseSound.volume=.25,this.takeoffSound.volume=.5,this.scrapeSound.volume=.1,this.thrusterSound.loop=!0,this.scrapeSound.loop=!0),this.thrusterSound&&(this.thrusterSound.volume=.15+-.05*Math.random(),this.thrusterSound.currentTime>1.5&&(this.thrusterSound.currentTime=.5),this.scrapeSound.currentTime>1.5&&(this.scrapeSound.currentTime=.5)),e||(this.dashed=!1),this.public.rolling||e?this.public.rolling?(this.scrapeSound&&this.scrapeSound.pause(),"curling"!==this.args.animation&&"uncurling"!==this.args.animation&&"rolling"!==this.args.animation&&"jumping"!==this.args.animation&&(this.args.animation="crouching",this.onTimeout(200,function(){t.public.rolling&&(t.args.animation="rolling",t.closeThruster())}))):(this.scrapeSound&&this.scrapeSound.pause(),this.dashed?this.args.animation="running2":"rolling"!==this.args.animation&&"jumping"!==this.args.animation&&"uncurling"!==this.args.animation&&"curling"!==this.args.animation&&"crouching"!==this.args.animation?(this.args.animation="curling",this.onTimeout(200,function(){t.thrusterCloseSound&&t.thrusterCloseSound.play(),t.public.falling&&(t.dashed?t.args.animation="running2":t.public.jumping&&(t.args.animation="jumping"),t.closeThruster())})):this.public.jumping||(this.args.animation="crouching")):(this.yAxis>0?this.args.crouching=!0:this.args.crouching=!1,Math.sign(this.public.gSpeed)!==r&&Math.abs(this.public.gSpeed-r)>5?(this.scrapeSound&&this.scrapeSound.play(),this.args.animation="skidding"):i>=a?(this.scrapeSound&&this.scrapeSound.pause(),this.args.animation="running2",this.thrusterSound&&this.thrusterSound.play(),this.public.takeoffPlayed||(this.args.takeoffPlayed=!0,this.takeoffSound&&this.takeoffSound.play()),this.args.accel=.75,i>75&&(this.args.accel=.01)):i>=10?(this.scrapeSound&&this.scrapeSound.play(),this.args.animation="running"):this.args.moving&&n?(this.scrapeSound&&this.scrapeSound.play(),"curling"===this.args.animation||"jumping"===this.args.animation||"rolling"===this.args.animation?(this.args.animation="uncurling",this.onTimeout(128,function(){t.args.animation="walking"})):"standing"!==this.args.animation&&"running"!==this.args.animation&&"running2"!==this.args.animation||(this.args.animation="walking")):this.args.crouching||this.standingOn&&this.standingOn.isVehicle?this.args.animation="crouching":(this.scrapeSound&&this.scrapeSound.pause(),"curling"===this.args.animation||"jumping"===this.args.animation||"rolling"===this.args.animation?(this.args.animation="uncurling",this.onTimeout(128,function(){t.args.animation="standing"})):"walking"!==this.args.animation&&"running"!==this.args.animation&&"running2"!==this.args.animation&&"skidding"!==this.args.animation&&"crouching"!==this.args.animation&&"rolling"!==this.args.animation||(this.args.animation="standing")),i<a&&this.closeThruster()),l(p(g.prototype),"update",this).call(this)}}},{key:"closeThruster",value:function(){this.args.takeoffPlayed&&this.landSound(),this.args.takeoffPlayed=!1,this.thrusterSound&&this.thrusterSound.pause()}},{key:"landSound",value:function(){this.thrusterCloseSound&&this.thrusterCloseSound.play()}},{key:"sleep",value:function(){this.thrusterSound&&this.thrusterSound.pause(),this.scrapeSound&&this.scrapeSound.pause()}},{key:"command_5",value:function(){this.public.falling&&this.airDash(1)}},{key:"command_4",value:function(){this.public.falling&&this.airDash(-1)}},{key:"airDash",value:function(t){var e=this;if(!(this.dashed||this.public.ignore&&-2!==this.public.ignore)){t<0?(this.args.direction=-1,this.args.facing="left"):(this.args.direction=1,this.args.facing="right");var r=7*t;this.args.float=3,this.args.mode=0,this.args.float=2,this.args.rolling=!1,this.args.height=this.public.normalHeight,this.public.xSpeed&&Math.sign(this.public.xSpeed)!==Math.sign(t)&&(r=11*t,this.args.float=6,this.args.xSpeed=0),this.args.falling=!0;var n=this.args.xSpeed+r,i=this.scanForward(r,.5);i&&Math.abs(n)>Math.abs(i)&&(r=i*Math.sign(n));var o=this.castRay(n,n>0?0:Math.PI,function(t,r){if(e.getMapSolidAt.apply(e,s(r).concat([e.public.layer])))return t});!1!==o&&(r=o*Math.sign(r)),this.args.xSpeed=n,this.args.ySpeed=0,this.dashTimer=0,this.dashed=!0,this.args.mode=0,this.args.groundAngle=0,this.args.takeoffPlayed=!0,this.takeoffSound&&(this.takeoffSound.currentTime=0,this.takeoffSound.play())}}},{key:"canRoll",get:function(){return!0}},{key:"controllable",get:function(){return!0}}])&&u(e.prototype,r),n&&u(e,n),g}();t.MechaSonic=g}),require.register("actor/MiniMace.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MiniMace=void 0;var i=e("./PointActor"),o=e("curvature/base/Mixin"),a=e("../mixin/Constrainable");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(p,o.Mixin.from(i.PointActor,a.Constrainable));var e,r,n,h=l(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=h.call.apply(h,[this].concat(r))).args.width=32,t.args.height=32,t.args.type="actor-item actor-mini-mace",t}return e=p,(r=[{key:"collideB",value:function(t){t.controllable&&t.damage()}},{key:"update",value:function(){}},{key:"updateEnd",value:function(){this.viewport.auras.has(this)||this.viewport.auras.add(this),c(f(p.prototype),"update",this).call(this),this.args._tiedTo.args.hitPoints?this.setPos():this.noClip=!0,c(f(p.prototype),"updateEnd",this).call(this)}}])&&s(e.prototype,r),n&&s(e,n),p}();t.MiniMace=h}),require.register("actor/Monitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Monitor=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag"),a=(e("../actor/Explosion"),e("../actor/Projectile")),s=(e("../actor/BrokenMonitor"),e("../actor/WoodenCrate")),c=e("../actor/SteelCrate");function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,r){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(d,i.PointActor);var e,r,n,g=h(d);function d(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=g.call.apply(g,[this].concat(r))).args.type="actor-item actor-monitor",t.args.width=30,t.args.height=32,t.args.decel=5,t.args.gone=!1,t}return e=d,(r=[{key:"onRendered",value:function(t){l(p(d.prototype),"onRendered",this).call(this,t),this.screen=new o.Tag('<div class = "monitor-screen">'),this.sprite.appendChild(this.screen.node)}},{key:"update",value:function(){l(p(d.prototype),"update",this).call(this),this.viewport&&this.viewport.args.audio&&!this.sample&&(this.sample=new Audio("/Sonic/object-destroyed.wav"),this.sample.volume=.6+-.3*Math.random())}},{key:"collideA",value:function(t,e){return!(t instanceof s.WoodenCrate||t instanceof c.SteelCrate)&&(l(p(d.prototype),"collideA",this).call(this,t,e),2===e&&this.args.float&&t.controllable?(t.args.ySpeed*=-1,this.args.ySpeed=-4,this.args.float=0,this.ignores.set(t,15),!0):void((2===e||!(t.args.ySpeed>0&&t.y<this.y||t.args.rolling)||this.args.falling&&-1!==this.args.float||this.args.gone||!this.viewport)&&(1!==e&&3!==e||!(t.args.rolling||t instanceof a.Projectile)||this.args.gone||!this.viewport)||this.pop(t)))}},{key:"pop",value:function(t){var e=this,r=this.viewport;if(r&&!this.args.gone){var n=new o.Tag('<div class = "particle-explosion">');t.args.score+=100,n.style({"--x":this.x,"--y":this.y-16}),r.particles.add(n),setTimeout(function(){return r.particles.remove(n)},512),setTimeout(function(){return e.screen&&e.screen.remove()},1024),this.args.gone=!0,this.box.setAttribute("data-animation","broken"),t.occupant&&(t=t.occupant),t.args.owner&&(t=t.args.owner),t.controllable&&this.effect(t),r.args.audio&&this.sample&&this.sample.play();var i=t.args.ySpeed;t.args.falling&&this.onNextFrame(function(){t.args.ySpeed=-i,t.args.falling=!0}),this.args.falling&&t.args.falling&&this.onNextFrame(function(){return t.args.xSpeed=-t.args.xSpeed}),this.onTimeout(1500,function(){e.viewport.actors.remove(e)})}}},{key:"effect",value:function(){}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!1}}])&&u(e.prototype,r),n&&u(e,n),d}();t.Monitor=g}),require.register("actor/NuclearSuperball.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.NuclearSuperball=void 0;var i=e("./PointActor");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.gSpeedMax=150,t.args.accel=2,t.args.jumpForce=20,t.willStick=!0,t.stayStuck=!0,t}return e=u,(r=[{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),u}();t.NuclearSuperball=u}),require.register("actor/Orb.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Orb=void 0;var i=e("./PointActor"),o=e("curvature/base/Mixin");e("../mixin/Pushable");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,o.Mixin.from(i.PointActor));var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-orb",t.args.width=48,t.args.height=48,t.args.rolled=0,t.args.decel=0,t.args.bindTo("x",function(e,r,n,i,o){return t.args.rolled+=Number(e-o||0)}),t.args.gravity=1.35,t}return e=h,(r=[{key:"onAttached",value:function(t){this.autoStyle.get(this.box)["--rolled"]="rolled"}},{key:"update",value:function(){var t=this;if(this.viewport&&this.viewport.controlActor){this.args.falling?this.viewport.onFrameOut(10,function(){t.args.falling&&t.viewport.auras.delete(t)}):this.viewport.auras.add(this);var e=this.viewport.controlActor,r=Math.max(Math.abs(this.args.gSpeed),Math.abs(e.args.gSpeed),14),n=Math.sign(this.args.gSpeed||this.gSpeedLast||e.args.gSpeed),i=this.x-e.x;!this.args.jumping&&this.args.falling||!n||this.args.mode||e.args.mode||this.args.groundAngle||e.args.groundAngle||(i<-64&&(this.args.gSpeed=r*n*.8),i<-128&&(this.args.gSpeed=r*n),i<-176&&(this.args.x-=i+176,this.args.gSpeed=e.args.gSpeed)),s(l(h.prototype),"update",this).call(this)}}},{key:"collideA",value:function(t){t.controllable&&t.loseRings(),t.controllable&&t.die()}},{key:"solid",get:function(){return!1}}])&&a(e.prototype,r),n&&a(e,n),h}();t.Orb=f}),require.register("actor/PogoSpring.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PogoSpring=void 0;var i=e("./Vehicle");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,i.Vehicle);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.type="actor-item actor-pogo-spring",t.args.width=32,t.args.height=32,t.removeTimer=null,t.args.gSpeedMax=20,t.args.decel=.45,t.args.accel=.45,t.args.gravity=1,t.args.seatHeight=32,t.args.skidTraction=.05,t.args.jumpForce=8,t.dustCount=0,t.args.particleScale=2,t.args.started=!1,t}return e=u,(r=[{key:"onAttached",value:function(){}},{key:"update",value:function(){}},{key:"solid",get:function(){return!this.occupant}}])&&o(e.prototype,r),n&&o(e,n),u}();t.PogoSpring=u}),require.register("actor/PointActor.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PointActor=void 0;var n=e("curvature/base/Bindable"),i=e("curvature/base/View"),o=e("curvature/base/Tag"),a=e("../effects/Twist"),s=e("../effects/Droop"),c=e("../effects/Pinch"),u=e("../ui/CharacterString"),l=e("../Classifier"),f=e("../controller/Controller"),h=e("../powerups/Sheild"),p=e("../powerups/FireSheild"),g=e("../powerups/SuperSheild"),d=e("../powerups/BubbleSheild"),y=e("../powerups/ElectricSheild");e("./LayerSwitch"),e("../viewport/Layer");function b(t){"@babel/helpers - typeof";return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t){return function(t){if(Array.isArray(t))return O(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||S(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||S(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=S(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function S(t,e){if(t){if("string"==typeof t)return O(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(t,e):void 0}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function x(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function k(t,e){return(k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function j(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,n=M(t);if(e){var i=M(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return P(this,r)}}function P(t,e){return!e||"object"!==b(e)&&"function"!=typeof e?_(t):e}function _(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function M(t){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function R(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var A=100,T=0,C=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(M,i.View);var e,r,S,O=j(M);function M(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,M);for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];r[n.Bindable.NoGetters]=!0,R(_(t=O.call.apply(O,[this].concat(r))),"template",'<div class  = "point-actor [[type]]">\n\t\t<div class = "sprite" cv-ref = "sprite">\n\t\t\t<div class = "labels" cv-ref = "labels" cv-each = "charStrings:charString:c">[[charString]]</div>\n\t\t</div>\n\t</div>'),R(_(t),"profiles",{normal:{height:1,width:1,decel:.85,accel:.2,gravity:.65,airAccel:.3,jumpForce:14,gSpeedMax:100}}),t[n.Bindable.NoGetters]=!0,t.stepCache={},t.fallTime=0,t.args.score=0,t.args.rings=0,t.args.mercy=!1,t.autoStyle=new Map,t.autoAttr=new Map,t.hanging=new Map,t.ignores=new Map,t.regions=new Set,t.powerups=new Set,t.behaviors=new Set,t.inventory=new l.Classifier([h.Sheild,p.FireSheild,d.BubbleSheild,y.ElectricSheild]),t.noClip=!1,t.sheild=null,t.inventory.addEventListener("adding",function(e){var r=e.detail.object;t.inventory.has(r.constructor)?e.preventDefault():(t.powerups.add(r),r.acquire&&r.acquire(_(t)),t.args.currentSheild=r,r.equip&&r.equip(_(t)))}),t.inventory.addEventListener("removing",function(e){var r=e.detail.object;t.powerups.delete(r),n.Bindable.make(r)===t.args.currentSheild&&(t.args.currentSheild=null)}),t.args.bindTo("currentSheild",function(e,r,n,i,o){o&&o.unequip&&o.unequip(_(t));var a,s=w(t.inventory.get(h.Sheild));try{for(s.s();!(a=s.n()).done;){var c=a.value;c instanceof g.SuperSheild||c.detach()}}catch(t){s.e(t)}finally{s.f()}e&&e.equip&&e.equip(_(t)),e&&e.render(t.sprite)}),Object.defineProperty(_(t),"public",{value:{}}),t.args.bindTo(function(e,r){t.public[r]=e}),t.args.type="actor-generic",t.args.modeTime=0,t.args.charStrings=[],t.args.display=t.args.display||"initial",t.args.emeralds=0,t.args.rings=0,t.args.coins=0,t.ringSet=new Set,t.ringDoc=new DocumentFragment,t.args.yMargin=0,t.args.cameraMode="normal",t.args.cameraBias=0,t.args.layer=1,t.args.moving=!1,t.args.active=!1,t.args.flySpeedMax=40,t.args.x=t.args.x||1280,t.args.y=t.args.y||32,t.args.z=t.args.z||0,t.args.xOff=0,t.args.yOff=0,t.args.width=t.args.width||1,t.args.height=t.args.height||1,t.args.direction=Number(t.args.direction)||1,t.args.gSpeed=t.args.gSpeed||0,t.args.xSpeed=t.args.xSpeed||0,t.args.ySpeed=t.args.ySpeed||0,t.args.angle=t.args.angle||0,t.args.groundAngle=t.args.groundAngle||0,t.args.displayAngle=0,t.args.airAngle=0,t.lastAngles=[],t.angleAvg=8,t.args.xSpeedMax=512,t.args.ySpeedMax=512,t.args.gSpeedMax=A,t.args.rollSpeedMax=34,t.args.gravity=.65,t.args.decel=.85,t.args.accel=.2,t.args.airAccel=.3,t.args.jumpForce=14,t.args.jumping=!1,t.args.jumpedAt=null,t.args.deepJump=!1,t.args.highJump=!1,t.maxStep=6,t.backStep=0,t.frontStep=0,t.args.rolling=!1,t.args.skidTraction=2.25,t.args.skidTraction=5,t.args.fgFilter="none",t.args.bgFilter="none",t.args.falling=!0,t.args.running=!1,t.args.crawling=!1,t.args.climbing=!1,t.args.rotateFixed=!1,t.args.mode=T,t.xAxis=0,t.yAxis=0,t.willStick=!1,t.stayStuck=!1,t.args.startled=t.args.startled||0,t.args.halted=t.args.halted||0,t.args.ignore=t.args.ignore||0,t.args.float=t.args.float||0,t.colliding=!1,t.args.flyAngle=0,t.args.bindTo(["x","y"],function(e,r){isNaN(e)&&console.trace(r,e),t.stepCache={}}),t.args.bindTo("gSpeed",function(e){t.gSpeedLast=e||t.gSpeedLast}),t.args.bindTo("xSpeed",function(e){t.airAngle=Math.atan2(t.args.ySpeed,e),t.xSpeedLast=e||t.xSpeedLast}),t.args.bindTo("ySpeed",function(e){t.airAngle=Math.atan2(e,t.args.xSpeed),t.ySpeedLast=e||t.ySpeedLast}),t.impulseMag=null,t.impulseDir=null,t.args.stopped=0,t.args.particleScale=1,t.dropDashCharge=0;var o=n.Bindable.make(_(t));return t.debindGroundX=null,t.debindGroundY=null,t.debindGroundL=null,t.controllable&&(t.controller=new f.Controller({deadZone:.2}),t.args.charStrings=[new u.CharacterString({value:t.public.name})],t.controller.zero()),t.debindGroundX=new Set,t.debindGroundY=new Set,t.debindGroundL=new Set,t.args.bindTo(["mode","falling"],function(){t.args.modeTime=0}),t.args.bindTo("standingOn",function(e,r,n){if(!t.isGhost&&t.args.standingOn!==e){var i,o=w(t.debindGroundX);try{for(o.s();!(i=o.n()).done;){var a=i.value;t.debindGroundX.delete(a),a()}}catch(t){o.e(t)}finally{o.f()}var s,c=w(t.debindGroundY);try{for(c.s();!(s=c.n()).done;){var u=s.value;t.debindGroundY.delete(u),u()}}catch(t){c.e(t)}finally{c.f()}var l,f=w(t.debindGroundL);try{for(f.s();!(l=f.n()).done;){var h=l.value;t.debindGroundL.delete(h),h()}}catch(t){f.e(t)}finally{f.f()}var p=n[r];if(p&&p.isVehicle&&(p.occupant=null,p.stayStuck=!1,p.willStick=!1,p.xAxis=0,p.yAxis=0,p.args.active=!1),e){if(t.controllable&&e.isVehicle){e.args.active=!0;var g=e.args.bindTo("x",function(r,n){var i=e.args.direction*e.args.seatForward||0,o=e.args.seatHeight||e.args.height||0,a=m(e.rotatePoint(i,o),2),s=a[0],c=a[1];t.args.x=s+r,t.args.y=c+e.y}),d=e.args.bindTo("y",function(r,n){var i=e.args.direction*e.args.seatForward||0,o=e.args.seatHeight||e.args.height||0,a=m(e.rotatePoint(i,o),2),s=a[0],c=a[1];t.args.x=s+e.x,t.args.y=c+r}),y=e.args.bindTo("layer",function(e,r){t.args.layer=e});t.debindGroundX.add(g),t.debindGroundY.add(d),t.debindGroundL.add(y);var b=e.occupant;e.args.yMargin=t.args.height,b&&b!==_(t)&&(b.args.standingOn=null,b.args.y-=32,b.args.gSpeed=0,b.args.xSpeed=-5*t.args.direction,b.args.ySpeed=-8,b.args.falling=!0),t.args.gSpeed=0,t.args.xSpeed=0,t.args.ySpeed=0,t.args.falling=!1,e.occupant=_(t)}else if(!e.isVehicle&&t.y<=t.public.height+e.y-e.args.height){var v=e.args.bindTo("x",function(r,n){t.args.x+=r-e.args.x}),S=e.args.bindTo("y",function(r,n){t.args.y=r-e.args.height}),O=e.args.bindTo("layer",function(e,r){t.args.layer=e});t.debindGroundX.add(v),t.debindGroundY.add(S),t.debindGroundL.add(O)}p&&p.isVehicle&&(p.occupant===_(t)&&(p.occupant=null,p.stayStuck=!1,p.willStick=!1),p.xAxis=0,p.yAxis=0),e.standBelow(_(t))}}}),P(t,o)}return e=M,S=[{key:"fromDef",value:function(t){var e,r={x:t.x+Math.floor(t.width/2),y:t.y-1,visible:t.visible,name:t.name,id:t.id},n=new Map;for(var i in r)"object"!==b(r[i])&&n.set(i,r[i]);for(var o in t.properties){var a=t.properties[o];r[a.name]=a.value,n.set(a.name,a.value)}var s=new this(Object.assign({},r));return s.def=n,s.args.float=null!==(e=s.float)&&void 0!==e?e:s.args.float,s}}],(r=[{key:"onRendered",value:function(){var t=this;if(!this.init){var e=this.viewport.objectPalette.ring;this.controllable&&this.args.bindTo("rings",function(r){r&&window.requestIdleCallback(function(){if(t.ringSet.size<r){var n=new e;n.viewport=t.viewport,n.render(t.ringDoc),t.ringSet.add(n)}})});var r=this.viewport.objectPalette["base-region"];if(this.isRegion=this instanceof r,this.box=this.findTag("div"),this.autoStyle.set(this.box,{display:"display","--animation-bias":"animationBias","--bg-filter":"bgFilter","--sprite-sheet":"spriteSheetUrl","--sprite-x":"spriteX","--sprite-y":"spriteY","--angle":"angle","--palletShift":"palletShift","--fly-angle":"flyAngle","--display-angle":"groundAngle","--ground-angle":"groundAngle","--air-angle":"airAngle","--height":"height","--width":"width","--x":"x","--y":"y","--z":"z"}),this.autoAttr.set(this.box,{"data-camera-mode":"cameraMode","data-colliding":"colliding","data-respawning":"respawning","data-mercy":"mercy","data-falling":"falling","data-facing":"facing","data-filter":"filter","data-angle":"angleDeg","data-active":"active","data-layer":"layer","data-mode":"mode","data-id":"id"}),this.args.bindTo("spriteSheet",function(e){return t.args.spriteSheetUrl=t.urlWrap(e)}),this.args.bindTo("angle",function(e){return t.args.angleDeg=t.rad2deg(e)}),this.sprite=this.findTag("div.sprite"),this.controllable){var i=new g.SuperSheild;i.equip(this),this.inventory.add(i)}this.init=!0,this.args.bindTo("animation",function(e){return t.box.setAttribute("data-animation",e)}),this.bindTo("isSuper",function(e){return t.box.setAttribute("data-super",e)}),this.bindTo("isHyper",function(e){return t.box.setAttribute("data-hyper",e)}),this.controllable&&this.sprite.parentNode.classList.add("controllable"),this.listen("click",function(){var e=Date.now();if(e-M.lastClick<1e3){t.viewport.auras.add(t);var r=t.viewport.onFrameInterval(1,function(){var e=t.viewport.serializePlayer();t.viewport.onFrameOut(5,function(){e.input&&(t.controller&&t.controller.replay(e.input),t.readInput()),e.args&&(Object.assign(t.args,e.args),t.viewport.setColCell(t))})});t.onRemove(r)}else if(M.lastClick=e,!t.viewport.args.networked&&t.controllable&&(t.viewport.nextControl=n.Bindable.ref(t),t.viewport.tags.currentActor)){var i,o=w(t.viewport.tags.currentActor.options);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.value===t.args.name&&(t.viewport.tags.currentActor.value=a.value)}}catch(t){o.e(t)}finally{o.f()}}})}}},{key:"updateStart",value:function(){this.args.localCameraMode=null,this.args.standingLayer&&(this.args.standingLayer.offsetXChanged&&(this.args.x+=this.args.standingLayer.offsetXChanged),this.args.standingLayer.offsetYChanged&&(this.args.y+=this.args.standingLayer.offsetYChanged))}},{key:"updateEnd",value:function(){this.args.falling&&(this.args.standingLayer&&(this.args.xSpeed+=this.args.standingLayer.offsetXChanged,this.args.ySpeed+=this.args.standingLayer.offsetYChanged),this.args.standingLayer=null);var t,e=w(this.autoStyle);try{for(e.s();!(t=e.n()).done;){for(var r=m(t.value,2),n=r[0],i=r[1],o={},a=0,s=Object.entries(i);a<s.length;a++){var c=m(s[a],2),u=c[0],l=c[1];l in this.public&&(o[u]=this.public[l])}n.style(o)}}catch(t){e.e(t)}finally{e.f()}var f,h=w(this.autoAttr);try{for(h.s();!(f=h.n()).done;){for(var p=m(f.value,2),g=p[0],d=p[1],y={},b=0,v=Object.entries(d);b<v.length;b++){var S=m(v[b],2),O=S[0],x=S[1];x in this.public&&(y[O]=this.public[x])}g.attr(y)}}catch(t){h.e(t)}finally{h.f()}}},{key:"update",value:function(){var t=this;if(this.args.respawning){var e,r,n=this.viewport.getCheckpoint(this.args.id);if(n&&n.checkpointId){var i=this.viewport.actorsById[n.checkpointId];e=i.x,r=i.y}else e=this.def.get("x"),r=this.def.get("y");var o=this.args.x-e,a=this.args.y-r;if(this.args.x-=o/20||1,this.args.y-=a/20||1,Math.abs(o)<1||Math.abs(a)<1){this.args.dead=!1,this.noClip=!1,this.args.respawning=!1,this.args.display="initial",this.args.x=e,this.args.y=r,this.args.ignore=4;var s=this.viewport;console.clear(),s.reset(),s.startLevel()}this.viewport&&this.viewport.setColCell(this)}else if(this.viewport&&this.viewport.meta.deathLine&&!this.args.dead&&this.controllable&&this.y>this.viewport.meta.deathLine)this.die();else{if(this.args.controllable){var c=Math.max(this.public.height,32),u=this.rotatePoint(0,.75*c),l=this.getMapSolidAt(this.x+u[0],this.y+u[1]);if(Array.isArray(l)&&(l=!!l.filter(function(t){return!t.args.platform&&!t.isVehicle}).length),!this.args.falling&&l)return void this.die()}var f,h=w(this.ignores);try{for(h.s();!(f=h.n()).done;){var p=m(f.value,2),g=p[0],d=p[1];d<=0?this.ignores.delete(g):this.ignores.set(g,-1+d)}}catch(t){h.e(t)}finally{h.f()}if(this.args.skimming=!1,this.args.airAngle=this.airAngle,this.args.falling){if(this.args.displayAngle!==this.args.groundAngle){var y=this.args.groundAngle+-this.args.displayAngle;this.args.displayAngle+=Math.sign(y)*(Math.abs(y)>1?1:Math.abs(y))*.5}}else this.args.displayAngle=this.args.groundAngle;if(this.public.halted<1&&this.public.halted>0&&(this.args.halted=0),this.public.halted>0)this.args.halted--;else if(this.args.currentSheild&&"update"in this.args.currentSheild&&this.args.currentSheild.update(this),this.public.rolling&&(this.args.height=this.public.rollingHeight||this.args.height),this.args.dontJump>0&&this.args.dontJump--,this.args.dontJump<0&&(this.args.dontJump=0),this.viewport&&!this.removed){if(this.args.modeTime++,this.args.standingOn&&this.args.standingOn.isVehicle&&!this.isVehicle){var S=this.args.standingOn;return this.args.falling=!0,this.args.flying=!1,this.args.jumping=!1,this.processInput(),this.args.cameraMode=S.args.cameraMode,this.willJump&&this.yAxis<0&&(this.args.standingOn=!1,this.willJump=!1,this.args.falling=!0,this.args.jumping=!0,this.args.y-=S.public.seatHeight||S.public.height,this.args.xSpeed=2*S.public.direction,this.args.ySpeed=-this.public.jumpForce,S.args.ySpeed=0),this.args.groundAngle=S.args.groundAngle||0,void(this.willJump&&this.yAxis>=0&&(this.args.standingOn.falling=!1,this.willJump=!1,this.args.standingOn.command_0()))}if(null!==this.impulseMag){if(this.args.xSpeed+=Number(Number(Math.cos(this.impulseDir)*this.impulseMag).toFixed(2)),this.args.ySpeed+=Number(Number(Math.sin(this.impulseDir)*this.impulseMag).toFixed(2)),this.impulseFal)this.args.falling=this.impulseFal;else switch(this.public.mode){case 0:this.args.gSpeed=Math.cos(this.impulseDir)*this.impulseMag;break;case 2:this.args.gSpeed=-Math.cos(this.impulseDir)*this.impulseMag;break;case 1:this.args.gSpeed=-Math.sin(this.impulseDir)*this.impulseMag;break;case 3:this.args.gSpeed=Math.sin(this.impulseDir)*this.impulseMag}this.impulseMag=null,this.impulseDir=null,this.impulseFal=null}-2===this.public.ignore&&!1===this.public.falling&&(this.args.ignore=0),-3===this.public.ignore&&(!this.public.falling||this.public.ySpeed>=0)&&(this.args.ignore=0),this.public.ignore<1&&this.public.ignore>0&&(this.args.ignore=0),this.public.ignore>0&&this.args.ignore--,this.args.startled>0&&this.args.startled--,this.public.float>0&&this.args.float--,this.public.standingOn instanceof M&&this.public.standingOn.callCollideHandler(this),!this.public.float&&this.public.falling?this.args.standingOn&&this.args.standingOn.isVehicle||(this.args.standingOn=null,this.args.landed=!1,this.lastAngles=[],this.public.jumping&&this.public.jumpedAt<this.y?this.args.deepJump=!0:this.public.jumping&&this.public.jumpedAt>this.y+160?this.args.highJump=!0:this.public.jumping&&(this.args.deepJump=!1)):this.public.jumping&&!this.public.falling&&(this.args.jumping=!1,this.args.deepJump=!1,this.args.highJump=!1,this.args.jumpedAt=null);var O,x=this.getLocalDrag(),k=this.viewport.regionsAtPoint(this.x,this.y),j=w(this.regions);try{for(j.s();!(O=j.n()).done;){O.value.updateActor(this)}}catch(t){j.e(t)}finally{j.f()}this.public.gSpeedMax;if(!this.isRegion){var P,_=w(this.regions);try{for(_.s();!(P=_.n()).done;){var R=P.value;k.has(R)||(this.regions.delete(R),this.crossRegionBoundary(R,!1))}}catch(t){_.e(t)}finally{_.f()}var A,T=w(k);try{for(T.s();!(A=T.n()).done;){var C=A.value;if(this.public.density&&C.public.density&&this.public.density<C.public.density){C.public.density,this.public.density;var E=this.y-this.public.height,B=C.y-C.public.height,D=Math.min((E-B)/this.public.height,1);this.args.float=1;var I=D*x;this.args.falling=!0,D>-1?(this.args.ySpeed-=I,this.args.ySpeed*=x):D<-1&&this.args.ySpeed<0&&Math.abs(D)<.25&&Math.abs(this.args.ySpeed)<1&&(this.args.ySpeed=0,this.args.y=-1+B+this.args.height)}this.regions.has(C)||(this.regions.add(C),this.crossRegionBoundary(C,!0))}}catch(t){T.e(t)}finally{T.f()}}if(!this.willJump||this.public.dontJump||this.public.falling&&!(this.falltime<2)){this.willJump=!1,this.noClip||this.args.gSpeed||this.args.xSpeed||this.args.ySpeed||this.args.float||(this.args.falling=!this.checkBelow(this.x,this.y)),this.noClip?(this.public.xSpeed&&(this.args.x+=this.public.xSpeed),this.public.ySpeed&&(this.args.y+=this.public.ySpeed)):this.public.static||this.isRegion||this.isEffect||!this.public.falling||!this.viewport?!this.args.standingLayer&&(this.public.static||this.isRegion||this.isEffect||this.public.falling)||(this.updateGroundPosition(),this.args.animationBias=Math.abs(this.args.gSpeed/this.args.gSpeedMax).toFixed(1),this.args.animationBias>1&&(this.args.animationBias=1)):(this.args.grinding&&(this.args.grinding=!1),this.updateAirPosition(),this.args.animationBias=Math.abs(this.args.airSpeed/this.args.flySpeedMax).toFixed(1),this.args.animationBias>1&&(this.args.animationBias=1));var F=Math.ceil(this.args.width/2),L=Math.floor(this.args.height/2);if(!this.noClip&&!this.isRegion&&this.public.pushed){var N,q=function(e){switch(t.public.mode){case 0:N=t.getMapSolidAt(t.x+F*e+(-1===e?0:-1),t.y-L);break;case 2:N=t.getMapSolidAt(t.x+F*e+(-1===e?0:-1),t.y+L);break;case 1:N=t.getMapSolidAt(t.x+L*(-1===e?0:2),t.y);break;case 3:N=t.getMapSolidAt(t.x-L*(-1===e?0:2),t.y)}return N&&Array.isArray(N)?N.filter(function(t){return!t.isVehicle}):N},W=q(-1),V=q(1);V&&!W&&(this.public.xSpeed>0&&(this.args.xSpeed=0),this.args.x--),W&&!V&&(this.public.xSpeed>0&&(this.args.xSpeed=0),this.args.x++)}if(this.viewport&&!this.removed){this.viewport.objectPalette["layer-switch"];var G=[this.viewport.objectPalette["base-region"]];if(!this.isGhost&&!G.some(function(e){return t instanceof e}))this.viewport.actorsAtPoint(this.x,this.y,this.public.width,this.public.height).filter(function(e){return e.args!==t.args}).filter(function(t){return!t.isPushable}).filter(function(e){return e.callCollideHandler(t)});if(this.viewport){var z=this.viewport.tileMap;if(Math.abs(this.args.gSpeed)<=1&&!this.args.falling&&!this.stayStuck&&!this.args.climbing){Math.floor(this.args.width/2);if(!z.getSolid(this.x,this.y+1,this.args.layer)){var U=this.args.mode;if(this.lastAngles=[],1===U&&this.args.groundAngle<=.1)this.args.xSpeed=1,this.args.mode=0,this.args.falling=!0,this.args.groundAngle=-Math.PI/2,this.args.x++,this.args.gSpeed<=0&&(this.args.gSpeed=0),this.args.gSpeed++,this.args.ignore=15;else if(3===U&&this.args.groundAngle>=-.1)this.args.xSpeed=-1,this.args.mode=0,this.args.falling=!0,this.args.groundAngle=Math.PI/2,this.args.x--,this.args.gSpeed>=0&&(this.args.gSpeed=0),this.args.gSpeed--,this.args.ignore=15;else if(2===U){this.args.y++,this.args.ignore=8,this.args.falling=!0,this.willJump=!1;var H=this.args.gSpeed;this.onNextFrame(function(){t.willJump=!1,t.args.groundAngle=Math.PI,t.args.xSpeed=-H,t.args.mode=0}),-1==this.public.direction?(this.args.facing="left",this.args.x++):(this.args.facing="right",this.args.x--)}}}if(this.args.landed=!0,this.controllable&&(this.args.x=this.public.x,this.args.y=this.public.y),!(this.noClip||this.public.falling||this.isRegion||0!==this.public.mode||this.public.gSpeed||this.public.xSpeed))for(;this.getMapSolidAt(this.x,this.y-1,!1);)this.args.ySpeed=0,this.args.y--;this.public.falling&&(this.args.gSpeed=0),this.controllable&&this.processInput(),this.public.falling||this.public.gSpeed?this.args.stopped=0:this.args.stopped++,this.lastAngles.length>0&&(this.args.groundAngle=this.lastAngles.map(function(t){return Number(t)}).reduce(function(t,e){return t+e})/this.lastAngles.length),isNaN(this.public.groundAngle)&&console.log(this.lastAngles,this.lastAngles.length);var J=this.viewport.regionsAtPoint(this.groundPoint[0],this.groundPoint[1]+1),K=this.getMapSolidAt.apply(this,v(this.groundPoint));if(Array.isArray(K)&&K.length){var Y=K.filter(function(e){return e.args!==t.args&&e.solid});if(Y.length){var X,$=w(Y);try{for($.s();!(X=$.n()).done;){var Z=X.value;!Z.isVehicle&&this.y>1+Z.y+-Z.args.height||(this.args.groundAngle=Z.groundAngle||0,this.args.standingOn=Z)}}catch(t){$.e(t)}finally{$.f()}}}else if(K)this.args.standingOn=null,"object"===b(K)?this.args.standingLayer=K:this.args.standingLayer=null;else if(0===this.public.mode&&J.size){var Q,tt=!K,et=w(J);try{for(et.s();!(Q=et.n()).done;){var rt=Q.value;if(Math.floor(this.y+1)===rt.y-rt.public.height&&Math.max(Math.abs(this.args.gSpeed),Math.abs(this.args.xSpeed))>=rt.skimSpeed&&!this.args.falling){this.args.gSpeed=Math.max(Math.abs(this.args.gSpeed),Math.abs(this.args.xSpeed))*Math.sign(this.args.gSpeed),this.args.skimming=!0,tt=!1,rt.skim(this);break}}}catch(t){et.e(t)}finally{et.f()}this.args.standingOn=null,this.args.falling=tt,tt&&(this.args.xSpeed=this.args.gSpeed||this.args.xSpeed)}else this.args.standingOn=null;if(this.args.falling&&this.args.ySpeed<this.args.ySpeedMax){if(!this.args.float){var nt,it=1,ot=w(this.regions);try{for(ot.s();!(nt=ot.n()).done;){var at=nt.value;(at.public.gravity||1===at.public.gravity)&&(it*=at.public.gravity)}}catch(t){ot.e(t)}finally{ot.f()}this.args.ySpeed+=this.public.gravity*it}this.args.landed=!1}this.args.falling||this.checkDropDash();var st,ct=w(this.behaviors);try{for(ct.s();!(st=ct.n()).done;){st.value.update(this)}}catch(t){ct.e(t)}finally{ct.f()}this.twister&&(this.twister.args.x=this.public.x,this.twister.args.y=this.public.y,this.twister.args.xOff=this.public.xOff,this.twister.args.yOff=this.public.yOff,this.twister.args.width=this.public.width,this.twister.args.height=this.public.height),this.pincherBg&&(this.pincherBg.args.x=this.public.x,this.pincherBg.args.y=this.public.y,this.pincherBg.args.xOff=this.public.xOff,this.pincherBg.args.yOff=this.public.yOff,this.pincherBg.args.width=this.public.width,this.pincherBg.args.height=this.public.height),this.pincherFg&&(this.pincherFg.args.x=this.public.x,this.pincherFg.args.y=this.public.y,this.pincherFg.args.xOff=this.public.xOff,this.pincherFg.args.yOff=this.public.yOff,this.pincherFg.args.width=this.public.width,this.pincherFg.args.height=this.public.height),this.public.falling&&(this.args.rolling=!1,this.fallTime++)}}}else{this.willJump=!1;this.viewport.tileMap;var ut=Math.max(this.public.height,32),lt=this.rotatePoint(0,ut+1),ft=this.getMapSolidAt(this.x+lt[0],this.y+lt[1]);if(Array.isArray(ft)&&(ft=!!ft.filter(function(t){return!t.args.platform&&!t.isVehicle}).length),!ft){var ht=this.args.jumpForce*x;this.running?ht*=1.5:this.crawling&&(ht*=.5),this.doJump(ht)}}}}}},{key:"popOut",value:function(t){var e=this.args.width/2,r=t.args.width/2,n=this.y-this.args.height+1,i=this.y,o=this.x-t.x,a=e+r;this.solid&&Math.abs(o)<Math.abs(a)&&i>t.y&&t.y>n&&(t.args.x=this.x+a*-Math.sign(o))}},{key:"getLocalDrag",value:function(){var t,e=1,r=w(this.regions);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.skimmers.has(this)||i.skimmers.has(n.Bindable.make(this))||(i.public.drag||0===i.public.drag)&&i.public.drag<e&&(e=i.public.drag)}}catch(t){r.e(t)}finally{r.f()}return e}},{key:"updateGroundPosition",value:function(){var t=this,e=this.getLocalDrag();this.args.gSpeedMax;this.running||this.crawling;var r=[0,0],n=Math.ceil(this.args.width/2),i=this.paused;if(this.public.gSpeed){Math.abs(this.args.gSpeed);var o=Math.sign(this.args.gSpeed),a=Math.abs(this.args.gSpeed);this.pause(!0);this.scanForward(this.args.gSpeed,.5);for(var s=0;s<a;s+=1){if(!this.args.rolling){var c=this.rotatePoint(n*-o,this.args.height),u=this.getMapSolidAt(this.x+c[0],this.y+c[1]);if(Array.isArray(u)&&(u=u.filter(function(e){return e.args!==t.args}).filter(function(e){return e.callCollideHandler(t)}).filter(function(t){return t.solid}).length),u){2===this.args.mode&&(this.args.x+=n*Math.sign(this.args.gSpeed),this.args.y+=this.args.height,this.args.mode=0),this.args.gSpeed=0;break}}var l=this.rotatePoint(n*-o,.5*this.args.height),f=this.getMapSolidAt(this.x+l[0],this.y+l[1]);if(Array.isArray(f)&&(f=f.filter(function(e){return e.args!==t.args}).filter(function(e){return e.callCollideHandler(t)}).filter(function(t){return t.solid}).length),f){2===this.args.mode&&(this.args.x+=n*Math.sign(this.args.gSpeed),this.args.y+=this.args.rollingeight||this.args.height,this.args.mode=0),this.args.gSpeed=0;break}if(!(r=this.findNextStep(1*o)))break;if(r[3]){this.args.moving=!1,this.args.gSpeed=0,1!==this.public.mode&&3!==this.public.mode||(this.args.mode=0,this.lastAngles=[]);break}if(!0===r[2]){if("break"===function(){var e=t.public.gSpeed,r=t.public.groundAngle;switch(t.public.mode){case 0:t.args.x+=e,t.args.xSpeed=e*Math.cos(r),t.args.ySpeed=-e*Math.sin(r),t.args.float=t.args.float<0?t.args.float:1;var i=!!t.public.gSpeed;t.args.falling=i;break;case 2:t.args.float=t.args.float<0?t.args.float:1,t.args.falling=!0,t.args.y+=2,t.onNextFrame(function(){t.args.xSpeed=-e*Math.cos(r),t.args.ySpeed=e*Math.sin(r),t.args.mode=0,t.args.groundAngle=0,t.args.displayAngle=Math.PI});break;case 1:t.args.climbing||(Math.abs(t.public.gSpeed)<8&&!t.args.rolling?t.public.gSpeed<0?(t.args.x-=t.public.direction,t.args.y-=t.public.gSpeed+2,t.args.groundAngle=0):(t.args.x+=n,t.args.y++):(t.args.ignore=-3,t.args.x+=n,t.xAxis=0),t.args.xSpeed=e*Math.sin(r),t.args.ySpeed=e*Math.cos(r),t.onNextFrame(function(){t.args.groundAngle=.5*-Math.PI,t.args.mode=0})),t.args.falling=!0;break;case 3:t.args.climbing||(Math.abs(t.args.gSpeed)<8&&!t.args.rolling?t.public.gSpeed>0?(t.args.x-=t.public.direction,t.args.y-=t.public.gSpeed+2,t.args.groundAngle=0):(t.args.x-=n,t.args.y++):(t.args.ignore=-3,t.args.x-=n,t.xAxis=0),t.args.xSpeed=-e*Math.sin(r),t.args.ySpeed=-e*Math.cos(r),t.onNextFrame(function(){t.args.groundAngle=.5*Math.PI,t.args.mode=0})),t.args.falling=!0}return"break"}())break}else if(r[0]||r[1])!r[0]&&!r[1]||this.rotateLock||(this.args.moving=!0,this.args.angle=r[0]?Math.atan(r[1]/r[0]):Math.sign(r[1])*Math.PI/2,this.lastAngles.unshift(this.public.angle),this.lastAngles.splice(this.angleAvg));else switch(this.args.moving=!1,this.public.mode){case 0:case 2:this.args.gSpeed=0}if(!this.rotateLock){switch(this.public.mode){case 0:this.args.x+=r[0],this.args.y-=r[1];break;case 2:this.args.x-=r[0],this.args.y+=r[1];break;case 1:this.args.x+=r[1],this.args.y+=r[0];break;case 3:this.args.x-=r[1],this.args.y-=r[0]}if(this.public.angle>Math.PI/4&&this.public.angle<Math.PI/2){switch(this.lastAngles=this.lastAngles.map(function(t){return t-Math.PI/2}),this.args.mode){case 0:this.args.mode=3;break;case 3:this.args.mode=2;break;case 2:this.args.mode=1;break;case 1:this.args.mode=0}this.args.groundAngle-=Math.PI/2}else if(this.public.angle<-Math.PI/4&&this.public.angle>-Math.PI/2){this.args.mode;switch(this.lastAngles=this.lastAngles.map(function(t){return Number(t)+Math.PI/2}),this.args.mode){case 0:this.args.mode=1;break;case 3:this.args.mode=0;break;case 2:this.args.mode=3;break;case 1:this.args.mode=2}this.args.groundAngle=Number(this.args.groundAngle)+Math.PI/2}}}i||this.pause(!1),!this.xAxis&&this.public.gSpeed&&(!this.public.grinding&&this.public.rolling?this.args.gSpeed-=1*this.public.decel/e*.06125*Math.sign(this.public.gSpeed):this.public.grinding||(this.args.gSpeed-=1*this.public.decel/e*Math.sign(this.public.gSpeed))),!this.xAxis&&Math.abs(this.public.gSpeed)<1*this.public.decel/e&&(this.args.gSpeed=0);var h=0;if(!this.args.climbing){switch(this.args.mode){case 0:h=this.public.groundAngle/(Math.PI/2),o>0&&(h*=-1);break;case 2:h=0;break;case 3:o>0?(h=-1,h-=this.public.groundAngle/(Math.PI/4)):(h=1,h+=this.public.groundAngle/(Math.PI/4));break;case 1:o>0?(h=1,h-=this.public.groundAngle/(Math.PI/4)):(h=-1,h+=this.public.groundAngle/(Math.PI/4))}if(this.public.rolling&&(h<0?this.args.gSpeed*=1-(0-h/2*.005):h>0&&Math.abs(this.public.gSpeed)<this.public.rollSpeedMax&&(this.args.gSpeed*=1.0075*(1+h/2*.055))),this.public.grinding){var p=Math.abs(this.public.gSpeed),g=this.args.direction||this.xSpeedLast||1;this.args.direction=g,Math.sign(this.args.gSpeed)!==Math.sign(this.args.direction)&&(this.args.gSpeed=0),p<6?this.args.gSpeed=6*g:p>40?this.args.gSpeed=40*g:h<0?this.args.gSpeed*=1-(0-h/2*.015):h>0?this.args.gSpeed*=1.0015*(1+h/2*.045):this.args.gSpeed+=.1*g}else if(!this.stayStuck){var d=1;h<0&&Math.abs(this.public.gSpeed)<10?d=.9999*(1-Math.pow(h,2)/4/2):h>1&&Math.abs(this.public.gSpeed)<this.public.gSpeedMax/2&&(d=1.05*(1+Math.pow(h,2)/4/2)),this.args.gSpeed*=d,Math.abs(this.public.gSpeed)<1&&h<=-1&&(this.args.gSpeed*=-.5,this.args.ignore=this.args.ignore||8,this.xAxis=0)}}}(!r||!1===r[0]&&!1===r[1])&&(this.args.ignore=this.public.ignore||1,this.args.falling&&(this.args.gSpeed=0))}},{key:"findAirPointA",value:function(t,e,r){if(r.viewport){var n=r.viewport,i=n.tileMap;return n.actorsAtPoint(e[0],e[1]).filter(function(t){return t.args!==r.args}).filter(function(t){return t.callCollideHandler(r)}).filter(function(t){return t.solid}).length>0?r.lastPointA:i.getSolid(e[0],e[1],r.args.layer)?r.lastPointA:void(r.lastPointA=e.map(Math.floor))}}},{key:"findAirPointB",value:function(t,e,r){if(r.viewport){var n=r.viewport,i=n.tileMap;return n.actorsAtPoint(e[0],e[1]).filter(function(t){return t.args!==r.args}).filter(function(t){return t.callCollideHandler(r)}).filter(function(t){return t.solid}).length>0?r.lastPointB:i.getSolid(e[0],e[1],r.args.layer)?r.lastPointB:void(r.lastPointB=e.map(Math.floor))}}},{key:"updateAirPosition",value:function(){var t=this,e=this.public.xSpeed,r=this.public.ySpeed,n=(this.viewport,Math.ceil(this.public.width/2)),i=Math.sign(this.public.xSpeed),o=(this.x,this.y,this.x,this.y,this.viewport.tileMap),a=Math.pow(this.public.xSpeed,2)+Math.pow(this.public.ySpeed,2),s=a?Math.sqrt(a):0;if(s){if(this.lastAngles.length&&this.lastAngles.splice(0),(this.controllable||this.isVehicle)&&(this.args.groundAngle+=.001*-Math.sign(this.args.groundAngle)*(this.xAxis?25:10)),Math.abs(this.args.groundAngle)<.01&&(this.args.groundAngle=0),this.noClip)return this.args.x+=this.args.xSpeed,void(this.args.y+=this.args.ySpeed);var c=(this.public.flying?this.public.height+this.public.yMargin:this.public.height)||1,u=this.castRay(Math.max(Math.abs(this.public.ySpeed),c)+1,-Math.PI/2,this.findSolid),l=(this.castRay(Math.abs(this.public.ySpeed)+1,Math.PI/2,this.findSolid),[]);if(!this.args.hLock){var f=Math.sign(this.xSpeedLast,this.args.xSpeed)*Math.max(Math.abs(this.xSpeedLast),Math.abs(this.args.xSpeed)),h=!!f&&this.scanForward(f,.9),p=!!f&&this.scanForward(f,.5),g=!!f&&this.scanForward(f,.1),d=[h,p];this.controllable&&d.push(g),l=d.filter(function(t){return!1!==t})}if(this.public.ySpeed<0&&u>0){if(this.args.ignore=1,this.args.y+=c-u,this.args.ySpeed=r=0,j=this.getMapSolidAt(this.x,this.y),Array.isArray(j)&&!this.public.flying){var y=j.filter(function(t){return t.canStick});this.willStick&&2!==this.willStick&&y.length&&(this.args.gSpeed=Math.floor(-e),this.args.mode=2,this.args.falling=!1)}else if(this.willStick&&2!==this.willStick&&!this.public.flying){var b=this.getMapSolidAt(this.x,this.y-1),m=Array.isArray(b)&&b.filter(function(t){return t.canStick});(!b.length||b.length&&m.length)&&(this.args.gSpeed=Math.floor(-e),this.args.mode=2,this.args.falling=!1)}}else{if(!this.willStick&&l.length){var w=Math.sign(this.xSpeedLast),S=(n+-Math.min.apply(Math,v(l)))*-w;isNaN(S)||(this.args.x+=S),this.args.flySpeed=0,this.args.xSpeed=0,this.args.gSpeed=0,e=0}var O=s+1,x=this.castRay(O,this.public.airAngle,this.findAirPointA),k=this.castRay(O,this.public.airAngle,[0,-3],this.findAirPointB);this.willJump=!1;var j=!1,P=!1;if([x,k].some(function(t){return!1===t})||(P=Math.atan2(x[1]-k[1],x[0]-k[0])),!1!==x&&!1!==k){var _=!1;e<0&&(_=P<=Math.PI/2),e>0&&(_=P>=Math.PI/2);var R=_&&e<0,A=_&&e>0;this.willStick||(this.args.gSpeed=e||this.args.gSpeed),this.args.xSpeed=0,this.args.ySpeed=0;var T=x[0],C=x[1];if(this.args.flying&&!_&&P&&(this.args.mode=2,this.args.xSpeed*=-1),this.args.x=T,this.args.y=C,j=this.getMapSolidAt(this.x+i,this.y),Array.isArray(j)&&((j=j.filter(function(e){return e.callCollideHandler(t)})).length||(j=!1)),this.willStick)if(this.getMapSolidAt(this.x-i,this.y)||this.getMapSolidAt(this.x-i,this.y+1)||this.getMapSolidAt(this.x-i,this.y-this.public.height))this.args.ySpeed=0,this.args.xSpeed=0;else{var E=!0;Array.isArray(j)&&(E=j.filter(function(t){return t.canStick}).length),E&&R?(this.args.gSpeed=0,this.args.mode=1):E&&A?(this.args.gSpeed=0,this.args.mode=3):E&&(this.args.mode=0)}Math.floor(this.public.width/2);var B=this.findNextStep(-2),D=this.findNextStep(2);if(D&&B){var I=Number(Math.atan2(D[1]-B[1],4).toFixed(1));if(isNaN(I))throw console.log(I),new Error("angle is NAN!");if(!D[2]&&!B[2]||D[2]&&!B[3]||!D[3]&&B[2]){this.args.groundAngle=I,(D[2]||D[3]||B[2]||B[3])&&(this.args.angle=this.args.groundAngle=I);var F=(0===this.public.mode?-1:1)*Math.sign(this.args.groundAngle),L=0;Math.abs(F)>0?L+=r*F:Math.abs(F)<0&&(L+=r/-F),e&&(L+=e),j.length&&(L=0),L&&(this.args.gSpeed=L),this.args.falling=!1}Math.abs(this.args.gSpeed)<1&&(this.args.gSpeed=0)}}else if(this.args.ySpeed>0){if(1===this.args.mode||3===this.args.mode){var N=1===this.args.mode?-1:1;this.args.direction=N,this.args.groundAngle=Math.PI/2*N}this.args.mode=0,e&&(this.args.gSpeed=Math.floor(e)),x&&!1!==P&&(isNaN(P)||P<Math.PI/2)&&(this.args.x=Number(x[0]),this.args.y=Number(x[1]))}if(o.getSolid(this.x+this.public.width/2*Math.sign(this.args.xSpeed),this.y,this.public.layer)||(Math.abs(this.public.xSpeed)>this.public.xSpeedMax&&(this.args.xSpeed=this.public.xSpeedMax*Math.sign(this.public.xSpeed)),Math.abs(this.public.ySpeed)>this.public.ySpeedMax&&(this.args.ySpeed=this.public.ySpeedMax*Math.sign(this.public.ySpeed))),!1===x&&(this.args.xSpeed&&(this.args.x+=this.args.xSpeed),this.args.ySpeed&&(this.args.y+=this.args.ySpeed)),this.args.standingOn instanceof M){var q=this.args.standingOn.y-this.args.standingOn.args.height;(this.y<q||this.args.ySpeed<0)&&(this.args.standingOn=null)}}}}},{key:"checkDropDash",value:function(){var t=this;if(this.dropDashCharge&&0===this.args.mode){var e=this.dropDashCharge*Math.sign(this.public.xSpeed||this.public.direction);this.dropDashCharge=0,this.onNextFrame(function(){t.args.gSpeed+=e,!t.args.ignore&&t.yAxis>=0&&(t.args.rolling=!0)});var r=this.viewport,n=new o.Tag('<div class = "particle-dust">'),i=this.rotatePoint(this.args.gSpeed,0);n.style({"--x":i[0]+this.x,"--y":i[1]+this.y,"z-index":0,opacity:2*Math.random()}),r.particles.add(n),setTimeout(function(){r.particles.remove(n)},350)}}},{key:"setCameraMode",value:function(){var t=this;if(this.viewport)if(this.args.bossMode)this.args.cameraMode="boss";else if(this.args.standingOn&&this.args.standingOn.isVehicle)this.args.cameraMode=this.args.standingOn.public.cameraMode;else if(this.args.localCameraMode)this.args.cameraMode=this.args.localCameraMode;else if(this.controllable)if(!this.public.falling||this.getMapSolidAt(this.x,this.y+24)){var e=this.getMapSolidAt(this.x+32*this.public.direction,this.y+24),r=this.getMapSolidAt(this.x+32*this.public.direction,this.y+96),n=this.getMapSolidAt(this.x+0*this.public.direction,this.y+48);0===this.public.mode&&0===this.public.groundAngle?n||!e||this.args.grinding||this.args.skimming?r||this.args.grinding||this.args.skimming?this.args.cameraMode="normal":this.args.cameraMode="cliff":this.args.cameraMode="bridge":this.args.cameraMode="normal"}else this.getMapSolidAt(this.x+0*this.public.direction,this.y+64)?this.args.cameraMode="normal":this.args.cameraMode="aerial",this.viewport.onFrameOut(45,function(){"airplane"!==t.args.cameraMode&&t.public.falling&&Math.abs(t.public.xSpeed>25)&&!t.getMapSolidAt(t.x,t.y+480)&&(t.args.cameraMode="airplane")})}},{key:"callCollideHandler",value:function(t){if(this.ignores.has(t))return!1;if(t.ignores.has(this))return!1;if(!this.args.dead&&!t.args.dead){if(t===this.args.hangingFrom)return!1;var e;if(!this.isGhost&&!t.isGhost)if(t.y<=this.y-this.args.height?(this.args.collType="collision-top",e=0):t.x<this.x-Math.floor(this.args.width/2)?(this.args.collType="collision-left",e=1):t.x>=this.x+Math.floor(this.args.width/2)?(this.args.collType="collision-right",e=3):t.y>=this.y?(this.args.collType="collision-bottom",e=2):(this.args.collType="collision-intersect",e=-1),this.viewport){this.viewport.collisions.has(this)||this.viewport.collisions.set(this,new Set),this.viewport.collisions.has(t)||this.viewport.collisions.set(t,new Set);var r=this.viewport.collisions.get(this),n=this.viewport.collisions.get(t);r.add(t),n.add(this),this.viewport.collisions.set(t,n),this.collideB(t,e%4),t.collideB(this,(e+2)%4);var i=this.collideA(t,e),o=t.collideA(this,e>-1?(e+2)%4:e),a=i||o;return this.args.colliding=this.colliding=this.colliding||a||!1,a}}}},{key:"checkBelow",value:function(t,e){var r=this,n=[],i=[];switch(this.public.mode){case 0:n[0]=this.x+0,n[1]=this.y+1,i[0]=this.x-0,i[1]=this.y+1;break;case 1:n[0]=this.x-1,n[1]=this.y+0,i[0]=this.x-1,i[1]=this.y-0;break;case 2:n[0]=this.x-0,n[1]=this.y-1,i[0]=this.x+0,i[1]=this.y-1;break;case 3:n[0]=this.x+1,n[1]=this.y+0,i[0]=this.x+1,i[1]=this.y-0}var o=this.getMapSolidAt.apply(this,n);return Array.isArray(o)&&(o=o.filter(function(t){return t.solid&&t.callCollideHandler(r)}).length),o}},{key:"processInput",value:function(){if(this.controllable&&this.args.standingOn&&this.args.standingOn.isVehicle&&this===n.Bindable.make(this.args.standingOn.occupant)){this.viewport.auras.add(this.args.standingOn);var t=this.args.standingOn;t.xAxis=this.xAxis,t.yAxis=this.yAxis,t.stayStuck=this.stayStuck,t.willStick=this.willStick,this.processInputVehicle(),this.args.direction=t.public.direction,this.args.facing=t.public.facing,this.args.layer=t.public.layer,this.args.mode=t.public.mode,this.args.angle=t.public.angle}else this.controllable&&this.processInputDirect()}},{key:"processInputDirect",value:function(){var t=this,e=this.xAxis,r=this.yAxis;0!==this.args.ignore&&-4!==this.args.ignore&&(e=0,r=0);var n=this.public.gSpeedMax;this.running?n=1/0:this.crawling&&(n=1),this.public.falling||(Math.abs(this.public.gSpeed)<.01?(this.viewport.onFrameOut(5,function(){!t.args.ignore&&Math.abs(t.public.gSpeed)<.01&&(t.args.rolling=!1)}),this.args.gSpeed=0):!this.args.ignore&&this.canRoll&&this.yAxis>.55&&(this.args.rolling=!0));var i=this.getLocalDrag();if(this.noClip&&!this.args.ignore)this.args.xSpeed+=e*this.public.airAccel*i,this.args.ySpeed+=r*this.public.airAccel*i,e||(this.args.xSpeed=0),r||(this.args.ySpeed=0);else if(this.public.falling){if(this.public.falling&&e&&Math.abs(this.public.xSpeed)<this.args.xSpeedMax){(!this.args.ignore||-4===this.args.ignore)&&Math.abs(this.public.xSpeed)<this.args.flySpeedMax&&(this.args.xSpeed+=e*this.public.airAccel*i);this.viewport.tileMap}}else if(!this.args.ignore&&e&&!this.public.rolling){var o=this.public.gSpeed,a=Math.sign(e),s=Math.sign(this.public.gSpeed);if(this.public.rolling||this.args.climbing||(o+=a!==s&&s?e*this.public.accel*i*this.public.skidTraction:e*this.public.accel*i),Math.abs(o)>n&&(o=n*Math.sign(o)),Math.sign(this.public.gSpeed)&&Math.sign(this.public.gSpeed)!==Math.sign(o))return void(this.args.gSpeed=0);(Math.abs(o)<n||Math.sign(o)!==e)&&(this.args.gSpeed=o)}e<0&&(this.public.climbing||this.args.ignore&&-4!==this.args.ignore||(this.args.facing="left"),this.args.grinding||(this.args.direction=-1)),e>0&&(this.public.climbing||this.args.ignore&&-4!==this.args.ignore||(this.args.facing="right"),this.args.grinding||(this.args.direction=1)),this.aAxis<-.75&&this.inventory.has(y.ElectricSheild)&&(this.args.currentSheild=v(this.inventory.get(y.ElectricSheild))[0]),this.aAxis>.75&&this.inventory.has(p.FireSheild)&&(this.args.currentSheild=v(this.inventory.get(p.FireSheild))[0]),this.bAxis<-.75&&this.inventory.has(d.BubbleSheild)&&(this.args.currentSheild=v(this.inventory.get(d.BubbleSheild))[0]),this.bAxis>.75&&(this.args.currentSheild="")}},{key:"processInputVehicle",value:function(){this.args.standingOn.processInputDirect()}},{key:"collideA",value:function(t,e){return this.solid}},{key:"collideB",value:function(t){}},{key:"findDownSolid",value:function(t,e,r){if(r.viewport){var n=r.viewport,i=n.tileMap;if(0===r.args.groundAngle){var o,a=w(r.viewport.regionsAtPoint(e[0],e[1]));try{for(a.s();!(o=a.n()).done;){var s=o.value;if(0===r.args.mode&&-1+e[1]===s.y+-s.public.height&&Math.abs(r.args.gSpeed)>=s.skimSpeed)return-1+t}}catch(t){a.e(t)}finally{a.f()}}return i.getSolid(e[0],e[1],r.args.layer)?t:n.actorsAtPoint(e[0],e[1]).filter(function(t){return t.args!==r.args}).filter(function(t){return t.callCollideHandler(r)}).filter(function(t){return t.solid}).length>0?t:void 0}}},{key:"findUpSpace",value:function(t,e,r){if(r.viewport){var n=r.viewport,i=n.tileMap;if(r.args.groundAngle<=0){var o,a=w(r.viewport.regionsAtPoint(e[0],e[1]));try{for(a.s();!(o=a.n()).done;){var s=o.value;if(0!==r.args.mode||e[1]!==1+s.y+-s.args.height||Math.abs(r.args.gSpeed)<s.skimSpeed)if(0===n.actorsAtPoint(e[0],e[1]).filter(function(t){return t.args!==r.args}).filter(function(t){return t.callCollideHandler(r)}).filter(function(t){return t.solid}).length&&!i.getSolid(e[0],e[1],r.args.layer))return t}}catch(t){a.e(t)}finally{a.f()}}return 0!==n.actorsAtPoint(e[0],e[1]).filter(function(t){return t.args!==r.args}).filter(function(t){return t.callCollideHandler(r)}).filter(function(t){return t.solid}).length||i.getSolid(e[0],e[1],r.args.layer)?void 0:t}}},{key:"findNextStep",value:function(t){if(this.viewport){if(void 0!==this.stepCache[t])return this.stepCache[t];this.viewport.tileMap;for(var e=this.maxStep,r=(Math.max(this.args.width/2,1),Math.sign(t)),n=!1,i=!1,o=0,a=0,s=0;s<Math.abs(t);s+=1){n=!1,i=!1;var c=void 0,u=(1+s)*r;switch(this.public.mode){case 0:c=[u,1];break;case 3:c=[1,-u];break;case 2:c=[-u,-1];break;case 1:c=[-1,u]}if(!1===(n=this.castRay(e,this.downAngle,c,this.findDownSolid)))return[!1,!1,!0];var l=a-n;if(Math.abs(l)>=e)return[!1,!1,l<0,l>0];if(0===n){var f=void 0;switch(this.public.mode){case 0:f=[u,0];break;case 3:f=[0,-u];break;case 2:f=[-u,0];break;case 1:f=[0,u]}var h=1+e;i=this.castRay(h,this.upAngle,f,this.findUpSpace);var p=Math.abs(o-i);if(!1===i)return[!1,!1,!1,!0];if(p>=e)return[!1,!1,!1,!0];o=i}else a=n;this.stepCache[s*r]=!1!==i?[s*r,i,!1]:[s*r,-n,!1]}return!1!==i?[s*r,i,!1]:[s*r,-n,!1]}}},{key:"castRay",value:function(){for(var t=1,e=function(){},r=Math.PI/2,n=[0,0],i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];switch(o.length){case 2:t=o[0],e=o[1];break;case 3:t=o[0],r=o[1],e=o[2];break;case 4:t=o[0],r=o[1],n=o[2],e=o[3]}for(var s=0;s<Math.floor(t);s++){var c=e(s,[this.public.x+n[0]+s*Math.cos(r),this.public.y+n[1]+s*Math.sin(r)],this);if(void 0!==c)return c}return!1}},{key:"doJump",value:function(t){if(!this.public.ignore&&!this.public.falling&&this.public.landed&&!this.public.float){this.args.standingOn&&this.args.standingOn.args.yForce&&(t+=this.args.standingOn.args.yForce/7);var e=this.args.width/2,r=Math.min(e,4),n=this.findNextStep(-r),i=this.findNextStep(+r),o=2*r,a=Math.atan2(n[1]-i[1],Math.ceil(o));this.args.ignore=6,this.args.landed=!1,this.args.falling=!0;this.public.mode;switch(this.public.mode){case 0:this.args.y-=16;break;case 3:a+=-Math.PI/2,this.args.x+=-this.public.width/2;break;case 2:a+=Math.PI,this.args.y+=this.public.height;break;case 1:a+=Math.PI/2,this.args.x+=this.public.width/2}this.args.xSpeed=this.public.gSpeed*Math.cos(a),this.args.ySpeed=this.public.gSpeed*Math.sin(a);var s=a-Math.PI/2,c=t*Math.cos(s),u=t*Math.sin(s);Math.abs(c)<.01&&(c=0),Math.abs(u)<.01&&(u=0),this.args.airAngle=s,this.args.xSpeed+=c,this.args.ySpeed+=u,this.args.jumpedAt=this.y,this.args.jumping=!0,this.viewport.tileMap.getSolid(this.x+this.public.width/2*Math.sign(this.args.xSpeed),this.y,this.public.layer)&&(this.args.xSpeed=0),this.args.rolling=!1,this.args.mode=0,this.args.groundAngle=0,this.args.gSpeed=0}}},{key:"impulse",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.impulseMag=t,this.impulseDir=e,this.impulseFal=r}},{key:"rad2deg",value:function(t){var e=180/Math.PI*t;return e>0?Math.floor(10*e)/10:Math.ceil(10*e)/10}},{key:"roundAngle",value:function(t,e){return e/=2,Math.round(t/(Math.PI/e))*Math.PI/e}},{key:"findNearestActor",value:function(t,e){var r=this,n=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],this.viewport);if(n){var i=n.getNearbyColCells(this),o=new Map;i.map(function(n){return n.forEach(function(n){if(n!==r&&!n.public.gone&&t(n)){var i=r.distanceFrom(n);Math.atan2(n.y-r.y,n.x-r.x);Math.abs(i)>e||o.set(i,n)}})});var a=v(o.keys()),s=Math.min.apply(Math,v(a));return o.get(s)}}},{key:"damage",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",n=this.args.currentSheild,i=new CustomEvent("damage",{cancelable:!0,detail:{other:t,type:r}});this.dispatchEvent(i)&&(this.args.mercy||(this.args.rings?(this.args.mercy=!0,this.viewport.onFrameOut(180,function(){return e.args.mercy=!1}),this.startle(),this.onNextFrame(function(){n&&n.protect||(e.loseRings(),e.args.rings=0)})):this.die()))}},{key:"startle",value:function(){var t=this;this.noClip||(this.args.jumping=!1,this.args.startled=180,this.args.ignore=30,this.args.gSpeed=0,this.args.xSpeed=-4*Math.sign(this.public.xSpeed||this.public.gSpeed||this.args.direction),this.args.ySpeed=-7,this.args.falling=!0,this.onNextFrame(function(){t.args.xSpeed=-4*Math.sign(t.public.xSpeed||t.public.gSpeed||t.args.direction),t.args.ySpeed=-7,t.args.standingOn=!1,2===t.args.mode&&(t.args.xSpeed*=-1,t.args.ySpeed*=-1),t.args.gSpeed=0,t.args.falling=!0}))}},{key:"findSolid",value:function(t,e,r){if(r.viewport){var n=r.viewport,i=n.tileMap;return n.actorsAtPoint(e[0],e[1]).filter(function(t){return t.args!==r.args}).filter(function(e){return t<=r.args.width/2&&e.callCollideHandler(r)}).filter(function(t){return t.solid}).length>0?t:i.getSolid(e[0],e[1],r.args.layer)?t:void 0}}},{key:"findSolidTile",value:function(t,e,r){if(tileMap.getSolid(e[0],e[1],r.args.layer))return t}},{key:"scanForward",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Math.sign(t),i=Math.round(this.args.width/2),o=(Math.round(this.args.height/2),Math.ceil(Math.abs(t))),a=this.viewport;if(a){a.tileMap;var s=this.rotatePoint(i*-n,this.args.height*e);return this.castRay(o+this.args.width,this.args.falling?[Math.PI,0,0][n+1]:this.roundAngle(this.realAngle+[0,0,Math.PI][n+1],16),s,r?this.findSolid:this.findSolidTile)}}},{key:"scanBottomEdge",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=this.viewport.tileMap,n=this.args.width/2,i=r.getSolid(this.x-n,this.y+1,this.args.layer),o=r.getSolid(this.x+n,this.y+1,this.args.layer);if(!i||!o)return this.castRay(this.public.width,e<0?Math.PI:0,[-e*n,0],function(e,n){if(!t.viewport.actorsAtPoint(n[0],n[1]+1).filter(function(e){return e.args!==t.args}).length&&!r.getSolid(n[0],n[1]+1,t.public.layer))return e})}},{key:"scanVerticalEdge",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=this.viewport.tileMap;return this.castRay(this.public.height+1,Math.PI/2,[e*this.public.width/2,-this.public.height],function(e,n){if(t.viewport.actorsAtPoint(n[0],n[1]).filter(function(e){return e.args!==t.args}).length||r.getSolid(n[0],n[1],t.public.layer))return e})}},{key:"realAngle",get:function(){if(!this.public.falling&&this.public.standingOn)return this.public.standingOn.realAngle;var t,e=Number(this.public.groundAngle);if(this.public.falling)return-e-Math.PI;switch(this.public.mode){case 0:t=-e-Math.PI;break;case 1:t=-e-Math.PI/2;break;case 2:t=-e;break;case 3:t=-e+Math.PI/2}return t}},{key:"downAngle",get:function(){switch(this.public.mode){case 0:return Math.PI/2;case 3:return 0;case 2:return-Math.PI/2;case 1:return Math.PI}}},{key:"upAngle",get:function(){switch(this.public.mode){case 0:return-Math.PI/2;case 3:return Math.PI;case 2:return Math.PI/2;case 1:return 0}}},{key:"leftAngle",get:function(){switch(this.public.mode){case 0:return Math.PI;case 3:return-Math.PI/2;case 2:return 0;case 1:return Math.PI/2}}},{key:"rightAngle",get:function(){switch(this.public.mode){case 0:return 0;case 3:return Math.PI/2;case 2:return Math.PI;case 1:return-Math.PI/2}}},{key:"groundPoint",get:function(){switch(this.public.mode){case 0:return[this.x+0,this.y+1];case 3:return[this.x+1,this.y+0];case 2:return[this.x+0,this.y-1];case 1:return[this.x-1,this.y+0]}}},{key:"rotatePoint",value:function(t,e){return[t*Math.cos(this.realAngle)-e*Math.sin(this.realAngle),e*Math.cos(this.realAngle)+t*Math.sin(this.realAngle)]}},{key:"standBelow",value:function(t){}},{key:"getMapSolidAt",value:function(t,e){var r=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.viewport){if(n){var i=this.viewport.actorsAtPoint(t,e).filter(function(t){return t.args!==r.args}).filter(function(t){return t.solid}).filter(function(t){return!t.args.platform&&!t.isVehicle||r.y<=t.y+-t.args.height&&r.args.ySpeed>=0});if(i.length>0)return i}return this.viewport.tileMap.getSolid(t,e,this.public.layer)}}},{key:"canRoll",get:function(){return!1}},{key:"canFly",get:function(){return!1}},{key:"canStick",get:function(){return!1}},{key:"canSpindash",get:function(){return!1}},{key:"isEffect",get:function(){return!1}},{key:"isGhost",get:function(){return!1}},{key:"isPushable",get:function(){return!1}},{key:"isVehicle",get:function(){return!1}},{key:"solid",get:function(){return!1}},{key:"x",get:function(){return this.public.x}},{key:"y",get:function(){return this.public.y}},{key:"point",get:function(){return[this.public.x,this.public.y]}},{key:"rotateLock",get:function(){return!1}},{key:"controllable",get:function(){return!1}},{key:"skidding",get:function(){return Math.abs(this.public.gSpeed)&&Math.sign(this.public.gSpeed)!==this.public.direction}},{key:"readInput",value:function(){if(this.controller){var t=this.controller;this.args.ignore&&-4!==this.args.ignore?(this.xAxis=0,this.yAxis=0):(t.axes[0]&&(this.xAxis=t.axes[0].magnitude),t.axes[1]&&(this.yAxis=t.axes[1].magnitude)),this.args.ignore?(this.aAxis=0,this.bAxis=0):(t.axes[2]&&(this.aAxis=t.axes[2].magnitude),t.axes[3]&&(this.bAxis=t.axes[3].magnitude));var e=t.buttons;for(var r in e){var n=e[r],i="release_".concat(r),o="command_".concat(r),a="hold_".concat(r);if(this.args.standingOn&&this.args.standingOn.isVehicle&&0!=r){if(this.args.standingOn&&this.args.standingOn.isVehicle){this.args.jumping=!1,this.args.flying=!1;var s=this.args.standingOn;1===n.delta?s[o]&&s[o](n):-1===n.delta?s[i]&&s[i](n):n.active&&s[a]&&s[a](n)}}else 1===n.delta?(this.args.currentSheild&&o in this.args.currentSheild&&this.args.currentSheild[o](this,n),this[o]&&this[o](n)):-1===n.delta?(this.args.currentSheild&&i in this.args.currentSheild&&this.args.currentSheild[i](this,n),this[i]&&this[i](n)):n.active&&(this.args.currentSheild&&a in this.args.currentSheild&&this.args.currentSheild[a](this,n),this[a]&&this[a](n))}}}},{key:"command_0",value:function(){if(this.args.hangingFrom&&this.args.hangingFrom.unhook){var t=this.getLocalDrag();return this.args.ySpeed=-this.args.jumpForce*t*.75,this.args.ignore=0,void this.args.hangingFrom.unhook()}this.public.falling||this.willJump||this.public.dontJump?this.args.standingOn&&this.args.standingOn.isVehicle&&(this.viewport.auras.delete(this.args.standingOn),this.willJump=!0):this.willJump||(this.yAxis<0&&(this.args.standingOn=!1),this.willJump=!0)}},{key:"command_1",value:function(){!this.args.ignore&&this.canRoll&&this.public.gSpeed&&(this.args.rolling=!0)}},{key:"release_0",value:function(){this.args.jumping&&this.args.ySpeed<-5&&(this.args.ySpeed*=.5)}},{key:"distanceFrom",value:function(t){var e=t.x,r=t.y,n=Math.pow(this.x-e,2)+Math.pow(this.y-r,2);return n?Math.sqrt(n):0}},{key:"twist",value:function(t){var e=this;if(!this.twister){var r=this.viewport.tags.bgFilters;this.twistFilter=new o.Tag('<div class = "point-actor-filter twist-filter">'),r.appendChild(this.twistFilter.node),this.twister=new a.Twist({id:"twist-"+this.args.id,scale:60}),this.twister.args.bindTo(["x","y","width","height","xOff","yOff"],function(t,r){var n;e.twistFilter.style((R(n={},"--".concat(r),t),R(n,"filter","url(#twist-".concat(e.args.id,")")),n))}),this.twister.render(this.sprite)}this.twister.args.scale=t}},{key:"pinch",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.pincherBg){var r=this.viewport.tags.bgFilters;this.args.type.split(" ").shift();this.pinchFilterBg=new o.Tag('<div class = "point-actor-filter pinch-filter">'),r.appendChild(this.pinchFilterBg.node),this.pincherBg=new c.Pinch({id:"pinch-"+this.args.id,scale:60}),this.pincherBg.args.bindTo(["x","y","width","height","xOff","yOff"],function(e,r){var n;t.pinchFilterBg.style((R(n={},"--".concat(r),e),R(n,"filter","url(#pinch-".concat(t.args.id,")")),n))}),this.args.yOff=16,this.pincherBg.render(this.sprite)}this.pincherBg.args.scale=e}},{key:"droop",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.public.width/2;if(!this.drooperFg)return this.drooperFg=new s.Droop({id:"droop-"+this.args.id,width:3*this.public.width,height:3*this.public.height,scale:64}),this.args.bindTo(["x","y"],function(e,r){t.drooperFg.args[r]=Number(e).toFixed(2)}),this.onNextFrame(function(){t.drooperFg.args.scale=Number(2*e).toFixed(2),t.sprite.style({transform:"translate(-50%, calc(".concat(e,"px + calc(-100% + 1px)))"),filter:"url(#droop-".concat(t.args.id,")")}),t.drooperFg.args.dx=-r}),void this.drooperFg.render(this.sprite);this.drooperFg.args.scale=Number(2*e).toFixed(2),this.sprite.style({transform:"translate(-50%, calc(".concat(e,"px + calc(-100% + 1px)))"),filter:"url(#droop-".concat(this.args.id,")")});var i=1-r/n;this.args.width;this.drooperFg.args.droopWidthLeft="".concat(51*i+1,"%"),this.drooperFg.args.droopRightStart="".concat(51*i,"%"),this.drooperFg.args.droopWidthRight="".concat(102+-51*i,"%")}},{key:"crossRegionBoundary",value:function(t){if(t){var e=t.args.drag;if(this.args.xSpeed*=e,this.args.ySpeed*=e,this.args.gSpeed*=e,this.viewport){var r=this.viewport;if(!this.args.gone&&t.entryParticle){var n=new o.Tag(t.entryParticle);n.node&&(n.style({"--x":this.x+this.args.xSpeed,"--y":t.y+-t.args.height+-8,"z-index":5,opacity:Math.random,"--particleScale":this.args.particleScale,"--time":320}),r.particles.add(n),setTimeout(function(){return n.node&&r.particles.remove(n)},320))}}}}},{key:"die",value:function(){var t=this;this.args.dead||(this.args.jumping=!1,this.args.falling=!0,this.args.ignore=-1,this.args.float=0,this.args.rings=0,this.args.dead=!0,this.noClip=!0,this.onNextFrame(function(){t.args.ySpeed=-6,t.args.xSpeed=0}),this.viewport.onFrameOut(120,function(){t.respawn()}))}},{key:"respawn",value:function(){this.args.xSpeed=0,this.args.ySpeed=0,this.args.gSpeed=0,this.args.respawning=!0,this.args.display="none"}},{key:"sleep",value:function(){}},{key:"wakeUp",value:function(){}},{key:"urlWrap",value:function(t){return"url(".concat(t,")")}},{key:"facePoint",get:function(){return this.rotatePoint(-5*this.public.direction,-14+this.public.height)}},{key:"registerDebug",value:function(t){window[t]=this}},{key:"loseRings",value:function(){var t=this,e=this.viewport.objectPalette.ring;this.spawnRings=this.spawnRings||0;for(var r=Math.min(this.args.rings,12),n=function(){var n=new e,i=t.spawnRings*(2*Math.PI)/r,o=Math.cos(i),a=Math.sin(i);n.args.x=t.x-8*o,n.args.y=t.y-8*a,n.args.static=!1,n.args.float=4,n.args.ignore=30,n.args.width=16,n.args.height=16,n.dropped=!0,t.viewport.onFrameOut(3+t.spawnRings%3,function(){t.viewport.spawn.add({object:n})}),t.viewport.onFrameOut(5,function(){n.args.xSpeed=t.args.xSpeed||t.args.gSpeed,n.args.ySpeed=t.args.ySpeed}),t.spawnRings++,t.viewport.onFrameOut(7,function(){t.onNextFrame(function(){n.args.xSpeed+=2*-o,n.args.gSpeed+=2*-o,n.args.ySpeed+=2*-a})}),n.noClip=!0,n.args.decoration=!0,t.spawnRings>16?t.viewport.onFrameOut(45,function(){t.viewport.actors.remove(n),n.dropped&&t.spawnRings>0&&t.spawnRings--}):(t.viewport.onFrameOut(10,function(){n.noClip=!1,n.args.decoration=!1}),t.viewport.onFrameOut(240,function(){t.viewport.actors.remove(n),n.dropped&&t.spawnRings>0&&t.spawnRings--}))};this.spawnRings<r;)n()}},{key:"collect",value:function(t){t.dropped&&(this.spawnRings&&this.spawnRings--,t.dropped=!1)}}])&&x(e.prototype,r),S&&x(e,S),M}();t.PointActor=C,R(C,"lastClick",0)}),require.register("actor/PowerupGlow.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PowerupGlow=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-powerup-glow",t.args.width=64,t.args.height=64,t}return e=h,(r=[{key:"onAttached",value:function(){this.autoAttr.get(this.box)["data-closed"]="closed",this.icon=new o.Tag('<div class = "powerup-icon">'),this.halo=new o.Tag('<div class = "powerup-halo">'),this.tags.sprite.appendChild(this.icon.node),this.box.appendChild(this.halo.node)}},{key:"collideA",value:function(t){var e=this;s(l(h.prototype),"collideA",this).call(this,t),t.controllable&&(this.onTimeout(125,function(){return e.args.closed="closed"}),this.onTimeout(4500,function(){return e.args.closed=""}))}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),h}();t.PowerupGlow=f}),require.register("actor/Projectile.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Projectile=void 0;var i=e("./PointActor"),o=(e("../actor/Explosion"),e("curvature/base/Tag")),a=e("../region/Region"),s=e("./Spring");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return h(t)}(this,r)}}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(d,i.PointActor);var e,r,n,g=f(d);function d(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=g.call.apply(g,[this].concat(o)),e=h(t),n=-1,(r="float")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="actor-item actor-projectile",t.args.width=8,t.args.height=8,t.removeTimer=null,t}return e=d,(r=[{key:"update",value:function(){var t=this;this.removed||(u(p(d.prototype),"update",this).call(this),this.args.xSpeed||this.args.ySpeed||this.explode(),this.removeTimer||(this.removeTimer=this.onTimeout(2500,function(){return t.explode()})))}},{key:"collideA",value:function(t){return!(t===this.args.owner||t instanceof a.Region||t instanceof s.Spring)&&(!(!t.solid&&!t.controllable)&&(this.args.owner&&!this.args.owner.args.gone&&t.controllable&&t.damage(),this.args.x+=Math.cos(this.public.angle)*(t.args.width/2)*Math.sign(this.public.xSpeed),this.args.y+=Math.sin(this.public.angle)*(t.args.width/2)*Math.sign(this.public.xSpeed),this.explode(),!1))}},{key:"explode",value:function(){var t=this.viewport;if(t){var e=new o.Tag('<div class = "particle-explosion">');e.style({"--x":this.x,"--y":this.y}),t.particles.add(e),setTimeout(function(){return t.particles.remove(e)},350),this.viewport.actors.remove(this),this.remove()}}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!1}}])&&c(e.prototype,r),n&&c(e,n),d}();t.Projectile=g}),require.register("actor/QuestionBlock.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionBlock=void 0;var i=e("./PointActor"),o=(e("./monitor/RingMonitor"),e("./monitor/SheildWaterMonitor"));function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e,r){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(g,i.PointActor);var e,r,n,p=c(g);function g(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return h(u(t=p.call.apply(p,[this].concat(r))),"maxBounce",4),h(u(t),"float",-1),h(u(t),"template",'<div\n\t\tclass = "point-actor [[type]] [[collType]]"\n\t\tstyle = "\n\t\t\tdisplay:[[display]];\n\t\t\t--angle:[[angle]];\n\t\t\t--airAngle:[[airAngle]];\n\t\t\t--display-angle:[[_angle]];\n\t\t\t--height:[[height]];\n\t\t\t--width:[[width]];\n\t\t\t--x:[[x]];\n\t\t\t--y:[[y]];\n\t\t"\n\t\tdata-colliding = "[[colliding]]"\n\t\tdata-falling   = "[[falling]]"\n\t\tdata-facing    = "[[facing]]"\n\t\tdata-angle     = "[[angle|rad2deg]]"\n\t\tdata-mode      = "[[mode]]"\n\t\tdata-empty     = "[[empty]]"\n\t\tcv-ref = "box"\n\t><div cv-ref = "sprite" class = "sprite"></div></div>'),t.args.type="actor-question-block actor-item",t.args.width=32,t.args.height=32,t.initY=null,t.empty=!1,t}return e=g,n=[{key:"fromDef",value:function(t){var e=l(f(g),"fromDef",this).call(this,t);return e.args.x=e.originalX=t.x+Math.floor(t.width/2),e.args.y=e.originalY=t.y,e}}],(r=[{key:"collideA",value:function(t,e){var r=this;if(l(f(g.prototype),"collideA",this).call(this,t),null===this.initY&&(this.initY=this.y),2===e){var n=Math.abs(t.args.ySpeed);if(t.args.falling=!0,t.args.ySpeed>0?t.args.ySpeed+=this.args.ySpeed:(this.args.y-=n,t.args.y+=n),this.args.ySpeed>0&&this.args.ySpeed>t.args.ySpeed&&(t.args.ySpeed=Math.abs(t.args.ySpeed),t.args.y+=this.args.ySpeed),this.args.ySpeed<0&&(this.args.ySpeed=-Math.abs(this.args.ySpeed)),this.args.ySpeed)return!0;var i=this.maxBounce,a=2===e?-Math.abs(t.args.ySpeed):t.args.ySpeed;Math.abs(a)>i&&(a=i*Math.sign(a)),this.args.ySpeed=a,t.args.ySpeed=-t.args.ySpeed}if(2===e&&!this.args.empty&&!this.args.empty){var s=new o.SheildWaterMonitor({x:this.x,y:this.y-96});this.viewport.spawn.add({object:s}),s.onRemove(function(){return r.args.empty=!1}),this.args.empty=!0}return!0}},{key:"update",value:function(){null!==this.initY&&(this.initY>this.y?this.args.ySpeed+=.75:this.initY<this.y&&(this.args.ySpeed-=.75),Math.abs(this.args.y-this.initY)<1&&Math.abs(this.args.ySpeed)<1&&(this.args.ySpeed=0,this.args.y=this.initY)),this.args.ySpeed*=.9,this.args.ySpeed=Math.floor(100*this.args.ySpeed)/100,this.args.y=Math.round(this.args.y);var t=this.maxBounce;Math.abs(this.args.ySpeed)>t&&(this.args.ySpeed=t*Math.sign(this.args.ySpeed)),l(f(g.prototype),"update",this).call(this)}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),g}();t.QuestionBlock=p}),require.register("actor/RailCar.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RailCar=void 0;var i=e("./Vehicle"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.Vehicle);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-rail-car",t.args.width=32,t.args.height=48,t.removeTimer=null,t.args.gSpeedMax=20,t.args.decel=0,t.args.accel=.75,t.args.gravity=1,t.args.seatHeight=44,t.args.skidTraction=.05,t.args.jumpForce=8,t.dustCount=0,t.args.particleScale=2,t.args.started=!1,t}return e=h,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.frontWheel=new o.Tag('<div class = "rail-car-wheel rail-car-wheel-front">'),this.backWheel=new o.Tag('<div class = "rail-car-wheel rail-car-wheel-back">'),this.frontFrag=new o.Tag('<div class = "rail-car-frag rail-car-frag-front">'),this.backFrag=new o.Tag('<div class = "rail-car-frag rail-car-frag-back">'),this.sprite.appendChild(this.frontWheel.node),this.sprite.appendChild(this.backWheel.node),this.sprite.appendChild(this.frontFrag.node),this.sprite.appendChild(this.backFrag.node)}},{key:"update",value:function(){this.public.falling?this.args.cameraMode="railcar-aerial":this.args.cameraMode="railcar-normal",this.originalSpeed=this.public.gSpeed||this.public.xSpeed;var t=this.x;s(l(h.prototype),"update",this).call(this);var e=this.x;if(0===this.public.gSpeed&&0===this.public.xSpeed||(this.sprite.classList.add("moving"),this.args.started=!0),e===t&&(this.sprite.classList.remove("moving"),this.args.started)){this.viewport;(!this.public.falling||this.public.xSpeed||this.public.ySpeed)&&(this.public.falling||this.public.gSpeed)||this.breakApart()}this.occupant&&!this.public.falling&&((Math.abs(this.public.gSpeed)<Math.abs(this.public.cartSpeed)||Math.sign(this.public.gSpeed)!==Math.sign(this.public.cartSpeed))&&(this.args.gSpeed+=.125*Math.sign(this.public.cartSpeed)),this.args.direction=Math.sign(this.args.gSpeed))}},{key:"breakApart",value:function(){var t=this;if(!this.public.broken){var e=this.viewport;if(e.onFrameOut(500,function(){return e&&e.actors.remove(t)}),e.onFrameOut(200,function(){return t.sprite.classList.add("broken")}),this.occupant){var r=this.occupant;r.args.standingOn=!1,r.startle(),this.args.falling=!0,this.onNextFrame(function(){r.args.xSpeed=-4*Math.sign(t.gSpeedLast||t.xSpeedLast)})}this.sprite.classList.add("breaking"),this.args.broken=!0,this.args.groundAngle=0,this.args.mode=0}}},{key:"processInputDirect",value:function(){}},{key:"solid",get:function(){return!this.args.broken&&!this.occupant}}])&&a(e.prototype,r),n&&a(e,n),h}();t.RailCar=f}),require.register("actor/RedEyeJet.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RedEyeJet=void 0;var i=e("curvature/base/Tag"),o=e("./PointActor"),a=e("./MiniMace");function s(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,r){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(g,o.PointActor);var e,r,n,c=h(g);function g(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.gravity=.4,t.args.width=96,t.args.height=32,t.args.type="actor-item actor-red-eye-jet",t.args.float=-1,t.args.phase="intro",t.args.hitPoints=t.args.hitPoints||8,t.args.maxSpeed=9,t.dieSound=new Audio("/Sonic/object-destroyed.wav"),t.hitSound=new Audio("/Sonic/S3K_6E.wav"),t.dudSound=new Audio("/Sonic/S2_59.wav"),t}return e=g,(r=[{key:"collideA",value:function(t,e){var r=this;if(t.controllable){if(this.args.hitPoints>0&&!(t.args.jumping||t.args.rolling||t.dashed))return t.args.xSpeed=1.5*-t.args.xSpeed,t.damage(),!0;if(!this.args.falling&&"exploding"!==this.args.phase){if(!(t.args.jumping||t.args.rolling||t.dashed))return!0;this.box.setAttribute("data-phase","exploding"),this.args.phase="exploding",this.viewport.clearCheckpoints(t.args.id);var n=this.viewport;n.onFrameOut(80,function(){r.box.setAttribute("data-phase","exploded"),r.args.falling=!0,r.args.ySpeed=-12,r.noClip=!0,r.viewport.args.audio&&(r.dieSound.volume=.5,r.dieSound.play())}),n.onFrameOut(100,function(){n.clearAct("".concat(t.args.name," BEAT THE MINI-MACE"))}),n.onFrameOut(200,function(){r.viewport.args.cutScene=!0}),n.onFrameOut(205,function(){r.viewport.controlActor.controller.replay({axes:[1,0,0,1]}),r.viewport.controlActor.readInput()}),n.onFrameOut(210,function(){r.viewport.controlActor.controller.replay({buttons:[1]}),r.viewport.controlActor.readInput()}),n.onFrameOut(211,function(){r.viewport.controlActor.dropDashCharge=30}),n.onFrameOut(285,function(){r.viewport.controlActor.controller.replay({buttons:[0,0,0,0,0,0]}),r.viewport.controlActor.readInput(),r.args.phase="done"}),n.onFrameOut(500,function(){r.args.xSpeed=0,r.args.ySpeed=0,r.args.y=-1024})}this.ignores.set(t,15),2===e&&(this.viewport.args.audio&&(this.dudSound.volume=.35+-.15*Math.random(),this.dudSound.play()),t.args.ySpeed=Math.max(7,Math.abs(t.args.ySpeed)));var i=Math.max(Math.abs(t.args.xSpeed),Math.abs(this.args.xSpeed));if(this.args.hitPoints>1&&this.args.falling?this.args.xSpeed=t.args.xSpeed:this.args.xSpeed=0,1===e&&(this.viewport.args.audio&&(this.hitSound.volume=.35+-.15*Math.random(),this.hitSound.play()),t.args.x=this.x-this.args.width/2,this.args.hitPoints>0?(t.args.xSpeed=1.25*-i,t.args.xSpeed=Math.min(-7,-this.args.xSpeed),this.args.hitPoints--):(t.args.xSpeed=-2,t.args.ignore=-2)),3===e&&(this.viewport.args.audio&&(this.hitSound.volume=.35+-.15*Math.random(),this.hitSound.play()),t.args.x=this.x+this.args.width/2,this.args.hitPoints>0?(t.args.xSpeed=1.25*i,t.args.xSpeed=Math.max(7,-this.args.xSpeed),this.args.hitPoints--):(t.args.xSpeed=2,t.args.ignore=-2)),1===e||3===e||0===e){if(["dead","exploding","damaged","done"].includes(this.args.phase)||(this.args.phase="damaged",this.args.animation="",this.args.animation="damaged",0===this.args.hitPoints&&"exploding"!==this.args.phase&&(this.box.setAttribute("data-phase","dead"),this.args.animation="",this.args.phase="dead"),this.viewport.onFrameOut(20,function(){r.args.hitPoints>0?(r.args.animation="attacking",r.args.phase="attacking"):["dead","exploding","done"].includes(r.args.phase)||(r.box.setAttribute("data-phase","dead"),r.args.animation="dead",r.args.phase="dead",r.args.xSpeed=0,t.args.score+=2e4)})),0===e){t.args.y=this.y-this.args.height;var o=t.args.animation,a=t.args.ySpeed;this.onNextFrame(function(){t.args.animation=o,t.args.falling=!0,t.args.xSpeed=-4*Math.sign(r.x-t.x),t.args.ySpeed=-Math.floor(Math.abs(a))||-4}),this.viewport.args.audio&&(this.hitSound.volume=.35+-.15*Math.random(),this.hitSound.play())}var s=t.args.gSpeed;t.args.gSpeed=-s,t.args.rolling&&this.onNextFrame(function(){t.args.gSpeed=-s,t.args.rolling=!0,t.args.direction,Math.sign(s)})}return t.args.ignore=1,this.args.hitPoints||(t.args.ignore=-2),!0}}},{key:"update",value:function(){if("intro"===this.args.phase){this.args.maxSpeed=9;var t,e=s(this.hanging.get(a.MiniMace));try{for(e.s();!(t=e.n()).done;){var r=t.value;r.args.x=this.x,r.args.y=this.y+16,r.args.float=-1}}catch(t){e.e(t)}finally{e.f()}Math.abs(this.viewport.controlActor.x-this.x)<8&&this.y<this.viewport.controlActor.y&&(this.args.phase="attacking")}if("attacking"===this.args.phase){this.args.maxSpeed=9;var n,o=s(this.hanging.get(a.MiniMace));try{for(o.s();!(n=o.n()).done;){n.value.args.float=0}}catch(t){o.e(t)}finally{o.f()}Math.abs(this.viewport.controlActor.x-this.x)>255&&(this.args.phase="chasing")}if("chasing"===this.args.phase&&Math.abs(this.viewport.controlActor.x-this.x)<8&&this.y<this.viewport.controlActor.y&&(this.args.phase="attacking"),"exploding"!==this.args.phase)"damaged"===this.args.phase&&(this.args.xSpeed*=.999),this.x-this.viewport.controlActor.x>0?Math.abs(this.x-this.viewport.controlActor.x)>128?this.box.setAttribute("data-looking","far-left"):-1===this.viewport.controlActor.args.direction?this.box.setAttribute("data-looking","far-left"):this.box.setAttribute("data-looking","left"):this.x-this.viewport.controlActor.x<0&&(this.box.setAttribute("data-looking","far-right"),Math.abs(this.x-this.viewport.controlActor.x)>128?this.box.setAttribute("data-looking","far-right"):1===this.viewport.controlActor.args.direction?this.box.setAttribute("data-looking","far-right"):this.box.setAttribute("data-looking","right")),32>this.y-this.viewport.controlActor.y?this.box.setAttribute("data-ducking","true"):this.box.setAttribute("data-ducking","false"),this.args.hitPoints&&["attacking","intro","chasing"].includes(this.args.phase)&&(Math.abs(this.x-this.viewport.controlActor.x)>384&&(this.args.x=this.viewport.controlActor.x+384*Math.sign(this.x-this.viewport.controlActor.x)),this.args.xSpeed+=.35*-Math.sign(this.x-this.viewport.controlActor.x)),this.args.hitPoints?(this.args.falling=!0,this.args.float=-1):this.args.float=0,"intro"!==this.args.phase&&"attacking"!==this.args.phase||(this.args.maxSpeed=11),"chasing"===this.args.phase?Math.abs(this.x-this.viewport.controlActor.x)<128&&(this.args.maxSpeed=Math.max(this.args.maxSpeed,this.viewport.controlActor.args.xSpeed)):Math.abs(this.args.xSpeed)>this.args.maxSpeed&&(this.args.xSpeed=Math.sign(this.args.xSpeed)*this.args.maxSpeed),l(p(g.prototype),"update",this).call(this);else{var c=this.viewport;if(c&&c.args.frameId%3==0){var u=new i.Tag('<div class = "particle-explosion">');c.args.audio&&(this.hitSound.currentTime=0,this.hitSound.volume=.35+-.15*Math.random(),this.hitSound.play());var f=this.args.width*Math.random()-this.args.width/2,h=this.args.height*Math.random()-this.args.height/2;u.style({"--x":this.x+f,"--y":this.y+h+-16}),c.particles.add(u),setTimeout(function(){return c.particles.remove(u)},512)}l(p(g.prototype),"update",this).call(this)}}},{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.body=new i.Tag('<div class = "body-center">'),this.bodyL=new i.Tag('<div class = "body-left">'),this.bodyR=new i.Tag('<div class = "body-right">'),this.fireA=new i.Tag('<div class = "boost-fire boost-fire-left">'),this.fireB=new i.Tag('<div class = "boost-fire boost-fire-right">'),this.eye=new i.Tag('<div class = "orange-eye">'),this.box.appendChild(this.body.node),this.box.appendChild(this.bodyL.node),this.box.appendChild(this.bodyR.node),this.box.appendChild(this.fireA.node),this.box.appendChild(this.fireB.node),this.box.appendChild(this.eye.node)}},{key:"solid",get:function(){return!0}}])&&u(e.prototype,r),n&&u(e,n),g}();t.RedEyeJet=g}),require.register("actor/Ring.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Ring=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-ring",t.args.width=32,t.args.height=32,t.args.static=!0,t.args.gone=!1,t.args.float=-1,t.sample=new Audio("/Sonic/ring-collect.wav"),t.sample.volume=.15+-.05*Math.random(),t.args.gravity=.48,t}return e=f,(r=[{key:"update",value:function(){this.viewport.args.frameId%4?this.noClip=!0:this.args.decoration||this.attract||(this.noClip=!1),this.args.decoration&&(this.args.type="actor-item actor-ring decoration"),this.args.falling||(this.args.ySpeed=.5*-this.ySpeedLast,this.args.xSpeed=.65*this.xSpeedLast,this.args.falling=!0),a(u(f.prototype),"update",this).call(this)}},{key:"callCollideHandler",value:function(t){if(!(t instanceof f))return a(u(f.prototype),"callCollideHandler",this).call(this,t)}},{key:"collideA",value:function(t){var e=this;if(this.public.gone||this.args.ignore)return!1;if(a(u(f.prototype),"collideA",this).call(this,t),t.public.owner&&(t=t.args.owner),t.occupant&&(t=t.occupant),!t.controllable&&!t.occupant&&!t.public.owner)return!1;t.controllable&&(t.args.rings+=1),this.args.gone=!0,this.viewport.auras.delete(this),this.args.xSpeed=0,this.args.ySpeed=0,this.args.static=!0,this.args.float=-1,this.args.type="actor-item actor-ring collected",this.viewport.args.audio&&this.sample&&this.sample.play(),this.viewport.onFrameOut(5,function(){e.args.type="actor-item actor-ring collected gone"});this.x,this.y,this.viewport;this.viewport.onFrameOut(1200,function(){e.restore=!0}),t.collect&&this.onNextFrame(function(){t.collect(e)}),this.args.xSpeed=0,this.args.ySpeed=0}},{key:"wakeUp",value:function(){this.restore&&(this.args.x=this.def.get("x"),this.args.y=this.def.get("y"),this.args.gone=this.restore=!1,this.args.type="actor-item actor-ring")}},{key:"solid",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Ring=l}),require.register("actor/RoadBarrier.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RoadBarrier=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.width=t.public.width||64,t.args.height=t.public.height||32,t.args.type="actor-item actor-road-barrier",t}return e=u,(r=[{key:"solid",get:function(){return!1}}])&&o(e.prototype,r),n&&o(e,n),u}();t.RoadBarrier=u}),require.register("actor/Rocket.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Rocket=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t,e,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(r=f.call.apply(f,[this].concat(i))).args.width=32,r.args.height=16,r.args.xMax=null!==(t=r.args.xMax)&&void 0!==t?t:24,r.args.yMax=null!==(e=r.args.yMax)&&void 0!==e?e:24,r.args.type="actor-item actor-rocket",r.args.launched=!1,r}return e=h,(r=[{key:"update",value:function(){this.viewport&&(this.viewport.args.audio&&!this.sample&&(this.sample=new Audio("/Sonic/object-destroyed.wav"),this.sample.volume=.6+-.3*Math.random()),s(l(h.prototype),"update",this).call(this),this.args.launched&&Math.abs(this.args.xSpeed)<Math.abs(this.args.xMax)&&(this.args.xSpeed+=.5*Math.sign(this.args.xMax)),this.args.launched&&Math.abs(this.args.ySpeed)<Math.abs(this.args.yMax)&&(this.args.ySpeed-=.5*Math.sign(this.args.yMax)),this.args.launched&&0===this.args.xSpeed&&0===this.args.ySpeed&&this.explode())}},{key:"activate",value:function(){this.viewport.auras.add(this),this.args.launched=!0,this.args.xMax&&(this.args.xSpeed+=.5),this.args.yMax&&(this.args.ySpeed-=.5)}},{key:"sleep",value:function(){this.args.launched&&this.explode()}},{key:"wakeUp",value:function(){}},{key:"explode",value:function(){var t=this,e=this.viewport;if(e){var r=new o.Tag('<div class = "particle-explosion">');r.style({"--x":this.x,"--y":this.y-8}),e.particles.add(r),setTimeout(function(){return e.particles.remove(r)},512),e.args.audio&&this.sample&&this.sample.play(),this.args.launched=!1,this.args.xSpeed=0,this.args.ySpeed=0,this.args.x=this.def.get("x"),this.args.y=this.def.get("y"),this.viewport.setColCell(this),this.onNextFrame(function(){t.args.launched=!1,t.args.xSpeed=0,t.args.ySpeed=0,t.args.x=t.def.get("x"),t.args.y=t.def.get("y"),t.viewport.setColCell(t),t.viewport.auras.delete(t)})}}}])&&a(e.prototype,r),n&&a(e,n),h}();t.Rocket=f}),require.register("actor/Rocks.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Rocks=void 0;var i=e("./PointActor"),o=e("../actor/Projectile"),a=e("curvature/base/Tag");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(p,i.PointActor);var e,r,n,h=l(p);function p(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(r=h.call(this,t,e)).args.type="actor-item actor-rocks-tall",r.args.width=48,r.args.height=80,r.gone=!1,r.particleA=new a.Tag('<div class = "particle-rock">'),r.particleB=new a.Tag('<div class = "particle-rock">'),r.particleC=new a.Tag('<div class = "particle-rock">'),r.particleD=new a.Tag('<div class = "particle-rock">'),r.particleE=new a.Tag('<div class = "particle-rock">'),r.particleF=new a.Tag('<div class = "particle-rock">'),r.particleG=new a.Tag('<div class = "particle-rock">'),r.particleH=new a.Tag('<div class = "particle-rock">'),r}return e=p,(r=[{key:"onAttached",value:function(){var t=-1,e=this.particleA,r=this.particleB,n=this.particleC,i=this.particleD,o=this.particleE,a=this.particleF,s=this.particleG,c=this.particleH;e.style({"--x":this.x-8,"--y":this.y-8,"--fallSpeed":1550+20*Math.random(),"--xMomentum":60*t+20*Math.random(),"--yMomentum":40,"z-index":0}),t*=-1,r.style({"--x":this.x+8,"--y":this.y-0,"--fallSpeed":1550+20*Math.random(),"--xMomentum":60*t+20*Math.random(),"--yMomentum":40,"z-index":0}),t*=-1,n.style({"--x":this.x,"--y":this.y-18,"--fallSpeed":1550+20*Math.random(),"--xMomentum":60*t+20*Math.random(),"--yMomentum":44,"z-index":0}),t*=-1,i.style({"--x":this.x+8,"--y":this.y-10,"--fallSpeed":1550+20*Math.random(),"--xMomentum":60*t+20*Math.random(),"--yMomentum":44,"z-index":0}),t*=-1,o.style({"--x":this.x-8,"--y":this.y-28,"--fallSpeed":1550+20*Math.random(),"--xMomentum":60*t+20*Math.random(),"--yMomentum":48,"z-index":0}),t*=-1,a.style({"--x":this.x+8,"--y":this.y-20,"--fallSpeed":1550+20*Math.random(),"--xMomentum":60*t+20*Math.random(),"--yMomentum":48,"z-index":0}),t*=-1,s.style({"--x":this.x-8,"--y":this.y-30,"--fallSpeed":1550+20*Math.random(),"--xMomentum":60*t+20*Math.random(),"--yMomentum":48,"z-index":0}),t*=-1,c.style({"--x":this.x+8,"--y":this.y-30,"--fallSpeed":1550+20*Math.random(),"--xMomentum":60*t+20*Math.random(),"--yMomentum":65,"z-index":0})}},{key:"update",value:function(){c(f(p.prototype),"update",this).call(this),this.viewport&&this.viewport.args.audio&&!this.sample&&(this.sample=new Audio("/Sonic/rock-smash.wav"),this.sample.volume=.3+-.2*Math.random())}},{key:"collideA",value:function(t,e){return!this.public.gone&&(c(f(p.prototype),"collideA",this).call(this,t,e),t.occupant||t.args.rolling||t.punching?(this.pop(t),!1):2!==e&&(!this.args.falling||-1===this.args.float)&&t.args.ySpeed>0&&t.y<this.y&&this.viewport&&!this.public.gone?(this.args.falling&&Math.abs(t.args.ySpeed)>0&&(t.args.xSpeed*=-1),this.pop(t),!1):!((1===e||3===e)&&t instanceof o.Projectile&&this.viewport&&!this.public.gone)||(this.pop(t),!1))}},{key:"collideB",value:function(t){return t.args.falling&&this.public.gone&&(t.args.ySpeed*=-1,t.args.falling=!0),!1}},{key:"pop",value:function(t){this.args.gone=!0;var e=this.viewport;if(e){e.args.audio&&this.sample&&this.sample.play();var r=this.particleA,n=this.particleB,i=this.particleC,o=this.particleD,a=this.particleE,s=this.particleF,c=this.particleG,u=this.particleH;e.particles.add(r),e.particles.add(n),e.particles.add(i),e.particles.add(o),e.particles.add(a),e.particles.add(s),e.particles.add(c),e.particles.add(u),setTimeout(function(){e.particles.remove(r),e.particles.remove(n),e.particles.remove(i),e.particles.remove(o),e.particles.remove(a),e.particles.remove(s),e.particles.remove(c),e.particles.remove(u)},2500),e.actors.remove(this)}}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!0}}])&&s(e.prototype,r),n&&s(e,n),p}();t.Rocks=h}),require.register("actor/Sean.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Sean=void 0;var i=e("./PointActor"),o=(e("curvature/base/Tag"),e("../behavior/SkidDust"));function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).behaviors.add(new o.SkidDust),t.args.type="actor-item actor-sean",t.args.normalHeight=35,t.args.rollingHeight=28,t.args.accel=.25,t.args.decel=.4,t.args.gSpeedMax=18,t.args.jumpForce=11,t.args.gravity=.5,t.args.width=10,t.args.height=35,t}return e=h,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div")}},{key:"update",value:function(){var t=this.args.falling;if(this.box){if(t)this.args.jumping&&this.box.setAttribute("data-animation","jumping");else{this.yAxis>0?this.args.crouching=!0:this.args.crouching=!1;var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;this.public.rolling?this.box.setAttribute("data-animation","rolling"):Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?this.box.setAttribute("data-animation","standing"):n>.25*i?this.box.setAttribute("data-animation","running"):this.args.moving&&r?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}s(l(h.prototype),"update",this).call(this)}else s(l(h.prototype),"update",this).call(this)}},{key:"solid",get:function(){return!1}},{key:"canRoll",get:function(){return!0}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),h}();t.Sean=f}),require.register("actor/Seymour.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Seymour=void 0;var i=e("./PointActor"),o=(e("curvature/base/Tag"),e("../behavior/SkidDust"));function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.PointActor);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).behaviors.add(new o.SkidDust),t.args.type="actor-item actor-seymour",t.args.normalHeight=44,t.args.rollingHeight=23,t.args.accel=.25,t.args.decel=.4,t.args.gSpeedMax=18,t.args.jumpForce=11,t.args.gravity=.5,t.args.width=18,t.args.height=44,t}return e=h,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div")}},{key:"update",value:function(){var t=this.args.falling;if(this.box){if(t)this.args.jumping&&this.box.setAttribute("data-animation","jumping");else{this.yAxis>0?this.args.crouching=!0:this.args.crouching=!1;var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;this.public.rolling?this.box.setAttribute("data-animation","rolling"):Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?this.box.setAttribute("data-animation","standing"):n>.25*i?this.box.setAttribute("data-animation","running"):this.args.moving&&r?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}s(l(h.prototype),"update",this).call(this)}else s(l(h.prototype),"update",this).call(this)}},{key:"solid",get:function(){return!1}},{key:"canRoll",get:function(){return!0}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),h}();t.Seymour=f}),require.register("actor/Signpost.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Signpost=void 0;var i=e("../ui/CharacterString"),o=e("./PointActor"),a=e("curvature/base/Tag");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(p,o.PointActor);var e,r,n,h=l(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=h.call.apply(h,[this].concat(r))).args.type="actor-item actor-signpost",t.args.width=48,t.args.height=256,t.args.active=!1,t.args.follow=!1,t}return e=p,(r=[{key:"collideA",value:function(t){var e=this;if(t.controllable&&!this.args.active){t.args.rolling=!1,this.viewport.onFrameOut(120,function(){return e.box.setAttribute("data-cleared-by",t.args.name)}),this.viewport.onFrameOut(180,function(){return e.viewport.clearAct("".concat(t.args.name," GOT THROUGH RADICAL CITY ZONE"))}),this.viewport.onFrameOut(540,function(){e.args.charStrings=[],t.args.ignore=0,e.args.follow=!1,e.args.boss}),this.viewport.onFrameOut(600,function(){var r=e.viewport.actorsById[e.args.boss];e.viewport.auras.add(r),r.args.x=e.x+(e.x<125e3?768:-768),r.args.y=e.y-160,t.args.clearSpeed=0});var r=(this.viewport.args.frameId-this.viewport.args.startFrameId)/60,n=String(Math.floor(Math.abs(r)/60)).padStart(2,"0");String(Math.trunc(Math.abs(r)%60)).padStart(2,"0");(r<0?"-":"")&&(n=Number(n));var o=60*((t.public.gSpeed||t.public.xSpeed)/32)*3;t.args.clearSpeed=o,this.args.charStrings=[new i.CharacterString({value:"Speed: ".concat(o.toFixed(2)," ft/sec")})],this.args.falling=!0,this.args.active=!0,this.args.follow=!0,this.args.xSpeed=1.1*(t.args.gSpeed||t.args.xSpeed),this.args.ySpeed=-7,this.args.y--,t.args.ignore=-1}}},{key:"update",value:function(){var t=this;if(this.args.follow){var e=Math.max(this.x,this.viewport.controlActor.x+-160);if(e!==this.x){if(!this.args.falling){var r=new a.Tag('<div class = "particle-dust">'),n=this.rotatePoint(this.args.gSpeed,0);r.style({"--x":n[0]+this.x+-4,"--y":n[1]+this.y,"z-index":0,opacity:2*Math.random()}),this.viewport.particles.add(r),this.viewport.onFrameOut(30,function(){return t.viewport.particles.remove(r)})}this.args.x=e}}c(f(p.prototype),"update",this).call(this)}},{key:"rotateLock",get:function(){return!0}}])&&s(e.prototype,r),n&&s(e,n),p}();t.Signpost=h}),require.register("actor/Sonic.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Sonic=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag"),a=e("curvature/base/View"),s=(e("../effects/Twist"),e("../effects/Pinch"),e("../sprite/Png")),c=e("./Ring"),u=e("./Spring"),l=(e("../powerups/FireSheild"),e("../powerups/BubbleSheild"),e("../powerups/ElectricSheild"),e("../region/GrindingRegion")),f=e("../behavior/SkidDust");function h(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function d(t,e,r){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=m(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=m(t);if(e){var o=m(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return v(t)}(this,r)}}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(S,i.PointActor);var r,n,p,w=b(S);function S(){var t,r,n,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,S);for(var o=arguments.length,c=new Array(o),u=0;u<o;u++)c[u]=arguments[u];return t=w.call.apply(w,[this].concat(c)),r=v(t),n="png",i=new s.Png("/Sonic/sonic.png"),n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,t.behaviors.add(new f.SkidDust),t.args.type="actor-sonic actor-item",t.accelNormal=.2,t.accelSuper=.7,t.args.accel=.2,t.args.decel=.45,t.gSpeedMaxNormal=18,t.gSpeedMaxSuper=25,t.jumpForceNormal=11.5,t.jumpForceSuper=16,t.args.gSpeedMax=t.gSpeedMaxNormal,t.args.jumpForce=t.jumpForceNormal,t.args.gravity=.5,t.args.width=16,t.args.height=40,t.args.lookTime=0,t.args.normalHeight=40,t.args.rollingHeight=28,t.sparks=new Set,t.spindashCharge=0,t.dropDashCharge=0,t.willStick=!1,t.stayStuck=!1,t.dashed=!1,t.airControlCard=a.View.from(e("../cards/sonic-air-controls.html")),t.controlCard=a.View.from(e("../cards/sonic-controls.html")),t.moveCard=a.View.from(e("../cards/basic-moves.html")),t.args.spriteSheet=t.spriteSheet="/Sonic/sonic.png",t.sampleRingLoss=new Audio("/Sonic/ring-loss.wav"),t.args.bindTo("falling",function(e){e||(!t.willStick||1!==t.public.mode&&3!==t.public.mode?t.onNextFrame(function(){t.args.wallSticking=!1}):(t.args.wallSticking=!0,t.onNextFrame(function(){t.dashed=!1})))}),t}return r=S,(n=[{key:"onAttached",value:function(t){var e=this;this.superSpriteSheet||this.png.ready.then(function(){var t=e.png.recolor({"8080e0":"e0e080","6060c0":"e0e000","4040a0":"e0e001",202080:"a0a000"});e.superSpriteSheet=t.toUrl()})}},{key:"update",value:function(){var t=this;this.isSuper&&this.viewport.args.frameId%60==0&&(this.args.rings>0?this.args.rings--:(this.isSuper=!1,this.setProfile())),this.public.falling?(this.public.wallSticking&&!this.dashed&&(1===this.public.mode?(this.args.direction=-1,this.args.facing="left"):3===this.public.mode&&(this.args.direction=1,this.args.facing="right"),this.args.animation="wall-dropping",this.args.wallDropping=!0,this.args.groundAngle=0,this.args.ignore=-2),this.args.wallSticking=!1):(this.doubleSpin=this.dashed=!1,this.public.mode%2==0&&(this.args.wallSticking=!1),this.args.wallSticking||(this.willStick=!1)),this.lightDashingCoolDown>0&&this.lightDashingCoolDown--,this.dashTimer>0&&this.dashTimer--;var e=this.public.falling;if(this.public.wallSticking){this.args.animation="wall-stick";var r=2;this.yAxis>0?r=6:this.yAxis<0&&(this.stayStuck=!0,r=0),1===this.public.mode?(this.args.facing="left",this.args.direction=1,Math.abs(this.args.gSpeed)<r?this.args.gSpeed+=1:this.args.gSpeed=r):3===this.public.mode&&(this.args.facing="right",this.args.direction=-1,Math.abs(this.args.gSpeed)<r?this.args.gSpeed-=1:this.args.gSpeed=-r)}else if(this.lightDashing){var n=Math.sign(this.public.xSpeed)||Math.sign(this.public.gSpeed);n<0?this.args.animation="lightdash-back":n>0&&(this.args.animation="lightdash"),e&&(this.args.direction=Math.sign(this.public.xSpeed)||this.args.direction,this.args.mode=0)}else if(e)this.dashed?e&&!this.args.jumping&&this.isSuper&&this.args.ySpeed>0&&(this.args.animation="dropping"):(this.args.height=this.public.rollingHeight,this.public.jumping?this.args.animation="jumping":!this.public.xSpeed&&this.public.ySpeed);else{var i=this.args.direction,a=this.args.gSpeed,s=Math.abs(a),c=this.public.gSpeedMax;this.args.height=this.public.normalHeight,this.spindashCharge?this.args.animation="spindash":this.args.rolling||(Math.sign(i)&&Math.sign(a)&&Math.sign(a)!==Math.sign(i)?this.args.animation="skidding":this.public.moving&&s>.45*c?this.isSuper&&this.public.moving&&s>.95*c?this.args.animation="dash":this.args.animation="running":this.public.moving&&this.public.gSpeed?this.args.animation="walking":this.yAxis>.5?(this.args.animation="crouching",this.args.lookTime--,this.public.lookTime<-45&&(this.args.cameraBias=-.5)):this.yAxis<-.5?(this.args.animation="looking-up",this.args.lookTime++,this.public.lookTime>45&&(this.args.cameraBias=.25)):(this.args.animation="standing",this.args.cameraBias=0,this.args.lookTime=0)),!this.spindashCharge&&this.dashDust&&(this.dashDust.remove(),this.dashDust=null),this.dropDashCharge&&(this.args.animation="spindash")}if(this.public.hangingFrom&&(this.args.animation="hanging"),this.public.rolling&&("spindash"!==this.args.animation?this.args.animation="rolling":(this.viewport.onFrameOut(15,function(){return t.args.animation="rolling"}),this.args.animation="spindash")),!this.skidding||this.public.rolling||this.public.falling||this.spindashCharge)this.spindashCharge||this.twister&&(this.twister.args.scale=0);else{this.args.xOff=8*-this.args.direction,this.args.yOff=32;var u=15*-this.public.gSpeed;Math.abs(u)>120&&(u=120*Math.sign(u)),this.twist(u)}if(this.public.standingOn&&this.public.standingOn.isVehicle&&(this.args.animation="standing"),this.args.grinding&&!this.args.falling){var l=new o.Tag('<div class = "particle-sparks">'),f=new o.Tag('<div class = "envelope-sparks">');f.appendChild(l.node);var p=this.rotatePoint(1.75*-this.public.gSpeed*this.args.direction,8),g=Math.sign(this.args.gSpeed);f.style({"--x":p[0]+this.x,"--y":p[1]+this.y+-3*Math.random,"z-index":0,"animation-delay":.25*-Math.random()+"s","--xMomentum":Math.max(Math.abs(this.args.gSpeed),4)*g,"--flip":g,"--angle":this.realAngle,opacity:2*Math.random()}),f.particle=l,this.viewport.particles.add(f),this.sparks.add(f),this.viewport.onFrameOut(30,function(){t.viewport.particles.remove(f),t.sparks.delete(f)})}if(this.pincherBg?(this.pincherBg.args.scale*=.875,Math.abs(this.pincherBg.args.scale)<.001&&(this.pincherBg.args.scale=0)):this.pinch(0,0),this.twister||this.twist(0),this.args.grinding&&(this.args.rolling=!1,this.args.animation="grinding"),d(m(S.prototype),"update",this).call(this),this.args.grinding&&!this.args.falling){var y,b=h(this.sparks);try{for(b.s();!(y=b.n()).done;){var v=y.value,w=this.rotatePoint(1.75*this.args.direction,8);v.style({opacity:2*Math.random(),"--x":w[0]+this.x,"--y":w[1]+this.y})}}catch(t){b.e(t)}finally{b.f()}}}},{key:"readInput",value:function(){this.lightDashing||d(m(S.prototype),"readInput",this).call(this)}},{key:"airDash",value:function(t){var e=this;if(!(this.dashed||this.public.ignore&&-2!==this.public.ignore)){var r=13*t;this.public.wallSticking&&(this.args.x+=r,r=21*t),this.args.mode=0,this.args.float=2,this.args.rolling=!1,this.args.height=this.public.normalHeight,this.public.xSpeed&&Math.sign(this.public.xSpeed)!==Math.sign(t)&&(r=18*t,this.args.float=6,this.args.xSpeed=0),this.args.falling=!0;var n=this.args.xSpeed+r,i=this.scanForward(r*t,.5);i&&Math.abs(n)>Math.abs(i)&&(r=i*Math.sign(n)),this.args.animation="rolling",this.viewport.onFrameOut(3,function(){return e.args.animation="airdash"}),this.args.xSpeed=n,this.args.ySpeed=0,this.args.gSpeed=0,this.dashTimer=0,this.dashed=!0,this.args.mode=0,this.args.groundAngle=0}}},{key:"command_0",value:function(){this.dropDashCharge=0,!this.public.jumping||this.dashed||this.doubleSpin||(this.doubleSpin=!0,this.args.xOff=0,this.args.yOff=32,this.pinch(-400,50)),d(m(S.prototype),"command_0",this).call(this)}},{key:"command_4",value:function(){this.public.falling&&(this.airDash(-1),this.willStick=2,this.stayStuck=!0)}},{key:"hold_4",value:function(t){(this.public.jumping||this.dashed)&&(this.dropDashCharge=0,this.willStick=2,this.stayStuck=!0),2===this.args.mode&&(this.stayStuck=!1,this.args.falling=!0)}},{key:"release_4",value:function(){var t=this;if(this.onNextFrame(function(){t.willStick=!1,t.stayStuck=!1}),this.public.wallSticking&&!this.dashed){this.args.falling=!0,this.args.ySpeed=0;var e=this.public.mode;this.airDash(1===e?1:-1),this.args.facing=1===e?"left":"right",this.args.mode=0,this.dashed=!0}}},{key:"command_5",value:function(){this.public.falling&&(this.airDash(1),this.willStick=2,this.stayStuck=!0)}},{key:"hold_5",value:function(t){(this.public.jumping||this.dashed&&2!==this.args.mode)&&(this.dropDashCharge=0,this.willStick=2,this.stayStuck=!0),2===this.args.mode&&(this.stayStuck=!1,this.args.falling=!0)}},{key:"release_5",value:function(){var t=this;if(this.onNextFrame(function(){t.willStick=!1,t.stayStuck=!1}),this.public.wallSticking&&!this.dashed){this.args.falling=!0,this.args.ySpeed=0;var e=this.public.mode;this.airDash(1===e?1:-1),this.args.facing=1===e?"left":"right",this.args.mode=0,this.dashed=!0}}},{key:"command_1",value:function(){var t=this;if(this.args.wallSticking&&this.doJump(0),this.args.gSpeed&&!this.args.falling&&!this.args.rolling){this.args.rolling=!0;this.viewport.onFrameOut(20,function e(){var r=[t.args.width/2,t.args.height+4];if(t.getMapSolidAt(t.x-r[0],t.y-r[1]))return t.viewport.onFrameOut(40,e),t.args.gSpeed=4*t.args.direction,void(t.args.rolling=!0);console.log("stand!"),t.args.rolling=!1})}}},{key:"release_1",value:function(){if(this.dropDashCharge=0,this.spindashCharge){var t=this.public.direction,e=this.spindashCharge/40;e>1&&(e=1),this.args.rolling=!0;var r=32*e;Math.sign(t)!==Math.sign(r)?this.args.gSpeed=r*Math.sign(t):this.args.gSpeed+=r*Math.sign(t),this.spindashCharge=0,this.dashDust&&this.dashDust.remove()}}},{key:"hold_1",value:function(t){if(!this.args.ignore)if(this.public.jumping&&this.dropDashCharge<20)this.dropDashCharge++;else if(!this.dropDashCharge)if(this.args.falling||this.willJump||this.public.gSpeed)this.spindashCharge=0;else{this.args.ignore=1;var e=this.spindashCharge/20;if(e>1&&(e=1),0===this.spindashCharge){this.spindashCharge=1;var r=this.viewport,n=new o.Tag('<div class = "particle-spindash-dust">'),i=this.rotatePoint(this.args.gSpeed,0);n.style({"--x":i[0]+this.x,"--y":i[1]+this.y,"--direction":this.public.direction,"--dashCharge":0}),this.public.direction<0?n.setAttribute("data-facing","left"):this.public.direction>0&&n.setAttribute("data-facing","right"),r.particles.add(n.node),this.dashDust=n}else this.dashDust&&this.dashDust.style({"--dashCharge":e});this.viewport.args.frameId%3==0&&this.spindashCharge++,this.args.xOff=5*-this.args.direction,this.args.yOff=32,this.twist(120*e*this.public.direction),this.args.animation="spindash",this.public.direction<0?this.args.facing="left":this.public.direction>0&&(this.args.facing="right")}}},{key:"hold_2",value:function(){if(this.public.falling&&!(this.lightDashing||this.lightDashingCoolDown>0)){var t=this.findDashableRing(48);t&&(this.lightDash(t),this.lightDashingCoolDown=9)}}},{key:"command_3",value:function(){var t=this;this.isSuper=!this.isSuper,this.onTimeout(150,function(){0===t.args.rings&&(t.isSuper=!1,t.setProfile())}),this.setProfile()}},{key:"setProfile",value:function(){this.isSuper?(this.args.spriteSheet=this.superSpriteSheet,this.args.gSpeedMax=this.gSpeedMaxSuper,this.args.jumpForce=this.jumpForceSuper,this.args.accel=this.accelSuper):(this.args.spriteSheet=this.spriteSheet,this.args.gSpeedMax=this.gSpeedMaxNormal,this.args.jumpForce=this.jumpForceNormal,this.args.accel=this.accelNormal)}},{key:"findNearestRing",value:function(){return this.findDashableRing(64)}},{key:"findDashableRing",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128,r=function(e){if(!(e instanceof c.Ring))return!1;var r=Math.sign(t.public.xSpeed);return!(r>0&&e.x<t.x)&&!(r<0&&e.x>t.x)},n=this.findNearestActor(r,e);if(n){var i=n.findNearestActor(r,e);if(i){var o=Math.atan2(this.y-n.y,this.x-n.x),a=Math.atan2(n.y-i.y,n.x-i.x);if(!(Math.abs(o-a)>Math.PI/2))return n}}}},{key:"lightDash",value:function(t){if(!this.public.falling)return this.lightDashing=!1,!1;var e;this.spindashCharge=0;var r=Math.atan2(t.y-this.y,t.x-this.x);e=this.args.groundAngle;var n=Math.abs(e-r),i=4*this.distanceFrom(t)*(Math.PI/2/n);i>55&&(i=55);var o=this.scanForward(i,.5);o&&i>o&&(i=o);Math.sign(this.args.xSpeed)||Math.sign(this.args.gSpeed);this.public.direction<0?this.args.animation="lightdash-back":this.public.direction>0&&(this.args.animation="lightdash");Math.PI;this.args.airAngle=r,this.lightDashing=!0,this.args.xSpeed=i*Math.cos(r),this.args.ySpeed=i*Math.sin(r),this.args.gSpeed=0,this.lightDashTimeout()}},{key:"collect",value:function(t){if(d(m(S.prototype),"collect",this).call(this,t),t instanceof c.Ring&&this.lightDashing){var e=this.findNearestActor(function(t){return t instanceof c.Ring},128);e?this.lightDash(e):(this.lightDashing=!1,this.args.float=0)}}},{key:"lightDashTimeout",value:function(){var t=this;this.clearLightDash&&(this.clearTimeout(this.clearLightDash),this.clearLightDash=!1),this.clearLightDash=this.onTimeout(150,function(){t.clearLightDash=!1,t.lightDashing=!1,t.args.float=0})}},{key:"setCameraMode",value:function(){this.args.wallSticking?this.args.cameraMode="aerial":d(m(S.prototype),"setCameraMode",this).call(this)}},{key:"startle",value:function(){var t=this;d(m(S.prototype),"startle",this).call(this),this.onNextFrame(function(){return t.args.animation="skidding"})}},{key:"die",value:function(){var t=this;d(m(S.prototype),"die",this).call(this),this.onNextFrame(function(){return t.args.animation="dead"})}},{key:"loseRings",value:function(){d(m(S.prototype),"loseRings",this).call(this),this.viewport.args.audio&&this.sampleRingLoss&&(this.sampleRingLoss.volume=.15+-.05*Math.random(),this.sampleRingLoss.play())}},{key:"collideA",value:function(t){var e=this;t instanceof u.Spring&&this.onNextFrame(function(){return e.args.animation="springdash"})}},{key:"solid",get:function(){return!1}},{key:"canRoll",get:function(){return!this.public.wallSticking}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}},{key:"facePoint",get:function(){return this.public.wallSticking?this.rotatePoint(0,-5):d(m(S.prototype),"facePoint",this)}},{key:"crossRegionBoundary",value:function(t,e){t instanceof l.GrindingRegion&&(e||(this.args.falling?this.args.animation="springdash":this.args.grinding=!1)),d(m(S.prototype),"crossRegionBoundary",this).call(this,t,e)}}])&&g(r.prototype,n),p&&g(r,p),S}();t.Sonic=w}),require.register("actor/Spikes.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Spikes=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t,e,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(f,i.PointActor);var e,r,n,l=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-spikes",t.args.width=r.width||32,t.args.height=32,t}return e=f,n=[{key:"fromDef",value:function(t){var e=c(u(f),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.x=e.originalX=t.x+Math.floor(t.width/2),e}}],(r=[{key:"collideA",value:function(t,e){return 0===e&&t.controllable&&t.damage(),!0}},{key:"solid",get:function(){return!0}},{key:"rotateLock",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Spikes=l}),require.register("actor/Spinner.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Spinner=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,i.PointActor);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.type="actor-item actor-spinner",t.args.width=64,t.args.height=24,t}return e=u,(r=[{key:"update",value:function(){this.sample||(this.sample=new Audio("/Sonic/S2_2B.wav"))}},{key:"collideB",value:function(t){t.args.ignore=4,t.args.direction=1,t.args.facing="right",t.args.gSpeed=t.args.gSpeed>38?t.args.gSpeed:38,this.viewport.args.audio&&this.sample&&(this.sample.currentTime=0,this.sample.volume=.5+Math.random()/2.5,this.sample.play())}}])&&o(e.prototype,r),n&&o(e,n),u}();t.Spinner=u}),require.register("actor/Spring.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Spring=void 0;var i=e("./PointActor"),o=e("../region/Region");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e,r){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=Symbol("WillSpring"),g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(d,i.PointActor);var e,r,n,g=c(d);function d(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return h(u(t=g.call.apply(g,[this].concat(r))),"float",-1),h(u(t),"template",'<div\n\t\tclass = "point-actor actor-item [[type]] [[collType]] [[active]]"\n\t\tstyle = "\n\t\t\tdisplay:[[display]];\n\t\t\t--angle:[[angle]];\n\t\t\t--airAngle:[[airAngle]];\n\t\t\t--ground-angle:[[groundAngle]];\n\t\t\t--height:[[height]];\n\t\t\t--width:[[width]];\n\t\t\t--x:[[x]];\n\t\t\t--y:[[y]];\n\t\t"\n\t\tdata-colliding = "[[colliding]]"\n\t\tdata-falling   = "[[falling]]"\n\t\tdata-facing    = "[[facing]]"\n\t\tdata-angle     = "[[angle|rad2deg]]"\n\t\tdata-mode      = "[[mode]]"\n\t>\n\t\t<div\n\t\t\tdata-color = "[[color]]"\n\t\t\tdata-type  = "[[base]]"\n\t\t\tclass      = "spring-pad"\n\t\t\tstyle = "--color:[[color]]deg"\n\t\t></div>\n\t\t<div class = "sprite"></div>\n\t</div>'),t.args.type="actor-item actor-spring",t.args.width=t.args.width||32,t.args.height=t.args.height||32,t.args.color=t.args.color||0,t.args.static=!0,t}return e=d,n=[{key:"fromDef",value:function(t){var e=l(f(d),"fromDef",this).call(this,t);return e.args.angle=Number(e.args.angle),e.args.width=t.width||32,e.args.height=t.height||32,e}}],(r=[{key:"update",value:function(){l(f(d.prototype),"update",this).call(this),this.viewport&&this.viewport.args.audio&&!this.sample&&(this.sample=new Audio("/Sonic/spring-activated.wav"),this.sample.volume=.05+.1*Math.random())}},{key:"collideA",value:function(t){var e=this;if(t instanceof this.constructor)return!1;if(l(f(d.prototype),"collideA",this).call(this,t),!this.public.active&&!t.args.platform&&!(t instanceof o.Region||(this.args.active="active",this.viewport.args.audio&&this.sample&&(this.sample.currentTime=0,this.sample.volume=.05+.1*Math.random(),this.sample.play()),t[p]||(this.viewport.onFrameOut(5,function(){delete t[p],e.args.active=null}),t.noClip)))){t[p]=!0,t.args.gSpeed=0,t.args.xSpeed=0,t.args.ySpeed=0;var r=this.roundAngle(this.args.angle,8,!0);t.controller&&(t.controller.rumble({duration:120,strongMagnitude:1,weakMagnitude:1}),this.onTimeout(100,function(){t.controller.rumble({duration:500,strongMagnitude:0,weakMagnitude:.25})})),t.args.xSpeed=0,t.args.ySpeed=0,t.args.gSpeed=0,t.args.float=2,t.args.x=this.x+16*Math.cos(r),t.args.y=this.y+16*Math.sin(r),t.args.jumping=!1,t.impulse(this.args.power,r,![0,Math.PI].includes(this.args.angle)),[0,Math.PI].includes(this.args.angle)&&!t.args.falling&&0===t.args.mode||(t.args.falling=!0,t.args.mode=0),t.args.xSpeed=1*Math.cos(r),t.args.ySpeed=1*Math.sin(r),t.args.ignore=1,this.onNextFrame(function(){t.args.groundAngle=0,t.args.falling||(t.args.ignore=8)})}}},{key:"sleep",value:function(){this.args.active=null}},{key:"canStick",get:function(){return!1}},{key:"solid",get:function(){return!1}}])&&a(e.prototype,r),n&&a(e,n),d}();t.Spring=g}),require.register("actor/StarBalloon.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.StarBalloon=void 0;var i=e("./Balloon");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.Balloon);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-balloon actor-star-balloon",t.args.target=t.args.target||0,t}return e=f,(r=[{key:"update",value:function(){if(!this.popped)if(this.launched){var t=this.args.target-this.y;this.args.ySpeed=Math.min(16,Math.abs(t))*Math.sign(t)}else this.args.ySpeed=Math.sin(this.viewport.args.frameId/10)/5;a(u(f.prototype),"update",this).call(this)}},{key:"activate",value:function(){this.launched=!0}},{key:"collideA",value:function(t){return!(!t.controllable||t.args.hangingFrom)&&(!this.popped&&void(t.args.ySpeed>=0&&(t.args.ySpeed=-14,this.pop())))}},{key:"sleep",value:function(){this.tags.sprite.classList.remove("popped"),this.args.x=this.def.get("x"),this.args.y=this.def.get("y"),this.args.xSpeed=0,this.args.ySpeed=0,this.args.float=-1,this.popped=this.launched=!1,this.args.falling=!0,this.viewport.setColCell(this)}},{key:"pop",value:function(){this.tags.sprite.classList.add("popped"),this.popped=!0,this.args.float=1}}])&&o(e.prototype,r),n&&o(e,n),f}();t.StarBalloon=l}),require.register("actor/StarPost.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.StarPost=void 0;e("../ui/CharacterString");var i=e("./PointActor"),o=e("curvature/base/Tag"),a=(e("./Monitor"),e("./monitor/RingMonitor")),s=e("./monitor/SheildElectricMonitor"),c=e("./monitor/SheildWaterMonitor"),u=e("./monitor/SheildFireMonitor");function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e,r){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(y,i.PointActor);var e,r,n,d=p(y);function y(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=d.call.apply(d,[this].concat(r))).args.type="actor-item actor-star-post",t.args.width=16,t.args.height=48,t.args.active=!1,t.args.static=!0,t.spinning=!1,t}return e=y,(r=[{key:"update",value:function(){f(g(y.prototype),"update",this).call(this),this.viewport&&this.viewport.args.audio&&!this.sample&&(this.sample=new Audio("/Sonic/starpost-active.wav"),this.sample.volume=.5+.025*Math.random())}},{key:"onRendered",value:function(){f(g(y.prototype),"onRendered",this).call(this),this.sprite=this.findTag("div.sprite"),this.box=this.findTag("div"),this.headBox=new o.Tag('<div class = "star-post-head-box">'),this.head=new o.Tag('<div class = "star-post-head">'),this.headBox.appendChild(this.head.node),this.box.appendChild(this.headBox.node)}},{key:"collideA",value:function(t){var e=this;if(f(g(y.prototype),"collideA",this).call(this,t),t.args.owner&&(t=t.args.owner),(t.controllable||t.occupant)&&this.box&&!this.args.active){this.args.active=!0,this.box.setAttribute("data-direction",t.args.direction),this.box.setAttribute("data-active","true"),this.box.setAttribute("data-spin","true"),this.viewport.args.audio&&this.sample&&this.sample.play();var r=(t.args.gSpeed||t.args.xSpeed)/2;Math.abs(r)>5&&(r=5*Math.sign(r));var n=t.args.rings>50?[a.RingMonitor,u.SheildFireMonitor,c.SheildWaterMonitor,s.SheildElectricMonitor]:[a.RingMonitor],i=new(0,n[Math.floor(Math.random()*n.length)])({direction:t.args.direction,xSpeed:r,ySpeed:-5,x:this.x-10,y:this.y-48});this.viewport.storeCheckpoint(t.args.id,this.args.id),this.viewport.spawn.add({object:i}),this.spinning=!0,this.viewport.onFrameOut(36,function(){e.spinning=!1})}}},{key:"solid",get:function(){return!1}}])&&l(e.prototype,r),n&&l(e,n),y}();t.StarPost=d}),require.register("actor/SteelCrate.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SteelCrate=void 0;e("./PointActor");var i=e("./Block"),o=e("./BreakableBlock");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,o.BreakableBlock);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-breakable-block actor-steel-crate",t.args.width=64,t.args.height=64,t.args.static=!1,t}return e=h,(r=[{key:"collideA",value:function(t,e){return t instanceof i.Block||(t.args.bouncing&&!this.broken?(this.break(),!0):!(!t.args.rolling||this.broken)||(!(0!==e||!t.controllable)||(1!==e&&3!==e||t.y<=this.y-this.args.height||!!this.viewport&&(-1!==e&&!t.args.rolling||s(l(h.prototype),"collideA",this).call(this,t,e)))))}}])&&a(e.prototype,r),n&&a(e,n),h}();t.SteelCrate=f}),require.register("actor/Stopper.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Stopper=void 0;var i=e("./BreakableBlock");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.BreakableBlock);var e,r,n,l=c(f);function f(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(t=l.call(this,e,r)).args.height=16,t}return e=f,(r=[{key:"collideA",value:function(t,e){var r=this;return!t.args.jumping||0!==e||(this.broken||(t.args.x=this.args.x+6,this.viewport.onFrameOut(3,function(){t.args.ySpeed=3,t.args.x=r.args.x+6,t.args.xSpeed=0,t.args.ySpeed=0,t.args.groundAngle=0,t.args.falling=!0,t.args.animation="rolling",t.args.ignore=30,t.args.float=30,r.viewport.onFrameOut(30,function(){t.args.ySpeed=10})})),a(u(f.prototype),"collideA",this).call(this,t,e))}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Stopper=l}),require.register("actor/SuperRing.js",function(t,e,r){"use strict"}),require.register("actor/Switch.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Switch=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-switch",t.args.width=32,t.args.height=10,t.removeTimer=null,t.args.active=!1,t.activator=null,t.args.bindTo("active",function(e){t.box&&t.box.setAttribute("data-active",e?"true":"false")}),t.ignore=0,t}return e=f,(r=[{key:"update",value:function(){a(u(f.prototype),"update",this).call(this),this.ignore>0?this.ignore--:this.activator&&this.activator.args.standingOn===this||(this.args.active=!1,this.activator=null)}},{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sample=new Audio("/Sonic/switch-activated.wav")}},{key:"collideA",value:function(t,e){var r=this;return this.activator==t?(this.ignore=8,!0):t.public.ySpeed<0?0===t.public.ySpeed&&t.y>this.y:!!(this.public.active&&t.y<this.y)||(t.isEffect||t.isRegion?void 0:(t.onRemove(function(){return r.activator=null}),t.y<=this.y-this.args.height&&(this.public.active||this.activate(t),this.ignore=8,this.args.active=!0,this.activator=t,!0)))}},{key:"activate",value:function(t){if(this.beep(),this.args.destroyLayer){var e=this.args.destroyLayer;this.viewport.args.layers[e].args.destroyed=!0,console.log("destroyLayer")}if(this.args.water){var r,n,i=this.viewport.actorsById[this.args.water],o=this.viewport.objDefs.get(this.args.setPoint);i.target=Number(i.y||0)-Number(o.y||0),i.args.fillSpeed=null!==(r=this.args.fillSpeed)&&void 0!==r?r:i.args.fillSpeed,i.args.drainSpeed=null!==(n=this.args.drainSpeed)&&void 0!==n?n:i.args.drainSpeed}var a=this.viewport.objDefs.get(this.args.point),s=this.viewport.objectPalette[this.args.spawn];s&&a&&this.viewport.spawn.add({object:new s({x:a.x,y:a.y})}),this.args.active=!0}},{key:"beep",value:function(){this.viewport.args.audio&&this.sample&&this.sample.play()}},{key:"solid",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Switch=l}),require.register("actor/Tails.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Tails=void 0;var i=e("./PointActor"),o=e("curvature/base/Tag"),a=e("../behavior/SkidDust");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(p,i.PointActor);var e,r,n,h=l(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=h.call.apply(h,[this].concat(r))).behaviors.add(new a.SkidDust),t.args.type="actor-item actor-tails",t.args.accel=.25,t.args.decel=.4,t.args.flySpeedMax=25,t.args.gSpeedMax=18,t.args.jumpForce=11,t.args.gravity=.5,t.args.width=15,t.args.height=32,t.args.normalHeight=32,t.args.rollingHeight=23,t.willStick=!1,t.stayStuck=!1,t}return e=p,(r=[{key:"onAttached",value:function(){this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.tails=new o.Tag('<div class = "tails-tails">'),this.sprite.appendChild(this.tails.node),this.flyingSound=new Audio("/Sonic/tails-flying.wav"),this.flyingSound.volume=.35+-.3*Math.random(),this.flyingSound.loop=!0}},{key:"update",value:function(){var t=this.args.falling;if(this.viewport.args.audio&&this.flyingSound&&(this.flyingSound.paused||(this.flyingSound.volume=.35+-.3*Math.random()),this.flyingSound.currentTime>.2&&(this.flyingSound.currentTime=0)),this.box){if(this.public.tailFlyCoolDown>0&&this.args.tailFlyCoolDown--,this.public.tailFlyCoolDown<0&&this.args.tailFlyCoolDown++,0===this.args.tailFlyCoolDown&&(this.flyingSound.pause(),this.args.flying=!1),t)this.args.flying?this.yAxis>0?(this.box.setAttribute("data-animation","jumping"),this.args.ySpeed=this.args.ySpeed>this.args.jumpForce?this.args.ySpeed:this.args.jumpForce):this.box.setAttribute("data-animation","flying"):this.public.jumping&&(this.flyingSound.pause(),this.box.setAttribute("data-animation","jumping"));else{this.args.tailFlyCoolDown=0,this.flyingSound.pause();var e=this.args.direction,r=this.args.gSpeed,n=Math.abs(r),i=this.args.gSpeedMax;this.public.rolling?this.box.setAttribute("data-animation","rolling"):Math.sign(this.args.gSpeed)!==e&&Math.abs(this.args.gSpeed-e)>5?this.box.setAttribute("data-animation","skidding"):n>i/2?this.box.setAttribute("data-animation","running"):this.args.moving&&this.args.gSpeed?this.box.setAttribute("data-animation","walking"):this.box.setAttribute("data-animation","standing")}c(f(p.prototype),"update",this).call(this)}else c(f(p.prototype),"update",this).call(this)}},{key:"command_0",value:function(t){c(f(p.prototype),"command_0",this).call(this,t),this.public.falling?0!==this.args.tailFlyCoolDown?(this.public.ySpeed>0&&(this.args.ySpeed=0),this.args.tailFlyCoolDown=80,this.args.flying=!0,this.flyingSound.volume=.35+-.3*Math.random(),this.viewport.args.audio&&this.flyingSound.paused&&this.flyingSound.play()):this.args.tailFlyCoolDown=80:this.args.tailFlyCoolDown=-80}},{key:"hold_0",value:function(t){this.public.flying?(this.args.ySpeed>0&&(this.args.ySpeed=0),Math.random()>.8&&(this.flyingSound.volume=.35+-.3*Math.random()),this.args.tailFlyCoolDown=80,this.args.ySpeed-=Math.min(3,t.time/9),this.args.ySpeed=Math.max(-5,this.args.ySpeed)):this.args.flying=!0}},{key:"sleep",value:function(){this.flyingSound&&this.flyingSound.pause()}},{key:"solid",get:function(){return!1}},{key:"canRoll",get:function(){return!0}},{key:"canFly",get:function(){return!0}},{key:"isEffect",get:function(){return!1}},{key:"controllable",get:function(){return!0}}])&&s(e.prototype,r),n&&s(e,n),p}();t.Tails=h}),require.register("actor/TextActor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TextActor=void 0;var i=e("./PointActor"),o=e("../ui/CharacterString");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(t,e){var r,n,i,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),r=l.call(this,t,e),n=u(r),a=-1,(i="float")in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,r.args.type="actor-item actor-text-actor",r.args.float=-1,r.text=new o.CharacterString({value:""}),r.args.x=t.x-48,r.args.bindTo("content",function(t){r.text.args.value=t,r.args.width=18*t.length,r.args.height=18}),r}return e=f,(r=[{key:"onAttached",value:function(){this.sprite=this.findTag("div.sprite"),this.text.render(this.sprite)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),f}();t.TextActor=f}),require.register("actor/Tornado.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Tornado=void 0;var i=e("./Vehicle"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.Vehicle);var e,r,n,f=u(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=f.call.apply(f,[this].concat(r))).args.type="actor-item actor-tornado",t.args.width=96,t.args.height=48,t.removeTimer=null,t.args.xSpeedMaxThrusting=64,t.args.xSpeedMaxOriginal=32,t.args.xSpeedMax=t.args.xSpeedMaxOriginal,t.args.gSpeedMax=5,t.args.decel=.15,t.args.accel=.5,t.args.seatHeight=14,t.args.seatForward=-32,t.args.skidTraction=.95,t.dustCount=0,t.args.flyAngle=-.25,t.args.particleScale=2,t.args.float=-1,t.args.thrusting=!1,t.args.landingGear=!0,t.args.jumpForce=8,t.args.fuelLevel=100,t.args.thrusterFill=0,t.args.noThrust=0,t}return e=h,(r=[{key:"onAttached",value:function(){var t=this;this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.plane=new o.Tag('<div class = "plane">'),this.fuselage=new o.Tag('<div class = "fuselage">'),this.propeller=new o.Tag('<div class = "propeller">'),this.thruster=new o.Tag('<div class = "thruster">'),this.fuelMeter=new o.Tag('<div class = "fuel-meter">'),this.frontGear=new o.Tag('<div class = "front-landing-gear">'),this.rearGear=new o.Tag('<div class = "rear-landing-gear">'),this.sprite.appendChild(this.plane.node),this.thruster.appendChild(this.fuelMeter.node),this.plane.appendChild(this.thruster.node),this.plane.appendChild(this.propeller.node),this.plane.appendChild(this.frontGear.node),this.plane.appendChild(this.rearGear.node),this.plane.appendChild(this.fuselage.node),this.args.bindTo("landingGear",function(e){t.plane&&t.plane.setAttribute("data-landing-gear",e)}),this.args.bindTo("thrusting",function(e){t.plane&&t.plane.setAttribute("data-thrusting",e)})}},{key:"update",value:function(){if(this.occupant&&this.args.falling||(this.args.flyAngle=this.args.falling?.26:-.26,this.args.flying=!1,this.args.float=0),!this.args.thrusting&&Math.abs(this.args.xSpeed)<8?(this.args.float=0,this.args.flying=!1):this.args.falling&&(this.args.float=-1,this.args.flying=!0),!this.args.jumping&&0===this.args.xSpeed&&this.args.falling)return this.args.flying=!1,this.args.float=0,this.args.thrusting&&(this.args.crashed=!0,this.args.thrusting=!1,this.args.noThrust=Date.now()+500),void s(l(h.prototype),"update",this).call(this);var t=this.args.xSpeedMaxThrusting;if(this.args.thrusting&&this.args.fuelLevel<=0&&(this.args.thrusting=!1,this.args.noThrust=Date.now()+500,this.args.thrusterFill=Date.now()+500),this.args.thrusting?(this.args.xSpeedMax=this.args.xSpeedMaxThrusting,this.args.fuelLevel>0&&(this.args.fuelLevel-=.1)):(this.args.xSpeedMax=this.args.xSpeedMaxOriginal,this.args.thrusterFill<Date.now()&&this.args.fuelLevel<100&&(this.args.fuelLevel+=.25)),this.fuelMeter.style({"--fuelLevel":this.args.fuelLevel/100}),!this.args.thrusting&&Math.abs(this.args.xSpeed)>t&&(this.args.xSpeed-=.2*Math.sign(this.args.xSpeed)),this.args.thrusting&&(Math.sign(this.args.xSpeed)!==this.args.direction||Math.abs(this.args.xSpeed)<t)&&(this.args.falling||0!==this.args.xSpeed||(this.args.flyAngle=-.26,this.args.falling=!0,this.args.flying=!0,this.args.ySpeed=-5),this.args.xSpeed+=4*Math.sign(this.args.direction)),Math.abs(this.args.xSpeed)>this.args.xSpeedMax/2&&!this.args.thrusting&&!this.xAxis&&(this.args.xSpeed*=.95),Math.abs(this.args.xSpeed)>t&&(this.args.xSpeed=t*Math.sign(this.args.direction)),this.args.flying){if(0===this.args.ySpeed&&(this.args.flyAngle=0),this.args.landingGear?!this.args.thrusting&&this.args.flyAngle<Math.PI/4?this.args.flyAngle+=.005:this.args.thrusting&&this.args.flyAngle>-Math.PI/4&&(this.args.flyAngle-=.005):Math.abs(this.args.flyAngle)>.00125?this.args.flyAngle-=.00125*Math.sign(this.args.flyAngle):this.args.flyAngle=0,!this.args.xSpeed)return void(this.args.flying=!1);var e=this.args.flyAngle+.035*Math.sign(this.yAxis);if(this.args.flyAngle>0?this.args.xSpeed*=1.025:this.args.flyAngle>0&&(this.args.xSpeed/=1.025),this.yAxis&&Math.abs(e)<Math.PI/2&&(this.args.flyAngle=e),Math.sign(this.args.xSpeed)===this.args.direction){var r=this.args.xSpeed||this.args.gSpeed;this.args.ySpeed=Math.sin(this.args.flyAngle)*r*(this.args.direction||Math.sign(r))*2}}else!this.args.thrusting&&this.args.flyAngle<Math.PI/2&&this.args.ySpeed>0&&(this.args.flyAngle+=.025);this.args.flying&&(this.args.airAngle=this.args.flyAngle,this.args.jumping=!1),this.args.falling||(this.args.landingGear=!0,this.args.flyAngle=-.26),s(l(h.prototype),"update",this).call(this),this.args.flying&&(this.args.cameraMode="airplane")}},{key:"command_1",value:function(){this.args.falling&&(this.args.landingGear=!this.args.landingGear)}},{key:"hold_2",value:function(){!this.args.thrusting&&this.args.fuelLevel<=1||this.args.fuelLevel<=0||(this.args.crashed||this.args.noThrust>Date.now()?this.args.false=!0:this.args.thrusting=!0)}},{key:"release_2",value:function(){this.args.thrusting=!1,this.args.crashed=!1}},{key:"solid",get:function(){return!this.occupant}}])&&a(e.prototype,r),n&&a(e,n),h}();t.Tornado=f}),require.register("actor/UnbreakableCrate.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.UnbreakableCrate=void 0;e("./PointActor");var i=e("./Block");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.Block);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-unbreakable-crate",t.args.width=64,t.args.height=64,t.args.static=!1,t}return e=f,(r=[{key:"update",value:function(){this.args.gate&&(this.viewport.actorsById[this.args.gate].args.hitPoints||this.viewport.actors.remove(this));a(u(f.prototype),"update",this).call(this)}},{key:"collideA",value:function(t,e){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.UnbreakableCrate=l}),require.register("actor/Vehicle.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Vehicle=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.PointActor);var e,r,n,l=c(f);function f(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),l.apply(this,arguments)}return e=f,(r=[{key:"update",value:function(){this.occupant&&(this.running=this.occupant.running,this.crawling=this.occupant.crawling),a(u(f.prototype),"update",this).call(this)}},{key:"collideA",value:function(t,e){return t.controllable?t.args.ySpeed>0:!(t.y>=this.y)&&(t.args.float||(t.args.ySpeed=-t.args.ySpeed,t.args.xSpeed=t.args.xSpeed||5*t.args.direction,t.args.ySpeed>-5&&(t.args.ySpeed=-5)),!1)}},{key:"standBelow",value:function(t){t.controllable||(t.args.ySpeed=-t.args.ySpeed,t.args.xSpeed=t.args.xSpeed||5*t.args.direction,t.args.ySpeed>-5&&(t.args.ySpeed=-5))}},{key:"isVehicle",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Vehicle=l}),require.register("actor/WaterFall.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WaterFall=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e,r){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(h,i.PointActor);var e,r,n,f=s(h);function h(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=f.call.apply(f,[this].concat(o)),e=c(t),n=-1,(r="float")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.width=t.public.width||32,t.args.height=t.public.height||64,t.args.type="actor-item actor-water-fall",t.args.active=!1,t}return e=h,n=[{key:"fromDef",value:function(t){var e=u(l(h),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.height=t.height,e.args.toHeight=t.toHeight||0,e.args.x=t.x+32,e.args.yOriginal=t.y,e}}],(r=[{key:"onAttached",value:function(){var t=this;this.switch=this.viewport.actorsById[this.public.switch],this.switch.args.bindTo("active",function(e){e&&!t.args.active&&(t.args.active=!0,t.onNextFrame(function(){t.args.toHeight=t.args.openHeight,t.args.y-=t.args.openOffset}))})}},{key:"update",value:function(){if(u(l(h.prototype),"update",this).call(this),this.args.toHeight!==this.args.height){var t=this.args.toHeight-this.args.height,e=8*Math.sign(t);t<e&&(this.args.height=this.args.toHeight,this.args.y=this.public.yOriginal+this.args.toHeight),this.args.height+=e,this.args.y+=e}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),h}();t.WaterFall=f}),require.register("actor/WaterJet.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WaterJet=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e,r){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(h,i.PointActor);var e,r,n,f=s(h);function h(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=f.call.apply(f,[this].concat(o)),e=c(t),n=-1,(r="float")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.width=t.public.width||32,t.args.height=t.public.height||64,t.args.type="actor-item actor-water-jet",t}return e=h,n=[{key:"fromDef",value:function(t){var e=u(l(h),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.height=t.height,e.args.x=t.x+t.width/2,e}}],(r=[{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}},{key:"isGhost",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),h}();t.WaterJet=f}),require.register("actor/Window.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Window=void 0;var i=e("./PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(l,i.PointActor);var e,r,n,u=s(l);function l(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=u.call.apply(u,[this].concat(o)),e=c(t),n=-1,(r="float")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="actor-item actor-window",t.args.width=64,t.args.height=160,t}return e=l,(r=[{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),l}();t.Window=l}),require.register("actor/WoodenCrate.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WoodenCrate=void 0;e("./PointActor");var i=e("./BreakableBlock");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.BreakableBlock);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="actor-item actor-breakable-block actor-wooden-crate",t.args.width=60,t.args.height=60,t.args.static=!1,t}return e=f,(r=[{key:"collideA",value:function(t,e){return!(0!==e||!t.controllable)||(t.spindashCharge?(this.break(),!0):-1!==e||t.args.gSpeed||t.args.falling||!t.controllable?1!==e&&3!==e||t.y<=this.y-this.args.height||(t.args.rolling?(this.break(),!1):!!this.viewport&&(-1!==e&&!t.args.rolling||a(u(f.prototype),"collideA",this).call(this,t,e))):(this.break(),!1))}}])&&o(e.prototype,r),n&&o(e,n),f}();t.WoodenCrate=l}),require.register("actor/monitor/RingMonitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RingMonitor=void 0;var i=e("../Monitor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.Monitor);var e,r,n,l=c(f);function f(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),l.apply(this,arguments)}return e=f,(r=[{key:"onRendered",value:function(t){a(u(f.prototype),"onRendered",this).call(this,t),this.box.attr({"data-monitor":"ring"}),this.ringSample=new Audio("/Sonic/ring-collect.wav"),this.ringSample.volume=.1+-.05*Math.random()}},{key:"effect",value:function(t){t.args.rings+=10,this.ringSample&&this.ringSample.play()}}])&&o(e.prototype,r),n&&o(e,n),f}();t.RingMonitor=l}),require.register("actor/monitor/SheildElectricMonitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SheildElectricMonitor=void 0;var i=e("../Monitor"),o=e("../../powerups/ElectricSheild");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.Monitor);var e,r,n,f=u(h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),f.apply(this,arguments)}return e=h,(r=[{key:"onRendered",value:function(t){s(l(h.prototype),"onRendered",this).call(this,t),this.box.attr({"data-monitor":"sheild-electric"})}},{key:"effect",value:function(t){if(t.controllable){var e=new o.ElectricSheild;t.inventory.add(e)}}}])&&a(e.prototype,r),n&&a(e,n),h}();t.SheildElectricMonitor=f}),require.register("actor/monitor/SheildFireMonitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SheildFireMonitor=void 0;var i=e("../Monitor"),o=e("../../powerups/FireSheild");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.Monitor);var e,r,n,f=u(h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),f.apply(this,arguments)}return e=h,(r=[{key:"onRendered",value:function(t){s(l(h.prototype),"onRendered",this).call(this,t),this.box.attr({"data-monitor":"sheild-fire"})}},{key:"effect",value:function(t){if(t.controllable){var e=new o.FireSheild;t.inventory.add(e)}}}])&&a(e.prototype,r),n&&a(e,n),h}();t.SheildFireMonitor=f}),require.register("actor/monitor/SheildStarMonitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SheildStarMonitor=void 0;var i=e("../Monitor"),o=e("../../powerups/StarSheild");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.Monitor);var e,r,n,f=u(h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),f.apply(this,arguments)}return e=h,(r=[{key:"onRendered",value:function(t){s(l(h.prototype),"onRendered",this).call(this,t),this.box.attr({"data-monitor":"sheild-star"})}},{key:"effect",value:function(t){if(t.controllable){var e=new o.StarSheild;t.inventory.add(e)}}}])&&a(e.prototype,r),n&&a(e,n),h}();t.SheildStarMonitor=f}),require.register("actor/monitor/SheildWaterMonitor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SheildWaterMonitor=void 0;var i=e("../Monitor"),o=e("../../powerups/BubbleSheild");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,i.Monitor);var e,r,n,f=u(h);function h(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),f.apply(this,arguments)}return e=h,(r=[{key:"onRendered",value:function(t){s(l(h.prototype),"onRendered",this).call(this,t),this.box.attr({"data-monitor":"sheild-water"})}},{key:"effect",value:function(t){if(t.controllable){var e=new o.BubbleSheild;t.inventory.add(e)}}}])&&a(e.prototype,r),n&&a(e,n),h}();t.SheildWaterMonitor=f}),require.register("backdrop/Backdrop.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Backdrop=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(f,i.View);var e,r,n,u=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return l(c(t=u.call.apply(u,[this].concat(r))),"template",'<div class = "backdrop [[name]]">\n\t\t<div cv-ref = "backdrop" class = "parallax"></div>\n\t</div>'),l(c(t),"layers",[]),l(c(t),"urls",[]),l(c(t),"stacked",0),t}return e=f,(r=[{key:"onAttached",value:function(t){var e=this;if(!this.alreadyAttached){this.alreadyAttached=!0;var r=this.tags.backdrop,n=this.args.strips.reverse(),i=[],o=[],a=[],s=0;for(var c in n){var u=n[c];i.push("calc(100% - calc(1px * ".concat(s,"))"));var f="0px";u.parallax&&(f="calc(".concat(f," + calc(1px * calc(").concat(u.parallax," * var(--x))))")),u.autoscroll&&(f="calc(".concat(f," + calc(1px * calc(").concat(u.autoscroll," * var(--frame) )) )")),o.push(f),a.push(n[c].url),s+=n[c].height-1}this.urls=a,this.stacked=s;var h=o.join(", "),p=i.join(", "),g=this.urls.map(function(t){return"url(".concat(t,")")}).join(", ");r.style({"background-position-y":p,"background-position-x":h,"background-repeat":"repeat-x","background-image":g,"--x":this.args.x,"--y":this.args.y}),this.args.bindTo(["x","y","xMax","yMax","frame","stacked","top","bottom"],function(t,e){return r.style(l({},"--".concat(e),t))}),this.args.bindTo("frame",function(t,r){for(var n in e.args.strips){var i=e.args.strips[n];i.frames&&0==i.timeout--&&(i.timeout=i.interval,i.frame++,i.frame>=i.frames.length&&(i.frame=0),e.urls[n]=i.frames[i.frame],e.refreshLayers())}})}}},{key:"refreshLayers",value:function(){this.tags.backdrop.style({"background-image":this.urls.map(function(t){return"url(".concat(t,")")}).join(", ")})}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Backdrop=f}),require.register("backdrop/Industrial.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Industrial=void 0;var i=e("./Backdrop");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=s(t);if(e){var o=s(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.Backdrop);var e=a(r);function r(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(i=e.call(this,t,n)).args.name="industrial",i.args.strips=[{autoscroll:.4,parallax:.035,url:"/Sonic/backdrop/labrynth-industrial/0.png",height:24},{autoscroll:.35,parallax:.025,url:"/Sonic/backdrop/labrynth-industrial/1.png",height:24},{autoscroll:.25,parallax:.015,url:"/Sonic/backdrop/labrynth-industrial/0.png",height:24},{autoscroll:.125,parallax:.0125,url:"/Sonic/backdrop/labrynth-industrial/1.png",height:24},{autoscroll:.025,parallax:.01,url:"/Sonic/backdrop/labrynth-industrial/2.png",height:24},{autoscroll:.015,parallax:.0075,url:"/Sonic/backdrop/labrynth-industrial/3.png",height:24},{autoscroll:0,parallax:.04,url:"/Sonic/backdrop/labrynth-industrial/4-dist.png",height:70},{autoscroll:0,parallax:.05,url:"/Sonic/backdrop/labrynth-industrial/4.png",height:0},{autoscroll:0,parallax:.05,url:"/Sonic/backdrop/labrynth-industrial/flame-0.png",height:1,interval:1,timeout:0,frame:0,frames:["/Sonic/backdrop/labrynth-industrial/flame-0a.png","/Sonic/backdrop/labrynth-industrial/flame-1.png","/Sonic/backdrop/labrynth-industrial/flame-1.png","/Sonic/backdrop/labrynth-industrial/flame-2.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-2.png","/Sonic/backdrop/labrynth-industrial/flame-2.png","/Sonic/backdrop/labrynth-industrial/flame-2.png","/Sonic/backdrop/labrynth-industrial/flame-3.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-3.png","/Sonic/backdrop/labrynth-industrial/flame-3.png","/Sonic/backdrop/labrynth-industrial/flame-4.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-4.png","/Sonic/backdrop/labrynth-industrial/flame-5.png","/Sonic/backdrop/labrynth-industrial/flame-6.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-6.png","/Sonic/backdrop/labrynth-industrial/flame-6.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png","/Sonic/backdrop/labrynth-industrial/flame-0.png"]},{autoscroll:0,parallax:.125,url:"/Sonic/backdrop/labrynth-industrial/5-bw-small.png",height:10},{autoscroll:0,parallax:.15,url:"/Sonic/backdrop/labrynth-industrial/5-bw-small.png",height:10},{autoscroll:0,parallax:.275,url:"/Sonic/backdrop/labrynth-industrial/5-dim.png",height:50},{autoscroll:0,parallax:.275,url:"/Sonic/backdrop/labrynth-industrial/5-pink-lights.png",height:1,interval:20,timeout:0,frame:0,frames:["/Sonic/backdrop/labrynth-industrial/5-lights-0.png","/Sonic/backdrop/labrynth-industrial/5-lights-0.png","/Sonic/backdrop/labrynth-industrial/5-lights-1.png","/Sonic/backdrop/labrynth-industrial/5-lights-1.png","/Sonic/backdrop/labrynth-industrial/5-lights-2.png","/Sonic/backdrop/labrynth-industrial/5-lights-2.png"]},{autoscroll:0,parallax:.275,url:"/Sonic/backdrop/labrynth-industrial/5-signals-0.png",height:1,interval:10,timeout:0,frame:0,frames:["/Sonic/backdrop/labrynth-industrial/5-signals-0.png","/Sonic/backdrop/labrynth-industrial/5-signals-1.png","/Sonic/backdrop/labrynth-industrial/5-signals-1.png","/Sonic/backdrop/labrynth-industrial/5-signals-1.png","/Sonic/backdrop/labrynth-industrial/5-signals-1.png","/Sonic/backdrop/labrynth-industrial/5-signals-0.png","/Sonic/backdrop/labrynth-industrial/5-signals-2.png","/Sonic/backdrop/labrynth-industrial/5-signals-2.png","/Sonic/backdrop/labrynth-industrial/5-signals-2.png","/Sonic/backdrop/labrynth-industrial/5-signals-2.png"]},{autoscroll:0,parallax:.35,url:"/Sonic/backdrop/labrynth-industrial/5.png",height:40},{autoscroll:0,parallax:.35,url:"/Sonic/backdrop/labrynth-industrial/5-pink-lights.png",height:1},{autoscroll:0,parallax:.35,url:"/Sonic/backdrop/labrynth-industrial/5-signals-0.png",height:1,interval:20,timeout:0,frame:0,frames:["/Sonic/backdrop/labrynth-industrial/5-signals-0.png","/Sonic/backdrop/labrynth-industrial/5-signals-2.png","/Sonic/backdrop/labrynth-industrial/5-signals-2.png","/Sonic/backdrop/labrynth-industrial/5-signals-2.png","/Sonic/backdrop/labrynth-industrial/5-signals-2.png","/Sonic/backdrop/labrynth-industrial/5-signals-0.png","/Sonic/backdrop/labrynth-industrial/5-signals-1.png","/Sonic/backdrop/labrynth-industrial/5-signals-1.png","/Sonic/backdrop/labrynth-industrial/5-signals-1.png","/Sonic/backdrop/labrynth-industrial/5-signals-1.png"]},{autoscroll:0,parallax:.4,url:"/Sonic/backdrop/labrynth-industrial/6-half.png",height:88}],i}return r}();t.Industrial=c}),require.register("backdrop/MarbleGarden.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MarbleGarden=void 0;var i=e("./Backdrop");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=s(t);if(e){var o=s(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.Backdrop);var e=a(r);function r(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(i=e.call(this,t,n)).args.name="marble-garden",i.args.strips=[{autoscroll:-1.25,parallax:.015,url:"/Sonic/backdrop/marble-garden/0.png",height:32},{autoscroll:-1,parallax:.015,url:"/Sonic/backdrop/marble-garden/1.png",height:24},{autoscroll:-.9,parallax:.015,url:"/Sonic/backdrop/marble-garden/2.png",height:8},{autoscroll:-.8,parallax:.015,url:"/Sonic/backdrop/marble-garden/3.png",height:24},{autoscroll:-.7,parallax:.015,url:"/Sonic/backdrop/marble-garden/4.png",height:8},{autoscroll:-.6,parallax:.0125,url:"/Sonic/backdrop/marble-garden/5.png",height:24},{autoscroll:-.5,parallax:.0125,url:"/Sonic/backdrop/marble-garden/6.png",height:16},{autoscroll:-.45,parallax:.0125,url:"/Sonic/backdrop/marble-garden/7.png",height:8},{autoscroll:-.45,parallax:.0125,url:"/Sonic/backdrop/marble-garden/8.png",height:16},{autoscroll:-.4,parallax:.0125,url:"/Sonic/backdrop/marble-garden/9.png",height:8},{autoscroll:-.35,parallax:.0125,url:"/Sonic/backdrop/marble-garden/10.png",height:16},{autoscroll:-.3,parallax:.01,url:"/Sonic/backdrop/marble-garden/11.png",height:8},{autoscroll:-.25,parallax:.0075,url:"/Sonic/backdrop/marble-garden/12.png",height:8},{autoscroll:-.2,parallax:.0075,url:"/Sonic/backdrop/marble-garden/13.png",height:8},{autoscroll:-.15,parallax:.01,url:"/Sonic/backdrop/marble-garden/14.png",height:8},{autoscroll:-.1,parallax:.01,url:"/Sonic/backdrop/marble-garden/15.png",height:5},{autoscroll:0,parallax:.1,url:"/Sonic/backdrop/marble-garden/16.png",height:30},{autoscroll:0,parallax:.125,url:"/Sonic/backdrop/marble-garden/17.png",height:12},{autoscroll:0,parallax:.125,url:"/Sonic/backdrop/marble-garden/18.png",height:6},{autoscroll:0,parallax:.15,url:"/Sonic/backdrop/marble-garden/19.png",height:6},{autoscroll:0,parallax:.175,url:"/Sonic/backdrop/marble-garden/20.png",height:8},{autoscroll:0,parallax:.2,url:"/Sonic/backdrop/marble-garden/21.png",height:8},{autoscroll:0,parallax:.225,url:"/Sonic/backdrop/marble-garden/22.png",height:24},{autoscroll:0,parallax:.25,url:"/Sonic/backdrop/marble-garden/23.png",height:344}],i}return r}();t.MarbleGarden=c}),require.register("backdrop/MysticCave.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MysticCave=void 0;var i=e("./Backdrop");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=s(t);if(e){var o=s(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.Backdrop);var e=a(r);function r(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(i=e.call(this,t,n)).args.name="mystic-cave",i.args.strips=[{autoscroll:0,parallax:.11,url:"/Sonic/backdrop/mystic-cave/1.png",height:37},{autoscroll:0,parallax:.12,url:"/Sonic/backdrop/mystic-cave/2.png",height:23},{autoscroll:0,parallax:.13,url:"/Sonic/backdrop/mystic-cave/3.png",height:18},{autoscroll:0,parallax:.14,url:"/Sonic/backdrop/mystic-cave/4.png",height:7},{autoscroll:0,parallax:.15,url:"/Sonic/backdrop/mystic-cave/5.png",height:6},{autoscroll:0,parallax:.16,url:"/Sonic/backdrop/mystic-cave/6.png",height:1},{autoscroll:0,parallax:.18,url:"/Sonic/backdrop/mystic-cave/7.png",height:1},{autoscroll:0,parallax:.2,url:"/Sonic/backdrop/mystic-cave/8.png",height:1},{autoscroll:0,parallax:.22,url:"/Sonic/backdrop/mystic-cave/9.png",height:1},{autoscroll:0,parallax:.21,url:"/Sonic/backdrop/mystic-cave/10.png",height:1},{autoscroll:0,parallax:.2,url:"/Sonic/backdrop/mystic-cave/11.png",height:48},{autoscroll:0,parallax:.19,url:"/Sonic/backdrop/mystic-cave/12.png",height:13},{autoscroll:0,parallax:.18,url:"/Sonic/backdrop/mystic-cave/13.png",height:19},{autoscroll:0,parallax:.17,url:"/Sonic/backdrop/mystic-cave/14.png",height:34},{autoscroll:0,parallax:.16,url:"/Sonic/backdrop/mystic-cave/15.png",height:62},{autoscroll:0,parallax:.15,url:"/Sonic/backdrop/mystic-cave/16.png",height:32},{autoscroll:0,parallax:.14,url:"/Sonic/backdrop/mystic-cave/16.5.png",height:19},{autoscroll:0,parallax:.13,url:"/Sonic/backdrop/mystic-cave/17.png",height:13},{autoscroll:0,parallax:.12,url:"/Sonic/backdrop/mystic-cave/18.png",height:48},{autoscroll:0,parallax:.15,url:"/Sonic/backdrop/mystic-cave/19.png",height:1},{autoscroll:0,parallax:.175,url:"/Sonic/backdrop/mystic-cave/20.png",height:1},{autoscroll:0,parallax:.2,url:"/Sonic/backdrop/mystic-cave/21.png",height:1},{autoscroll:0,parallax:.25,url:"/Sonic/backdrop/mystic-cave/22.png",height:1},{autoscroll:0,parallax:.275,url:"/Sonic/backdrop/mystic-cave/23.png",height:1},{autoscroll:0,parallax:.325,url:"/Sonic/backdrop/mystic-cave/24.png",height:6},{autoscroll:0,parallax:.375,url:"/Sonic/backdrop/mystic-cave/25.png",height:7},{autoscroll:0,parallax:.4,url:"/Sonic/backdrop/mystic-cave/26.png",height:32},{autoscroll:0,parallax:.425,url:"/Sonic/backdrop/mystic-cave/27.png",height:18},{autoscroll:0,parallax:.45,url:"/Sonic/backdrop/mystic-cave/28.png",height:23},{autoscroll:0,parallax:.5,url:"/Sonic/backdrop/mystic-cave/29.png",height:37}],i}return r}();t.MysticCave=c}),require.register("backdrop/ProtoLabrynth.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ProtoLabrynth=void 0;var i=e("./Backdrop");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=s(t);if(e){var o=s(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.Backdrop);var e=a(r);function r(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(i=e.call(this,t,n)).args.name="proto-labrynth",i.args.strips=[{autoscroll:0,parallax:.15,url:"/Sonic/backdrop/protolabrynth/0.png",height:48},{autoscroll:0,parallax:.125,url:"/Sonic/backdrop/protolabrynth/1.png",height:24},{autoscroll:0,parallax:.1,url:"/Sonic/backdrop/protolabrynth/2.png",height:8},{autoscroll:0,parallax:.075,url:"/Sonic/backdrop/protolabrynth/3.png",height:68},{autoscroll:0,parallax:.1,url:"/Sonic/backdrop/protolabrynth/4.png",height:18},{autoscroll:0,parallax:.125,url:"/Sonic/backdrop/protolabrynth/5.png",height:27},{autoscroll:0,parallax:.15,url:"/Sonic/backdrop/protolabrynth/5.png",height:27},{autoscroll:0,parallax:.175,url:"/Sonic/backdrop/protolabrynth/6.png",height:76}],i}return r}();t.ProtoLabrynth=c}),require.register("backdrop/WestSide.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WestSide=void 0;var i=e("./Backdrop");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=s(t);if(e){var o=s(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.Backdrop);var e=a(r);function r(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(i=e.call(this,t,n)).args.name="west-side",i.args.strips=[{autoscroll:0,parallax:.001,url:"/Sonic/backdrop/west-side/stars.png",height:162},{autoscroll:0,parallax:5e-4,url:"/Sonic/backdrop/west-side/island-dark.png",height:27},{autoscroll:0,parallax:5e-4,url:"/Sonic/backdrop/west-side/water.png",height:128},{autoscroll:0,parallax:.001,url:"/Sonic/backdrop/west-side/stars-reflected.png",height:0}],i}return r}();t.WestSide=c}),require.register("behavior/Behavior.js",function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Behavior=void 0;var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,i;return e=t,(r=[{key:"update",value:function(t){}}])&&n(e.prototype,r),i&&n(e,i),t}();t.Behavior=i}),require.register("behavior/SkidDust.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SkidDust=void 0;var i=e("curvature/base/Tag"),o=e("./Behavior");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(l,o.Behavior);var e,r,n,u=c(l);function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=u.call(this)).dustType=t||"particle-dust",e}return e=l,(r=[{key:"update",value:function(t){if(!(t.public.falling||t.public.rolling||t.public.wallSticking||t.public.climbing)){var e=t.public.direction;if(Math.sign(t.public.gSpeed)&&Math.sign(e)&&Math.sign(t.public.gSpeed)!==Math.sign(e)&&!(Math.abs(t.public.gSpeed-e)<5)&&t.skidding){var r=t.viewport;if(r.args.frameId%2==0){var n=new i.Tag('<div class = "'.concat(this.dustType,'">')),o=t.rotatePoint(t.public.gSpeed,0);n.style({"--x":o[0]+t.x,"--y":o[1]+t.y,"z-index":0,opacity:2*Math.random()}),r.particles.add(n),setTimeout(function(){r.particles.remove(n)},350)}}}}}])&&a(e.prototype,r),n&&a(e,n),l}();t.SkidDust=l}),require.register("cards/basic-controls.html",function(t,e,r){r.exports='<div class = "control-card">\n\t<span class = "button-index">\n\t\t<span class = "arrow button arrow-west"></span>\n\t\t/ <span class = "arrow button arrow-east"></span>\n\t\t/ <b>wasd</b>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-x"></span>\n\t\t<span class = "button xb xb-a"></span>\n\t\t<b>space</b>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-o"></span>\n\t\t<span class = "button xb xb-b"></span>\n\t\t<b>ctrl</b>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-s"></span>\n\t\t<span class = "button xb xb-x"></span>\n\t\t<b>shift</b>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-t"></span>\n\t\t<span class = "button xb xb-y"></span>\n\t\t<b>z</b>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-l1"></span>\n\t\t<span class = "button xb xb-lb"></span>\n\t\t<b>q</b>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-r1"></span>\n\t\t<span class = "button xb xb-rb"></span>\n\t\t<b>e</b>\n\t</span>\n</div>\n'}),require.register("cards/basic-moves.html",function(t,e,r){r.exports='<p><b>jump</b> + <b>jump</b> - fly / double jump action</p>\n\n<p><span class = "arrow-button arrow-north"></span> + <b>jump</b> - disengage vehicle</p>\n\n\x3c!-- <p><span class = "arrow-button arrow-south"></span> + <b>jump</b> - spindash</p> --\x3e\n'}),require.register("cards/plane-air-controls.html",function(t,e,r){r.exports='<div class = "control-card">\n\t<span class = "button-index">\n\t\t<span class = "arrow button arrow-west"></span>\n\t\t/ <span class = "arrow button arrow-east"></span>\n\t\t/ <b>wasd</b>\n\t\t- move\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-x"></span>\n\t\t<span class = "button xb xb-a"></span>\n\t\t<b>space</b>\n\t\t- double barrier\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-o"></span>\n\t\t<span class = "button xb xb-b"></span>\n\t\t<b>ctrl</b>\n\t\t- <span>no action</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-s"></span>\n\t\t<span class = "button xb xb-x"></span>\n\t\t<b>shift</b>\n\t\t- <span>light dash</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-t"></span>\n\t\t<span class = "button xb xb-y"></span>\n\t\t<b>z</b>\n\t\t- <span>no action</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-l1"></span>\n\t\t<span class = "button xb xb-lb"></span>\n\t\t<b>q</b>\n\t\t- <span>air dash left</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-r1"></span>\n\t\t<span class = "button xb xb-rb"></span>\n\t\t<b>e</b>\n\t\t- <span>air dash right</span>\n\t</span>\n\n</div>\n'}),require.register("cards/sonic-air-controls.html",function(t,e,r){r.exports='<div class = "control-card">\n\t<span class = "button-index">\n\t\t<span class = "arrow button arrow-west"></span>\n\t\t/ <span class = "arrow button arrow-east"></span>\n\t\t/ <b>wasd</b>\n\t\t- move\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-x"></span>\n\t\t<span class = "button xb xb-a"></span>\n\t\t<b>space</b>\n\t\t- double barrier\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-o"></span>\n\t\t<span class = "button xb xb-b"></span>\n\t\t<b>ctrl</b>\n\t\t- <span>no action</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-s"></span>\n\t\t<span class = "button xb xb-x"></span>\n\t\t<b>shift</b>\n\t\t- <span>light dash</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-t"></span>\n\t\t<span class = "button xb xb-y"></span>\n\t\t<b>z</b>\n\t\t- <span>no action</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-l1"></span>\n\t\t<span class = "button xb xb-lb"></span>\n\t\t<b>q</b>\n\t\t- <span>air dash left</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-r1"></span>\n\t\t<span class = "button xb xb-rb"></span>\n\t\t<b>e</b>\n\t\t- <span>air dash right</span>\n\t</span>\n\n</div>\n'}),require.register("cards/sonic-controls.html",function(t,e,r){r.exports='<div class = "control-card">\n\n\t<span class = "button-index">\n\t\t<span class = "arrow button arrow-west"></span>\n\t\t/ <span class = "arrow button arrow-east"></span>\n\t\t/ <b>wasd</b>\n\t\t- move\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-x"></span>\n\t\t<span class = "button xb xb-a"></span>\n\t\t<b>space</b>\n\t\t- jump\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-o"></span>\n\t\t<span class = "button xb xb-b"></span>\n\t\t<b>ctrl</b>\n\t\t- <span>spindash</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-s"></span>\n\t\t<span class = "button xb xb-x"></span>\n\t\t<b>z</b>\n\t\t- <span>no action</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-t"></span>\n\t\t<span class = "button xb xb-y"></span>\n\t\t<b>x</b>\n\t\t- <span>super</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-l1"></span>\n\t\t<span class = "button xb xb-lb"></span>\n\t\t<b>q</b>\n\t\t- <span>no action</span>\n\t</span>\n\n\t<span class = "button-index">\n\t\t<span class = "button ps ps-r1"></span>\n\t\t<span class = "button xb xb-rb"></span>\n\t\t<b>e</b>\n\t\t- <span>no action</span>\n\t</span>\n\n</div>\n'}),require.register("console/task/Impulse.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Impulse=void 0;var i=e("subspace-console/Task");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(f,i.Task);var e,r,n,u=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return l(c(t=u.call.apply(u,[this].concat(r))),"title","Impulse task"),l(c(t),"prompt",".."),t}return e=f,(r=[{key:"init",value:function(t,e){f.viewport.controlActor.impulse(t,e,!0)}},{key:"write",value:function(t){this.print(t)}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Impulse=f,l(f,"viewport",null),l(f,"helpText","Apply an impulse to the player object."),l(f,"useText","input magnitude angle")}),require.register("console/task/Input.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Input=void 0;var i=e("subspace-console/Task");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(f,i.Task);var e,r,n,u=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return l(c(t=u.call.apply(u,[this].concat(r))),"title","Input task"),l(c(t),"prompt",".."),t}return e=f,(r=[{key:"init",value:function(t){var e,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=function(){};if("a"===t[0]){var a=t.substring(1);this.print("Setting axis ".concat(a," to ").concat(i," for ").concat(n," milliseconds...")),e={axes:l({},a,i)},r=setInterval(function(){u.tilt(a,i),c.readInput()},16),o=function(){u.tilt(a,0),c.readInput(),clearInterval(r)}}if("b"===t[0]){var s=t.substring(1);this.print("Pressing button ".concat(s," for ").concat(n," milliseconds...")),e={buttons:l({},s,1)},r=setInterval(function(){e.buttons[s]=1,u.replay(e),c.readInput()},16),o=function(){e.buttons[s]=0,u.replay(e),c.readInput(),clearInterval(r)}}if(e){var c=f.viewport.controlActor,u=c.controller;return u.replay(e),c.readInput(),new Promise(function(t){setTimeout(function(){o(),t()},n)})}}},{key:"write",value:function(t){this.print(t)}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Input=f,l(f,"viewport",null),l(f,"helpText","Press a button x for y milliseconds."),l(f,"useText","input x y")}),require.register("console/task/Move.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Move=void 0;var i=e("subspace-console/Task");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(f,i.Task);var e,r,n,u=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return l(c(t=u.call.apply(u,[this].concat(r))),"prompt",".."),t}return e=f,(r=[{key:"init",value:function(t,e){this.print("Moving character to x, y...");var r=f.viewport.controlActor;r.args.x=Number(t),r.args.y=Number(e),r.viewport&&r.viewport.setColCell(r)}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Move=f,l(f,"viewport",null),l(f,"helpText","Move the current actor to a position in space."),l(f,"useText","move x y")}),require.register("console/task/Pos.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Pos=void 0;var i=e("subspace-console/Task");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,i.Task);var e,r,n,c=s(u);function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),c.apply(this,arguments)}return e=u,(r=[{key:"init",value:function(t,e){var r=u.viewport.controlActor;this.print("Character is at ".concat(r.x,", ").concat(r.y,"."))}}])&&o(e.prototype,r),n&&o(e,n),u}();t.Pos=l,u(l,"viewport",null),u(l,"helpText","Check the current actor's position in space.")}),require.register("console/task/Settings.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Settings=void 0;var i=e("subspace-console/Task");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(f,i.Task);var e,r,n,u=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return l(c(t=u.call.apply(u,[this].concat(r))),"prompt",".."),t}return e=f,(r=[{key:"init",value:function(t,e){var r=f.viewport;void 0!==e&&(r.settings[t]=JSON.parse(e)),this.print(JSON.stringify(r.settings[t]))}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Settings=f,l(f,"viewport",null),l(f,"helpText","Get/set the values of settings variables."),l(f,"useText","set key val")}),require.register("controller/Axis.js",function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Object.defineProperty(t,"__esModule",{value:!0}),t.Axis=void 0;var o=function(){function t(e){var r=e.deadZone,n=void 0===r?0:r,o=e.proportional,a=void 0===o||o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,"active",!1),i(this,"magnitude",0),i(this,"delta",0),n&&(this.proportional=a,this.deadZone=n)}var e,r,o;return e=t,(r=[{key:"tilt",value:function(t){t=this.deadZone&&Math.abs(t)>=this.deadZone?(Math.abs(t)-this.deadZone)/(1-this.deadZone)*Math.sign(t):0,this.delta=Number(t-this.magnitude).toFixed(3)-0,this.magnitude=Number(t).toFixed(3)-0}},{key:"zero",value:function(){this.magnitude=this.delta=0}}])&&n(e.prototype,r),o&&n(e,o),t}();t.Axis=o}),require.register("controller/Button.js",function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Object.defineProperty(t,"__esModule",{value:!0}),t.Button=void 0;var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,"active",!1),i(this,"pressure",0),i(this,"delta",0),i(this,"time",0)}var e,r,o;return e=t,(r=[{key:"update",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.pressure?this.time++:!this.pressure&&this.time>0?this.time=-1:!this.pressure&&this.time<0&&this.time--,this.time<-1&&-1===this.delta&&(this.delta=0)}},{key:"press",value:function(t){this.delta=Number(t-this.pressure).toFixed(3)-0,this.pressure=Number(t).toFixed(3)-0,this.active=!0,this.time=this.time>0?this.time:0}},{key:"release",value:function(){this.active&&(this.delta=Number(-this.pressure).toFixed(3)-0,this.pressure=0,this.active=!1)}},{key:"zero",value:function(){this.pressure=this.delta=0,this.active=!1}}])&&n(e.prototype,r),o&&n(e,o),t}();t.Button=o}),require.register("controller/Controller.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;var n=e("./Axis"),i=e("./Button");function o(t){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var u={Space:0,Enter:0,NumpadEnter:0,ControlLeft:1,ControlRight:1,ShiftLeft:2,ShiftRight:2,KeyZ:3,KeyQ:4,KeyE:5,Digit1:6,Digit3:7,KeyW:12,KeyA:14,KeyS:13,KeyD:15,KeyH:112,KeyJ:113,KeyK:114,KeyL:115,KeyP:9,Pause:9,Tab:11,ArrowUp:12,ArrowDown:13,ArrowLeft:14,ArrowRight:15,Numpad4:112,Numpad2:113,Numpad8:114,Numpad6:115,Backquote:1010};s(Array(12)).map(function(t,e){return u["F".concat(e)]=1e3+e});var l={12:-1,13:1,14:-0,15:0,112:-2,113:3,114:-3,115:2},f=function(){function t(e){e.keys;var r=e.deadZone,n=void 0===r?0:r;e.gamepad,e.keyboard;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.deadZone=n,Object.defineProperties(this,{buttons:{value:{}},pressure:{value:{}},axes:{value:{}},keys:{value:{}}})}var e,r,c;return e=t,(r=[{key:"update",value:function(t){var e=t.gamepad;for(var r in this.buttons){this.buttons[r].update()}e&&this.willRumble&&("object"!==o(this.willRumble)&&(this.willRumble={duration:1e3,strongMagnitude:1,weakMagnitude:1}),e.vibrationActuator&&e.vibrationActuator.playEffect("dual-rumble",this.willRumble),this.willRumble=!1)}},{key:"rumble",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.willRumble=t}},{key:"readInput",value:function(t){var e=t.keyboard,r=t.gamepad,n={},o={};if(r)for(var a in r.buttons){var c=r.buttons[a];c.pressed&&(this.press(a,c.value),n[a]=!0)}if(e){for(var f in s(Array(10)))n[f]||e.getKeyCode(f)>0&&(this.press(f,1),n[f]=!0);for(var h in u)if(!n[h]){var p=u[h];e.getKeyCode(h)>0&&(this.press(p,1),n[p]=!0)}}if(r)for(var g in r.buttons){if(!n[g])r.buttons[g].pressed||(this.release(g),o[g]=!0)}if(e){for(var d in s(Array(10)))o[d]||n[d]||e.getKeyCode(d)<0&&(this.release(d),o[d]=!0);for(var y in u){var b=u[y];o[b]||(n[b]||e.getKeyCode(y)<0&&(this.release(b),o[y]=!0))}}var v={};if(r)for(var m in r.axes){var w=r.axes[m];v[m]=!0,this.tilt(m,w)}for(var S in l){this.buttons[S]||(this.buttons[S]=new i.Button);var O=l[S],x=Math.sign(1/O),k=Math.abs(O);this.buttons[S].active?(v[k]=!0,this.tilt(k,x)):v[k]||this.tilt(k,0)}}},{key:"tilt",value:function(t,e){this.axes[t]||(this.axes[t]=new n.Axis({deadZone:this.deadZone})),this.axes[t].tilt(e)}},{key:"press",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.buttons[t]||(this.buttons[t]=new i.Button),this.buttons[t].press(e)}},{key:"release",value:function(t){this.buttons[t]||(this.buttons[t]=new i.Button),this.buttons[t].release()}},{key:"serialize",value:function(){var t={};for(var e in this.buttons)t[e]=this.buttons[e].pressure;var r={};for(var n in this.axes)r[n]=this.axes[n].magnitude;return{axes:r,buttons:t}}},{key:"replay",value:function(t){if(t.buttons)for(var e in t.buttons)t.buttons[e]>0?this.press(e,t.buttons[e]):this.release(e);if(t.axes)for(var r in t.axes)t.axes[r].magnitude!==t.axes[r]&&this.tilt(r,t.axes[r])}},{key:"zero",value:function(){for(var t in this.axes)this.axes[t].zero();for(var e in this.buttons)this.buttons[e].zero()}}])&&a(e.prototype,r),c&&a(e,c),t}();t.Controller=f}),require.register("debug/LineDump.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.LineDump=void 0;var i=e("curvature/base/View");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return s(t)}(this,r)}}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.View);var e=a(r);function r(){var t,n,i,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return t=e.call.apply(e,[this].concat(c)),n=s(t),o='<div class = "line-dump" style = "--x:[[x]];--y:[[y]];--length:[[len]];--angle:[[angle]]">\n\t\t<div class = "line" style = "border-color:[[color]]"></div>\n\t</div>',(i="template")in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,t.args.x=t.args.x||0,t.args.y=t.args.y||0,t}return r}();t.LineDump=u}),require.register("debug/PointDump.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PointDump=void 0;var i=e("curvature/base/View");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return s(t)}(this,r)}}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.View);var e=a(r);function r(){var t,n,i,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return t=e.call.apply(e,[this].concat(c)),n=s(t),o='<div class = "point-dump">\n\t\t<div class = "point" style = "--color:[[color]]">[[x]], [[y]]</div>\n\t</div>',(i="template")in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,t.args.x=t.args.x||0,t.args.y=t.args.y||0,t}return r}();t.PointDump=u}),require.register("debug/arrow-east.svg",function(t,e,r){r.exports='<svg width="497.81px" height="497.81px" enable-background="new 0 0 497.812 497.812" version="1.1" viewBox="0 0 497.81 497.81" xmlns="http://www.w3.org/2000/svg">\n\t<g transform="matrix(-1 0 0 1 497.81 0)">\n\t\t<path d="m203.66 312.91 117.03 117.03-67.906 67.875-248.91-248.91 248.91-248.91 67.906 67.875-117.06 117.06 290.28-0.031 0.031 127.97z"/>\n\t</g>\n</svg>\n'}),require.register("effects/Cylinder.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Cylinder=void 0;var i=e("curvature/base/View"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(h,i.View);var r,n,l,f=c(h);function h(t,r){var n,i,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),n=f.call(this,t,r),i=u(n),o="template",a=e("./twist.svg"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n.args.scale=n.args.scale||0,n.args.id=n.args.id||"cylinder",n.args.width=n.args.width||64,n.args.height=n.args.height||64,n}return r=h,(n=[{key:"onRendered",value:function(){var t=this,e=new o.Tag('<canvas width = "'.concat(this.args.width,'" height = "').concat(this.args.height,'">')),r=e.getContext("2d");r.imageSmoothingEnabled=!1;for(var n=r.getImageData(0,0,this.args.width,this.args.height),i=n.data,a=0;a<i.length;a+=4){var s,c,u=a/4,l=Math.floor(u/this.args.width),f=u%this.args.width-this.args.width/2,h=l-this.args.height/2;Math.sqrt(Math.pow(f,2)+Math.pow(h,2)),Math.min(this.args.width,this.args.height);c=128+4*f*(Math.abs(f/this.args.width)/2),128,0,i[a+0]=null!==(s=c)&&void 0!==s?s:128,i[a+1]=(128,128),i[a+2]=null!==0?0:128,i[a+3]=255}r.putImageData(n,0,0),e.toBlob(function(e){return t.args.blob=URL.createObjectURL(e)},"image/png")}},{key:"name",get:function(){return"".concat(this.args.id)}}])&&a(r.prototype,n),l&&a(r,l),h}();t.Cylinder=f}),require.register("effects/Droop.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Droop=void 0;var i=e("curvature/base/View"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(p,i.View);var r,n,l,h=c(p);function p(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),f(u(n=h.call(this,t,r)),"template",e("./droop.svg")),n.args.scale=n.args.scale||0,n.args.id=n.args.id||"droop",n.args.width=2*(t.width||64),n.args.height=t.height||64,n.args.intensity=1,n.args.droopWidth="102%",n}return r=p,l=[{key:"generateMap",value:function(t,e){var r="".concat(t,"::").concat(e),n=this.memoMaps;if(n.has(r))return Promise.resolve(n.get(r));var i=new o.Tag('<canvas width = "'.concat(t,'" height = "').concat(e,'">')),a=i.getContext("2d");a.imageSmoothingEnabled=!1;for(var s=a.getImageData(0,0,t,e),c=s.data,u=0;u<c.length;u+=4){var l,f,h=u/4,p=h%t/t,g=(Math.floor(h/t),-Math.PI+p*Math.PI);128,f=128+Math.round(128*(.5*Math.cos(g)+.5)),0,255,c[u+0]=(128,128),c[u+1]=null!==(l=f)&&void 0!==l?l:128,c[u+2]=null!==0?0:128,c[u+3]=(255,255)}return a.putImageData(s,0,0),new Promise(function(t){i.toBlob(function(e){var i=URL.createObjectURL(e,"image/png");n.set(r,i),t(i)})})}}],(n=[{key:"onRendered",value:function(){var t=this;this.constructor.generateMap(this.args.width,this.args.height).then(function(e){t.args.blob=e})}},{key:"name",get:function(){return"".concat(this.args.id)}}])&&a(r.prototype,n),l&&a(r,l),p}();t.Droop=h,f(h,"memoMaps",new Map)}),require.register("effects/Pinch.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Pinch=void 0;var i=e("curvature/base/View"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(h,i.View);var r,n,l,f=c(h);function h(t,r){var n,i,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),n=f.call(this,t,r),i=u(n),o="template",a=e("./twist.svg"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n.args.scale=n.args.scale||0,n.args.id=n.args.id||"pinch",n.args.width=n.args.width||64,n.args.height=n.args.height||64,n}return r=h,(n=[{key:"onRendered",value:function(){var t=this,e=new o.Tag('<canvas width = "'.concat(this.args.width,'" height = "').concat(this.args.height,'">')),r=e.getContext("2d");r.imageSmoothingEnabled=!1;for(var n=r.getImageData(0,0,this.args.width,this.args.height),i=n.data,a=0;a<i.length;a+=4){var s,c,u,l,f=void 0,h=0,p=a/4,g=Math.floor(p/this.args.width),d=p%this.args.width-this.args.width/2,y=g-this.args.height/2,b=Math.sqrt(Math.pow(d,2)+Math.pow(y,2)),v=Math.min(this.args.width,this.args.height)/2;b<v?(f=Math.pow(1-b/v,2),h=Math.pow(1-b/v,2)):(f=0,h=0),u=128+4*d*f,l=128+4*y*h,0,i[a+0]=null!==(s=u)&&void 0!==s?s:128,i[a+1]=null!==(c=l)&&void 0!==c?c:128,i[a+2]=null!==0?0:128,i[a+3]=255}r.putImageData(n,0,0),e.toBlob(function(e){return t.args.blob=URL.createObjectURL(e)},"image/png")}},{key:"name",get:function(){return"".concat(this.args.id)}}])&&a(r.prototype,n),l&&a(r,l),h}();t.Pinch=f}),require.register("effects/Twist.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Twist=void 0;var i=e("curvature/base/View"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(h,i.View);var r,n,l,f=c(h);function h(t,r){var n,i,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),n=f.call(this,t,r),i=u(n),o="template",a=e("./twist.svg"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n.args.scale=n.args.scale||0,n.args.id=n.args.id||"twist",n.args.width=n.args.width||64,n.args.height=n.args.height||64,n.args.dx=0,n.args.dy=0,n}return r=h,(n=[{key:"onRendered",value:function(){var t=this,e=new o.Tag('<canvas width = "64" height = "64">'),r=e.getContext("2d");r.imageSmoothingEnabled=!1;for(var n=r.getImageData(0,0,64,64),i=n.data,a=0;a<i.length;a+=4){var s,c,u,l,f=1,h=a/4,p=h%64-31.5,g=Math.floor(h/64)-31.5-15.5,d=Math.sqrt(Math.pow(p,2)+Math.pow(g,2));u=128+4*g*(f=d>32?0:Math.pow(1-d/32,3)),l=128-4*p*f,i[a+0]=null!==(s=u)&&void 0!==s?s:0,i[a+1]=null!==(c=l)&&void 0!==c?c:0,i[a+2]=0,i[a+3]=255}r.putImageData(n,0,0),e.toBlob(function(e){return t.args.blob=URL.createObjectURL(e)},"image/png")}},{key:"name",get:function(){return"".concat(this.args.id)}}])&&a(r.prototype,n),l&&a(r,l),h}();t.Twist=f}),require.register("effects/droop.svg",function(t,e,r){r.exports='<svg\n\twidth  ="100%"\n\theight ="100%"\n>\n\t<defs>\n\n\t\t<filter\n\t\t\tcv-ref = "filter"\n\t\t\tcolor-interpolation-filters="sRGB"\n\t\t\tid = "[[id]]"\n\t\t\twidth  ="102%"\n\t\t\theight ="500%"\n\t\t\tx  = "-1%"\n\t\t\ty  = "-1%"\n\n\t\t>\n\t\t\t<feImage\n\t\t\t\tpreserveAspectRatio = "none"\n\t\t\t\tresult  = "DisplacementSourceLeft"\n\t\t\t\tcv-attr = "width:droopWidthLeft,href:blob"\n\t\t\t/>\n\n\t\t\t<feImage\n\t\t\t\tpreserveAspectRatio = "none"\n\t\t\t\tresult  = "DisplacementSourceRightInvert"\n\t\t\t\tcv-attr = "x:droopRightStart,width:droopWidthRight,href:blob"\n\t\t\t/>\n\n\t\t\t<feColorMatrix\n\t\t\t\tin     = "DisplacementSourceRightInvert"\n\t\t\t\tresult = "DisplacementSourceRight"\n\t\t\t\ttype   = "matrix"\n\t\t\t\tvalues="\n\t\t\t\t\t1 0 0 0 0\n\t\t\t\t\t0 -1 0 0 1.5\n\t\t\t\t\t0 0 1 0 0\n\t\t\t\t\t0 0 0 1 0"\n\t\t\t/>\n\n\t\t\t<feComposite\n\t\t\t\toperator="over"\n\t\t\t\tin     = "DisplacementSourceLeft"\n\t\t\t\tin2    = "DisplacementSourceRight"\n\t\t\t\tresult = "DisplacementSource"\n\t\t\t\twidth  ="102%"\n\t\t\t/>\n\n\t\t\t<feFlood flood-color="#808000" result = "OffsetNeutral" />\n\n\t\t\t<feComposite\n\t\t\t\toperator="over"\n\t\t\t\tin     = "DisplacementSource"\n\t\t\t\tin2    = "OffsetNeutral"\n\t\t\t\tresult = "DisplacementResult"\n\t\t\t\twidth  ="102%"\n\t\t\t/>\n\n\t\t\t<feComposite\n\t\t\t\toperator="over"\n\t\t\t\tin     = "DisplacementSource"\n\t\t\t\tin2    = "OffsetNeutral"\n\t\t\t\tresult = "DisplacementResult"\n\t\t\t\twidth  ="102%"\n\t\t\t/>\n\n\t\t\t<feDisplacementMap\n\t\t\t\txChannelSelector = "R"\n\t\t\t\tyChannelSelector = "G"\n\t\t\t\tin      = "SourceGraphic"\n\t\t\t\tin2     = "DisplacementResult"\n\t\t\t\tcv-ref  = "displace"\n\t\t\t\tcv-attr = "scale:scale"\n\t\t\t\twidth  ="102%"\n\t\t\t/>\n\n\t\t</filter>\n\n\t</defs>\n</svg>\n'}),require.register("effects/twist.svg",function(t,e,r){r.exports='<svg\n\theight ="100%"\n\twidth  ="100%"\n>\n\t<defs>\n\n\t\t<filter\n\t\t\tcv-ref = "filter"\n\t\t\tcolor-interpolation-filters="sRGB"\n\t\t\theight = "100%"\n\t\t\twidth  = "100%"\n\t\t\tid     = "[[id]]"\n\t\t\tx      = "0%"\n\t\t\ty      = "0%"\n\n\t\t>\n\t\t\t<feFlood\n\t\t\t\tflood-color="#808000"\n\t\t\t\theight = "100%"\n\t\t\t\twidth  = "100%"\n\t\t\t\tresult = "OffsetNeutral"\n\t\t\t\tx="0"\n\t\t\t\ty="0"\n\t\t\t/>\n\n\t\t\t<feImage\n\t\t\t\txlink:href="[[blob]]"\n\t\t\t\tresult = "DisplacementSource"\n\t\t\t\theight = "100%"\n\t\t\t\twidth  = "100%"\n\t\t\t/>\n\n\t\t\t<feOffset\n\t\t\t\tin      = "DisplacementSource"\n\t\t\t\tresult  = "OffsetSource"\n\t\t\t\tcv-attr =  "dx:dx,dy:dy"\n\t\t\t/>\n\n\t\t\t<feComposite\n\t\t\t\toperator="over"\n\t\t\t\tin2    = "OffsetNeutral"\n\t\t\t\tin     = "OffsetSource"\n\t\t\t\tresult = "DisplacementResult"\n\t\t\t/>\n\n\t\t\t<feDisplacementMap\n\t\t\t\txChannelSelector = "R"\n\t\t\t\tyChannelSelector = "G"\n\t\t\t\tin      = "SourceGraphic"\n\t\t\t\tin2     = "DisplacementResult"\n\t\t\t\tcv-ref  = "displace"\n\t\t\t\tcv-attr = "scale:scale"\n\t\t\t/>\n\n\t\t</filter>\n\n\t</defs>\n</svg>\n'}),require.register("initialize.js",function(t,e,r){"use strict";var n=e("./viewport/Viewport"),i=e("curvature/base/Tag"),o=(e("./tileMap/TileMap"),new n.Viewport);document.addEventListener("DOMContentLoaded",function(){navigator.serviceWorker&&navigator.serviceWorker.register("/worker-cache.js");var t=0;o.render(document.body),o.args.fps="...";new i.Tag(document.body);var e=[];!function r(){var n=performance.now(),i=n-t,a=1e3/(o.args.maxFps||60);if(requestAnimationFrame(r),!(o.args.maxFps<60&&a>i)&&(o.update(),t=n,e.push(i),e.length>1)){var s=e.reduce(function(t,e){return t+e})/e.length;o.args.fps=1e3/s,e.splice(0)}}()})}),require.register("intro/BootCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BootCard=void 0;var i=e("./Card");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=s(t);if(e){var o=s(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.Card);var e=a(r);function r(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(i=e.call(this,t,n)).args.cardName="boot-card",i.args.text="PRODUCED BY\nSEAN MORRIS UNDER\nTHE APACHE 2.0 LICENSE",i}return r}();t.BootCard=c}),require.register("intro/Card.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Card=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(f,i.View);var r,n,u,l=s(f);function f(){var t,r,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),t=l.call(this,o,a),r=c(t),n="template",i=e("./card.html"),n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,o.text=o.text||"this is an intro card.",t.args.timeout=t.args.timeout||1e3,t.args.animation="opening",t.done=new Promise(function(e){return t.accept=e}),t}return r=f,(n=[{key:"play",value:function(t){var e=this;return this.onTimeout(50,function(){return e.args.animation="opened"}),new Promise(function(t){var r=e.args.timeout;r<0||(e.onTimeout(r-500,function(){return e.args.animation="closing"}),e.onTimeout(r,function(){e.args.animation="closed";var n=new Promise(function(t){return e.onTimeout(r,t)});e.accept([n]),t([n])}))})}}])&&o(r.prototype,n),u&&o(r,u),f}();t.Card=l}),require.register("intro/DebianCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.DebianCard=void 0;var i=e("./Card");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return s(t)}(this,r)}}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(n,i.Card);var r=a(n);function n(t,i){var o,a,c,u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),o=r.call(this,t,i),a=s(o),c="template",u=e("./debian-card.html"),c in a?Object.defineProperty(a,c,{value:u,enumerable:!0,configurable:!0,writable:!0}):a[c]=u,o.args.cardName="debian-card",o.args.text="",o}return n}();t.DebianCard=u}),require.register("intro/LoadingCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingCard=void 0;var i=e("./Card");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=s(t);if(e){var o=s(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.Card);var e=a(r);function r(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(i=e.call(this,t,n)).args.cardName="loading-card",i}return r}();t.LoadingCard=c}),require.register("intro/LogoSplash.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.LogoSplash=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,i.View);var e,r,n,c=s(u);function u(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(t=c.call(this,e,r)).ringSample=new Audio("/Sonic/ring-collect.wav"),t.ringSample.volume=.5,t.template='<div class = "splash [[animation]]" style = "\n\t\t\tpointer-events: [[pointerEvents]]\n\t\t">\n\t\t\t<div class = "center">SEAN<span class = "min">MORRIS</span><div class = "sm">SM</div></div>\n\t\t\t<div class = "center">SEAN<span class = "min">MORRIS</span><div class = "sm">SM</div></div>\n\t\t\t<div class = "center">SEAN<span class = "min">MORRIS</span><div class = "sm">SM</div></div>\n\t\t</div>',t}return e=u,(r=[{key:"onAttached",value:function(){var t=this;this.alreadyAttached||(this.alreadyAttached=!0,this.args.left=0,this.args.right=0,this.args.fade=1,this.args.frame=0,this.args.fullFade=1,this.args.pointerEvents="all",this.args.animation="hide",this.onTimeout(500,function(){return t.args.animation="slide"}),this.onTimeout(1250,function(){return t.args.animation="show"}),this.onTimeout(5e3,function(){return t.args.animation="done"}),this.onTimeout(1250,function(){return t.parent.args.audio&&t.ringSample.play()}))}}])&&o(e.prototype,r),n&&o(e,n),u}();t.LogoSplash=u}),require.register("intro/SeanCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SeanCard=void 0;var i=e("./Card"),o=e("./LogoSplash");function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(r,i.Card);var e=s(r);function r(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(i=e.call(this,t,n)).args.cardName="sean-card",i.args.text=new o.LogoSplash({},n),i}return r}();t.SeanCard=u}),require.register("intro/Series.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Series=void 0;var i=e("curvature/base/View");e("./Card");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(l,i.View);var e,r,n,u=s(l);function l(){var t,e,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),t=u.call(this,i,o),e=c(t),n='<div class = "intro-cards" cv-each = "cards:card:c">[[card]]</div>',(r="template")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.cards=i.cards,t.args.cards=[],t.args.card=null,t.startTime=!1,t}return e=l,(r=[{key:"play",value:function(){var t=this,e=this.cards.shift(),r=new Promise(function(t){return e.onRemove(t)}),n=e.play();return this.args.cards.push(e),this.startTime=Date.now(),Promise.race([n,r,e.done]).then(function(r){t.parent.onFrameOut(10,function(){return r&&t.parent.onFrameOut(10,function(){Promise.all(r).then(function(){return e.remove()})}),t.cards.length?t.play():n})})}},{key:"input",value:function(t){var e=this.args.cards[this.args.cards.length-1];e&&e.input&&e.input(t)}}])&&o(e.prototype,r),n&&o(e,n),l}();t.Series=l}),require.register("intro/TitleScreenCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TitleScreenCard=void 0;var i=e("./Card"),o=e("../ui/CharacterString"),a=e("../backdrop/MarbleGarden"),s=e("curvature/input/Keyboard");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return h(t)}(this,r)}}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(y,i.Card);var r,n,g,d=f(y);function y(t,r){var n,i,c,u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),n=d.call(this,t,r),i=h(n),c="template",u=e("./titlescreen.html"),c in i?Object.defineProperty(i,c,{value:u,enumerable:!0,configurable:!0,writable:!0}):i[c]=u,n.args.cardName="title-screen-card",n.args.text="",n.args.backdrop="...",n.startPressed=!1;var l=new a.MarbleGarden;l.args.frame=0,l.args.x=0,l.args.y=140,l.args.xMax=1e4,l.args.yMax=800,n.started=0,n.bgm=new Audio("/Sonic/carnival-night-zone-act-2-beta.mp3"),n.bgm.volume=.5,n.onRemove(function(){return n.bgm.pause()});var f=s.Keyboard.get().codes.bindTo("Enter",function(t){!n.started||Date.now()-n.started<2e3||(n.onTimeout(200,function(){return n.startPressed=!0}),n.args.animation="closing",n.audioDebind())});return n.onRemove(f),n.start=new Promise(function(t){n.onFrame(function(){if(n.started&&!(Date.now()-n.started<0)&&(l.args.x-=24,l.args.frame++,n.startPressed)){var e=new Promise(function(t){return n.onTimeout(200,t)});t([e])}})}),n.args.backdrop=l,n.args.pressStart=new o.CharacterString({value:"press start/enter"}),n}return r=y,(n=[{key:"input",value:function(t){var e=this;!this.started||Date.now()-this.started<2e3||t.buttons[9]&&1===t.buttons[9].time&&(this.onTimeout(200,function(){return e.startPressed=!0}),this.args.animation="closing",this.audioDebind())}},{key:"play",value:function(){var t=this;this.onTimeout(1e3,function(){t.audioDebind=t.parent.args.bindTo("audio",function(e){e?t.bgm.play():t.bgm.pause()}),t.onRemove(t.audioDebind)}),this.onTimeout(2e3,function(){return t.args.aurora="aurora"}),this.started=Date.now();var e=u(p(y.prototype),"play",this).call(this);return e.then(function(){t.bgm.pause(),t.audioDebind(),t.remove()}),Promise.race([this.start,e])}}])&&c(r.prototype,n),g&&c(r,g),y}();t.TitleScreenCard=g}),require.register("intro/WebkitCard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WebkitCard=void 0;var i=e("./Card");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(p,i.Card);var r,n,f,h=c(p);function p(t,r){var n,i,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),n=h.call(this,t,r),i=u(n),o="template",a=e("./webkit-card.html"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n.args.cardName="webkit-card",n.args.text="",n}return r=p,(n=[{key:"play",value:function(t){var e=this;return this.onTimeout(2400,function(){return e.args.animation="spindash-charge"}),this.onTimeout(4e3,function(){return e.args.animation="spindash"}),a(l(p.prototype),"play",this).call(this,t)}}])&&o(r.prototype,n),f&&o(r,f),p}();t.WebkitCard=f}),require.register("intro/card.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]]">\n\t<span>[[text]]</span>\n</div>\n'}),require.register("intro/debian-card.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]] [[aurora]]">\n\t<div class = "main-elements-container">\n\t\t<div class = "debian-logo"></div>\n\t\t<div class = "caption">Built on Debian</div>\n\t</div>\n</div>\n'}),require.register("intro/titlescreen.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]] [[aurora]]">\n\t[[backdrop]]\n\n\t<div class = "main-elements-container">\n\n\t\t<div class = "title-emblem"></div>\n\t\t<div class = "press-start">[[pressStart]]</div>\n\n\t</div>\n\n</div>\n'}),require.register("intro/webkit-card.html",function(t,e,r){r.exports='<div class = "screen-card screen-card-[[cardName]] [[animation]] [[aurora]]">\n\t<div class = "main-elements-container">\n\t\t<div class = "chromium-logo"></div>\n\t\t<div class = "caption">WebKit recommended for best experience.</div>\n\t</div>\n</div>\n'}),require.register("legacy/Actor.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Actor=void 0;var i=e("curvature/base/View"),o=e("../debug/PointDump");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(p,i.View);var r,n,l,h=c(p);function p(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return f(u(t=h.call.apply(h,[this].concat(n))),"speed",15),f(u(t),"template",e("./actor.html")),t.world=null,t.x=92,t.y=1024,t.width=64,t.height=64,t.boxWidth=64,t.boxHeight=64,t.directions=16,t.state="standing",t.gSpeed=0,t.gSpeedMax=40,t.xSpeed=0,t.ySpeed=0,t.angle=0,t.maxGravity=48,t.gravity=0,t.slopeFactor=.01,t.falling=!0,t.sensors={top:!1,bottom:!1,left:!1,right:!1},t.mode=t.args.mode=0,t.modes={floor:0,leftWall:1,ceiling:2,rightWall:3},t.animationClasses={},t.currentClasses=null,t.pdL=new o.PointDump({color:"red"}),t.pdR=new o.PointDump({color:"green"}),t.args.debugs=[t.pdL,t.pdR],t}return r=p,(n=[{key:"destroy",value:function(){}},{key:"update",value:function(){if(this.tags.actor){var t=this.gSpeed;this.args.animspeed=Math.floor((this.gSpeedMax-Math.abs(t))/12),this.args.animspeed<1&&(this.args.animspeed=1);var e=Math.round(1e3*this.angle)/1e3;if(this.falling?(this.falling||this.jumped)&&(this.args.state="jumping"):(e>Math.PI/4&&e<2*Math.PI/4&&(this.mode===this.modes.floor?this.args.mode=this.mode=this.modes.leftWall:this.mode===this.modes.leftWall?this.args.mode=this.mode=this.modes.ceiling:this.mode===this.modes.ceiling?this.args.mode=this.mode=this.modes.rightWall:this.mode===this.modes.rightWall&&(this.args.mode=this.mode=this.modes.floor)),e<-Math.PI/4&&e>-2*Math.PI/4&&(this.mode===this.modes.floor?this.args.mode=this.mode=this.modes.rightWall:this.mode===this.modes.rightWall?this.args.mode=this.mode=this.modes.ceiling:this.mode===this.modes.ceiling?this.args.mode=this.mode=this.modes.leftWall:this.mode===this.modes.leftWall&&(this.args.mode=this.mode=this.modes.floor)),Math.abs(t)>this.gSpeedMax/2?this.args.state="running":Math.abs(t)>0?this.args.state="walking":this.args.state="standing",this.args.facing=t>0?"facing-right":"facing-left"),this.falling?this.mode==this.modes.floor?this.ySpeed++:this.mode==this.modes.ceiling?this.ySpeed--:this.mode==this.modes.leftWall?this.xSpeed--:this.mode==this.modes.rightWall&&this.xSpeed++:this.jumped||(this.xSpeed=0,this.ySpeed=0),this.x+=this.xSpeed,this.ySpeed&&(this.y+=this.ySpeed>0?1:-1),t)for(var r=Math.abs(t),n=r>8?8:r,i=0;i<n;i++)this.iteratePosition(Math.floor(t/n));else this.iteratePosition(0);this.ySpeed>32&&(this.ySpeed=32),this.ySpeed<-32&&(this.ySpeed=-32),this.xSpeed>32&&(this.xSpeed=32),this.xSpeed<-32&&(this.xSpeed=-32),this.tags.actor.style({"--x":Math.floor(this.x),"--y":Math.floor(this.y)}),this.mode===this.modes.floor?this.tags.actor.style({"--angle":this.angle}):this.mode===this.modes.leftWall?this.tags.actor.style({"--angle":this.angle+Math.PI/2*1}):this.mode===this.modes.ceiling?this.tags.actor.style({"--angle":this.angle+Math.PI/2*2}):this.mode===this.modes.rightWall&&this.tags.actor.style({"--angle":this.angle+Math.PI/2*3}),this.jumped&&(this.jumped=!1)}}},{key:"iteratePosition",value:function(t){var e,r,n,i,o=Math.sin(this.angle),a=Math.cos(this.angle),s=this.center,c=(this.top,this.bottom),u=(this.left,this.right);this.mode==this.modes.floor||this.mode==this.modes.ceiling?(e=u-s[0],s[1]):this.mode!=this.modes.leftWall&&this.mode!=this.modes.rightWall||(e=u-s[1],s[0]),r=this.left-e*o+.5*e,n=this.right-e*o-.5*e,i=Math.abs(n-r);var l,f,h,p,g=this.viewport.tileMap,d=0,y=0,b=!1,v=!1,m=(this.falling,this.height),w=[[-m,0],[-m,m]];t:for(var S in w)for(d=w[S][0];d<w[S][1];){if(this.mode==this.modes.floor?(l=r,f=c+d):this.mode==this.modes.ceiling?(l=r,f=c-d):this.mode==this.modes.leftWall?(l=c-d,f=r):this.mode==this.modes.rightWall&&(l=c+d,f=r),b=g.getSolid(l,f)){if(0!==d)break t;break}d++}for(var O in w)for(y=w[O][0];y<w[O][1]&&(this.mode==this.modes.floor?(h=n,p=c+y):this.mode==this.modes.ceiling?(h=n,p=c-y):this.mode==this.modes.leftWall?(h=c-y,p=n):this.mode==this.modes.rightWall&&(h=c+y,p=n),!(v=g.getSolid(h,p)));)y++;if(this.pdL.args.x=l,this.pdL.args.y=f,this.pdR.args.x=h,this.pdR.args.y=p,this.angle=Math.atan((y-d)/i),!this.falling){var x=(d+y)/2;this.mode===this.modes.floor?(this.x+=t*a,this.y+=t*o):this.mode===this.modes.rightWall?(this.x+=t*o,this.y-=t*a):this.mode===this.modes.ceiling?(this.x-=t*a,this.y-=t*o):this.mode===this.modes.leftWall&&(this.x-=t*o,this.y+=t*a),b&&v&&d<=0&&y<=0&&(this.mode==this.modes.floor?this.y+=Math.ceil(x):this.mode==this.modes.ceiling?this.y-=Math.ceil(x):this.mode==this.modes.leftWall?this.x-=x:this.mode==this.modes.rightWall&&(this.x+=x))}this.falling=d>0&&y>0}},{key:"isColliding",value:function(t){}},{key:"animate",value:function(){this.animationClasses[animation]&&this.currentClasses!=this.animationClasses[animation]&&(this.currentClasses.map(function(t){this.tags.sprite.removeClass(t)}),this.animationClasses[animation].map(function(t){this.tags.sprite.addClass(t)}),this.currentClasses=this.animationClasses[animation])}},{key:"roundAngle",value:function(t,e){return 360*"Math.round"((t=Math.round(t*(180/Math.PI)))/(360/e))/e*(Math.PI/180)}},{key:"goLeft",value:function(){this.gSpeed>0&&(this.gSpeed=0),this.gSpeed>-this.gSpeedMax&&this.gSpeed--}},{key:"goRight",value:function(){this.gSpeed<0&&(this.gSpeed=0),this.gSpeed<this.gSpeedMax&&this.gSpeed++}},{key:"slowDown",value:function(){Math.abs(this.gSpeed)>32?this.gSpeed=.95*this.gSpeed:this.gSpeed=.75*this.gSpeed,Math.abs(this.gSpeed)<=.1&&(this.gSpeed=0)}},{key:"jump",value:function(){var t;this.falling||(this.falling=!0,this.jumped=!0,this.mode=this.args.mode=this.modes.floor,this.mode===this.modes.floor?t=this.angle:this.mode===this.modes.leftWall?t=this.angle+Math.PI/2*1:this.mode===this.modes.ceiling?t=this.angle+Math.PI/2*2:this.mode===this.modes.rightWall&&(t=this.angle+Math.PI/2*3),this.angle=0,this.ySpeed=20*-Math.cos(t),this.xSpeed=20*Math.sin(t),this.mode!==this.modes.leftWall&&this.mode!==this.modes.rightWall||(this.gSpeed=0))}},{key:"center",get:function(){return[this.x+this.boxWidth/2,this.y+this.boxHeight/2]}},{key:"left",get:function(){return this.mode==this.modes.floor?this.center[0]-this.width/2:this.mode==this.modes.ceiling?this.center[0]+this.width/2:this.mode==this.modes.leftWall?this.center[1]-this.width/2:this.mode==this.modes.rightWall?this.center[1]+this.width/2:void 0}},{key:"right",get:function(){return this.mode==this.modes.floor?this.center[0]+this.width/2:this.mode==this.modes.ceiling?this.center[0]-this.width/2:this.mode==this.modes.leftWall?this.center[1]+this.width/2:this.mode==this.modes.rightWall?this.center[1]-this.width/2:void 0}},{key:"top",get:function(){return this.mode==this.modes.floor?this.center[1]-Math.floor(this.height/2):this.mode==this.modes.ceiling?this.center[1]+Math.floor(this.height/2):this.mode==this.modes.leftWall?this.center[0]+Math.floor(this.height/2):this.mode==this.modes.rightWall?this.center[0]-Math.floor(this.height/2):void 0}},{key:"bottom",get:function(){return this.mode==this.modes.floor?this.center[1]+Math.floor(this.height/2):this.mode==this.modes.ceiling?this.center[1]-Math.floor(this.height/2):this.mode==this.modes.leftWall?this.center[0]-Math.floor(this.height/2):this.mode==this.modes.rightWall?this.center[0]+Math.floor(this.height/2):void 0}}])&&a(r.prototype,n),l&&a(r,l),p}();t.Actor=h}),require.register("legacy/Walker.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Walker=void 0;var i=e("./Actor");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=s(t);if(e){var o=s(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.Actor);var e=a(r);function r(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),e.apply(this,arguments)}return r}();t.Walker=c}),require.register("legacy/actor.html",function(t,e,r){r.exports='<div class = "actor knuckles [[state]] [[facing]]" cv-ref = "actor" data-mode = "[[mode]]" style = "--animspeed:[[animspeed]]">\n\t<div class = "sprite" cv-ref = "sprite" ></div>\n</div>\n<div cv-each = "debugs:debug">[[debug]]</div>\n'}),require.register("mixin/CanPop.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanPop=void 0;var n=e("curvature/base/Tag"),i=(e("../actor/Explosion"),e("../actor/Projectile")),o={collideA:function(t,e){if(this.args.currentSheild||this.args.gone||!this.viewport||!(t.dashed||t.args.jumping||t.args.rolling||t instanceof i.Projectile))return t&&t.controllable&&t.damage(this),!1;this.pop(t)},damage:function(t,e){this.pop(t)},pop:function(t){var e=this,r=this.viewport;if(r&&!this.args.gone&&t.args.owner!==this){var i=new n.Tag('<div class = "particle-explosion">');i.style({"--x":this.x,"--y":this.y-16}),r.particles.add(i),setTimeout(function(){return r.particles.remove(i)},512),setTimeout(function(){return e.screen&&e.screen.remove()},1024),this.box.setAttribute("data-animation","broken"),t.dashed&&(t.args.gSpeed=0,t.args.xSpeed=0,t.args.ySpeed=-9,t.args.x=this.x,t.dashed=!1),t.occupant&&(t=t.occupant),t.args.owner&&(t=t.args.owner),t.controllable&&"function"==typeof this.effect&&(this.args.gold?t.args.score+=1e4:t.args.score+=100,this.effect(t)),r.args.audio&&this.sample&&(this.sample.play(),t.dashed&&(t.args.xSpeed/=4),t.dashed=!1);var o=t.args.ySpeed;t.args.falling&&this.onNextFrame(function(){t.args.ySpeed=Math.min(-o,-7),t.args.falling=!0}),this.viewport.actors.remove(this),this.args.gone=!0}}};t.CanPop=o}),require.register("mixin/Constrainable.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Constrainable=void 0;var n=e("curvature/base/Tag"),i={onAttached:function(){var t=this;if(this.box=this.findTag("div"),this.sprite=this.findTag("div.sprite"),this.chain=new n.Tag('<div class = "chain">'),this.sprite.appendChild(this.chain.node),!this.args._tiedTo){var e=this.viewport.actorsById[this.args.tiedTo];this.args._tiedTo=e,e.hanging.has(this.constructor)||e.hanging.set(this.constructor,new Set);var r=e.hanging.get(this.constructor);r.add(this),this.onRemove(function(){return r.delete(t)})}},findNextStep:function(){return!1},setPos:function(){var t=this.args._tiedTo;if(!t)return!1;if(!t.args.falling)return this.args.groundAngle=-1.57,!1;this.args.falling=!0;var e=t.x-this.x,r=t.y-this.y,n=Math.atan2(r,e),i=Math.sqrt(Math.pow(r,2)+Math.pow(e,2)),o=this.args.ropeLength||64;this.chain.style({"--distance":Math.min(i,o)}),this.args.groundAngle=-(n+Math.PI/2);var a=n+Math.PI;if(i>=o){var s=t.x-Math.cos(n)*o,c=t.y-Math.sin(n)*o;this.args.xSpeed-=Math.cos(a),this.args.ySpeed-=Math.sin(a),this.args.x=s-t.args.xSpeed/5,this.args.y=c,this.viewport.setColCell(this),this.x!==t.x||t.args.xSpeed||(this.args.ySpeed=0)}}};t.Constrainable=i}),require.register("mixin/Pushable.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pushable=void 0;var n={collideA:function(t,e){if(-1===e||t.isEffect)return!1;var r=Math.ceil(Math.abs(t.args.gSpeed||t.args.xSpeed))*Math.sign(t.args.gSpeed||t.args.xSpeed);if(Math.abs(t.public.ySpeed)>Math.abs(t.public.xSpeed))return!0;if(!this.args.falling&&1===e&&r<=0)return!1;if(!this.args.falling&&3===e&&r>=0)return!1;var n=this.y-this.args.height;if((1===e||3===e)&&(t.y>=this.y||t.y>n)){if(!r)return!0;this.args.gSpeed=r,this.args.pushed=Math.sign(r)||this.args.pushed;var i=this.viewport.tileMap,o=1===e?1:3===e&&-1,a=this.scanBottomEdge(o);if(i.getSolid(this.x+Math.ceil(this.args.width/2)*o,this.y))return!0;var s=this.args.width/2;if(o>0&&0===a)this.args.falling=!0;else if(o<0&&0===a)this.args.falling=!0;else if(!this.args.falling||a>0){var c=this.findNextStep(o),u=this.findNextStep(o+s*Math.sign(o));if((!c[1]||c[2])&&!u[3]){var l=t.args.width,f=this.args.width/2;return this.args.x=t.args.x+o*(f+l),0===a}return!0}}return!0}};t.Pushable=n}),require.register("network/ChatBox.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ChatBox=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(f,i.View);var r,n,u,l=s(f);function f(t,r){var n,i,o,a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),n=l.call(this,t,r),i=c(n),o="template",a=e("./chat-box.html"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n.args.outputLines=[];return n.listen(t.pipe,"open",function(t){return n.args.outputLines=["You joined the chat."]}),n.listen(t.pipe,"message",function(t){var e=JSON.parse(t.detail);e.message&&(n.args.outputLines.push("> ".concat(e.message)),n.onNextFrame(function(){var t=n.tags.chatOutput;t&&t.scrollTo(0,t.scrollHeight)}))}),n}return r=f,(n=[{key:"send",value:function(t){var e=this;if(!t||"Enter"===t.key){var r=this.args.chatInput;r&&(this.args.outputLines.push("< ".concat(r)),this.args.chatInput="",this.onNextFrame(function(){var t=e.tags.chatOutput;t.scrollTo(0,t.scrollHeight),t.focus()}),this.args.pipe.send(JSON.stringify({message:r})))}}}])&&o(r.prototype,n),u&&o(r,u),f}();t.ChatBox=l}),require.register("network/Rtc.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Rtc=void 0;t.Rtc=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}}),require.register("network/RtcClient.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RtcClient=void 0;var i=e("curvature/base/Mixin"),o=e("curvature/mixin/EventTargetMixin");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(l,i.Mixin["with"](o.EventTargetMixin));var e,r,n,u=c(l);function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=u.call(this)).peerClient=new RTCPeerConnection(t),e.peerClientChannel=e.peerClient.createDataChannel("chat"),e.peerClientChannel.addEventListener("open",function(t){var r=new CustomEvent("open",{detail:t.data});r.originalEvent=t,e.dispatchEvent(r),e.connected=!0}),e.peerClientChannel.addEventListener("close",function(t){var r=new CustomEvent("close",{detail:t.data});r.originalEvent=t,e.dispatchEvent(r),e.connected=!1}),e.peerClientChannel.addEventListener("message",function(t){var r=new CustomEvent("message",{detail:t.data});r.originalEvent=t,e.dispatchEvent(r)}),e}return e=l,(r=[{key:"send",value:function(t){this.peerClientChannel&&this.peerClientChannel.send(t)}},{key:"close",value:function(){this.peerClientChannel&&this.peerClientChannel.close()}},{key:"offer",value:function(){var t=this;this.peerClient.createOffer().then(function(e){t.peerClient.setLocalDescription(e)});var e=new Set;return new Promise(function(r){t.peerClient.addEventListener("icecandidate",function(n){n.candidate&&(console.log(n.candidate),e.add(n.candidate),r(t.peerClient.localDescription))})})}},{key:"accept",value:function(t){var e=new RTCSessionDescription(t);this.peerClient.setRemoteDescription(e)}}])&&a(e.prototype,r),n&&a(e,n),l}();t.RtcClient=l}),require.register("network/RtcClientTask.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RtcClientTask=void 0;var i=e("subspace-console/Task"),o=e("curvature/base/Tag"),a=e("./RtcClient");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=Symbol("accept"),g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(g,i.Task);var e,r,n,f=u(g);function g(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return h(l(t=f.call.apply(f,[this].concat(r))),"title","RTC Client Task"),h(l(t),"connected",!1),t}return e=g,(r=[{key:"init",value:function(){var t=this;return this.client=new a.RtcClient({iceServers:[{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}]}),this.finally(function(){console.log("Terminating connection..."),t.client.close()}),this.client.addEventListener("open",function(){t.print("Remote peer client accepted!")}),this.client.addEventListener("close",function(){t.print("Peer reset connection.")}),this.client.addEventListener("message",function(e){t.print("> ".concat(e.detail))}),this.client.offerToken.then(function(e){var r=JSON.stringify(e),n="s3ktp://request/".concat(btoa(r));t.print("Client request code: ".concat(n));var i=new o.Tag('<textarea style = "display:none">');i.innerText=n,document.body.append(i.node),i.select(),document.execCommand("copy"),i.node.remove()}),new Promise(function(e){t[p]=e})}},{key:"main",value:function(t){t&&(this.client.connected?(this.print("< ".concat(t)),this.client.send(t)):this.accept(t))}},{key:"accept",value:function(t){if(t){var e=/^s3ktp:\/\/accept\/(.+)/.exec(t);console.log(e),e&&(t=atob(e[1]));var r=JSON.parse(t);this.client.accept(r)}else this.print("Please supply server's accept string.")}}])&&s(e.prototype,r),n&&s(e,n),g}();t.RtcClientTask=g,h(g,"helpText","RTC Client."),h(g,"useText","")}),require.register("network/RtcServer.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RtcServer=void 0;var i=e("curvature/base/Mixin"),o=e("curvature/mixin/EventTargetMixin");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(l,i.Mixin["with"](o.EventTargetMixin));var e,r,n,u=c(l);function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=u.call(this)).peerServer=new RTCPeerConnection(t),e.peerServer.addEventListener("datachannel",function(t){e.peerServerChannel=t.channel,e.peerServerChannel.addEventListener("open",function(t){var r=new CustomEvent("open",{detail:t.data});r.originalEvent=t,e.dispatchEvent(r),e.connected=!0}),e.peerServerChannel.addEventListener("close",function(t){var r=new CustomEvent("close",{detail:t.data});r.originalEvent=t,e.dispatchEvent(r),e.connected=!1}),e.peerServerChannel.addEventListener("message",function(t){var r=new CustomEvent("message",{detail:t.data});r.originalEvent=t,e.dispatchEvent(r)})}),e}return e=l,(r=[{key:"send",value:function(t){this.peerServerChannel&&this.peerServerChannel.send(t)}},{key:"close",value:function(){this.peerServerChannel&&this.peerServerChannel.close()}},{key:"answer",value:function(t){var e=this;return new Promise(function(r){e.peerServer.setRemoteDescription(t),e.peerServer.createAnswer(function(t){return e.peerServer.setLocalDescription(t)},function(t){return console.error(t)});var n=new Set;e.peerServer.addEventListener("icecandidate",function(t){t.candidate&&(console.log(t.candidate),n.add(t.candidate),r(e.peerServer.localDescription))})})}}])&&a(e.prototype,r),n&&a(e,n),l}();t.RtcServer=l}),require.register("network/RtcServerTask.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RtcServerTask=void 0;var i=e("subspace-console/Task"),o=e("curvature/base/Tag"),a=e("./RtcServer");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=Symbol("accept"),g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(g,i.Task);var e,r,n,f=u(g);function g(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return h(l(t=f.call.apply(f,[this].concat(r))),"title","RTC Server Task"),h(l(t),"connected",!1),t}return e=g,(r=[{key:"init",value:function(){var t=this;return this.server=new a.RtcServer({iceServers:[{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}]}),this.finally(function(){t.print("Terminating connection..."),t.server.close()}),this.server.addEventListener("open",function(){t.print("Remote peer client accepted!")}),this.server.addEventListener("close",function(){t.print("Peer reset connection.")}),this.server.addEventListener("message",function(e){t.print("> ".concat(e.detail))}),this.server.answerToken.then(function(e){var r=JSON.stringify(e),n="s3ktp://accept/".concat(btoa(r));t.print("Server accept code: ".concat(n));var i=new o.Tag('<textarea style = "display:none">');i.innerText=n,document.body.append(i.node),i.select(),document.execCommand("copy"),i.node.remove()}),this.printErr("Please supply client's request code."),new Promise(function(e){t[p]=e})}},{key:"main",value:function(t){t&&(this.server.connected?(this.print("< ".concat(t)),this.server.send(t)):this.answer(t))}},{key:"answer",value:function(t){var e=/^s3ktp:\/\/request\/(.+)/.exec(t);console.log(e),e&&(t=atob(e[1]));var r=JSON.parse(t);this.server.answer(r)}},{key:"done",value:function(){}}])&&s(e.prototype,r),n&&s(e,n),g}();t.RtcServerTask=g,h(g,"helpText","RTC Server."),h(g,"useText","")}),require.register("network/chat-box.html",function(t,e,r){r.exports='<div class = "chatbox">\n\n\t<div class = "chat-output" cv-each = "outputLines:line" cv-ref = "chatOutput">\n\t\t<p>[[line]]</p>\n\t</div>\n\n\t<div class = "chat-input">\n\t\t<input cv-bind = "chatInput" cv-ref = "chatInput" cv-on = "keydown:send(event)">\n\t\t<button cv-on = "click:send">send</button>\n\t</div>\n\n</div>\n'}),require.register("particle/Particle3d.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Particle3d=void 0;var i=e("curvature/base/Tag");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=s(t);if(e){var o=s(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.Tag);var e=a(r);function r(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),t=e.call(this,'<div class = "particle-3d">');var n=new i.Tag('<div class = "front-3d">'),o=new i.Tag('<div class = "back-3d">'),a=new i.Tag('<div class = "right-3d">'),s=new i.Tag('<div class = "left-3d">'),c=new i.Tag('<div class = "top-3d">'),u=new i.Tag('<div class = "bottom-3d">');return t.append(o.node),t.append(a.node),t.append(s.node),t.append(n.node),t.append(c.node),t.append(u.node),t}return r}();t.Particle3d=c}),require.register("powerups/BubbleSheild.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BubbleSheild=void 0;var i=e("curvature/base/Bindable"),o=e("./Sheild");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(h,o.Sheild);var e,r,n,l=c(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return f(u(t=l.call.apply(l,[this].concat(r))),"template",'<div class = "sheild bubble-sheild [[bouncing]]"><div class = "bubble-sheild-shine"></div></div>'),f(u(t),"protect",!0),f(u(t),"type","water"),t}return e=h,(r=[{key:"acquire",value:function(t){var e=this;if(t.viewport){t.addEventListener("damage",function r(n){if(t.args.currentSheild===i.Bindable.make(e)){n.preventDefault();var o=n.detail.other;o&&o.pop&&o.pop(t),e.onNextFrame(function(){t.args.currentSheild=null,t.inventory.remove(e)}),t.removeEventListener("damage",r),t.startle()}})}}},{key:"command_0",value:function(t,e){t.canFly||t.dashed||t.args.standingOn&&t.args.standingOn.isVehicle||(this.args.force=10,t.args.jumping&&(t.impulse(14,Math.PI/2),this.args.bouncing="bouncing",t.args.bouncing=!0))}},{key:"hold_0",value:function(){this.args.bouncing&&this.args.force<25&&this.args.force++}},{key:"update",value:function(t){var e=this;t.args.ySpeed<-5&&this.onNextFrame(function(){t.args.bouncing=!1,e.args.bouncing=!1,e.args.force=0}),this.sample||(this.initSample=new Audio("/Sonic/S3K_3F.wav"),this.initSample.volume=.15+-.05*Math.random(),this.sample=new Audio("/Sonic/S3K_44.wav"),this.sample.volume=.15+-.05*Math.random(),t.viewport.args.audio&&this.initSample.play()),t.canFly||t.public.falling||this.args.bouncing&&this.args.force&&(t.args.gSpeed=0,this.onNextFrame(function(){t.args.standingOn=null,t.args.bouncing=!1,t.args.falling=!0,t.args.jumping=!0,t.args.ySpeed=-e.args.force}),this.args.bouncing="",t.viewport.args.audio&&(this.sample.currentTime=0,this.sample.play()),t.controller.rumble({duration:200,strongMagnitude:1,weakMagnitude:1}))}}])&&a(e.prototype,r),n&&a(e,n),h}();t.BubbleSheild=h}),require.register("powerups/ElectricSheild.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ElectricSheild=void 0;var i=e("curvature/base/Bindable"),o=e("./Sheild");function a(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw o}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return f(t)}(this,r)}}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(h,o.Sheild);var e,r,n,s=l(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return p(f(t=s.call.apply(s,[this].concat(r))),"template",'<div class = "sheild electric-sheild [[boosted]]"></div>'),p(f(t),"protect",!0),p(f(t),"type","electric"),p(f(t),"jumps",3),p(f(t),"attract",new Set),p(f(t),"magnetism",0),p(f(t),"magnetTimeout",!1),t}return e=h,(r=[{key:"acquire",value:function(t){var e=this;if(t.viewport){t.addEventListener("damage",function r(n){if(t.args.currentSheild===i.Bindable.make(e)){n.preventDefault();var o=n.detail.other;o&&o.pop&&o.pop(t),e.onNextFrame(function(){t.args.currentSheild=null,t.inventory.remove(e)}),t.removeEventListener("damage",r),t.startle()}})}}},{key:"command_0",value:function(t,e){var r=this;t.canFly||this.jumps>0&&t.args.jumping&&(t.args.ySpeed=0,t.impulse(10,-Math.PI/2),this.jumps--,this.args.boosted="boosted",this.onTimeout(250,function(){return r.args.boosted=""}),t.viewport.args.audio&&(this.sample.currentTime=0,this.sample.play()),t.xAxis&&Math.sign(t.xAxis)!==Math.sign(t.public.xSpeed)&&(t.args.xSpeed=1*t.xAxis))}},{key:"release_6",value:function(t,e){}},{key:"hold_6",value:function(t,e){var r=this;t.args.xOff=0,t.args.yOff=32,this.args.boosted="boosted",this.magnetism=Math.max(0,e.pressure-.25),t.pinch(260*this.magnetism,0);var n=t.viewport.objectPalette.ring,i=t.findNearestActor(function(t){return!r.attract.has(t)&&t instanceof n&&!t.args.gone&&!t.restore},386*this.magnetism);i&&(t.viewport.auras.add(i),this.attract.add(i))}},{key:"update",value:function(t){var e=this;if(t.public.falling||this.magnetTimeout||(this.magnetTimeout=this.onTimeout(100,function(){e.magnetTimeout=!1,e.args.boosted=""})),!this.sample&&t.controllable&&(this.initSample=new Audio("/Sonic/S3K_41.wav"),this.initSample.volume=.15+-.05*Math.random(),this.sample=new Audio("/Sonic/S3K_45.wav"),this.sample.volume=.15+-.05*Math.random(),t.viewport.args.audio&&this.initSample.play()),!t.canFly){t.public.falling||(this.jumps=3);var r,n=a(this.attract);try{var i=function(){var n=r.value;if(n.args.gone)return e.attract.delete(n),n.attract=null,e.onTimeout(500,function(){n.def&&(n.args.static=!1,n.args.xSpeed=0,n.args.ySpeed=0,n.args.x=n.def.get("x"),n.args.y=n.def.get("y"),t.viewport.setColCell(n),e.onTimeout(3e3,function(){t.viewport.auras.delete(n),n.args.float=-1,n.noClip=!1,n.restore=!0}))}),"continue";n.attract=t,n.noClip=!0;var i=t.x-n.x,o=t.y-t.args.height/4-n.y,a=Math.atan2(o,i);Math.sqrt(Math.pow(o,2)+Math.pow(i,2))>384&&(n.args.x=t.x-384*Math.cos(a),n.args.y=t.y-384*Math.sin(a));var s=Math.sign(i),c=Math.sign(o),u=Math.sign(n.args.xSpeed)===s,l=Math.sign(n.args.ySpeed)===c;t.viewport.setColCell(n);var f=e.magnetism||.55,h=Math.max(f,u?.35:.45),p=Math.max(f,l?.25:.35);n.args.groundAngle=0;var g=e.magnetism?Math.random():1;(!u||Math.abs(n.args.xSpeed)<8)&&(n.args.xSpeed+=h*(s*g)),(!l||Math.abs(n.args.ySpeed)<8)&&(n.args.ySpeed+=p*(c*g)),n.args.falling=!0};for(n.s();!(r=n.n()).done;)i()}catch(t){n.e(t)}finally{n.f()}}}}])&&c(e.prototype,r),n&&c(e,n),h}();t.ElectricSheild=g}),require.register("powerups/FireSheild.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.FireSheild=void 0;var i=e("curvature/base/Bindable"),o=e("./Sheild");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(h,o.Sheild);var e,r,n,l=c(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return f(u(t=l.call.apply(l,[this].concat(r))),"template",'<div class = "sheild fire-sheild [[boosted]]"></div>'),f(u(t),"protect",!0),f(u(t),"type","fire"),t}return e=h,(r=[{key:"acquire",value:function(t){var e=this;if(t.viewport){t.addEventListener("damage",function r(n){if(t.args.currentSheild===i.Bindable.make(e)){n.preventDefault();var o=n.detail.other;o&&o.pop&&o.pop(t),e.onNextFrame(function(){t.args.currentSheild=null,t.inventory.remove(e)}),t.removeEventListener("damage",r),t.startle()}})}}},{key:"update",value:function(t){this.initSample||(this.initSample=new Audio("/Sonic/S3K_3E.wav"),this.initSample.volume=.15+-.05*Math.random(),this.sample=new Audio("/Sonic/S3K_43.wav"),this.sample.volume=.15+-.05*Math.random(),t.viewport.args.audio&&this.initSample.play()),t.public.falling||(this.power=15)}},{key:"hold_4",value:function(t,e){var r=this;this.power<=0||(this.power--,t.canFly||(t.args.falling?(t.impulse(1,Math.PI),this.args.boosted||(this.args.boosted="boosted",this.sample&&(this.sample.currentTime=0,this.sample.play()),t.viewport.onFrameOut(15,function(){return r.args.boosted=""}))):this.args.boosted=""))}},{key:"hold_5",value:function(t,e){var r=this;this.power<=0||(this.power--,t.canFly||(t.args.falling?(t.impulse(1,0),this.args.boosted||(this.args.boosted="boosted",this.sample&&(this.sample.currentTime=0,this.sample.play()),t.viewport.onFrameOut(15,function(){return r.args.boosted=""}))):this.args.boosted=""))}}])&&a(e.prototype,r),n&&a(e,n),h}();t.FireSheild=h}),require.register("powerups/Powerup.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Powerup=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,i.View);var e,r,n,c=s(u);function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),c.apply(this,arguments)}return e=u,(r=[{key:"equip",value:function(){}},{key:"unequip",value:function(){}},{key:"acquire",value:function(){}},{key:"drop",value:function(){}}])&&o(e.prototype,r),n&&o(e,n),u}();t.Powerup=u}),require.register("powerups/Sheild.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Sheild=void 0;var i=e("./Powerup");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=s(t);if(e){var o=s(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.Powerup);var e=a(r);function r(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),e.apply(this,arguments)}return r}();t.Sheild=c}),require.register("powerups/StarSheild.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.StarSheild=void 0;var i=e("./Sheild"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=l(t);if(e){var o=l(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return u(t)}(this,r)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(h,i.Sheild);var e,r,n,l=c(h);function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return f(u(t=l.call.apply(l,[this].concat(r))),"type","star"),f(u(t),"protect",!0),f(u(t),"template",'<div class = "sheild star-sheild">\n\t\t<div class = "star-sheild-stars"></div>\n\t</div>'),f(u(t),"frame",0),t}return e=h,(r=[{key:"acquire",value:function(t){var e=this,r=t.viewport;if(r){var n=function(e){e.preventDefault();var r=e.detail.other;r&&r.pop&&r.pop(t)};t.addEventListener("damage",n),r.onFrameOut(600,function(){t.inventory.remove(e),t.removeEventListener("damage",n)})}}},{key:"drop",value:function(t){console.log(this,t)}},{key:"update",value:function(t){var e=t.viewport;if(e){var r=new o.Tag('<div class = "particle-stars">'),n=t.rotatePoint(t.args.gSpeed,t.args.height/2),i=t.dashed||"springdash"===t.args.animation;r.style({"--x":n[0]+t.x+-4+t.args.xSpeed,"--y":n[1]+t.y+(i?-18:0)+t.args.ySpeed,"--frame":this.frame++,"z-index":-1,opacity:2*Math.random()}),e.particles.add(r),e.onFrameOut(15,function(){return e.particles.remove(r)})}}}])&&a(e.prototype,r),n&&a(e,n),h}();t.StarSheild=h}),require.register("powerups/SuperSheild.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SuperSheild=void 0;var i=e("./Sheild");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return s(t)}(this,r)}}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.Sheild);var e=a(r);function r(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return u(s(t=e.call.apply(e,[this].concat(i))),"template",'<div class = "sheild super-sheild">\n\t\t<div class = "super-sheild-shine"></div>\n\t\t<div class = "super-sheild-spark"></div>\n\t\t<div class = "super-sheild-flare"></div>\n\t</div>'),u(s(t),"type","super"),t}return r}();t.SuperSheild=l}),require.register("region/BossRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BossRegion=void 0;var i=e("./Region");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,i.Region);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.type="region boss",t}return e=u,(r=[{key:"updateActor",value:function(t){t.args.falling||(this.args._boss||(this.viewport.actorsById[this.args.boss].args.hitPoints?t.args.bossMode=!0:t.args.bossMode=!1))}}])&&o(e.prototype,r),n&&o(e,n),u}();t.BossRegion=u}),require.register("region/CorkscrewRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CorkscrewRegion=void 0;var i=e("./Region");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t,e,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(f,i.Region);var e,r,n,l=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="region corkscrew",t}return e=f,n=[{key:"fromDef",value:function(t){var e=t.width,r=t.height,n=(t.x,t.y),i=c(u(f),"fromDef",this).call(this,t);return i.args.width=e,i.args.height=r,i.args.y=n+r,i}}],(r=[{key:"updateActor",value:function(t){if(t.canRoll&&!(t.args.falling&&t.args.ySpeed<0)){t.args.groundAngle=0;var e=(t.x-this.x)/this.args.width,r=(1+Math.cos(-Math.PI+e*Math.PI*2))*this.args.height*.5;t.args.y=this.y-r-1,t.args.ySpeed=0,t.args.xSpeed=Math.max(Math.abs(t.args.xSpeed)||t.args.width)*Math.sign(t.args.xSpeed),t.args.gSpeed=t.args.xSpeed,t.args.mode=0,t.args.ignore=-2,e>1||e<0?(t.args.falling=!1,t.args.y=this.y-1):t.args.animation="rolling"}}},{key:"collideA",value:function(t){return!1}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.CorkscrewRegion=l}),require.register("region/ExitRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ExitRegion=void 0;var i=e("./Region");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,i.Region);var e,r,n,c=s(u);function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=c.call.apply(c,[this].concat(r))).args.type="region exit",t}return e=u,(r=[{key:"updateActor",value:function(t){var e=this;if(t.controllable){var r=this.viewport;r.args.fade=!0,r.onFrameOut(30,function(){r.actors.remove(e),r.quit()})}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),u}();t.ExitRegion=u}),require.register("region/ForceRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ForceRegion=void 0;var i=e("./Region");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.Region);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="region region-force",t.args.xForce=0,t.args.yForce=-5,t}return e=f,(r=[{key:"update",value:function(){this.originalHeight||(this.originalHeight=this.public.height),a(u(f.prototype),"update",this).call(this)}},{key:"updateActor",value:function(t){if(t.args.falling)return Math.abs(t.public.xSpeed)<Math.abs(this.public.xForce)&&(t.args.xSpeed+=Math.sign(t.public.xSpeed- -this.public.xForce)),void(Math.abs(t.public.ySpeed)<Math.abs(this.public.yForce)&&(t.args.ySpeed+=Math.sign(t.public.ySpeed- -this.public.yForce)));switch(t.args.mode){case 0:Math.abs(t.public.gSpeed)<Math.abs(this.public.xForce)&&(t.args.gSpeed+=Math.sign(t.public.gSpeed- -this.public.xForce));break;case 1:Math.abs(t.public.gSpeed)<Math.abs(this.public.yForce)&&(t.args.gSpeed+=Math.sign(t.public.gSpeed- -this.public.yForce));break;case 2:Math.abs(t.public.gSpeed)<Math.abs(this.public.xForce)&&(t.args.gSpeed-=Math.sign(t.public.gSpeed- -this.public.xForce));break;case 3:Math.abs(t.public.gSpeed)<Math.abs(this.public.yForce)&&(t.args.gSpeed-=Math.sign(t.public.gSpeed- -this.public.yForce))}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.ForceRegion=l}),require.register("region/GrindingRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.GrindingRegion=void 0;var i=e("./Region");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.Region);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="region grinding",t}return e=f,(r=[{key:"update",value:function(){this.originalHeight||(this.originalHeight=this.public.height),a(u(f.prototype),"update",this).call(this)}},{key:"updateActor",value:function(t){t.args.falling||(t.args.grinding=!0)}},{key:"collideA",value:function(t,e){a(u(f.prototype),"collideA",this).call(this,t,e)}},{key:"collideB",value:function(t,e){a(u(f.prototype),"collideA",this).call(this,t,e)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.GrindingRegion=l}),require.register("region/LavaRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.LavaRegion=void 0;var i=e("./Region"),o=e("curvature/base/Tag");function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return l(t)}(this,r)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(p,i.Region);var e,r,n,h=u(p);function p(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=h.call.apply(h,[this].concat(o)),e=l(t),n=!0,(r="isWater")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="region region-lava",t.args.gravity=.5,t.args.drag=.85,t.args.density=10,t.skimSpeed=10,t}return e=p,(r=[{key:"update",value:function(){!this.filterWrapper&&this.tags.sprite&&(this.filterWrapper=new o.Tag('<div class = "region-filter-wrapper">'),this.colorWrapper=new o.Tag('<div class = "region-color-wrapper">'),this.filter=new o.Tag('<div class = "region-filter">'),this.color=new o.Tag('<div class = "region-color">'),this.filterWrapper.appendChild(this.filter.node),this.colorWrapper.appendChild(this.color.node),this.tags.sprite.appendChild(this.filterWrapper.node),this.tags.sprite.appendChild(this.colorWrapper.node)),this.originalHeight||(this.originalHeight=this.public.height),s(f(p.prototype),"update",this).call(this)}},{key:"collideA",value:function(t,e){s(f(p.prototype),"collideA",this).call(this,t,e)}},{key:"collideB",value:function(t,e){s(f(p.prototype),"collideA",this).call(this,t,e)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&a(e.prototype,r),n&&a(e,n),p}();t.LavaRegion=h}),require.register("region/Region.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Region=void 0;var i=e("../actor/PointActor");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function c(t,e,r){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(f,i.PointActor);var e,r,n,l=s(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="region",t.args.width=t.public.width||32,t.args.height=t.public.height||32,t.args.density=1,t.args.gravity=1,t.args.drag=1,t.skimSpeed=1/0,t.args.float=-1,t.skimmers=new WeakSet,t}return e=f,n=[{key:"fromDef",value:function(t){var e=c(u(f),"fromDef",this).call(this,t);return e.args.width=t.width,e.args.height=t.height,e.args.x=e.originalX=32*Math.floor(t.x/32)-0,e.args.y=e.originalY=32*Math.floor(t.y/32)-0,this.static=!0,e}}],(r=[{key:"skim",value:function(t){this.skimmers.add(t)}},{key:"updateStart",value:function(){this.skimmers=new WeakSet}},{key:"update",value:function(){c(u(f.prototype),"update",this).call(this);var t=-this.viewport.args.y-(this.y-this.args.height),e=-16-this.viewport.args.x-this.x;this.tags.sprite&&this.tags.sprite.style({"--viewportWidth":this.viewport.args.width+"px","--viewportHeight":this.viewport.args.height+"px","--leftBoundry":e+"px","--topBoundry":t+"px"})}},{key:"updateActor",value:function(t){}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.Region=l}),require.register("region/RollingRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RollingRegion=void 0;var i=e("./Region");e("curvature/base/Tag");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,i.Region);var e,r,n,l=c(f);function f(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=l.call.apply(l,[this].concat(r))).args.type="region rolling",t}return e=f,(r=[{key:"update",value:function(){this.originalHeight||(this.originalHeight=this.public.height),a(u(f.prototype),"update",this).call(this)}},{key:"updateActor",value:function(t){Math.abs(t.public.gSpeed)<4&&(t.args.gSpeed=4*Math.sign(t.args.gSpeed||t.args.direction)),t.public.rolling||(t.args.rolling=!0),t.willJump&&(t.willJump=!1)}},{key:"collideA",value:function(t,e){a(u(f.prototype),"collideA",this).call(this,t,e)}},{key:"collideB",value:function(t,e){a(u(f.prototype),"collideA",this).call(this,t,e)}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&o(e.prototype,r),n&&o(e,n),f}();t.RollingRegion=l}),require.register("region/ShadeRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ShadeRegion=void 0;var i=e("../ui/CharacterString"),o=e("../effects/Cylinder"),a=e("../effects/Pinch"),s=e("./Region"),c=e("curvature/base/Tag");function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,r){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return p(t)}(this,r)}}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(b,s.Region);var e,r,n,y=h(b);function b(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return d(p(t=y.call.apply(y,[this].concat(r))),"currentFilter",-1),d(p(t),"filters",["studio","western","heat","hydro","lava","frost","eight-bit","corruption","black-hole","normal"]),t.args.type="region region-shade",t}return e=b,(r=[{key:"onAttached",value:function(){this.filterWrapper=new c.Tag('<div class = "region-filter-wrapper">'),this.colorWrapper=new c.Tag('<div class = "region-color-wrapper">'),this.filter=new c.Tag('<div class = "region-filter">'),this.color=new c.Tag('<div class = "region-color">'),this.filterWrapper.appendChild(this.filter.node),this.colorWrapper.appendChild(this.color.node),this.mainElem=this.tags.sprite.parentNode,this.tags.sprite.appendChild(this.filterWrapper.node),this.mainElem.appendChild(this.colorWrapper.node),this.text=new i.CharacterString({value:""}),this.text.render(this.tags.sprite),this.cylinder=new o.Cylinder({id:"shade-cylinder",width:this.args.width,height:this.args.height}),this.cylinder.render(this.tags.sprite),this.pinch=new a.Pinch({id:"shade-pinch",width:this.args.width,height:this.args.height,scale:150}),this.pinch.render(this.tags.sprite),this.rotateFilter()}},{key:"update",value:function(){var t=this;l(g(b.prototype),"update",this).call(this),this.args.scale=175-Math.abs(25*Math.sin(Date.now()/200)),!this.switch&&this.public.switch&&(this.switch=this.viewport.actorsById[this.public.switch],this.switch&&this.switch.args.bindTo("active",function(e){e&&t.rotateFilter()}))}},{key:"rotateFilter",value:function(){this.mainElem&&this.public.filter&&this.mainElem.classList.remove(this.public.filter),this.mainElem&&(this.args.filter=this.filters[this.currentFilter++],this.currentFilter>=this.filters.length&&(this.currentFilter=0),this.public.filter&&this.mainElem.classList.add(this.public.filter),this.public.filter&&(this.text.remove(),this.text=new i.CharacterString({value:"".concat(this.currentFilter,": ").concat(this.public.filter)}),this.text.render(this.tags.sprite)))}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&u(e.prototype,r),n&&u(e,n),b}();t.ShadeRegion=y}),require.register("region/WaterRegion.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.WaterRegion=void 0;var i=e("./Region"),o=e("curvature/base/Tag"),a=e("curvature/base/View");function s(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,r){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return p(t)}(this,r)}}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(d,i.Region);var e,r,n,c=h(d);function d(){var t,e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=c.call.apply(c,[this].concat(o)),e=p(t),n=!0,(r="isWater")in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,t.args.type="region region-water",t.entryParticle='<div class = "particle-splash">',t.args.gravity=.4,t.args.drag=.85,t.args.density=1,t.skimSpeed=15,t.draining=0,t}return e=d,(r=[{key:"skim",value:function(t){var e=this;if(l(g(d.prototype),"skim",this).call(this,t),!(this.viewport.args.frameId%4)){var r=new o.Tag('<div class = "particle-skim">'),n=t.rotatePoint(t.public.gSpeed,0);r.style({"--x":n[0]+t.x,"--y":n[1]+t.y,"z-index":0,"--flip":"".concat(t.args.direction)}),this.viewport.particles.add(r),this.viewport.onFrameOut(16,function(){return e.viewport.particles.remove(r)})}}},{key:"update",value:function(){var t=this;if(!this.filterWrapper&&this.tags.sprite&&(this.filterWrapper=new o.Tag('<div class = "region-filter-wrapper">'),this.colorWrapper=new o.Tag('<div class = "region-color-wrapper">'),this.filter=new o.Tag('<div class = "region-filter">'),this.color=new o.Tag('<div class = "region-color">'),this.mask=a.View.from('<svg style = "width: 100vw;height: 100vh">\n\t\t\t\t<defs>\n\t\t\t\t\t<clipPath id = "mask-'.concat(this.args.id,'" clipPathUnits="userSpaceOnUse">\n\t    \t\t\t\t<path d="\n\t    \t\t\t\t\tM 0 0 L 0 ').concat(544," L ").concat(544," ").concat(544," L ").concat(544," 0 z\n\t    \t\t\t\t\tM ").concat(544," 150 L ").concat(544," 200 L ").concat(272," 175 L ").concat(272,' 175 z"\n\n\t    \t\t\t\t/>\n    \t\t\t\t</clipPath>\n    \t\t\t</defs>\n\t\t\t<svg>')),this.filterWrapper.appendChild(this.filter.node),this.colorWrapper.appendChild(this.color.node),this.tags.sprite.appendChild(this.filterWrapper.node),this.tags.sprite.appendChild(this.colorWrapper.node),this.mask.render(this.tags.sprite),this.tags.sprite.style({"--maskImage":"url(#mask-".concat(this.args.id,")")})),!this.switch&&this.public.switch&&(this.switch=this.viewport.actorsById[this.public.switch],this.switch.args.bindTo("active",function(e){!e&&t.draining,t.draining=e?1:-1})),this.originalHeight||(this.originalHeight=this.public.height),this.draining&&(this.draining>0&&this.public.height>=32?this.args.height-=3.5:this.draining<0&&this.public.height<this.originalHeight&&(this.args.height+=3.5),this.public.height<=0?(this.args.display="none",this.draining>0&&(this.draining=0)):this.args.display="initial"),this.target&&this.args.height!==this.target){var e,r,n=this.args.height-this.target,i=null!==(e=this.args.drainSpeed)&&void 0!==e?e:1,s=null!==(r=this.args.fillSpeed)&&void 0!==r?r:1,c=n>0?i:s;Math.abs(this.args.height-this.target)>c?this.args.height-=Math.abs(c)*Math.sign(n):this.args.height=this.target}l(g(d.prototype),"update",this).call(this)}},{key:"updateActor",value:function(t){var e=this;if(t.controllable&&!(t.y-t.args.height<this.y-this.args.height)&&this.viewport.args.frameId%5==0&&Math.random()>.9){var r=this.viewport,n=new o.Tag('<div class = "particle-bubble">'),i=t.rotatePoint.apply(t,s(t.facePoint)),a=(t.x,i[0],t.y+i[1]);n.style({"--startY":a,"--size":Math.random()});var c=this.onFrame(function(){var r=t.facePoint,i=t.x+r[0],o=t.y+r[1];t.y<e.y-e.public.height&&n.style({display:"none"}),o<e.y-e.public.height&&n.style({display:"none"}),n.style({"--x":i,"--y":o})}),u=this.onFrame(function(){n.style({"--maxY":e.y-e.args.height})});r.particles.add(n),r.onTimeout(350,function(){n.classList.add("float"),c()}),r.onTimeout(1e3,function(){n.classList.add("floating")}),setTimeout(function(){r.particles.remove(n),u()},1500)}}},{key:"solid",get:function(){return!1}},{key:"isEffect",get:function(){return!0}}])&&u(e.prototype,r),n&&u(e,n),d}();t.WaterRegion=d}),require.register("sprite/Png.js",function(t,e,r){"use strict";function n(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t){"@babel/helpers - typeof";return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return e&&s(t.prototype,e),r&&s(t,r),t}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Object.defineProperty(t,"__esModule",{value:!0}),t.Png=void 0;var l=[137,80,78,71,13,10,26,10],f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;a(this,t),u(this,"r",0),u(this,"g",0),u(this,"b",0),u(this,"a",1),this.r=e,this.g=r,this.b=n,this.a=i}return c(t,[{key:"mean",value:function(){return(this.r+this.g+this.b)/3}},{key:"hex",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;return 3===t?"".concat(this.r.toString(16).padStart(2,"0")).concat(this.g.toString(16).padStart(2,"0")).concat(this.b.toString(16).padStart(2,"0")):4===t?"".concat(this.r.toString(16).padStart(2,"0")).concat(this.g.toString(16).padStart(2,"0")).concat(this.b.toString(16).padStart(2,"0")).concat(this.a.toString(16).padStart(2,"0")):void 0}},{key:"valueOf",value:function(){return"rgba(".concat(this.r,", ").concat(this.g,", ").concat(this.b,", ").concat(this.a,")")}}]),t}(),h=function(){function t(){a(this,t),u(this,"previous",null),u(this,"content",null),u(this,"length",0),u(this,"start",0),u(this,"type",""),u(this,"crc",0)}return c(t,[{key:"text",get:function(){return this.bytes.map(function(t){return String.fromCharCode(t)}).join("")}},{key:"bytes",get:function(){for(var t=[],e=0;e<this.length;e++)t.push(this.content.getUint8(e));return t}}]),t}(),p=function(){function t(e){var r=this;a(this,t),u(this,"buffer",null),u(this,"width",0),u(this,"height",0),u(this,"depth",0),u(this,"colorType",0),u(this,"compression",0),u(this,"filter",0),u(this,"interlace",0),"string"==typeof e?this.ready=fetch(e).then(function(t){return t.arrayBuffer()}).then(function(t){r.buffer=t,r.checkHeader(),r.indexChunks()}):"object"===o(e)&&e instanceof t&&(this.ready=Promise.resolve(),this.buffer=e.buffer.slice(0),this.checkHeader(),this.indexChunks())}return c(t,[{key:"checkHeader",value:function(){var t=new Uint8Array(this.buffer);for(var e in l)if(l[e]!==t[e])throw new Error("Png is not valid.")}},{key:"readIhdr",value:function(){var t=this.chunks[0];this.width=t.content.getUint32(0),this.height=t.content.getUint32(4),this.depth=t.content.getUint8(8),this.colorType=t.content.getUint8(9),this.compression=t.content.getUint8(10),this.filter=t.content.getUint8(11),this.interlace=t.content.getUint8(12)}},{key:"palette",get:function(){var t=[];for(var e in this.chunks){var r=this.chunks[e];if("PLTE"===r.type){for(var n=0;n<r.bytes.length;n+=3){var i=new f(r.bytes[n+0],r.bytes[n+1],r.bytes[n+2]);t.push(i)}return t}}}},{key:"recolor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.palette,i=[];for(var o in r){var a=r[o],s=(a.valueOf(),a.mean(),a.hex());if(e[s]){var c=e[s],u=[c.substring(0,2),c.substring(2,4),c.substring(4,6)].map(function(t){return parseInt(t,16)});i.push.apply(i,n(u))}else i.push(a.r,a.g,a.b)}var l=new t(this);for(var f in l.chunks){var h=l.chunks[f];if("PLTE"===h.type){var p=new Uint8Array(l.buffer),g=new DataView(l.buffer,h.start+h.length,4);p.set(i,h.start),g.setUint32(0,l.runCrc(h))}}return l}},{key:"runCrc",value:function(e){if(!t.crcTable){t.crcTable=new Uint32Array(256);for(var r=0;r<256;r++){for(var n=r,i=0;i<8;i++)1==(1&n)?n=3988292384^n>>>1:n>>>=1;t.crcTable[r]=n}}var o=4294967295,a=new Uint8Array(this.buffer).slice(e.start-4,e.start+e.length);for(var s in a){var c=a[s];o=t.crcTable[255&(o^c)]^o>>>8}return o=(4294967295^o)>>>0}},{key:"indexChunks",value:function(){for(var t=[],e=8;e<this.buffer.byteLength;){var r=new DataView(this.buffer,e,4);e+=4;var n=new DataView(this.buffer,e,4);e+=4;var i=new h;i.start=e,i.length=r.getUint32();for(var o=0;o<4;o++){var a=n.getUint8(o),s=String.fromCharCode(a);i.type+=s}i.content=new DataView(this.buffer,e,i.length),e+=i.length;var c=new DataView(this.buffer,e,4);i.crc=c.getUint32(),i.previous=t[t.length-1],t.push(i),e+=4}this.chunks=t}},{key:"toBlob",value:function(){return new Blob([new Uint8Array(this.buffer)],{type:"image/png"})}},{key:"toUrl",value:function(){return URL.createObjectURL(this.toBlob())}}]),t}();t.Png=p,p.Pixel=f,p.Chunk=h}),require.register("tileMap/TileMap.js",function(t,e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileMap=void 0;var n=e("curvature/base/Tag");function i(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function t(e,r){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.heightMask=null,this.tileImages=new Map,this.tileNumberCache=new Map,this.tileSetCache=new Map,this.tileCache=new Map,this.heightMasks=new Map,this.heightMaskCache=new Map,this.solidCache=new Map,this.collisionLayers=[],this.destructibleLayers=[],this.tileLayers=[],this.objectLayers=[];var o=e.mapUrl;this.mapUrl=o,this.ready=new Promise(function(t){fetch(o).then(function(t){return t.json()}).then(function(e){Object.defineProperty(i,"mapData",{value:e});var r=e.layers||[];i.objectLayers=r.filter(function(t){return"objectLayers"===t.type}),i.tileLayers=r.filter(function(t){return"tilelayer"===t.type}),i.collisionLayers=i.tileLayers.filter(function(t){return!!t.name.match(/^Collision\s\d+/)}),i.destructibleLayers=i.tileLayers.filter(function(t){return!!t.name.match(/^Destructible\s\d+/)});var o=[],a=function(t){var e=i.mapData.tilesets[t],r=new Image;i.tileImages.set(e,r);var a=new Promise(function(t){r.addEventListener("load",function(o){var a=new n.Tag("<canvas>");a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0,r.width,r.height),i.heightMasks.set(e,a),t(r.heightMask)})});r.src="/map/"+e.image,o.push(a)};for(var s in i.mapData.tilesets)a(s);Promise.all(o).then(t)})})}var e,r,o;return e=t,(r=[{key:"reset",value:function(){for(var t=0;t<this.tileLayers.length;t++){var e=this.tileLayers[t];e.destroyed=!1,console.log(e)}}},{key:"coordsToTile",value:function(t,e,r){var n,i,o=this.mapData.tilewidth,a=0,s=0;this.tileLayers[r]&&(a=null!==(n=this.tileLayers[r].offsetX)&&void 0!==n?n:0,s=null!==(i=this.tileLayers[r].offsetY)&&void 0!==i?i:0);return[Math.floor((t-a)/o),Math.floor((e-s)/o)]}},{key:"getTileNumber",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.tileLayers,i=this.mapData;if(!n[r])return!1;if(t>=i.width||e>=i.height||t<0||e<0)return 0===r&&1;var o=e*i.width+t;if(o in n[r].data){var a=n[r].data[o];return a>0?a-1:0}return!1}},{key:"getObjectDefs",value:function(){if(this.mapData)return this.mapData.layers.filter(function(t){return"objectgroup"===t.type}).map(function(t){return t.objects}).flat()}},{key:"getTile",value:function(t){var e=this.tileCache.get(t);if(void 0!==e)return e;var r=this.blockSize,n=0,i=0,o="",a=this.getTileset(t),s=this.tileImages.get(a);if(t){var c=t+-a.firstgid+1,u=Math.ceil(s.width/r);n=c%u,i=Math.floor(c/u),o=a.image}var l=[n,i,o];return this.tileCache.set(t,l),l}},{key:"getSolid",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.coordsToTile(t,e,r),o=this.getTileNumber.apply(this,i(n).concat([r]));if(1===r||2===r){if(this.getSolid(t,e,0))return this.tileLayers[0];for(var a=3;a<this.tileLayers.length;a++){var s=this.tileLayers[a];if("Art"!==s.name.substring(0,3)&&("Foreground"!==s.name.substring(0,10)&&("Destructible"!==s.name.substring(0,12)||!s.destroyed)&&this.getSolid(t,e,a)))return this.tileLayers[a]}}if(r<=2){if(0===o)return!1;if(1===o)return this.tileLayers[r]}var c=this.getTileset(o),u=this.mapData.tilewidth,l=this.getTile(o).map(function(t){return t*u}),f=Number(t)%u,h=Number(e)%u,p=l[0]+f,g=l[1]+h,d=[p,g,o].join("::"),y=this.heightMaskCache;if(y.has(d))return y.get(d);var b=!1;return b=255===this.heightMasks.get(c).getContext("2d").getImageData(p,g,1,1).data[3]&&this.tileLayers[r],y.set(d,b),b}},{key:"getTileset",value:function(t){t=Number(t);var e=this.tileSetCache.get(t);if(void 0!==e)return e;if(this.mapData)for(var r in this.mapData.tilesets){var n=this.mapData.tilesets[r];if(t+1>=n.firstgid){var i=this.mapData.tilesets[Number(r)+1];if(!i)return this.tileSetCache.set(t,n),n;if(t+1<i.firstgid)return this.tileSetCache.set(t,n),n}}}},{key:"blockSize",get:function(){return this.mapData.tilewidth}}])&&a(e.prototype,r),o&&a(e,o),t}();t.TileMap=s}),require.register("titlecard/Titlecard.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Titlecard=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=Symbol("Accept"),f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(h,i.View);var r,n,u,f=s(h);function h(){var t,r,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),t=f.call(this,o,a),r=c(t),n="template",i=e("./titlecard.html"),n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,t.args.firstLine=o.firstLine||"First Line",t.args.secondLine=o.secondLine||"Second Line",t.args.creditLine=o.creditLine||"Credit Line",t.args.actNumber=o.actNumber||1,t.args.animation="start",t.played=new Promise(function(e){return t[l]=e}),t}return r=h,(n=[{key:"play",value:function(t){var e=this;if(this.playing)return this.playing;var r=new Promise(function(t){var r=e.args.waitFor||Promise.resolve(),n=750;e.onTimeout(n,function(){return e.onNextFrame(function(){return e.args.animation=""})}),n+=750,e.onTimeout(n,function(){return e.onNextFrame(function(){return e.args.animation="opening"})}),n+=500,r.finally(function(){e.onTimeout(n,function(){return e.onNextFrame(function(){return e.args.animation="opening2"})}),n+=750,e.onTimeout(n,function(){return e.onNextFrame(function(){return e.args.animation="closing"})}),e.onTimeout(n,function(){t([new Promise(function(t){return e.onTimeout(n+500,t)})]),e[l]()}),n+=1e3,e.onTimeout(n,function(){return e.onNextFrame(function(){return e.args.animation="closed"})}),n+=2500,e.onTimeout(n,function(){return e.onNextFrame(function(){e.args.animation="done",e.playing=!1})})})});return this.playing=r,r}}])&&o(r.prototype,n),u&&o(r,u),h}();t.Titlecard=f}),require.register("titlecard/titlecard.html",function(t,e,r){r.exports='<div class = "titlecard [[animation]]">\n\n\t<div class = "titlecard-field"></div>\n\n\t<div class = "titlecard-bottom-border">\n\t\t<div class = "titlecard-border-text">[[creditLine]]</div>\n\t</div>\n\n\t<div class = "titlecard-left-border">\n\t\t<div class = "titlecard-border-shadow"></div>\n\t\t<div class = "titlecard-border-color"></div>\n\t</div>\n\n\t<div class = "titlecard-title">\n\n\t\t<div class = "titlecard-title-box">\n\n\t\t\t<div class = "titlecard-title-line-1">[[firstLine]]</div>\n\n\t\t\t<div class = "titlecard-title-line-2">\n\t\t\t\t[[secondLine]]<div class = "titlecard-title-number">[[actNumber]]</div>\n\t\t\t</div>\n\n\t\t</div>\n\n\t</div>\n\n</div>\n'}),require.register("ui/CharacterString.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterString=void 0;var i=e("curvature/base/View");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return s(t)}(this,r)}}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.View);var e=a(r);function r(){var t,n,i,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];t=e.call.apply(e,[this].concat(c)),n=s(t),o='<div cv-ref = "main" class = "hud-character-string [[hide]] [[color]]" cv-each = "chars:char:c" style = "--scale:[[scale]];"><span\n\t\t\t\tclass = "hud-character"\n\t\t\t\tdata-type  = "[[char.type]]"\n\t\t\t\tdata-value = "[[char.pos]]"\n\t\t\t\tdata-index = "[[c]]"\n\t\t\t\tstyle      = "--value:[[char.pos]];--index:[[c]];--length:[[chars.length]];"\n\t\t\t>[[char.original]]</span></div>',(i="template")in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,t.args.chars=[],t.args.scale=t.args.scale||1;t.args.high,t.args.med,t.args.low;return t.args.bindTo("value",function(e){var r=String(e).split("").map(function(e,r){var n=e,i="number";if(" "===e||Number(e)!=e)switch(e){case"-":e=11,i="number";break;case":":e=10,i="number";break;case".":e=12,i="number";break;case"/":e=13,i="number";break;case" ":e=14,i="number";break;default:e=String(e).toLowerCase().charCodeAt(0)-97,i="letter"}return t.args.chars[r]?(t.args.chars[r].original=n,t.args.chars[r].type=i,t.args.chars[r].pos=e,t.args.chars[r]):{pos:e,type:i,original:n}});r.length!==t.args.chars.length&&t.args.chars.splice(r.length),Object.assign(t.args.chars,r)}),t}return r}();t.CharacterString=u}),require.register("ui/ClickSwitch.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ClickSwitch=void 0;var i=e("curvature/base/View");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return c(t)}(this,r)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(f,i.View);var r,n,u,l=s(f);function f(){var t,r,n,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return t=l.call.apply(l,[this].concat(a)),r=c(t),n="template",i=e("./click-switch.html"),n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,t}return r=f,(n=[{key:"toggle",value:function(){this.args.active=!this.args.active}}])&&o(r.prototype,n),u&&o(r,u),f}();t.ClickSwitch=l}),require.register("ui/HudFrame.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.HudFrame=void 0;var i=e("curvature/base/View");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=c(t);if(e){var o=c(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return s(t)}(this,r)}}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,i.View);var e=a(r);function r(){var t,n,i,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];return t=e.call.apply(e,[this].concat(c)),n=s(t),o='<div class = "hud-frame [[type]] [[alert]]">\n\t\t<div class = "hud-value">[[value]]</div>\n\t</div>',(i="template")in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,t}return r}();t.HudFrame=u}),require.register("ui/click-switch.html",function(t,e,r){r.exports='<div class = "switch" data-active = "[[active]]"  cv-on = "click:toggle(event)">\n\n\t<div class = "label labelOff">\n\t\t<img src = "/ui/mute.svg" />\n\t</div>\n\n\t<div class = "slide">\n\t\t<div class = "head"></div>\n\t</div>\n\n\t<div class = "label labelOn">\n\t\t<img src = "/ui/unmute.svg" />\n\t</div>\n\n</div>\n'}),require.register("viewport/Layer.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Layer=void 0;var i=e("curvature/base/Bindable"),o=e("curvature/base/View"),a=e("curvature/base/Tag"),s=e("curvature/base/Bag");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return f(t)}(this,r)}}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(g,o.View);var r,n,h,p=l(g);function g(t,r){var n,o,a,c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),t[i.Bindable.NoGetters]=!0,n=p.call(this,t,r),o=f(n),a="template",c=e("./layer.html"),a in o?Object.defineProperty(o,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):o[a]=c,n[i.Bindable.NoGetters]=!0,n.args.width=t.width||320,n.args.height=t.height||200,n.args.blockSize=32,n.x=0,n.y=0,n.args.offsetX=0,n.args.offsetY=0,n.args.layerId=n.args.layerId,Object.defineProperty(f(n),"blocksXY",{value:new Map}),Object.defineProperty(f(n),"blocks",{value:new s.Bag}),Object.defineProperty(f(n),"offsets",{value:new Map}),Object.defineProperty(f(n),"blockSrcs",{value:new Map}),n.args.blocks=n.blocks.list,n.args.bindTo("destroyed",function(t){n.args.viewport.tileMap.tileLayers[n.args.layerId].destroyed=!!t}),n.args.bindTo(["offsetX","offsetY"],function(t,e,r,i,o){var a=n.args.viewport.tileMap.tileLayers[n.args.layerId];n["".concat(e,"Changed")]=a["".concat(e,"Changed")]=t-(o||0),a[e]=t}),n}return r=g,(n=[{key:"move",value:function(){var t=this.args.viewport.tileMap.tileLayers[this.args.layerId];t&&(t.offsetXChanged=0,t.offsetYChanged=0),this.fallspeed=this.fallspeed||0,this.tags.background&&"Moving"===this.args.name.split(" ")[0]&&(this.args.offsetY=128*Math.sin(this.args.viewport.args.frameId/100),this.tags.background.style({"--offsetX":-this.args.offsetX%this.args.blockSize}),this.tags.background.style({"--offsetY":-this.args.offsetY%this.args.blockSize}))}},{key:"update",value:function(t){var e=this.args.viewport;if(this.args.destroyed&&this.tags.background){var r=e.tileMap,n=this.args.layerId;return r.tileLayers[n].destroyed=!0,void this.tags.background.style({display:"none"})}for(var i=this.args.blockSize,o=Math.ceil(this.args.width/i)+1,s=Math.ceil(this.args.height/i)+1,c=this.blocksXY,u=o/2,l=s/2,f=this.blocks,h=this.offsets,p=this.blockSrcs,g=this.args.offsetX,d=this.args.offsetY,y=this.args.layerId,b=o,v=0,m=0;m<=b;m+=Math.sign(o)){for(var w=m+-Math.ceil(this.x/i)+-Math.ceil(g/i)+(g>0?1:0),S=0;S<=s;S+=Math.sign(s)){var O=String(m)+"::"+String(S),x=S+-Math.ceil(this.y/i)+(this.offsetYChange<0?-Math.ceil(d/i):-Math.floor(d/i))+(d<0?-1:0),k=t.getTileNumber(w,x,y),j=void 0;if(c.has(O))j=c.get(O);else{j=new a.Tag("<div>"),c.set(O,j),j.style({width:i+"px",height:i+"px"});var P=i*m,_=i*S;j.style({transform:"translate(".concat(P,"px, ").concat(_,"px) scale(1.01, 1.01)"),position:"absolute",left:0,top:0}),f.add(j)}var M=[];y&&!1===k?(M[0]=-1,M[1]=-1):M=t.getTile(k);var R=h.get(j),A=p.get(j),T=M[0]*i*-1+"px "+M[1]*i*-1+"px",C=M[2];R===T&&A===C||(!1!==k&&0!==k?j.style({display:"initial","background-position":T,"background-image":"url(/map/".concat(C,")"),"--screenX":(u-v)/u,"--screenY":(S-l)/l}):j.style({display:"none"})),h.set(j,T),p.set(j,C)}v++}}}])&&c(r.prototype,n),h&&c(r,h),g}();t.Layer=p}),require.register("viewport/Viewport.js",function(t,e,r){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;var i=e("curvature/base/Bindable"),o=e("curvature/base/Bag"),a=(e("curvature/base/Tag"),e("curvature/base/View")),s=e("curvature/base/Router"),c=e("curvature/input/Keyboard"),u=e("../tileMap/TileMap"),l=e("../titlecard/Titlecard"),f=e("../particle/Particle3d"),h=(e("../backdrop/MarbleGarden"),e("../backdrop/ProtoLabrynth")),p=e("../backdrop/MysticCave"),g=e("../intro/Series"),d=(e("../intro/Card"),e("../intro/TitleScreenCard")),y=e("../intro/LoadingCard"),b=e("../intro/BootCard"),v=e("../intro/DebianCard"),m=e("../intro/WebkitCard"),w=e("../intro/SeanCard"),S=e("../Menu/PauseMenu.js"),O=e("../Menu/MainMenu.js"),x=e("../actor/LayerSwitch"),k=e("../region/Region"),j=e("../ui/CharacterString"),P=(e("../ui/HudFrame"),e("./Layer")),_=e("../controller/Controller"),M=e("../BackdropPalette"),R=e("../ObjectPalette"),A=e("../ui/ClickSwitch"),T=e("subspace-console/Console"),C=e("../console/task/Input"),E=e("../console/task/Impulse"),B=e("../console/task/Settings"),D=e("../console/task/Move"),I=e("../console/task/Pos"),F=e("../network/RtcClient"),L=e("../network/RtcServer"),N=e("../Classifier"),q=e("../network/ChatBox"),W=(e("../actor/Sonic"),e("../actor/Tails"),e("../actor/Seymour")),V=e("../actor/Chalmers");function G(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||H(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=H(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function U(t){return function(t){if(Array.isArray(t))return J(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||H(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(t,e){if(t){if("string"==typeof t)return J(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?J(t,e):void 0}}function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function K(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Y(t,e){return(Y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function X(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var r,i=Z(t);if(e){var o=Z(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;return $(t)}(this,r)}}function $(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Z(t){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Q(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Symbol("collision-cells-near");var tt=Symbol("collision-cell"),et=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Y(t,e)}(Z,a.View);var r,n,H,J=X(Z);function Z(t,r){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Z),Q($(n=J.call(this,t,r)),"secretSample",new Audio("/doom/dssecret.wav")),Q($(n),"secretsFound",new Set),Q($(n),"template",e("./viewport.html")),n[i.Bindable.NoGetters]=!0,s.Router.listen($(n),{"":function(){return""}}),n.objectPalette=R.ObjectPalette,n.meta={},n.callIntervals=new Map,n.callFrames=new Map,n.willDetach=new Map,n.backdrops=new Map,n.checkpoints=new Map,n.server=null,n.client=null,n.args.networked=!1,n.args.mouse="moved",n.settings=i.Bindable.make({blur:!0,displace:!0,showHud:!0,shortcuts:!0,showFps:!0,debugOsd:!1,outline:1,musicVol:100,sfxVol:100,username:"player"}),n.vizi=!0,n.args.level="";var c="/map/pixel-hill-zone.json",f=s.Router.query.map,h=!1;f&&f.match(/^\w/)&&(c="/map/"+f,h=!0),n.args.startFrameId=0,n.tileMap=new u.TileMap({mapUrl:c}),n.sprites=new o.Bag,n.world=null;n.tileMap.ready;var p=s.Router.query.nointro,d=[];for(var y in h?(p=!0,d.push(n.args.zonecard=new l.Titlecard({},$(n))),n.tileMap.ready.then(function(){n.setZoneCard(),n.args.zonecard.play().then(function(){n.startLevel()})})):p?(n.args.zonecard=new l.Titlecard({waitFor:n.tileMap.ready},$(n)),d.push(new O.MainMenu({timeout:-1},$(n)),n.args.zonecard)):d.push.apply(d,U(n.introCards())),n.args.noIntro=p?"no-intro":"",n.args.titlecard=new g.Series({cards:d},$(n)),n.args.pauseMenu=new S.PauseMenu({},$(n)),n.particleObserver=new IntersectionObserver(function(t,e){var r,n=z(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;0===i.intersectionRation?(i.target.style.display="none",i.target.remove()):delete i.target.style.display}}catch(t){n.e(t)}finally{n.f()}},{threshold:0}),n.particles=new o.Bag(function(t,e,r){r===o.Bag.ITEM_ADDED?(t.node&&n.particleObserver.observe(t.node),t.node&&n.tags.particles.appendChild(t.node)):r===o.Bag.ITEM_REMOVED&&t.remove()}),n.effects=new o.Bag,n.maxCameraBound=64,n.cameraBound=64,n.args.particles=n.particles.list,n.args.effects=n.effects.list,n.args.maxFps=60,n.args.currentActor="",n.args.xOffset=.5,n.args.yOffset=.5,n.args.xOffsetTarget=.5,n.args.yOffsetTarget=.75,n.args.topLine=new j.CharacterString({value:"",scale:2}),n.args.status=new j.CharacterString({value:"",scale:2}),n.args.focusMe=new j.CharacterString({value:"",scale:2}),n.args.labelChar=new j.CharacterString({value:"Char: "}),n.args.labelX=new j.CharacterString({value:"x pos: "}),n.args.labelY=new j.CharacterString({value:"y pos: "}),n.args.labelGround=new j.CharacterString({value:"Grounded: "}),n.args.labelCamera=new j.CharacterString({value:"Camera: "}),n.args.labelAngle=new j.CharacterString({value:"Gnd theta: "}),n.args.labelGSpeed=new j.CharacterString({value:"Gnd spd: "}),n.args.labelXSpeed=new j.CharacterString({value:"X air spd: "}),n.args.labelYSpeed=new j.CharacterString({value:"Y air spd: "}),n.args.labelMode=new j.CharacterString({value:"Mode: "}),n.args.labelFrame=new j.CharacterString({value:"Frame ID: "}),n.args.labelFps=new j.CharacterString({value:"FPS: "}),n.args.labelAirAngle=new j.CharacterString({value:"Air theta: "}),n.args.char=new j.CharacterString({value:"..."}),n.args.xPos=new j.CharacterString({value:0}),n.args.yPos=new j.CharacterString({value:0}),n.args.gSpeed=new j.CharacterString({value:0,high:199,med:99,low:49}),n.args.ground=new j.CharacterString({value:""}),n.args.xSpeed=new j.CharacterString({value:0}),n.args.ySpeed=new j.CharacterString({value:0}),n.args.mode=new j.CharacterString({value:0}),n.args.angle=new j.CharacterString({value:0}),n.args.cameraMode=new j.CharacterString({value:0}),n.args.airAngle=new j.CharacterString({value:0}),n.args.nowPlaying=new j.CharacterString({value:"Now playing"}),n.args.trackName=new j.CharacterString({value:"Ice cap zone act 1 theme"}),n.args.fpsSprite=new j.CharacterString({value:0}),n.args.frame=new j.CharacterString({value:0}),n.args.scoreLabel=new j.CharacterString({value:"SCORE: ",color:"yellow"}),n.args.timerLabel=new j.CharacterString({value:"TIME: ",color:"yellow"}),n.args.ringLabel=new j.CharacterString({value:"RINGS: ",color:"yellow"}),n.args.actClearLabel=new j.CharacterString({value:"...",color:"yellow"}),n.args.perfectBonusLabel=new j.CharacterString({value:"PERFECT BONUS: ",color:"yellow"}),n.args.perfectBonus=new j.CharacterString({value:0}),n.args.speedBonusLabel=new j.CharacterString({value:"SPEED BONUS: ",color:"yellow"}),n.args.speedBonus=new j.CharacterString({value:0}),n.args.ringBonusLabel=new j.CharacterString({value:"RING BONUS: ",color:"yellow"}),n.args.ringBonus=new j.CharacterString({value:0}),n.args.timeBonusLabel=new j.CharacterString({value:"TIME BONUS: ",color:"yellow"}),n.args.timeBonus=new j.CharacterString({value:0}),n.args.totalBonusLabel=new j.CharacterString({value:"TOTAL: ",color:"yellow"}),n.args.totalBonus=new j.CharacterString({value:0}),n.args.rings=new j.CharacterString({value:0}),n.args.score=new j.CharacterString({value:0}),n.args.timer=new j.CharacterString({value:"00:00"}),n.args.frameId=-1,n.settings.bindTo("displace",function(t){return n.args.displacement=t?"on":"off"}),n.settings.bindTo("outline",function(t){return n.args.outline=t}),n.settings.bindTo("debugOsd",function(t){return n.args.debugOsd=t}),n.settings.bindTo("showHud",function(t){return n.args.showHud=t}),n.settings.bindTo("shortcuts",function(t){return n.args.shortcuts=t}),n.settings.bindTo("showFps",function(t){return n.args.showFps=t}),n.args.emeralds=[],n.settings){var b=localStorage.getItem("sonic-3000-setting-v0.0.0="+y);try{var v;n.settings[y]=null!==(v=JSON.parse(b))&&void 0!==v?v:n.settings[y]}catch(t){console.warn(t)}}n.settings.bindTo(function(t,e){localStorage.setItem("sonic-3000-setting-v0.0.0="+e,JSON.stringify(t))}),n.args.blockSize=32,n.args.populated=!1,n.args.willStick=!1,n.args.stayStuck=!1,n.args.willStick=!0,n.args.stayStuck=!0,n.args.width=512,n.args.height=288,n.args.scale=2,s.Router.query.noScale&&(n.args.width=896,n.args.height=512,n.args.scale=1),s.Router.query.bigScale&&(n.args.width=1920,n.args.height=1088,n.args.scale=1),n.collisions=new Map,n.args.x=n.args.x||0,n.args.y=n.args.y||0,n.args.fgLayers=[],n.args.layers=[],n.args.animation="",n.regions=new Set,n.spawn=new Set,n.auras=new Set,n.recent=new Set,n.actorsById={},n.playable=new Set,n.actors=new o.Bag(function(t,e,r){r==o.Bag.ITEM_ADDED?(t.viewport=$(n),n.setColCell(t),t instanceof k.Region&&n.regions.add(t),t.controllable&&n.playable.add(t),n.actorsById[t.args.id]=t,n.objectDb.add(t)):r==o.Bag.ITEM_REMOVED&&(t.viewport=null,t.remove(),t[tt]&&(n.playable.delete(t),t[tt].delete(t)),t instanceof k.Region&&n.regions.delete(t),n.auras.delete(t),delete n.actorsById[t.args.id],delete t[tt],n.objectDb.remove(t))});return n.layerDb=new N.Classifier([/^Art\s+$/,/^Collision\s+$/,/^Destructible\s+$/],function(){}),n.objectDb=new N.Classifier(Object.values(R.ObjectPalette)),n.blocks=new o.Bag,n.args.blocks=n.blocks.list,n.args.actors=n.actors.list,n.listen(window,"gamepadconnected",function(t){return n.padConnected(t)}),n.listen(window,"gamepaddisconnected",function(t){return n.padRemoved(t)}),n.colCellDiv=n.args.width>n.args.height?.75*n.args.width:.75*n.args.height,n.colCellCache=new Map,n.colCells=new Map,n.actorPointCache=new Map,n.startTime=null,n.args.audio=!0,n.nextControl=!1,n.updateStarted=new Set,n.updateEnded=new Set,n.updated=new Set,n.args.xBlur=0,n.args.yBlur=0,n.args.controlCard=a.View.from(e("../cards/basic-controls.html")),n.args.moveCard=a.View.from(e("../cards/basic-moves.html")),n.args.isRecording=!1,n.args.isReplaying=!1,n.replayInputs=[],n.args.standalone="",n.args.fullscreen="",n.args.initializing="initializing",n.args.muteSwitch=new A.ClickSwitch,n.args.muteSwitch.args.active=!!JSON.parse(localStorage.getItem("sonic-3000-audio-enabled")||0),n.args.muteSwitch.args.bindTo("active",function(t){return n.args.audio=t}),n.args.bindTo("audio",function(t){localStorage.setItem("sonic-3000-audio-enabled",t)}),n.args.showConsole=null,n.listen(document,"keydown",function(t){"Escape"===t.key&&(n.args.showConsole=!1),"F10"!==t.key&&"`"!==t.key||(n.args.subspace||(n.args.subspace=new T.Console({scroller:n.tags.subspace,path:{input:C.Input,move:D.Move,impulse:E.Impulse,pos:I.Pos,set:B.Settings}})),n.args.showConsole=n.args.showConsole?null:"showConsole",t.preventDefault())}),n.args.bindTo("showConsole",function(t){n.args.subspace&&(t?(n.onNextFrame(function(){return n.args.subspace.focus()}),n.args.showConsole="showConsole"):(n.onNextFrame(function(){return n.tags.viewport.focus()}),n.args.showConsole=null))}),n.controller=new _.Controller({deadZone:.2}),n.controller.zero(),n}return r=Z,(n=[{key:"fullscreen",value:function(){var t=this;if(document.fullscreenElement)return document.exitFullscreen(),this.showStatus(3e3," hit escape to revert. "),this.showStatus(0,""),this.args.focusMe.args.hide="",void(this.args.fullscreen="");this.args.focusMe.args.hide="hide",this.initScale=this.args.scale,this.showStatus(3500," hit escape to revert. "),this.tags.viewport.node.requestFullscreen().then(function(e){t.onTimeout(100,function(){t.fitScale(),t.args.fullscreen="fullscreen"})}).catch(function(t){return console.error(t)})}},{key:"fitScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=window.innerHeight/this.args.height,r=window.innerWidth/this.args.width;this.args.scale=t?e>r?e:r:e>r?r:e,this.tags.frame&&this.tags.frame.style({"--width":this.args.width,"--height":this.args.height,"--scale":this.args.scale})}},{key:"showStatus",value:function(t,e){var r=this;this.args.status.args.hide="",this.args.status.args.value=e,t>=0&&this.onTimeout(t,function(){r.args.status.args.hide="hide"})}},{key:"onAttached",value:function(t){var e=this;B.Settings.viewport=this,E.Impulse.viewport=this,C.Input.viewport=this,D.Move.viewport=this,I.Pos.viewport=this,this.onTimeout(100,function(){return e.fitScale(!1)}),this.onTimeout(20500,function(){e.args.focusMe.args.value=" Click here to enable keyboard control. "}),this.tags.blurDistance.setAttribute("style","filter:url(#motionBlur)"),this.tags.blurDistanceFg.setAttribute("style","filter:url(#motionBlur)"),this.listen(this.tags.frame,"click",function(t){t.target===e.tags.frame.node&&e.tags.viewport.focus()}),this.listen(window,"resize",function(t){e.onTimeout(100,function(){return e.fitScale(!1)})}),this.listen(document,"fullscreenchange",function(t){if(e.onTimeout(100,function(){return e.fitScale(!1)}),!document.fullscreenElement)return e.args.scale=e.initScale,void(e.args.fullscreen="")}),this.args.titlecard.play(),this.tags.frame.style({"--width":this.args.width,"--height":this.args.height,"--scale":this.args.scale}),this.startTime||(this.startTime=0),this.args.started=!1,this.args.running=!1,this.args.paused=!1,this.listen(document.body,"click",function(t){t.target===document.body&&e.tags.viewport.focus()}),this.args.scale=this.args.scale||1;var r=c.Keyboard.get();r.listening=!0,r.focusElement=this.tags.viewport.node,(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: fullscreen)").matches)&&(this.args.standalone="standalone",document.title="Sonic 3000",this.listen(window,"resize",function(){return e.fitScale(!1)}),this.onTimeout(100,function(){return e.fitScale(!1)})),this.onTimeout(100,function(){return e.args.initializing=""})}},{key:"setZoneCard",value:function(){if(this.tileMap.mapData&&this.tileMap.mapData.properties){var t,e=z(this.tileMap.mapData.properties);try{for(e.s();!(t=e.n()).done;){var r=t.value,n=r.name.replace(/-/g,"_");this.meta[n]=r.value}}catch(t){e.e(t)}finally{e.f()}}this.args.zonecard.args.firstLine=this.meta.titlecard_title_1,this.args.zonecard.args.secondLine=this.meta.titlecard_title_2,this.args.zonecard.args.creditLine=this.meta.titlecard_author,this.args.zonecard.args.actNumber=this.meta.titlecard_number}},{key:"fillBackground",value:function(){var t=M.BackdropPalette[this.meta.backdrop];delete this.args.backdrop,this.args.backdrop=t?new t:null,this.args.theme=this.meta.theme||"construct";for(var e=this.tileMap.tileLayers,r=e.length,n=0;n<r;n++){var i=new P.Layer({layerId:n,viewport:this,name:e[n].name,width:this.args.width,height:this.args.height});"Foreground"===e[n].name.substring(0,10)?this.args.fgLayers.push(i):this.args.layers.push(i)}}},{key:"startLevel",value:function(){var t=this;if(this.setZoneCard(),this.args.fade=!1,this.args.startFrameId=this.args.frameId,this.args.backdrop||this.fillBackground(),this.args.networked){var e=new V.Chalmers({name:"Player 1",x:1500,y:1600},this),r=new W.Seymour({name:"Player 2",x:1400,y:1600},this);this.auras.add(e),this.auras.add(r),this.actors.add(e),this.actors.add(r),e.render(this.tags.actors),e.onRendered(),e.onAttached&&e.onAttached(),r.render(this.tags.actors),r.onRendered(),r.onAttached&&r.onAttached()}this.populateMap();for(var n=0,i=[].concat(U(this.args.layers),U(this.args.fgLayers));n<i.length;n++){i[n].args.destroyed=!1}if(this.args.networked){if(this.args.networked){var o=this.actors.list;this.nextControl=this.nextControl||o[-1+this.args.playerId]}}else{this.actors.list;this.playableIterator||(this.playableIterator=this.playable.entries(),this.playableIterator.next()),this.nextControl=Object.values(this.args.actors)[0];var a=this.getCheckpoint(this.nextControl.args.id),s=a?this.actorsById[a.checkpointId]:null;s&&(this.args.startFrameId=this.args.frameId-a.frames,this.args.x=this.nextControl.args.x=s.x,this.args.y=this.nextControl.args.y=s.y)}this.nextControl&&this.nextControl.controller?this.nextControl.controller.zero():this.controller&&this.controller.zero(),c.Keyboard.get().reset(),this.args.zonecard.played.then(function(){t.args.started=!0,t.args.running=!0,t.update(),t.args.level="level",t.args.running=!1,t.onTimeout(1e3,function(){t.startTime=Date.now(),t.args.running=!0})})}},{key:"takeInput",value:function(t){var e=c.Keyboard.get();if(e.update(),this.gamepad)for(var r=navigator.getGamepads(),n=0;n<r.length;n++){var i=r.item(n);if(i)if(t.readInput({keyboard:e,gamepad:i}),i){var o=String(i.id);o.match(/xbox/i)?this.args.inputType="input-xbox":o.match(/playstation/i)?this.args.inputType="input-playstation":this.args.inputType="input-generic"}else this.args.inputName="keyboard",this.args.inputType=""}else t.readInput({keyboard:e});if(t.buttons[1011]&&1===t.buttons[1011].time&&this.fullscreen(),!this.args.networked&&!this.args.paused&&!this.dontSwitch&&t.buttons[11]&&1===t.buttons[11].time){this.playableIterator=this.playableIterator||this.playable.entries();var a=this.playableIterator.next();a.done&&(this.playableIterator=!1,this.playableIterator=this.playable.entries(),a=this.playableIterator.next()),a.value&&(this.nextControl=a.value[0],this.dontSwitch=3)}if(this.args.started&&(this.controlActor&&(this.args.currentSheild=this.controlActor.public.currentSheild?this.controlActor.public.currentSheild.type:""),t.buttons[9]&&t.buttons[9].active&&1===t.buttons[9].time&&(this.args.paused?this.unpauseGame():this.pauseGame()),this.controlActor&&this.args.isRecording)){var s=this.args.frameId,u=t.serialize(),l=Q({},this.controlActor.public.id,{x:this.controlActor.public.x,y:this.controlActor.public.y,gSpeed:this.controlActor.public.gSpeed,xSpeed:this.controlActor.public.xSpeed,ySpeed:this.controlActor.public.ySpeed});this.replayInputs.push({frame:s,input:u,args:l})}t.update({gamepad:this.gamepad})}},{key:"moveCamera",value:function(){if(this.controlActor){this.cameraBound<=this.maxCameraBound?this.cameraBound=this.maxCameraBound:this.cameraBound-=5e-4;var t=30,e=this.controlActor,r=e.public.highJump,n=e.public.deepJump,i=(e.public.falling,e.public.ySpeed);switch(e.public.jumping?(this.maxCameraBound=24,(n||r)&&(this.maxCameraBound=12)):this.maxCameraBound=64,this.controlActor.args.cameraMode){case"airplane":var o=this.controlActor.args.standingOn&&this.controlActor.args.standingOn.public.xSpeed,a=Math.abs(o);t=10;var s=Math.min(a/40,1)*-Math.sign(o);this.args.xOffsetTarget=.5+.5*s,this.args.yOffsetTarget=.5;break;case"railcar-aerial":case"railcar-normal":this.args.xOffsetTarget=.5,this.args.yOffsetTarget=.5,this.maxCameraBound=0,t=0;break;case"aerial":this.args.xOffsetTarget=.5,!e.public.flying&&(n||r)&&i>0?this.args.yOffsetTarget=.1:!e.public.flying&&(n||r)&&i<0?this.args.yOffsetTarget=.9:this.args.yOffsetTarget=.5,t=30;break;case"cinematic":this.args.xOffsetTarget=.5,this.args.yOffsetTarget=.5,this.maxCameraBound=1,t=0;break;case"cliff":this.args.xOffsetTarget=.5+-.02*this.controlActor.public.direction,this.args.yOffsetTarget=.45,t=30;break;case"bridge":this.args.xOffsetTarget=.5,this.args.yOffsetTarget=.65,t=30;break;case"boss":this.args.xOffsetTarget=.5,this.args.yOffsetTarget=.8,this.maxCameraBound=1,t=5;break;default:this.args.xOffsetTarget=.5,this.args.yOffsetTarget=.75,t=25}if("boss"!==this.controlActor.args.cameraMode){var c=this.controlActor.public.gSpeed,u=Math.abs(c),l=Math.min(u/25,1)*-Math.sign(c);switch(this.controlActor.public.mode){case 0:this.args.xOffsetTarget=.5+.35*l,this.args.yOffsetTarget=.6;break;case 1:this.args.xOffsetTarget=.25,this.args.yOffsetTarget=.5+.35*l;break;case 2:this.args.xOffsetTarget=.5-.35*l,this.args.yOffsetTarget=.3;break;case 3:this.args.xOffsetTarget=.75,this.args.yOffsetTarget=.5-.35*l}}if(this.args.yOffsetTarget+=this.controlActor.args.cameraBias,this.controlActor.args.cameraBias&&(t=15),t){var f=this.args.yOffsetTarget-this.args.yOffset;this.args.yOffset+=f/t}else this.args.yOffset=this.args.yOffsetTarget;if(t){var h=this.args.xOffsetTarget-this.args.xOffset;this.args.xOffset+=h/t}else this.args.xOffset=this.args.xOffsetTarget;var p=e.rotatePoint(0,-e.public.height/2),g=-e.x+p[0]+this.args.width*this.args.xOffset,d=-e.y+p[1]+this.args.height*this.args.yOffset,y=this.args.y-d,b=this.args.x-g,v=Math.sqrt(Math.pow(b,2)+Math.pow(y,2)),m=Math.atan2(y,b),w=this.cameraBound,S=Math.min(w,v),O=Math.abs(S/w),x=S/24,k=g+S*Math.cos(m),j=d+S*Math.sin(m);k=Number(Number(k-O*Math.cos(m)*x)),j=Number(Number(j-O*Math.sin(m)*x)),k>96&&(k=96),j>96&&(j=96);var P=-32*this.tileMap.mapData.width+this.args.width-96,_=-32*this.tileMap.mapData.height+this.args.height-96;k<P&&(k=P),j<_&&(j=_),this.args.x=k,this.args.y=j}}},{key:"applyMotionBlur",value:function(){var t=this.controlActor;if(this.settings.blur&&t&&this.tags.blur){var e=this.args.x-this.xPrev,r=this.args.y-this.yPrev,n=Math.pow(Number(e)/5,2),i=Math.pow(Number(r)/5,2);n=n<32?n:32,i=i<32?i:32;var o=Math.sqrt(Math.pow(n,2)+Math.pow(i,2))/2,a=Math.atan2(r,e).toFixed(4);o>.5?(this.tags.blurAngle.setAttribute("style","transform:rotate(calc(1rad * ".concat(a,"))")),this.tags.blurAngleFg.setAttribute("style","transform:rotate(calc(1rad * ".concat(a,"))")),this.tags.blurAngleCancel.setAttribute("style","transform:rotate(calc(-1rad * ".concat(a,"))")),this.tags.blurAngleCancelFg.setAttribute("style","transform:rotate(calc(-1rad * ".concat(a,"))")),this.tags.blur.setAttribute("stdDeviation","".concat(.75*o-1,", 0"))):(this.tags.blurAngle.setAttribute("style","transform:none;"),this.tags.blurAngleFg.setAttribute("style","transform:none;"),this.tags.blurAngleCancel.setAttribute("style","transform:none;"),this.tags.blurAngleCancelFg.setAttribute("style","transform:none;"),this.tags.blur.removeAttribute("stdDeviation")),this.xPrev=this.args.x,this.yPrev=this.args.y}else this.tags.blurAngle.setAttribute("style","transform:none;"),this.tags.blurAngleFg.setAttribute("style","transform:none;"),this.tags.blurAngleCancel.setAttribute("style","transform:none;"),this.tags.blurAngleCancelFg.setAttribute("style","transform:none;"),this.tags.blur.removeAttribute("stdDeviation")}},{key:"updateBackground",value:function(){var t=this,e=this.controlActor;e&&e.standingOn&&e.standingOn.isVehicle&&(e=this.controlActor.standingOn);for(var r=0,n=[].concat(U(this.args.layers),U(this.args.fgLayers));r<n.length;r++){var i=n[r],o=Math.sign(i.x-this.args.x),a=Math.sign(i.y-this.args.y);i.x=this.args.x,i.y=this.args.y,i.update(this.tileMap,o,a)}this.tileMap.ready.then(function(){var e,r=-32*t.tileMap.mapData.width,n=-32*t.tileMap.mapData.height,i=z(t.backdrops);try{for(i.s();!(e=i.n()).done;){var o=G(e.value,2)[1];if(!o.view){var a,s="",c=z(o.properties);try{for(c.s();!(a=c.n()).done;){var u=a.value;"backdrop"===u.name&&(s=u.value)}}catch(t){c.e(t)}finally{c.f()}"protolabrynth"===s?(o.view=new h.ProtoLabrynth,o.view.render(t.tags.backdrops)):"mystic-cave"===s&&(o.view=new p.MysticCave,o.view.render(t.tags.backdrops))}t.args.width,t.args.x,o.x,o.width,t.args.x,o.x;var l=t.args.height+-t.args.y+-o.y,f=-(-o.height-t.args.y-o.y);o.view&&Object.assign(o.view.args,{x:Math.round(t.args.x),xMax:r,y:t.args.y+o.y,yMax:t.args.y+o.y+-o.view.stacked,stacked:-o.view.stacked+"px",frame:t.args.frameId,top:l,bottom:f})}}catch(t){i.e(t)}finally{i.f()}t.args.backdrop&&Object.assign(t.args.backdrop.args,{x:t.args.x,y:t.args.y,xMax:r,yMax:n,frame:t.args.frameId,stacked:-t.args.backdrop.stacked+"px"})}),this.tags.bgFilters.style({"--x":Number(this.args.x),"--y":Number(this.args.y)}),this.tags.content.style({"--x":Number(this.args.x),"--y":Number(this.args.y),"--outlineWidth":this.settings.outline+"px"});var s=this.args.x<=0?this.args.x%this.args.blockSize:(-this.args.blockSize+this.args.x%this.args.blockSize)%this.args.blockSize,c=this.args.y<=0?this.args.y%this.args.blockSize:(-this.args.blockSize+this.args.y%this.args.blockSize)%this.args.blockSize;this.tags.background.style({transform:"translate( ".concat(s,"px, ").concat(c,"px )")}),this.tags.foreground.style({transform:"translate( ".concat(s,"px, ").concat(c,"px )")}),this.tags.frame.style({"--width":this.args.width,"--height":this.args.height,"--scale":this.args.scale})}},{key:"populateMap",value:function(){if(!this.args.populated){this.args.populated=!0;var t=this.tileMap.getObjectDefs();this.objDefs=new Map;var e,r=z(this.backdrops);try{for(r.s();!(e=r.n()).done;){var n=G(e.value,2),o=n[0],a=n[1];a.view&&a.view.remove(),this.backdrops.delete(o)}}catch(t){r.e(t)}finally{r.f()}var s,c=z(this.particles.list);try{for(c.s();!(s=c.n()).done;){var u=s.value;u&&(u.remove(),this.particles.remove(u))}}catch(t){c.e(t)}finally{c.f()}for(var l in t){var h=t[l],p=h.type;if("particle"===p){var g=new f.Particle3d;g.style({"--x":h.x,"--y":h.y}),this.particles.add(g.node)}if("backdrop"!==p){if(this.objDefs.set(h.id,h),R.ObjectPalette[p]&&(!this.args.networked||["layer-switch","ring","companion-block","region","force-region","shade-region","rolling-region","water-region","lava-region","block","switch","base-region","water-region","force-region","rolling-region","lava-region","q-block","sheild-fire-monitor","sheild-water-monitor","sheild-electric-monitor"].includes(p))){var d=R.ObjectPalette[p].fromDef(h);d[i.Bindable.NoGetters]=!0;var y=i.Bindable.make(d);this.actors.add(y),k.Region,y.render(this.tags.actors),y.onRendered(),y.onAttach&&!1===y.onAttach()&&y.detach(),this.actorIsOnScreen(y)?y.args.display="initial":(y.args.display="none",y.detach()),y.controllable&&(y.name=h.name,y.args.display="initial")}}else this.backdrops.set(h.id,h)}var b,v=z(this.actors.list);try{for(v.s();!(b=v.n()).done;){var m=b.value;if(m){var w=this.getCheckpoint(m.args.id);if(w&&w.checkpointId){var S=this.actorsById[w.checkpointId];m.args.x=S.x,m.args.y=S.y}}}}catch(t){v.e(t)}finally{v.f()}}}},{key:"actorIsOnScreen",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256;if(t){var r=this.args.width,n=this.args.height,i=-this.args.x-16-e,o=16-this.args.x+e+r,a=-this.args.y-e,s=-this.args.y+n+e,c=t.args.width,u=t.y-t.args.height,l=t.x-c/2,f=t.x+c+c/2;return i<f&&o>l&&a<t.y&&s>u||l<o&&f>i&&u<s&&t.y>a}}},{key:"spawnActors",value:function(){var t,e=new DocumentFragment,r=(new DocumentFragment,!1),n=z(this.spawn);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o.frame){if(o.frame<=this.args.frameId){this.spawn.delete(o),o.object[i.Bindable.NoGetters]=!0,this.actors.add(i.Bindable.make(o.object));o.object,k.Region;var a=e;o.object.render(a),o.object.onRendered(),o.object.onAttached&&o.object.onAttached(),o.object.onAttach&&!1===o.object.onAttach()&&o.object.detach(),r=!0}}else this.spawn.delete(o),o.object[i.Bindable.NoGetters]=!0,this.actors.add(i.Bindable.make(o.object)),o.object.render(e),o.object.onRendered(),o.object.onAttached&&o.object.onAttached(),o.object.onAttach&&!1===o.object.onAttach()&&o.object.detach(),r=!0}}catch(t){n.e(t)}finally{n.f()}r&&this.tags.actors.append(e)}},{key:"actorUpdateStart",value:function(t){for(var e in t){var r,n=z(t[e]);try{for(n.s();!(r=n.n()).done;){var i=r.value;this.updateStarted.has(i)||(this.updateStarted.add(i),i.updateStart(),i.colliding&&(i.colliding=!1))}}catch(t){n.e(t)}finally{n.f()}}}},{key:"actorUpdate",value:function(t){for(var e in t){var r,n=z(t[e]);try{for(n.s();!(r=n.n()).done;){var i=r.value;this.updated.has(i)||(this.updated.add(i),i.update())}}catch(t){n.e(t)}finally{n.f()}}}},{key:"actorUpdateEnd",value:function(t){for(var e in t){var r,n=z(t[e]);try{for(n.s();!(r=n.n()).done;){var i=r.value;this.updateEnded.has(i)||(this.updateEnded.add(i),i.args.colliding=i.colliding,i.updateEnd(),this.setColCell(i))}}catch(t){n.e(t)}finally{n.f()}}}},{key:"nearbyActors",value:function(t){var e=this.getNearbyColCells(t),r=(this.args.width,this.args.height,this.args.x,this.args.y,new Set);for(var n in e){var i,o=z(e[n]);try{for(o.s();!(i=o.n()).done;){var a=i.value;r.add(a)}}catch(t){o.e(t)}finally{o.f()}}return r}},{key:"update",value:function(){var t=this,e=this.controlActor?this.controlActor.controller:this.controller;if(this.args.paused||(this.callFrameOuts(),this.callFrameIntervals(),this.args.frameId++),!1!==this.args.paused&&!this.args.networked)return this.takeInput(e),this.args.pauseMenu.input(e),void(this.args.paused>0&&this.args.paused--);if(!this.args.started)return this.startTime=Date.now(),void(e&&(this.takeInput(e),this.args.titlecard&&this.args.titlecard.input(e)));for(var r=0,n=[].concat(U(this.args.layers),U(this.args.fgLayers));r<n.length;r++){var i=n[r],o=Math.sign(i.x-this.args.x),a=Math.sign(i.y-this.args.y);i.x=this.args.x,i.y=this.args.y,i.move(this.tileMap,o,a)}if(this.args.frameId%15==0){var s,c=z(this.willDetach);try{for(c.s();!(s=c.n()).done;){var u=G(s.value,2),l=u[0],f=u[1];this.willDetach.delete(l),f()}}catch(t){c.e(t)}finally{c.f()}}Number(this.args.rings.args.value)?this.args.ringLabel.args.color="yellow":this.args.ringLabel.args.color="red",this.args.fpsSprite.args.value=Number(this.args.fps).toFixed(2),this.args.frame.args.value=this.args.frameId;var h=(this.args.frameId-this.args.startFrameId)/60,p=String(Math.trunc(Math.abs(h)/60)).padStart(2,"0"),g=String(Math.trunc(Math.abs(h)%60)).padStart(2,"0"),d=h<0?"-":"";if(d&&(p=Number(p)),this.args.timer.args.value="".concat(d).concat(p,":").concat(g),this.dontSwitch>0&&this.dontSwitch--,this.dontSwitch<0&&(this.dontSwitch=0),this.args.rippleFrame=this.args.frameId%128,this.args.displaceWater=this.args.frameId%128,this.actorPointCache.clear(),this.controlActor)if(this.args.isReplaying){this.args.focusMe.args.hide="hide";var y=this.replayInputs[this.args.frameId];if(y&&y.actors){for(var b in y.actors){var v=this.actorsById[b],m=y.actors[b];m.input&&(v.controller.replay(m.input),v.readInput()),m.args&&Object.assign(v.args,m.args)}this.replayInputs.length&&(this.args.hasRecording=!0,this.args.topLine.args.value=" i cant believe its not canvas. ",this.args.status.args.value=" click here to exit demo. ")}else this.args.isReplaying=!1}else this.gamepad&&(this.args.focusMe.args.hide="hide"),this.args.cutScene||(this.controlActor.controller&&this.takeInput(this.controlActor.controller),this.controlActor.readInput());if(this.updateStarted.clear(),this.updated.clear(),this.updateEnded.clear(),this.args.running){var w,S=z(this.regions);try{for(S.s();!(w=S.n()).done;){var O=w.value;this.actorIsOnScreen(O,768)&&(O.updateStart(),O.update(),O.updateEnd(),this.updated.add(O))}}catch(t){S.e(t)}finally{S.f()}var j,P=z(this.auras);try{for(P.s();!(j=P.n()).done;){var _=j.value;if(!this.updated.has(_)){this.actorUpdateStart([[_]]),this.actorUpdate([[_]]),this.actorUpdateEnd([[_]]);var M=this.getNearbyColCells(_);this.actorUpdateStart(M),this.actorUpdate(M),this.actorUpdateEnd(M),this.setColCell(_)}}}catch(t){P.e(t)}finally{P.f()}if(this.collisions){var R,A=z(this.collisions);try{for(A.s();!(R=A.n()).done;){var T,C=G(R.value,2),E=(C[0],z(C[1]));try{for(E.s();!(T=E.n()).done;){var B=T.value;B&&B.pause(!1)}}catch(t){E.e(t)}finally{E.f()}}}catch(t){A.e(t)}finally{A.f()}}if(this.controlActor&&(this.args.score.args.value=String(this.controlActor.args.score).padStart(4," "),this.args.rings.args.value=String(this.controlActor.args.rings).padStart(4," "),this.args.hasRings=!!this.controlActor.args.rings,this.args.hasEmeralds=!!this.controlActor.args.emeralds,this.args.char.args.value=this.controlActor.args.name,this.args.charName=this.controlActor.args.name,this.args.debugOsd)){this.args.xPos.args.value=Number(this.controlActor.x).toFixed(2),this.args.yPos.args.value=Number(this.controlActor.y).toFixed(2),this.args.ground.args.value=this.controlActor.args.landed,this.args.gSpeed.args.value=Number(this.controlActor.args.gSpeed).toFixed(2),this.args.xSpeed.args.value=Number(this.controlActor.args.xSpeed).toFixed(2),this.args.ySpeed.args.value=Number(this.controlActor.args.ySpeed).toFixed(2),this.args.angle.args.value=(Math.round(1e3*this.controlActor.args.groundAngle)/1e3).toFixed(3),this.args.airAngle.args.value=(Math.round(1e3*this.controlActor.args.airAngle)/1e3).toFixed(3);this.args.mode.args.value=["FLOOR","L-WALL","CEILING","R-WALL"][Math.floor(this.controlActor.args.mode)]||Math.floor(this.controlActor.args.mode),this.args.cameraMode.args.value=this.controlActor.args.cameraMode}}var D=this.args.width,I=this.args.height,F=(this.args.x,this.args.x,this.args.y,this.args.y,new WeakSet);if(this.controlActor&&function(){for(var e=new DocumentFragment,r=(new DocumentFragment,!1),n=0,i=[t.nearbyActors(t.controlActor)||[],t.regions];n<i.length;n++){var o,a=z(i[n]);try{for(a.s();!(o=a.n()).done;){var s=o.value;!t.actorIsOnScreen(s)||s instanceof x.LayerSwitch||(s.args.display="initial",s.vizi||(s.public.hidden||(k.Region,s.nodes.map(function(t){return e.append(t)}),r=!0),s.wakeUp()),t.willDetach.delete(s),s.vizi=!0),F.add(s),t.recent.add(s)}}catch(t){a.e(t)}finally{a.f()}}var c,u=z(t.recent);try{var l=function(){var e=c.value,r=t.actorIsOnScreen(e);!e.vizi||t.willDetach.has(e)||r||(t.willDetach.set(e,function(){e.sleep(),e.args.display="none",e.detach(),e.vizi=!1,e.willhide=null,t.willDetach.delete(e)}),t.recent.delete(e))};for(u.s();!(c=u.n()).done;)l()}catch(t){u.e(t)}finally{u.f()}r&&t.tags.actors.append(e)}(),this.nextControl&&(!this.args.networked&&this.auras.clear(),this.controlActor&&this.controlActor.sprite.parentNode&&this.controlActor.sprite.parentNode.classList.remove("actor-selected"),this.controlActor&&(this.controlActor.selected=!1),this.controlActor=this.nextControl,this.controlActor.selected=!0,this.controlActor.sprite.parentNode.classList.add("actor-selected"),this.auras.add(this.controlActor),this.controlActor.args.display="initial",this.controlActor.nodes.map(function(e){return t.tags.actors.append(e)}),this.controlActor.vizi=!0,this.args.maxSpeed=null,this.nextControl=null),this.updateBackground(),this.controlActor&&(this.controlActor.setCameraMode(),this.moveCamera(),this.applyMotionBlur(),"seymour"===this.controlActor.args.name&&this.controlActor.y<3840&&this.controlActor.x>38400&&this.controlActor.standingOn&&this.controlActor.standingOn.isVehicle?(this.args.secret="aurora",this.secretsFound.has("seymour-aurora")||(this.args.audio&&this.secretSample&&(this.secretSample.currentTime=0,this.secretSample.volume=.25,this.secretSample.play()),this.showStatus(1e4," A secret is revealed "),this.secretsFound.add("seymour-aurora"))):this.args.secret=""),this.args.networked&&this.controlActor){var L={frame:this.serializePlayer()};1===this.args.playerId?this.server.send(JSON.stringify(L)):2===this.args.playerId&&this.client.send(JSON.stringify(L))}this.spawnActors(),this.collisions=new Map}},{key:"click",value:function(t){this.args.isReplaying&&(this.controlActor.controller.zero(),this.stop())}},{key:"regionsAtPoint",value:function(t,e){var r,n=new Set,i=z(this.regions);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=o.public,s=a.x,c=a.y,u=a.width,l=a.height;Math.floor(u/2);t>=s&&s+u>t&&c>=e&&e>c-l&&n.add(o)}}catch(t){i.e(t)}finally{i.f()}return n}},{key:"actorsAtPoint",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t+"::"+e,o=this.actorPointCache;if(o.has(i))return o.get(i);var a,s=[],c=z(this.getNearbyColCells({x:t,y:e}));try{for(c.s();!(a=c.n()).done;){var u,l=z(a.value);try{for(l.s();!(u=l.n()).done;){var f=u.value,h=f.public,p=h.x,g=h.y,d=h.width,y=h.height,b=Math.max(Math.floor(r/2),0),v=t-b,m=t+b,w=e-Math.max(n,0),S=d/2;m>=p-S&&p+S>v&&g>=w&&e>g-y&&s.push(f)}}catch(t){l.e(t)}finally{l.f()}}}catch(t){c.e(t)}finally{c.f()}return o.set(i,s),s}},{key:"screenBox",value:function(){return[this.camera.x-Math.floor(this.width/2),this.camera.y-Math.floor(this.height/2),this.camera.x+Math.ceil(this.width/2),this.camera.y+Math.ceil(this.height/2)]}},{key:"padConnected",value:function(t){this.gamepad=t.gamepad}},{key:"padRemoved",value:function(t){this.gamepad&&this.gamepad.index===t.gamepad.index&&(this.gamepad=null)}},{key:"getColCell",value:function(t){var e=this.colCellDiv,r=this.colCells,n=Math.floor(t.x/e),i=Math.floor(t.y/e),o="".concat(n,":").concat(i);if(!r.has(o)){var a=new Set;return r.set(o,a),a.name=o,a}return r.get(o)}},{key:"setColCell",value:function(t){t[i.Bindable.NoGetters]=!0,t=i.Bindable.make(t);var e=this.getColCell(t),r=t[tt];return r&&r!==e&&r.delete(t),t[tt]=e,t[tt].add(t),e}},{key:"getNearbyColCells",value:function(t){var e=t.x,r=t.y,n=this.colCellDiv,i=Math.floor(e/n),o=Math.floor(r/n),a="".concat(i,"::").concat(o),s=this.colCellCache.get(a);if(s)return s.filter(function(t){return t.size});var c=e-n,u=e,l=e+n,f=r-n,h=r,p=r+n;return this.colCellCache.set(a,s=[this.getColCell({x:c,y:f}),this.getColCell({x:c,y:h}),this.getColCell({x:c,y:p}),this.getColCell({x:u,y:f}),this.getColCell({x:u,y:h}),this.getColCell({x:u,y:p}),this.getColCell({x:l,y:f}),this.getColCell({x:l,y:h}),this.getColCell({x:l,y:p})]),s.filter(function(t){return t.size})}},{key:"screenFilter",value:function(t){this.args.screenFilter=t}},{key:"reset",value:function(){for(var t in this.args.actClear=!1,this.args.cutScene=!1,this.args.fade=!1,this.stop(),this.actors.list){var e=this.actors.list[t];this.actors.remove(e)}this.controlActor&&this.actors.remove(this.controlActor),this.callFrames.clear(),this.callIntervals.clear(),this.collisions.clear(),this.colCellCache.clear(),this.colCells.clear(),this.regions.clear(),this.spawn.clear(),this.auras.clear();var r,n=z(this.effects.list);try{for(n.s();!(r=n.n()).done;){var i=r.value;i&&this.effects.remove(i)}}catch(t){n.e(t)}finally{n.f()}var o,a=z(this.particles.list);try{for(a.s();!(o=a.n()).done;){var s=o.value;s&&this.particles.remove(s)}}catch(t){a.e(t)}finally{a.f()}this.spawn.clear(),this.actorPointCache.clear(),this.args.isRecording=!1,this.args.isReplaying=!1,this.args.populated=!1,this.controlActor=null,this.tags.viewport.focus();for(var c=0,u=[].concat(U(this.args.layers),U(this.args.fgLayers));c<u.length;c++){u[c].args.destroyed=!1}}},{key:"quit",value:function(){for(var t in this.args.actClear=!1,this.args.cutScene=!1,this.args.fade=!1,this.callFrames.clear(),this.callIntervals.clear(),this.collisions.clear(),this.colCellCache.clear(),this.colCells.clear(),this.regions.clear(),this.spawn.clear(),this.auras.clear(),this.args.timeBonus.args.value=0,this.args.ringBonus.args.value=0,this.args.speedBonus.args.value=0,this.args.totalBonus.args.value=0,this.actors.list){var e=this.actors.list[t];this.actors.remove(e)}for(var r=0,n=[].concat(U(this.args.layers),U(this.args.fgLayers));r<n.length;r++){n[r].args.destroyed=!1}this.args.isRecording=!1,this.args.isReplaying=!1,this.playableIterator=!1,this.args.populated=!1,this.args.paused=!1,this.args.started=!1,this.controlActor=null,this.args.frameId=-1,this.args.timer.args.value="",this.args.rings.args.value=0,this.args.hasRings=!1,this.args.hasCoins=!1,this.args.hasEmeralds=!1,this.args.char.args.value="",this.args.charName="",this.args.level=!1;this.args.layers.length;var i,o=z(this.args.layers);try{for(o.s();!(i=o.n()).done;){i.value.remove()}}catch(t){o.e(t)}finally{o.f()}var a,s=z(this.args.fgLayers);try{for(s.s();!(a=s.n()).done;){a.value.remove()}}catch(t){s.e(t)}finally{s.f()}var c=[];c.push.apply(c,U(this.homeCards())),this.args.titlecard=new g.Series({cards:c},this),this.args.backdrop=null,this.args.titlecard.play()}},{key:"introCards",value:function(){return[new y.LoadingCard({timeout:350,text:"loading"},this),new b.BootCard({timeout:3500}),new v.DebianCard({timeout:4500}),new m.WebkitCard({timeout:5500}),new w.SeanCard({timeout:5e3},this)].concat(U(this.homeCards()))}},{key:"homeCards",value:function(){var t=this.args.zonecard=new l.Titlecard({},this);return[new d.TitleScreenCard({timeout:5e4},this),new O.MainMenu({timeout:-1},this),t]}},{key:"record",value:function(){this.reset(),this.replayInputs=[],this.args.isRecording=!0,this.args.hasRecording=!0}},{key:"playback",value:function(){this.reset(),this.args.isReplaying=!0}},{key:"stop",value:function(){if(this.args.isReplaying=!1,this.args.isRecording){var t=JSON.stringify(U(this.replayInputs));localStorage.setItem("replay",t)}this.args.isRecording=!1,this.controlActor&&this.controlActor.controller.zero()}},{key:"focus",value:function(){this.tags.viewport&&this.tags.viewport.focus()}},{key:"getServer",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&e||new L.RtcServer({iceServers:[]});return this.listen(e,"open",function(r){console.log("Connection opened!"),t.args.chatBox=new q.ChatBox({pipe:e}),t.args.playerId=1},{once:!0}),this.listen(e,"message",function(e){var r=t.actors.list;if(r[1]){var n=JSON.parse(e.detail),i=r[1];n.frame&&(n.frame.input&&(i.controller.replay(n.frame.input),i.readInput()),n.frame.args&&Object.assign(i.args,n.frame.args))}}),this.server=e,e}},{key:"getClient",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.client||new F.RtcClient({iceServers:[]});return this.listen(e,"open",function(r){console.log("Connection opened!"),t.args.chatBox=new q.ChatBox({pipe:e}),t.args.playerId=2},{once:!0}),this.listen(e,"message",function(e){var r=t.actors.list;if(r[0]){var n=JSON.parse(e.detail),i=r[0];n.frame&&(n.frame.input&&(i.controller.replay(n.frame.input),i.readInput()),n.frame.args&&Object.assign(i.args,n.frame.args))}}),this.client=e,e}},{key:"serializePlayer",value:function(){return{frame:this.args.frameId,input:this.controlActor.controller.serialize(),args:{x:this.controlActor.public.x,y:this.controlActor.public.y,gSpeed:this.controlActor.public.gSpeed,xSpeed:this.controlActor.public.xSpeed,ySpeed:this.controlActor.public.ySpeed,direction:this.controlActor.public.direction,facing:this.controlActor.public.facing,falling:this.controlActor.public.falling,rolling:this.controlActor.public.rolling,jumping:this.controlActor.public.jumping,flying:this.controlActor.public.flying,float:this.controlActor.public.float,angle:this.controlActor.public.angle,mode:this.controlActor.public.mode,groundAngle:this.controlActor.public.groundAngle}}}},{key:"onFrameOut",value:function(t,e){if(!(t<=0)){var r=this.args.frameId+t;this.callFrames.has(r)||this.callFrames.set(r,new Set);var n=this.callFrames.get(r);return n.add(e),function(){return n.delete(e)}}}},{key:"onFrameInterval",value:function(t,e){if(!(frames<=0)){var r=t;this.callIntervals.has(r)||this.callIntervals.set(r,new Set);var n=this.callIntervals.get(r);return n.add(e),function(){return n.delete(e)}}}},{key:"callFrameOuts",value:function(){if(this.callFrames.has(this.args.frameId)){var t,e=z(this.callFrames.get(this.args.frameId));try{for(e.s();!(t=e.n()).done;){(0,t.value)()}}catch(t){e.e(t)}finally{e.f()}this.callFrames.delete(this.args.frameId)}}},{key:"callFrameIntervals",value:function(){var t,e=z(this.callIntervals);try{for(e.s();!(t=e.n()).done;){var r=G(t.value,2),n=r[0],i=r[1];if(this.args.frameId%n==0){var o,a=z(i);try{for(a.s();!(o=a.n()).done;){(0,o.value)()}}catch(t){a.e(t)}finally{a.f()}}}}catch(t){e.e(t)}finally{e.f()}}},{key:"pauseGame",value:function(){var t=this;this.focus(),this.args.paused=-1,this.args.pauseMenu.focusFirst(),this.onTimeout(6,function(){t.controller&&t.controller.zero()})}},{key:"unpauseGame",value:function(){var t=this;this.onTimeout(15,function(){t.controller&&t.controller.zero()}),this.onTimeout(30,function(){t.focus()}),this.onTimeout(60,function(){t.args.paused=!1})}},{key:"mousemove",value:function(t){var e=this;this.args.mouse="moved",this.onTimeout(5e3,function(){e.args.mouse="hide"})}},{key:"hyphenate",value:function(t){return String(t).replace(/\s/g,"-").toLowerCase()}},{key:"storeCheckpoint",value:function(t,e){this.checkpoints[this.tileMap.mapUrl]||(this.checkpoints[this.tileMap.mapUrl]={}),this.checkpoints[this.tileMap.mapUrl][t]={checkpointId:e,frames:this.args.frameId-this.args.startFrameId},localStorage.setItem("checkpoints:::".concat(this.tileMap.mapUrl),JSON.stringify(this.checkpoints[this.tileMap.mapUrl]))}},{key:"getCheckpoint",value:function(t){if(!this.checkpoints[this.tileMap.mapUrl]){var e=localStorage.getItem("checkpoints:::".concat(this.tileMap.mapUrl))||"{}";this.checkpoints[this.tileMap.mapUrl]=JSON.parse(e)||{}}return this.checkpoints[this.tileMap.mapUrl][t]}},{key:"clearCheckpoints",value:function(t){this.checkpoints[this.tileMap.mapUrl]||(this.checkpoints[this.tileMap.mapUrl]={}),delete this.checkpoints[this.tileMap.mapUrl][t],localStorage.setItem("checkpoints:::".concat(this.tileMap.mapUrl),JSON.stringify(this.checkpoints[this.tileMap.mapUrl]))}},{key:"clearAct",value:function(t){var e=this;this.args.actClearLabel.args.value=t;var r=Math.trunc(10*this.controlActor.args.clearSpeed),n=100*this.controlActor.args.rings,i=0,o=(this.args.frameId-this.args.startFrameId)/60,a=Math.trunc(Math.abs(o)),s=(i=a<30?5e4:a<45?1e4:a<60?5e3:a<90?4e3:a<120?3e3:a<180?2e3:a<240?1e3:500)+n+r;this.controlActor.args.score+=s,this.args.actClear=!0,this.args.timeBonus.args.value=0,this.args.ringBonus.args.value=0,this.args.speedBonus.args.value=0,this.args.totalBonus.args.value=0,this.onFrameOut(45,function(){return e.args.timeBonus.args.value=i}),this.onFrameOut(90,function(){return e.args.ringBonus.args.value=n}),this.onFrameOut(135,function(){return e.args.speedBonus.args.value=r}),this.onFrameOut(180,function(){return e.args.totalBonus.args.value=s}),this.onFrameOut(420,function(){return e.args.actClear=!1})}}])&&K(r.prototype,n),H&&K(r,H),Z}();t.Viewport=et}),require.register("viewport/layer.html",function(t,e,r){r.exports='<div data-name = "[[name]]" class = "viewport-background" cv-each = "blocks:block:b" cv-ref = "background" data-layer = "[[layerId]]">[[block]]</div>\n'}),require.register("viewport/viewport.html",function(t,e,r){r.exports='<section class = "filters" cv-each = "effects:effect">[[effect]]</section>\n\n<div class = "viewport-frame [[initializing]] [[standalone]] [[secret]] [[level]] [[noIntro]] [[inputType]]" cv-ref = "frame">\n\t<div class = "viewport-header">\n\t\t<span class = "sean-icon"></span>\n\t\t<h1>Pixel Physics</h1>\n\t</div>\n\t<div class = "viewport [[standalone]] [[fullscreen]] displacement-[[displacement]] mouse-[[mouse]] [[theme]]" cv-ref = "viewport" tabindex="0" cv-on = "click(event);mousemove(event)">\n\n\t\t<svg height="100" width="100">\n\t\t<defs>\n\n\t\t\t<filter id="motionBlur">\n\t\t\t\t<feGaussianBlur in="SourceGraphic" stdDeviation="0" cv-ref = "blur" />\n\t\t\t</filter>\n\n\t\t\t<filter id="dilate">\n\t\t\t\t<feMorphology operator="dilate" radius="0.25" result = "expanded"/>\n\t\t\t\t<feMerge>\n\t\t\t\t\t<feMergeNode in="expanded" />\n\t\t\t\t\t<feMergeNode in="SourceGraphic" />\n\t\t\t\t</feMerge>\n\t\t\t</filter>\n\n\t\t\t<filter id = "waves"\n\t\t\t\tcolor-interpolation-filters="sRGB"\n\t\t\t\tx      ="0%"\n\t\t\t\ty      ="0%"\n\t\t\t\theight ="100%"\n\t\t\t\twidth  ="100%"\n\t\t\t>\n\t\t\t\t<feFlood\n\t\t\t\t\tflood-color="#408000"\n\t\t\t\t\tresult = "DisplacementGreen"\n\t\t\t\t></feFlood>\n\n\t\t\t\t<feImage\n\t\t\t\t\txlink:href="/effects/wave.png"\n\t\t\t\t\tresult="DisplacementSource"\n\t\t\t\t\theight="64"\n\t\t\t\t\twidth="64"\n\t\t\t\t></feImage>\n\n\t\t\t\t<feTile\n\t\t\t\t\tin="DisplacementSource"\n\t\t\t\t\tresult="DisplacementTile"\n\t\t\t\t></feTile>\n\n\t\t\t\t<feComposite\n\t\t\t\t\tin  = "DisplacementTile"\n\t\t\t\t\tin2 = "DisplacementGreen"\n\t\t\t\t\tresult ="DisplacementField"\n\t\t\t\t\toperator ="over"\n\t\t\t\t></feComposite>\n\n\t\t\t\t<feOffset\n\t\t\t\t\tin  = "DisplacementField"\n\t\t\t\t\tout = "DisplacementOffset"\n\t\t\t\t\tdx  = "0"\n\t\t\t\t>\n\t\t\t\t\t<animate\n\t\t\t\t\t\tattributeName="dy"\n\t\t\t\t\t\tvalues = "0;-64"\n\t\t\t\t\t\tdur="1500ms"\n\t\t\t\t\t\trepeatCount="indefinite" />\n\n\t\t\t\t</feOffset>\n\n\t\t\t\t<feDisplacementMap\n\t\t\t\t\tin="SourceGraphic"\n\t\t\t\t\tin2="DisplacementOffset"\n\t\t\t\t\tresult="Displaced"\n\t\t\t\t\txChannelSelector="R"\n\t\t\t\t\tyChannelSelector="G"\n\t\t\t\t\tscale="4"\n\t\t\t\t></feDisplacementMap>\n\n\t\t\t\t<feGaussianBlur\n\t\t\t\t\tin="Displaced"\n\t\t\t\t\tstdDeviation="0.35"\n\t\t\t\t></feGaussianBlur>\n\n\t\t\t</filter>\n\n\t\t\t<filter id = "ntsc"\n\t\t\t\tcolor-interpolation-filters="sRGB"\n\t\t\t\tx      = "0%"\n\t\t\t\ty      = "0%"\n\t\t\t\twidth  = "100%"\n\t\t\t\theight = "200%"\n\t\t\t>\n\t\t\t\t<feFlood\n\t\t\t\t\tflood-color="#808000"\n\t\t\t\t\tresult = "DisplacementGreen"\n\t\t\t\t></feFlood>\n\n\t\t\t\t<feImage\n\t\t\t\t\txlink:href="/effects/ntsc-static.png"\n\t\t\t\t\tresult ="DisplacementSource"\n\t\t\t\t\twidth  = "128"\n\t\t\t\t\theight = "128"\n\t\t\t\t></feImage>\n\n\t\t\t\t<feTile\n\t\t\t\t\tin="DisplacementSource"\n\t\t\t\t\tresult="DisplacementTile"\n\t\t\t\t></feTile>\n\n\t\t\t\t<feComposite\n\t\t\t\t\tin  = "DisplacementTile"\n\t\t\t\t\tin2 = "DisplacementGreen"\n\t\t\t\t\tresult ="DisplacementField"\n\t\t\t\t\toperator ="over"\n\t\t\t\t></feComposite>\n\n\t\t\t\t<feOffset\n\t\t\t\t\tin  = "DisplacementField"\n\t\t\t\t\tout = "DisplacementOffset"\n\t\t\t\t\tdx  = "0"\n\t\t\t\t\tdy  = "0"\n\t\t\t\t>\n\t\t\t\t\t<animate\n\t\t\t\t\t\tattributeName="dy"\n\t\t\t\t\t\tvalues = "-128;0"\n\t\t\t\t\t\tdur="2000ms"\n\t\t\t\t\t\trepeatCount="8"\n\t\t\t\t\t></animate>\n\n\t\t\t\t</feOffset>\n\n\t\t\t\t<feDisplacementMap\n\t\t\t\t\tin="SourceGraphic"\n\t\t\t\t\tin2="DisplacementOffset"\n\t\t\t\t\tresult="Displaced"\n\t\t\t\t\txChannelSelector="R"\n\t\t\t\t\tyChannelSelector="G"\n\t\t\t\t\tscale = "0"\n\t\t\t\t>\n\t\t\t\t\t<animate\n\t\t\t\t\t\tattributeName="scale"\n\t\t\t\t\t\tvalues = "512;192;0"\n\t\t\t\t\t\tdur="2000ms"\n\t\t\t\t\t\trepeatCount="1"\n\t\t\t\t\t></animate>\n\n\t\t\t\t</feDisplacementMap>\n\n\t\t\t</filter>\n\n\t\t</defs>\n\t\t</svg>\n\n\t\t<div class = "viewport-zoom">\n\n\t\t\t[[backdrop]]\n\n\t\t\t<div class = "backdrops" cv-ref ="backdrops"></div>\n\n\t\t\t<div class = "blurAngle" cv-ref = "blurAngle">\n\t\t\t<div class = "blurDistance" cv-ref = "blurDistance">\n\t\t\t<div class = "blurAngleCancel" cv-ref = "blurAngleCancel">\n\t\t\t\t<div\n\t\t\t\t\tcv-ref  = "background"\n\t\t\t\t\tclass   = "viewport-bg-layers"\n\t\t\t\t\tcv-each = "layers:layer"\n\t\t\t\t>[[layer]]</div>\n\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class = "filters filters-background" cv-ref = "bgFilters"></div>\n\n\t\t\t<div cv-ref = "content" class = "viewport-content">\n\t\t\t\t<div cv-ref = "actors" class = "viewport-actors"></div>\n\t\t\t\t<div cv-ref = "particles" class = "viewport-particles"></div>\n \t\t\t</div>\n\n\t\t\t<div class = "blurAngle" cv-ref = "blurAngleFg">\n\t\t\t<div class = "blurDistance" cv-ref = "blurDistanceFg">\n \t\t\t<div class = "blurAngleCancel" cv-ref = "blurAngleCancelFg">\n\t\t\t\t<div\n\t\t\t\t\tcv-ref  = "foreground"\n\t\t\t\t\tclass   = "viewport-bg-layers"\n\t\t\t\t\tcv-each = "fgLayers:layer"\n\t\t\t\t>[[layer]]</div>\n\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n \t\t</div>\n\n \t\t<div class = "viewport-overlay">\n\t\t\t<div class = "hud hud-top-right hud-table"  cv-if = "debugOsd">\n\t\t\t\t<table>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td colspan = "2">[[char]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelGround]]</td>\n\t\t\t\t\t\t<td>[[ground]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelCamera]]</td>\n\t\t\t\t\t\t<td>[[cameraMode]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelMode]]</td>\n\t\t\t\t\t\t<td>[[mode]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelX]]</td>\n\t\t\t\t\t\t<td>[[xPos]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelY]]</td>\n\t\t\t\t\t\t<td>[[yPos]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelGSpeed]]</td>\n\t\t\t\t\t\t<td>[[gSpeed]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelXSpeed]]</td>\n\t\t\t\t\t\t<td>[[xSpeed]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelYSpeed]]</td>\n\t\t\t\t\t\t<td>[[ySpeed]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelAirAngle]]</td>\n\t\t\t\t\t\t<td>[[airAngle]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelAngle]]</td>\n\t\t\t\t\t\t<td>[[angle]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[labelFrame]]</td>\n\t\t\t\t\t\t<td>[[frame]]</td>\n\t\t\t\t\t</tr>\n\n\t\t\t\t</table>\n\t\t\t</div>\n\n\t\t\t<div class = "hud hud-top-right" cv-if = "showHud">\n\n\t\t\t\t<div class = "char-hud">\n\t\t\t\t\t[[char]]\n\t\t\t\t\t<div class = "char-icon [[charName|hyphenate]]"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class = "emerald-hud" cv-each = "emeralds:emerald:e">\n\t\t\t\t\t<img src = "/Sonic/emerald-[[emerald]]-mini.png" />\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t\t<div class = "hud hud-bottom-right" cv-if = "showHud">\n\n\t\t\t\t<div class ="sheild-hud [[currentSheild]] [[hasElectric]] [[hasFire]] [[hasWater]]">\n\t\t\t\t\t<div class = "sheild-icon sheild-electric"></div>\n\t\t\t\t\t<div class = "sheild-icon spacer"></div>\n\t\t\t\t\t<div class = "sheild-icon sheild-fire"></div>\n\t\t\t\t\t<div class = "sheild-icon sheild-water"></div>\n\t\t\t\t</div>\n\n\t\t\t\t<span class = "contents" cv-if = "showFps">\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>[[labelFps]]</td>\n\t\t\t\t\t\t\t<td>[[fpsSprite]]</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</span>\n\t\t\t</div>\n\n\t\t\t<div class = "hud hud-dark hud-bottom-left" cv-if = "showHud">\n\t\t\t\t[[nowPlaying]]\n\t\t\t\t[[trackName]]\n\t\t\t</div>\n\n\t\t\t<div class = "hud hud-top-left"  cv-if = "showHud">\n\t\t\t\t<div>[[scoreLabel]] [[score]]</div>\n\t\t\t\t<div>[[timerLabel]] [[timer]]</div>\n\t\t\t\t<div>[[ringLabel]] [[rings]]</div>\n\t\t\t</div>\n\n\t\t\t<div class = "hud hud-dark hud-centered" cv-if = "actClear">\n\t\t\t\t<table>\n\t\t\t\t\t<tr><td colspan="2">\n\t\t\t\t\t\t<div class = "centered">[[actClearLabel]]</div>\n\t\t\t\t\t</td></tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[timeBonusLabel]]</td>\n\t\t\t\t\t\t<td>[[timeBonus]]</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[ringBonusLabel]]</td>\n\t\t\t\t\t\t<td>[[ringBonus]]</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t\x3c!-- <tr>\n\t\t\t\t\t\t<td>[[perfectBonusLabel]]</td>\n\t\t\t\t\t\t<td>[[perfectBonus]]</td>\n\t\t\t\t\t</tr> --\x3e\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[speedBonusLabel]]</td>\n\t\t\t\t\t\t<td>[[speedBonus]]</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>[[totalBonusLabel]]</td>\n\t\t\t\t\t\t<td>[[totalBonus]]</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t</div>\n\n\t\t\t<section class = "pause-menu full" cv-if = "paused">[[pauseMenu]]</section>\n\n\t\t\t[[titlecard]]\n\n\t\t\t<div class = "topLine">\n\t\t\t\t<div class = "status-message">[[topLine]]</div>\n\t\t\t</div>\n\n\t\t\t<div class = "focus-me">\n\t\t\t\t<div class = "status-message">[[focusMe]]</div>\n\t\t\t</div>\n\n\t\t\t<div class = "status-message">[[status]]</div>\n\n\t\t\t<section class = "contents" cv-if = "networked">[[chatBox]]</section>\n\n\t\t\t\x3c!-- <div class = "filters filters-foreground" cv-ref = "fgFilters"></div> --\x3e\n\n\t\t\t<div class = "console [[showConsole]]" cv-ref = "subspace" tab-index = "0">[[subspace]]</div>\n\n\t\t\t<div class = "shade" data-fade = "[[fade]]"></div>\n\n\t\t</div>\n\n\t\t<div class = "quick-controls" cv-if = "shortcuts">\n\n\t\t\t[[muteSwitch]]\n\n\t\t\t<div class = "button" cv-on = "click:fullscreen()">\n\t\t\t\t<image src = "/ui/fullscreen.svg" />\n\t\t\t</div>\n\n\t\t</div>\n\n\n\t</div>\n\n</div>\n'}),require.register("___globals___",function(t,e,r){})}(),require("___globals___");
